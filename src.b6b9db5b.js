parcelRequire=function(e){var r="function"==typeof parcelRequire&&parcelRequire,n="function"==typeof require&&require,i={};function u(e,u){if(e in i)return i[e];var t="function"==typeof parcelRequire&&parcelRequire;if(!u&&t)return t(e,!0);if(r)return r(e,!0);if(n&&"string"==typeof e)return n(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return u.register=function(e,r){i[e]=r},i=e(u),u.modules=i,u}(function (require) {function Ne(a){return a&&a.__esModule?{d:a.default}:{d:a}}var Oe={};function a(){return function(){throw new Error("Unimplemented abstract method.")}()}var Fn=0;function ba(t){return t.ol_uid||(t.ol_uid=String(++Fn))}var Pe="6.0.0-beta.14";var Gn=Oe&&Oe.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),Qe=function(t){function r(r){var e=this,o="Assertion failed. See https://openlayers.org/en/"+("latest"===Pe?Pe:"v"+Pe.split("-")[0])+"/doc/errors/#"+r+" for details.";return(e=t.call(this,o)||this).code=r,e.name="AssertionError",e.message=o,e}return Gn(r,t),r}(Error);Oe.default=Qe;var hd={};var C={ADD:"add",REMOVE:"remove"};var xc={};var rb={PROPERTYCHANGE:"propertychange"};var id={};function Hn(e){var t=function(t){var r=e.listener,$=e.bindTo||e.target;return e.callOnce&&l(e),r.call($,t)};return e.boundListener=t,t}function Di(e,t,r,$){for(var n,a=0,i=e.length;a<i;++a)if((n=e[a]).listener===t&&n.bindTo===r)return $&&(n.deleteIndex=a),n}function Re(e,t){var r=jd(e);return r?r[t]:void 0}function jd(e,t){var r=e.ol_lm;return!r&&t&&(r=e.ol_lm={}),r}function In(e){delete e.ol_lm}function Ei(e,t){var r=Re(e,t);if(r){for(var $=0,n=r.length;$<n;++$)e.removeEventListener(t,r[$].boundListener),$a(r[$]);r.length=0;var a=jd(e);a&&(delete a[t],0===Object.keys(a).length&&In(e))}}function f(e,t,r,$,n){var a=jd(e,!0),i=a[t];i||(i=a[t]=[]);var s=Di(i,r,$,!1);return s?n||(s.callOnce=!1):(s={bindTo:$,callOnce:!!n,listener:r,target:e,type:t},e.addEventListener(t,Hn(s)),i.push(s)),s}function yc(e,t,r,$){return f(e,t,r,$,!0)}function ka(e,t,r,$){var n=Re(e,t);if(n){var a=Di(n,r,$,!0);a&&l(a)}}function l(e){if(e&&e.target){e.target.removeEventListener(e.type,e.boundListener);var t=Re(e.target,e.type);if(t){var r="deleteIndex"in e?e.deleteIndex:t.indexOf(e);-1!==r&&t.splice(r,1),0===t.length&&Ei(e.target,e.type)}$a(e)}}function Jn(e){var t=jd(e);if(t)for(var r in t)Ei(e,r)}var $="function"==typeof Object.assign?Object.assign:function(e,r){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),s=1,n=arguments.length;s<n;++s){var o=arguments[s];if(null!=o)for(var $ in o)o.hasOwnProperty($)&&(t[$]=o[$])}return t};function $a(e){for(var r in e)delete e[r]}var Se="function"==typeof Object.values?Object.values:function(e){var r=[];for(var t in e)r.push(e[t]);return r};function Vb(e){var r;for(r in e)return!1;return!r}var Te={};var zc=function(){function t(){this.disposed_=!1}return t.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},t.prototype.disposeInternal=function(){},t}();function W(){return!0}function sb(){return!1}function Ha(){}var L=function(){function t(t){this.propagationStopped,this.type=t,this.target=null}return t.prototype.preventDefault=function(){this.propagationStopped=!0},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t}();function Kn(t){t.stopPropagation()}var Ln=Te&&Te.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),tb=function(t){function e(){var e=t.call(this)||this;return e.pendingRemovals_={},e.dispatching_={},e.listeners_={},e}return Ln(e,t),e.prototype.addEventListener=function(t,e){var n=this.listeners_[t];n||(n=this.listeners_[t]=[]),-1===n.indexOf(e)&&n.push(e)},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new L(t):t,n=e.type;e.target=this;var i,r=this.listeners_[n];if(r){n in this.dispatching_||(this.dispatching_[n]=0,this.pendingRemovals_[n]=0),++this.dispatching_[n];for(var s=0,o=r.length;s<o;++s)if(!1===r[s].call(this,e)||e.propagationStopped){i=!1;break}if(--this.dispatching_[n],0===this.dispatching_[n]){var p=this.pendingRemovals_[n];for(delete this.pendingRemovals_[n];p--;)this.removeEventListener(n,Ha);delete this.dispatching_[n]}return i}},e.prototype.disposeInternal=function(){Jn(this)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var n=this.listeners_[t];if(n){var i=n.indexOf(e);t in this.pendingRemovals_?(n[i]=Ha,++this.pendingRemovals_[t]):(n.splice(i,1),0===n.length&&delete this.listeners_[t])}},e}(zc);Te.default=tb;var g={CHANGE:"change",ERROR:"error",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEOUT:"mouseout",MOUSEUP:"mouseup",MOUSEWHEEL:"mousewheel",MSPOINTERDOWN:"MSPointerDown",RESIZE:"resize",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",WHEEL:"wheel"};var Mn=id&&id.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),Ue=function(t){function r(){var r=t.call(this)||this;return r.revision_=0,r}return Mn(r,t),r.prototype.changed=function(){++this.revision_,this.dispatchEvent(g.CHANGE)},r.prototype.getRevision=function(){return this.revision_},r.prototype.on=function(t,r){if(Array.isArray(t)){for(var e=t.length,n=new Array(e),o=0;o<e;++o)n[o]=f(this,t[o],r);return n}return f(this,t,r)},r.prototype.once=function(t,r){if(Array.isArray(t)){for(var e=t.length,n=new Array(e),o=0;o<e;++o)n[o]=yc(this,t[o],r);return n}return yc(this,t,r)},r.prototype.un=function(t,r){if(Array.isArray(t))for(var e=0,n=t.length;e<n;++e)ka(this,t[e],r);else ka(this,t,r)},r}(tb);function Nn(t){if(Array.isArray(t))for(var r=0,e=t.length;r<e;++r)l(t[r]);else l(t)}id.unByKey=Nn,id.default=Ue;var Fi=xc&&xc.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ve=function(e){function t(t,r,n){var $=e.call(this,t)||this;return $.key=r,$.oldValue=n,$}return Fi(t,e),t}(L);xc.ObjectEvent=Ve;var ga=function(e){function t(t){var r=e.call(this)||this;return ba(r),r.values_={},void 0!==t&&r.setProperties(t),r}return Fi(t,e),t.prototype.get=function(e){var t;return this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t},t.prototype.getKeys=function(){return Object.keys(this.values_)},t.prototype.getProperties=function(){return $({},this.values_)},t.prototype.notify=function(e,t){var r;r=x(e),this.dispatchEvent(new Ve(r,e,t)),r=rb.PROPERTYCHANGE,this.dispatchEvent(new Ve(r,e,t))},t.prototype.set=function(e,t,r){if(r)this.values_[e]=t;else{var n=this.values_[e];this.values_[e]=t,n!==t&&this.notify(e,n)}},t.prototype.setProperties=function(e,t){for(var r in e)this.set(r,e[r],t)},t.prototype.unset=function(e,t){if(e in this.values_){var r=this.values_[e];delete this.values_[e],t||this.notify(e,r)}},t}(Ue),We={};function x(e){return We.hasOwnProperty(e)?We[e]:We[e]="change:"+e}xc.getChangeEventType=x,xc.default=ga;var Gi=hd&&hd.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),Hi={LENGTH:"length"},Ac=function(t){function r(r,e,n){var o=t.call(this,r)||this;return o.element=e,o.index=n,o}return Gi(r,t),r}(L);hd.CollectionEvent=Ac;var M=function(t){function r(r,e){var n=t.call(this)||this,o=e||{};if(n.unique_=!!o.unique,n.array_=r||[],n.unique_)for(var i=0,s=n.array_.length;i<s;++i)n.assertUnique_(n.array_[i],i);return n.updateLength_(),n}return Gi(r,t),r.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},r.prototype.extend=function(t){for(var r=0,e=t.length;r<e;++r)this.push(t[r]);return this},r.prototype.forEach=function(t){for(var r=this.array_,e=0,n=r.length;e<n;++e)t(r[e],e,r)},r.prototype.getArray=function(){return this.array_},r.prototype.item=function(t){return this.array_[t]},r.prototype.getLength=function(){return this.get(Hi.LENGTH)},r.prototype.insertAt=function(t,r){this.unique_&&this.assertUnique_(r),this.array_.splice(t,0,r),this.updateLength_(),this.dispatchEvent(new Ac(C.ADD,r,t))},r.prototype.pop=function(){return this.removeAt(this.getLength()-1)},r.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var r=this.getLength();return this.insertAt(r,t),this.getLength()},r.prototype.remove=function(t){for(var r=this.array_,e=0,n=r.length;e<n;++e)if(r[e]===t)return this.removeAt(e)},r.prototype.removeAt=function(t){var r=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Ac(C.REMOVE,r,t)),r},r.prototype.setAt=function(t,r){var e=this.getLength();if(t<e){this.unique_&&this.assertUnique_(r,t);var n=this.array_[t];this.array_[t]=r,this.dispatchEvent(new Ac(C.REMOVE,n,t)),this.dispatchEvent(new Ac(C.ADD,r,t))}else{for(var o=e;o<t;++o)this.insertAt(o,void 0);this.insertAt(t,r)}},r.prototype.updateLength_=function(){this.set(Hi.LENGTH,this.array_.length)},r.prototype.assertUnique_=function(t,r){for(var e=0,n=this.array_.length;e<n;++e)if(this.array_[e]===t&&e!==r)throw new Qe(58)},r}(ga);hd.default=M;var kd={};function q(r,$){if(!r)throw new Qe($)}var On=kd&&kd.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),K=function(e){function t(t){var r=e.call(this)||this;if(r.id_=void 0,r.geometryName_="geometry",r.style_=null,r.styleFunction_=void 0,r.geometryChangeKey_=null,f(r,x(r.geometryName_),r.handleGeometryChanged_,r),t)if("function"==typeof t.getSimplifiedGeometry){var o=t;r.setGeometry(o)}else{var n=t;r.setProperties(n)}return r}return On(t,e),t.prototype.clone=function(){var e=new t(this.getProperties());e.setGeometryName(this.getGeometryName());var r=this.getGeometry();r&&e.setGeometry(r.clone());var o=this.getStyle();return o&&e.setStyle(o),e},t.prototype.getGeometry=function(){return this.get(this.geometryName_)},t.prototype.getId=function(){return this.id_},t.prototype.getGeometryName=function(){return this.geometryName_},t.prototype.getStyle=function(){return this.style_},t.prototype.getStyleFunction=function(){return this.styleFunction_},t.prototype.handleGeometryChange_=function(){this.changed()},t.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(l(this.geometryChangeKey_),this.geometryChangeKey_=null);var e=this.getGeometry();e&&(this.geometryChangeKey_=f(e,g.CHANGE,this.handleGeometryChange_,this)),this.changed()},t.prototype.setGeometry=function(e){this.set(this.geometryName_,e)},t.prototype.setStyle=function(e){this.style_=e,this.styleFunction_=e?Ii(e):void 0,this.changed()},t.prototype.setId=function(e){this.id_=e,this.changed()},t.prototype.setGeometryName=function(e){ka(this,x(this.geometryName_),this.handleGeometryChanged_,this),this.geometryName_=e,f(this,x(this.geometryName_),this.handleGeometryChanged_,this),this.handleGeometryChanged_()},t}(ga);function Ii(e){return"function"==typeof e?e:(Array.isArray(e)?t=e:(q("function"==typeof e.getZIndex,41),t=[e]),function(){return t});var t}kd.createStyleFunction=Ii,kd.default=K;var Xe={};var ub={};function Pn(r,e,o){for(var n,t,$=o||vb,i=0,u=r.length,a=!1;i<u;)(t=+$(r[n=i+(u-i>>1)],e))<0?i=n+1:(u=n,a=!t);return a?i:~i}function vb(r,e){return r>e?1:r<e?-1:0}function wb(r,e){return r.indexOf(e)>=0}function Ye(r,e,o){var n=r.length;if(r[0]<=e)return 0;if(e<=r[n-1])return n-1;var t=void 0;if(o>0){for(t=1;t<n;++t)if(r[t]<e)return t-1}else if(o<0){for(t=1;t<n;++t)if(r[t]<=e)return t}else for(t=1;t<n;++t){if(r[t]==e)return t;if(r[t]<e)return r[t-1]-e<e-r[t]?t-1:t}return n-1}function Qn(r,e,o){for(;e<o;){var n=r[e];r[e]=r[o],r[o]=n,++e,--o}}function X(r,e){for(var o=Array.isArray(e)?e:[e],n=o.length,t=0;t<n;t++)r[r.length]=o[t]}function Rn(r,e){var o=r.indexOf(e),n=o>-1;return n&&r.splice(o,1),n}function Bc(r,e){var o=r.length;if(o!==e.length)return!1;for(var n=0;n<o;n++)if(r[n]!==e[n])return!1;return!0}function Sn(r,e,o){var n=e||vb;return r.every(function(e,t){if(0===t)return!0;var $=n(r[t-1],e);return!($>0||o&&0===$)})}function A(t){for(var e=S(),$=0,r=t.length;$<r;++$)Xb(e,t[$]);return e}function Tn(t,e,$){return la(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),$)}function ld(t,e,$){return $?($[0]=t[0]-e,$[1]=t[1]-e,$[2]=t[2]+e,$[3]=t[3]+e,$):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function Ji(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function xb(t,e,$){var r,o;return(r=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*r+(o=$<t[1]?t[1]-$:t[3]<$?$-t[3]:0)*o}function Ze(t,e){return $e(t,e[0],e[1])}function yb(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function $e(t,e,$){return t[0]<=e&&e<=t[2]&&t[1]<=$&&$<=t[3]}function _e(t,e){var $=t[0],r=t[1],o=t[2],n=t[3],p=e[0],i=e[1],a=E.UNKNOWN;return p<$?a|=E.LEFT:p>o&&(a|=E.RIGHT),i<r?a|=E.BELOW:i>n&&(a|=E.ABOVE),a===E.UNKNOWN&&(a=E.INTERSECTING),a}function S(){return[1/0,1/0,-1/0,-1/0]}function la(t,e,$,r,o){return o?(o[0]=t,o[1]=e,o[2]=$,o[3]=r,o):[t,e,$,r]}function Wb(t){return la(1/0,1/0,-1/0,-1/0,t)}function md(t,e){var $=t[0],r=t[1];return la($,r,$,r,e)}function Un(t,e){return Vn(Wb(e),t)}function Ki(t,e,$,r,o){return Li(Wb(o),t,e,$,r)}function Cc(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function af(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function Xb(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Vn(t,e){for(var $=0,r=e.length;$<r;++$)Xb(t,e[$]);return t}function Li(t,e,$,r,o){for(;$<r;$+=o)Wn(t,e[$],e[$+1]);return t}function Wn(t,e,$){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],$),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],$)}function Mi(t,e){var $;return($=e(Ia(t)))?$:($=e(zb(t)))?$:($=e(_a(t)))?$:($=e(wa(t)))||!1}function bf(t){var e=0;return cf(t)||(e=H(t)*va(t)),e}function Ia(t){return[t[0],t[1]]}function zb(t){return[t[2],t[1]]}function Yb(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function Xn(t,e){var $;return e===Ec.BOTTOM_LEFT?$=Ia(t):e===Ec.BOTTOM_RIGHT?$=zb(t):e===Ec.TOP_LEFT?$=wa(t):e===Ec.TOP_RIGHT?$=_a(t):q(!1,13),$}function Ni(t,e,$,r,o){var n=e*r[0]/2,p=e*r[1]/2,i=Math.cos($),a=Math.sin($),L=n*i,x=n*a,s=p*i,c=p*a,u=t[0],d=t[1],g=u-L+c,m=u-L-c,f=u+L-c,l=u+L+c,h=d-x-s,R=d-x+s,E=d+x+s,C=d+x-s;return la(Math.min(g,m,f,l),Math.min(h,R,E,C),Math.max(g,m,f,l),Math.max(h,R,E,C),o)}function va(t){return t[3]-t[1]}function Dc(t,e,$){var r=$||S();return fa(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):Wb(r),r}function wa(t){return[t[0],t[3]]}function _a(t){return[t[2],t[3]]}function H(t){return t[2]-t[0]}function fa(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function cf(t){return t[2]<t[0]||t[3]<t[1]}function Yn(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function Oi(t,e){var $=(t[2]-t[0])/2*(e-1),r=(t[3]-t[1])/2*(e-1);t[0]-=$,t[2]+=$,t[1]-=r,t[3]+=r}function Zn(t,e,$){var r=!1,o=_e(t,e),n=_e(t,$);if(o===E.INTERSECTING||n===E.INTERSECTING)r=!0;else{var p=t[0],i=t[1],a=t[2],L=t[3],x=e[0],s=e[1],c=$[0],u=$[1],d=(u-s)/(c-x),g=void 0,m=void 0;n&E.ABOVE&&!(o&E.ABOVE)&&(r=(g=c-(u-L)/d)>=p&&g<=a),r||!(n&E.RIGHT)||o&E.RIGHT||(r=(m=u-(c-a)*d)>=i&&m<=L),r||!(n&E.BELOW)||o&E.BELOW||(r=(g=c-(u-i)/d)>=p&&g<=a),r||!(n&E.LEFT)||o&E.LEFT||(r=(m=u-(c-p)*d)>=i&&m<=L)}return r}function $n(t,e,$){var r=[t[0],t[1],t[0],t[3],t[2],t[1],t[2],t[3]];return e(r,r,2),Tn([r[0],r[2],r[4],r[6]],[r[1],r[3],r[5],r[7]],$)}var Ec={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};var E={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};var u={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};var b={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};var df={};var Fc={};var ef={};function Ab(r,t,e,$,o,a){for(var n=a||[],v=0,s=t;s<e;s+=$){var f=r[s],l=r[s+1];n[v++]=o[0]*f+o[2]*l+o[4],n[v++]=o[1]*f+o[3]*l+o[5]}return a&&n.length!=v&&(n.length=v),n}function Pi(r,t,e,$,o,a,n){for(var v=n||[],s=Math.cos(o),f=Math.sin(o),l=a[0],b=a[1],j=0,p=t;p<e;p+=$){var x=r[p]-l,h=r[p+1]-b;v[j++]=l+x*s-h*f,v[j++]=b+x*f+h*s;for(var c=p+2;c<p+$;++c)v[j++]=r[c]}return n&&v.length!=j&&(v.length=j),v}function _n(r,t,e,$,o,a,n,v){for(var s=v||[],f=n[0],l=n[1],b=0,j=t;j<e;j+=$){var p=r[j]-f,x=r[j+1]-l;s[b++]=f+o*p,s[b++]=l+a*x;for(var h=j+2;h<j+$;++h)s[b++]=r[h]}return v&&s.length!=b&&(s.length=b),s}function Qi(r,t,e,$,o,a,n){for(var v=n||[],s=0,f=t;f<e;f+=$){v[s++]=r[f]+o,v[s++]=r[f+1]+a;for(var l=f+2;l<f+$;++l)v[s++]=r[l]}return n&&v.length!=s&&(v.length=s),v}function ff(r,o,$){var t;if(void 0!==o){for(var e=0,n=r.length;e<n;++e)o[e]=r[e];t=o}else t=r.slice();return t}function gf(r,o,$){if(void 0!==o&&r!==o){for(var t=0,e=r.length;t<e;++t)o[t]=r[t];r=o}return r}function ao(r){qo(r.getCode(),r),qd(r,r,ff)}function bo(r){r.forEach(ao)}function p(r){return"string"==typeof r?po(r):r||null}function hf(r,o,$,t){var e,n=(r=p(r)).getPointResolutionFunc();if(n)e=n(o,$),t&&t!==r.getUnits()&&(c=r.getMetersPerUnit())&&(e=e*c/ya[t]);else if(r.getUnits()==P.DEGREES&&!t||t==P.DEGREES)e=o;else{var c,i=Zb(r,p("EPSG:4326")),a=[$[0]-o/2,$[1],$[0]+o/2,$[1],$[0],$[1]-o/2,$[0],$[1]+o/2];a=i(a,a,2),e=(kf(a.slice(0,2),a.slice(2,4))+kf(a.slice(4,6),a.slice(6,8)))/2,void 0!==(c=t?ya[t]:r.getMetersPerUnit())&&(e/=c)}return e}function Ri(r){bo(r),r.forEach(function(o){r.forEach(function(r){o!==r&&qd(o,r,ff)})})}function co(r,o,$,t){r.forEach(function(r){o.forEach(function(o){qd(r,o,$),qd(o,r,t)})})}function jf(r,o){return r?"string"==typeof r?p(r):r:p(o)}function Bb(r,o){if(r===o)return!0;var $=r.getUnits()===o.getUnits();return r.getCode()===o.getCode()?$:Zb(r,o)===ff&&$}function Zb(r,o){var $=r.getCode(),t=o.getCode(),e=oo($,t);return e||(e=gf),e}function nd(r,o){return Zb(p(r),p(o))}function eo(r,o,$){return nd(o,$)(r,void 0,r.length)}function fo(){Ri(mf),Ri(of),co(of,mf,Wi,Xi)}function D(r,e,t){return Math.min(Math.max(r,e),t)}var go="cosh"in Math?Math.cosh:function(r){var e=Math.exp(r);return(e+1/e)/2};function ho(r,e,t,$,o,a){var n=o-t,s=a-$;if(0!==n||0!==s){var p=((r-t)*n+(e-$)*s)/(n*n+s*s);p>1?(t=o,$=a):p>0&&(t+=n*p,$+=s*p)}return Cb(r,e,t,$)}function Cb(r,e,t,$){var o=t-r,a=$-e;return o*o+a*a}function io(r){for(var e=r.length,t=0;t<e;t++){for(var $=t,o=Math.abs(r[t][t]),a=t+1;a<e;a++){var n=Math.abs(r[a][t]);n>o&&(o=n,$=a)}if(0===o)return null;var s=r[$];r[$]=r[t],r[t]=s;for(var p=t+1;p<e;p++)for(var q=-r[p][t]/r[t][t],x=t;x<e+1;x++)t==x?r[p][x]=0:r[p][x]+=q*r[t][x]}for(var u=new Array(e),A=e-1;A>=0;A--){u[A]=r[A][e]/r[A][A];for(var K=A-1;K>=0;K--)r[K][e]-=r[K][A]*u[A]}return u}function Si(r){return 180*r/Math.PI}function xa(r){return r*Math.PI/180}function Db(r,e){var t=r%e;return t*e<0?t+e:t}function $b(r,e,t){return r+t*(e-r)}var od=6371008.8;function kf(e,t,r){var $=r||od,a=xa(e[1]),o=xa(t[1]),T=(o-a)/2,n=xa(t[0]-e[0])/2,A=Math.sin(T)*Math.sin(T)+Math.sin(n)*Math.sin(n)*Math.cos(a)*Math.cos(o);return 2*$*Math.atan2(Math.sqrt(A),Math.sqrt(1-A))}function lf(e,t){for(var r=0,$=0,a=e.length;$<a-1;++$)r+=kf(e[$],e[$+1],t);return r}function jo(e,t){var r=t||{},$=r.radius||od,a=r.projection||"EPSG:3857",o=e.getType();o!==b.GEOMETRY_COLLECTION&&(e=e.clone().transform(a,"EPSG:4326"));var T,n,A,x,p,s,d=0;switch(o){case b.POINT:case b.MULTI_POINT:break;case b.LINE_STRING:case b.LINEAR_RING:d=lf(T=e.getCoordinates(),$);break;case b.MULTI_LINE_STRING:case b.POLYGON:for(A=0,x=(T=e.getCoordinates()).length;A<x;++A)d+=lf(T[A],$);break;case b.MULTI_POLYGON:for(A=0,x=(T=e.getCoordinates()).length;A<x;++A)for(p=0,s=(n=T[A]).length;p<s;++p)d+=lf(n[p],$);break;case b.GEOMETRY_COLLECTION:var i=e.getGeometries();for(A=0,x=i.length;A<x;++A)d+=jo(i[A],t);break;default:throw new Error("Unsupported geometry type: "+o);}return d}function pd(e,t){for(var r=0,$=e.length,a=e[$-1][0],o=e[$-1][1],T=0;T<$;T++){var n=e[T][0],A=e[T][1];r+=xa(n-a)*(2+Math.sin(xa(o))+Math.sin(xa(A))),a=n,o=A}return r*t*t/2}function ko(e,t){var r=t||{},$=r.radius||od,a=r.projection||"EPSG:3857",o=e.getType();o!==b.GEOMETRY_COLLECTION&&(e=e.clone().transform(a,"EPSG:4326"));var T,n,A,x,p,s,d=0;switch(o){case b.POINT:case b.MULTI_POINT:case b.LINE_STRING:case b.MULTI_LINE_STRING:case b.LINEAR_RING:break;case b.POLYGON:for(T=e.getCoordinates(),d=Math.abs(pd(T[0],$)),A=1,x=T.length;A<x;++A)d-=Math.abs(pd(T[A],$));break;case b.MULTI_POLYGON:for(A=0,x=(T=e.getCoordinates()).length;A<x;++A)for(n=T[A],d+=Math.abs(pd(n[0],$)),p=1,s=n.length;p<s;++p)d-=Math.abs(pd(n[p],$));break;case b.GEOMETRY_COLLECTION:var i=e.getGeometries();for(A=0,x=i.length;A<x;++A)d+=ko(i[A],t);break;default:throw new Error("Unsupported geometry type: "+o);}return d}function lo(e,t,r,$){var a=$||od,o=xa(e[1]),T=xa(e[0]),n=t/a,A=Math.asin(Math.sin(o)*Math.cos(n)+Math.cos(o)*Math.sin(n)*Math.cos(r)),x=T+Math.atan2(Math.sin(r)*Math.sin(n)*Math.cos(o),Math.cos(n)-Math.sin(o)*Math.sin(A));return[Si(x),Si(A)]}var Ja={};var e=arguments[0];var P={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},ya={};ya[P.DEGREES]=2*Math.PI*6370997/360,ya[P.FEET]=.3048,ya[P.METERS]=1,ya[P.USFEET]=1200/3937;var Ti=function(){function t(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}return t.prototype.canWrapX=function(){return this.canWrapX_},t.prototype.getCode=function(){return this.code_},t.prototype.getExtent=function(){return this.extent_},t.prototype.getUnits=function(){return this.units_},t.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||ya[this.units_]},t.prototype.getWorldExtent=function(){return this.worldExtent_},t.prototype.getAxisOrientation=function(){return this.axisOrientation_},t.prototype.isGlobal=function(){return this.global_},t.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},t.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},t.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},t.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},t.prototype.setWorldExtent=function(t){this.worldExtent_=t},t.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},t.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},t}();var mo=Ja&&Ja.__extends||function(){var $=function(n,r){return($=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function($,n){$.__proto__=n}||function($,n){for(var r in n)n.hasOwnProperty(r)&&($[r]=n[r])})(n,r)};return function(n,r){function t(){this.constructor=n}$(n,r),n.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}(),Gc=6378137;Ja.RADIUS=Gc;var Eb=Math.PI*Gc;Ja.HALF_SIZE=Eb;var Ui=[-Eb,-Eb,Eb,Eb];Ja.EXTENT=Ui;var Vi=[-180,-85,180,85];Ja.WORLD_EXTENT=Vi;var Fb=function($){function n(n){return $.call(this,{code:n,units:P.METERS,extent:Ui,global:!0,worldExtent:Vi,getPointResolution:function($,n){return $/go(n[1]/Gc)}})||this}return mo(n,$),n}(Ti),mf=[new Fb("EPSG:3857"),new Fb("EPSG:102100"),new Fb("EPSG:102113"),new Fb("EPSG:900913"),new Fb("urn:ogc:def:crs:EPSG:6.18:3:3857"),new Fb("urn:ogc:def:crs:EPSG::3857"),new Fb("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Wi($,n,r){var t=$.length,o=r>1?r:2,e=n;void 0===e&&(e=o>2?$.slice():new Array(t));for(var m=Eb,Z=0;Z<t;Z+=o){e[Z]=m*$[Z]/180;var p=Gc*Math.log(Math.tan(Math.PI*(+$[Z+1]+90)/360));p>m?p=m:p<-m&&(p=-m),e[Z+1]=p}return e}function Xi($,n,r){var t=$.length,o=r>1?r:2,e=n;void 0===e&&(e=o>2?$.slice():new Array(t));for(var m=0;m<t;m+=o)e[m]=180*$[m]/Eb,e[m+1]=360*Math.atan(Math.exp($[m+1]/Gc))/Math.PI-90;return e}Ja.PROJECTIONS=mf,Ja.fromEPSG4326=Wi,Ja.toEPSG4326=Xi;var _b={};var no=_b&&_b.__extends||function(){var t=function(r,$){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var $ in r)r.hasOwnProperty($)&&(t[$]=r[$])})(r,$)};return function(r,$){function e(){this.constructor=r}t(r,$),r.prototype=null===$?Object.create($):(e.prototype=$.prototype,new e)}}(),Yi=6378137;_b.RADIUS=Yi;var nf=[-180,-90,180,90];_b.EXTENT=nf;var Zi=Math.PI*Yi/180;_b.METERS_PER_UNIT=Zi;var ab=function(t){function r(r,$){return t.call(this,{code:r,units:P.DEGREES,extent:nf,axisOrientation:$,global:!0,metersPerUnit:Zi,worldExtent:nf})||this}return no(r,t),r}(Ti),of=[new ab("CRS:84"),new ab("EPSG:4326","neu"),new ab("urn:ogc:def:crs:EPSG::4326","neu"),new ab("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new ab("urn:ogc:def:crs:OGC:1.3:CRS84"),new ab("urn:ogc:def:crs:OGC:2:84"),new ab("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ab("urn:x-ogc:def:crs:EPSG:4326","neu")];_b.PROJECTIONS=of;var ac={};function qd($,t,r){var e=$.getCode(),o=t.getCode();e in ac||(ac[e]={}),ac[e][o]=r}function oo($,t){var r;return $ in ac&&t in ac[$]&&(r=ac[$][t]),r}var $i={};function po($){return $i[$]||null}function qo($,t){$i[$]=t}fo();var Iw=new Array(6);function ma(){return[1,0,0,1,0,0]}function ro($,t,r,e,n,o,p){return $[0]=t,$[1]=r,$[2]=e,$[3]=n,$[4]=o,$[5]=p,$}function so($,t){return $[0]=t[0],$[1]=t[1],$[2]=t[2],$[3]=t[3],$[4]=t[4],$[5]=t[5],$}function da($,t){var r=t[0],e=t[1];return t[0]=$[0]*r+$[2]*e+$[4],t[1]=$[1]*r+$[3]*e+$[5],t}function to($,t,r){return ro($,t,0,0,r,0,0)}function Ka($,t,r,e,n,o,p,D){var L=Math.sin(o),x=Math.cos(o);return $[0]=e*x,$[1]=n*L,$[2]=-e*L,$[3]=n*x,$[4]=p*e*x-D*e*L+t,$[5]=p*n*L+D*n*x+r,$}function pf($,t){var r=uo(t);q(0!==r,32);var e=t[0],n=t[1],o=t[2],p=t[3],D=t[4],L=t[5];return $[0]=p/r,$[1]=-n/r,$[2]=-o/r,$[3]=e/r,$[4]=(o*L-p*D)/r,$[5]=-(e*L-n*D)/r,$}function uo($){return $[0]*$[3]-$[1]*$[2]}function qf($){return"matrix("+$.join(", ")+")"}var vo=ef&&ef.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),_i=ma(),rf=function(t){function r(){var r=t.call(this)||this;return r.extent_=S(),r.extentRevision_=-1,r.simplifiedGeometryCache={},r.simplifiedGeometryMaxMinSquaredTolerance=0,r.simplifiedGeometryRevision=0,r}return vo(r,t),r.prototype.clone=function(){return a()},r.prototype.closestPointXY=function(t,r,e,n){return a()},r.prototype.containsXY=function(t,r){var e=this.getClosestPoint([t,r]);return e[0]===t&&e[1]===r},r.prototype.getClosestPoint=function(t,r){var e=r||[NaN,NaN];return this.closestPointXY(t[0],t[1],e,1/0),e},r.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},r.prototype.computeExtent=function(t){return a()},r.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),Yn(this.extent_,t)},r.prototype.rotate=function(t,r){a()},r.prototype.scale=function(t,r,e){a()},r.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},r.prototype.getSimplifiedGeometry=function(t){return a()},r.prototype.getType=function(){return a()},r.prototype.applyTransform=function(t){a()},r.prototype.intersectsExtent=function(t){return a()},r.prototype.translate=function(t,r){a()},r.prototype.transform=function(t,r){var e=p(t),n=e.getUnits()==P.TILE_PIXELS?function(t,n,o){var i=e.getExtent(),$=e.getWorldExtent(),p=va($)/va(i);return Ka(_i,$[0],$[3],p,-p,0,0,0),Ab(t,0,t.length,o,_i,n),nd(e,r)(t,n,o)}:nd(e,r);return this.applyTransform(n),this},r}(ga);ef.default=rf;var wo=Fc&&Fc.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),La=function(t){function e(){var e=t.call(this)||this;return e.layout=u.XY,e.stride=2,e.flatCoordinates=null,e}return wo(e,t),e.prototype.computeExtent=function(t){return Ki(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return a()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!=this.getRevision()&&($a(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=t.toString();if(this.simplifiedGeometryCache.hasOwnProperty(e))return this.simplifiedGeometryCache[e];var r=this.getSimplifiedGeometryInternal(t);return r.getFlatCoordinates().length<this.flatCoordinates.length?(this.simplifiedGeometryCache[e]=r,r):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=sf(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){a()},e.prototype.setLayout=function(t,e,r){var o;if(t)o=sf(t);else{for(var i=0;i<r;++i){if(0===e.length)return this.layout=u.XY,void(this.stride=2);e=e[0]}t=xo(o=e.length)}this.layout=t,this.stride=o},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var r=this.getFlatCoordinates();if(r){var o=this.getStride();Pi(r,0,r.length,o,t,e,r),this.changed()}},e.prototype.scale=function(t,e,r){var o=e;void 0===o&&(o=t);var i=r;i||(i=Yb(this.getExtent()));var a=this.getFlatCoordinates();if(a){var n=this.getStride();_n(a,0,a.length,n,t,o,i,a),this.changed()}},e.prototype.translate=function(t,e){var r=this.getFlatCoordinates();if(r){var o=this.getStride();Qi(r,0,r.length,o,t,e,r),this.changed()}},e}(rf);function xo(t){var e;return 2==t?e=u.XY:3==t?e=u.XYZ:4==t&&(e=u.XYZM),e}function sf(t){var e;return t==u.XY?e=2:t==u.XYZ||t==u.XYM?e=3:t==u.XYZM&&(e=4),e}function aj(t,e,r){var o=t.getFlatCoordinates();if(o){var i=t.getStride();return Ab(o,0,o.length,i,e,r)}return null}Fc.getStrideForLayout=sf,Fc.transformGeom2D=aj,Fc.default=La;function bj(e,r,n,$){for(var i=0,t=e[n-$],a=e[n-$+1];r<n;r+=$){var o=e[r],g=e[r+1];i+=a*o-t*g,t=o,a=g}return i/2}function cj(e,r,n,$){for(var i=0,t=0,a=n.length;t<a;++t){var o=n[t];i+=bj(e,r,o,$),r=o}return i}function yo(e,r,n,$){for(var i=0,t=0,a=n.length;t<a;++t){var o=n[t];i+=cj(e,r,o,$),r=o[o.length-1]}return i}function dj(r,t,a,e,$,h,s){var o,n=r[t],i=r[t+1],l=r[a]-n,u=r[a+1]-i;if(0===l&&0===u)o=t;else{var x=(($-n)*l+(h-i)*u)/(l*l+u*u);if(x>1)o=a;else{if(x>0){for(var w=0;w<e;++w)s[w]=$b(r[t+w],r[a+w],x);return void(s.length=e)}o=t}}for(w=0;w<e;++w)s[w]=r[o+w];s.length=e}function tf(r,t,a,e,$){var h=r[t],s=r[t+1];for(t+=e;t<a;t+=e){var o=r[t],n=r[t+1],i=Cb(h,s,o,n);i>$&&($=i),h=o,s=n}return $}function uf(r,t,a,e,$){for(var h=0,s=a.length;h<s;++h){var o=a[h];$=tf(r,t,o,e,$),t=o}return $}function zo(r,t,a,e,$){for(var h=0,s=a.length;h<s;++h){var o=a[h];$=uf(r,t,o,e,$),t=o[o.length-1]}return $}function vf(r,t,a,e,$,h,s,o,n,i,l){if(t==a)return i;var u,x;if(0===$){if((x=Cb(s,o,r[t],r[t+1]))<i){for(u=0;u<e;++u)n[u]=r[t+u];return n.length=e,x}return i}for(var w=l||[NaN,NaN],B=t+e;B<a;)if(dj(r,B-e,B,e,s,o,w),(x=Cb(s,o,w[0],w[1]))<i){for(i=x,u=0;u<e;++u)n[u]=w[u];n.length=e,B+=e}else B+=e*Math.max((Math.sqrt(x)-Math.sqrt(i))/$|0,1);if(h&&(dj(r,a-e,t,e,s,o,w),(x=Cb(s,o,w[0],w[1]))<i)){for(i=x,u=0;u<e;++u)n[u]=w[u];n.length=e}return i}function wf(r,t,a,e,$,h,s,o,n,i,l){for(var u=l||[NaN,NaN],x=0,w=a.length;x<w;++x){var B=a[x];i=vf(r,t,B,e,$,h,s,o,n,i,u),t=B}return i}function Ao(r,t,a,e,$,h,s,o,n,i,l){for(var u=l||[NaN,NaN],x=0,w=a.length;x<w;++x){var B=a[x];i=wf(r,t,B,e,$,h,s,o,n,i,u),t=B[B.length-1]}return i}function ej(e,r,t,o){for(var n=0,a=t.length;n<a;++n)e[r++]=t[n];return r}function rd(e,r,t,o){for(var n=0,a=t.length;n<a;++n)for(var $=t[n],d=0;d<o;++d)e[r++]=$[d];return r}function xf(e,r,t,o,n){for(var a=n||[],$=0,d=0,u=t.length;d<u;++d){var l=rd(e,r,t[d],o);a[$++]=l,r=l}return a.length=$,a}function Bo(e,r,t,o,n){for(var a=n||[],$=0,d=0,u=t.length;d<u;++d){var l=xf(e,r,t[d],o,a[$]);a[$++]=l,r=l[l.length-1]}return a.length=$,a}function Hc(r,t,e,o,n){for(var a=void 0!==n?n:[],i=0,$=t;$<e;$+=o)a[i++]=r.slice($,$+o);return a.length=i,a}function sd(r,t,e,o,n){for(var a=void 0!==n?n:[],i=0,$=0,l=e.length;$<l;++$){var f=e[$];a[i++]=Hc(r,t,f,o,a[i]),t=f}return a.length=i,a}function fj(r,t,e,o,n){for(var a=void 0!==n?n:[],i=0,$=0,l=e.length;$<l;++$){var f=e[$];a[i++]=sd(r,t,f,o,a[i]),t=f[f.length-1]}return a.length=i,a}function yf(r,$,e,t,a,o,n){var u=(e-$)/t;if(u<3){for(;$<e;$+=t)o[n++]=r[$],o[n++]=r[$+1];return n}var p=new Array(u);p[0]=1,p[u-1]=1;for(var i=[$,e-t],m=0;i.length>0;){for(var M=i.pop(),s=i.pop(),w=0,I=r[s],x=r[s+1],l=r[M],c=r[M+1],f=s+t;f<M;f+=t){var g=r[f],d=r[f+1],v=ho(g,d,I,x,l,c);v>w&&(m=f,w=v)}w>a&&(p[(m-$)/t]=1,s+t<m&&i.push(s,m),m+t<M&&i.push(m,M))}for(f=0;f<u;++f)p[f]&&(o[n++]=r[$+f*t],o[n++]=r[$+f*t+1]);return n}function Co(r,$,e,t,a,o,n,u){for(var p=0,i=e.length;p<i;++p){var m=e[p];n=yf(r,$,m,t,a,o,n),u.push(n),$=m}return n}function Gb(r,$){return $*Math.round(r/$)}function Do(r,$,e,t,a,o,n){if($==e)return n;var u,p,i=Gb(r[$],a),m=Gb(r[$+1],a);$+=t,o[n++]=i,o[n++]=m;do{if(u=Gb(r[$],a),p=Gb(r[$+1],a),($+=t)==e)return o[n++]=u,o[n++]=p,n}while(u==i&&p==m);for(;$<e;){var M=Gb(r[$],a),s=Gb(r[$+1],a);if($+=t,M!=u||s!=p){var w=u-i,I=p-m,x=M-i,l=s-m;w*l==I*x&&(w<0&&x<w||w==x||w>0&&x>w)&&(I<0&&l<I||I==l||I>0&&l>I)?(u=M,p=s):(o[n++]=u,o[n++]=p,i=u,m=p,u=M,p=s)}}return o[n++]=u,o[n++]=p,n}function gj(r,$,e,t,a,o,n,u){for(var p=0,i=e.length;p<i;++p){var m=e[p];n=Do(r,$,m,t,a,o,n),u.push(n),$=m}return n}function Eo(r,$,e,t,a,o,n,u){for(var p=0,i=e.length;p<i;++p){var m=e[p],M=[];n=gj(r,$,m,t,a,o,n,M),u.push(M),$=m[m.length-1]}return n}var Fo=df&&df.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),zf=function(t){function e(e,o){var r=t.call(this)||this;return r.maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===o||Array.isArray(e[0])?r.setCoordinates(e,o):r.setFlatCoordinates(o,e),r}return Fo(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,o,r){return r<xb(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(tf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),vf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,o,r))},e.prototype.getArea=function(){return bj(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return Hc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var o=[];return o.length=yf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,o,0),new e(o,u.XY)},e.prototype.getType=function(){return b.LINEAR_RING},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=rd(this.flatCoordinates,0,t,this.stride),this.changed()},e}(La);df.default=zf;var Af={};var Go=Af&&Af.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),na=function(t){function e(e,r){var o=t.call(this)||this;return o.setCoordinates(e,r),o}return Go(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,r,o){var n=this.flatCoordinates,i=Cb(t,e,n[0],n[1]);if(i<o){for(var s=this.stride,a=0;a<s;++a)r[a]=n[a];return r.length=s,i}return o},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return md(this.flatCoordinates,t)},e.prototype.getType=function(){return b.POINT},e.prototype.intersectsExtent=function(t){return $e(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ej(this.flatCoordinates,0,t,this.stride),this.changed()},e}(La);Af.default=na;function Ho(n,r,t,i,a){return!Mi(a,function(a){return!Hb(n,r,t,i,a[0],a[1])})}function Hb(n,r,t,i,a,e){for(var $=0,o=n[t-i],s=n[t-i+1];r<t;r+=i){var l=n[r],g=n[r+1];s<=e?g>e&&(l-o)*(e-s)-(a-o)*(g-s)>0&&$++:g<=e&&(l-o)*(e-s)-(a-o)*(g-s)<0&&$--,o=l,s=g}return 0!==$}function Bf(n,r,t,i,a,e){if(0===t.length)return!1;if(!Hb(n,r,t[0],i,a,e))return!1;for(var $=1,o=t.length;$<o;++$)if(Hb(n,t[$-1],t[$],i,a,e))return!1;return!0}function Io(n,r,t,i,a,e){if(0===t.length)return!1;for(var $=0,o=t.length;$<o;++$){var s=t[$];if(Bf(n,r,s,i,a,e))return!0;r=s[s.length-1]}return!1}function hj(r,t,a,e,o,n,$){for(var i,p,m,s,f,u,g,V=o[n+1],l=[],x=0,y=a.length;x<y;++x){var h=a[x];for(s=r[h-e],u=r[h-e+1],i=t;i<h;i+=e)f=r[i],g=r[i+1],(V<=u&&g<=V||u<=V&&V<=g)&&(m=(V-u)/(g-u)*(f-s)+s,l.push(m)),s=f,u=g}var v=NaN,A=-1/0;for(l.sort(vb),s=l[0],i=1,p=l.length;i<p;++i){f=l[i];var I=Math.abs(f-s);I>A&&(m=(s+f)/2,Bf(r,t,a,e,m,V)&&(v=m,A=I)),s=f}return isNaN(v)&&(v=o[n]),$?($.push(v,V,A),$):[v,V,A]}function Jo(r,t,a,e,o){for(var n=[],$=0,i=a.length;$<i;++$){var p=a[$];n=hj(r,t,p,e,o,2*$,n),t=p[p.length-1]}return n}function td(r,t,e,n,i){var $=Li(S(),r,t,e,n);return!!fa(i,$)&&(!!yb(i,$)||$[0]>=i[0]&&$[2]<=i[2]||$[1]>=i[1]&&$[3]<=i[3]||jj(r,t,e,n,function(r,t){return Zn(i,r,t)}))}function Ko(r,t,e,n,i){for(var $=0,a=e.length;$<a;++$){if(td(r,t,e[$],n,i))return!0;t=e[$]}return!1}function Lo(r,t,e,n,i){return!!td(r,t,e,n,i)||!!Hb(r,t,e,n,i[0],i[1])||!!Hb(r,t,e,n,i[0],i[3])||!!Hb(r,t,e,n,i[2],i[1])||!!Hb(r,t,e,n,i[2],i[3])}function ij(r,t,e,n,i){if(!Lo(r,t,e[0],n,i))return!1;if(1===e.length)return!0;for(var $=1,a=e.length;$<a;++$)if(Ho(r,e[$-1],e[$],n,i)&&!td(r,e[$-1],e[$],n,i))return!1;return!0}function Mo(r,t,e,n,i){for(var $=0,a=e.length;$<a;++$){var s=e[$];if(ij(r,t,s,n,i))return!0;t=s[s.length-1]}return!1}function jj(r,$,o,p,t){for(var e,f=[r[$],r[$+1]],s=[];$+p<o;$+=p){if(s[0]=r[$+p],s[1]=r[$+p+1],e=t(f,s))return e;f[0]=s[0],f[1]=s[1]}return!1}function kj(r,e,n,i){for(var $=0,t=r[n-i],o=r[n-i+1];e<n;e+=i){var p=r[e],x=r[e+1];$+=(p-t)*(x+o),t=p,o=x}return $>0}function lj(r,e,n,i,$){for(var t=void 0!==$&&$,o=0,p=n.length;o<p;++o){var x=n[o],s=kj(r,e,x,i);if(0===o){if(t&&s||!t&&!s)return!1}else if(t&&!s||!t&&s)return!1;e=x}return!0}function No(r,e,n,i,$){for(var t=0,o=n.length;t<o;++t){var p=n[t];if(!lj(r,e,p,i,$))return!1;p.length&&(e=p[p.length-1])}return!0}function Cf(r,e,n,i,$){for(var t=void 0!==$&&$,o=0,p=n.length;o<p;++o){var x=n[o],s=kj(r,e,x,i);(0===o?t&&s||!t&&!s:t&&!s||!t&&s)&&Oo(r,e,x,i),e=x}return e}function mj(r,e,n,i,$){for(var t=0,o=n.length;t<o;++t)e=Cf(r,e,n[t],i,$);return e}function Oo(o,r,e,$){for(;r<e-$;){for(var t=0;t<$;++t){var a=o[r+t];o[r+t]=o[e-$+t],o[e-$+t]=a}r+=$,e-=$}}var Po=ub&&ub.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),oa=function(t){function e(e,r,i){var o=t.call(this)||this;return o.ends_=[],o.flatInteriorPointRevision_=-1,o.flatInteriorPoint_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,void 0!==r&&i?(o.setFlatCoordinates(r,e),o.ends_=i):o.setCoordinates(e,r),o}return Po(e,t),e.prototype.appendLinearRing=function(t){this.flatCoordinates?X(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,r,i){return i<xb(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(uf(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),wf(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,r,i))},e.prototype.containsXY=function(t,e){return Bf(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},e.prototype.getArea=function(){return cj(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Cf(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,sd(e,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=Yb(this.getExtent());this.flatInteriorPoint_=hj(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new na(this.getFlatInteriorPoint(),u.XYM)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new zf(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,r=this.ends_,i=[],o=0,n=0,s=r.length;n<s;++n){var a=r[n],l=new zf(e.slice(o,a),t);i.push(l),o=a}return i},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;lj(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Cf(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[],i=[];return r.length=gj(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),r,0,i),new e(r,u.XY,i)},e.prototype.getType=function(){return b.POLYGON},e.prototype.intersectsExtent=function(t){return ij(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=xf(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===r.length?0:r[r.length-1],this.changed()},e}(La);function nj(t,e,r,i){for(var o=r||32,n=[],s=0;s<o;++s)X(n,lo(t,e,2*Math.PI*s/o,i));return n.push(n[0],n[1]),new oa(n,u.XY,[n.length])}function Ic(t){var e=t[0],r=t[1],i=t[2],o=t[3],n=[e,r,e,o,i,o,i,r,e,r];return new oa(n,u.XY,[n.length])}function Df(t,e,r){for(var i=e||32,o=t.getStride(),n=t.getLayout(),s=t.getCenter(),a=o*(i+1),l=new Array(a),$=0;$<a;$+=o){l[$]=0,l[$+1]=0;for(var p=2;p<o;p++)l[$+p]=s[p]}var h=[l.length],d=new oa(l,n,h);return Ef(d,s,t.getRadius(),r),d}function Ef(t,e,r,i){for(var o=t.getFlatCoordinates(),n=t.getStride(),s=o.length/n-1,a=i||0,l=0;l<=s;++l){var $=l*n,p=a+2*Db(l,s)*Math.PI/s;o[$]=e[0]+r*Math.cos(p),o[$+1]=e[1]+r*Math.sin(p)}t.changed()}ub.default=oa,ub.circular=nj,ub.fromExtent=Ic,ub.fromCircle=Df,ub.makeRegular=Ef;var oj=Xe&&Xe.__extends||function(){var t=function(r,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])})(r,n)};return function(r,n){function e(){this.constructor=r}t(r,n),r.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),o={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"},Qo=function(t){function r(r){var n=t.call(this,g.ERROR)||this;return n.code=r.code,n.message=r.message,n}return oj(r,t),r}(L),pj=function(t){function r(r){var n=t.call(this)||this,e=r||{};return n.position_=null,n.transform_=gf,n.watchId_=void 0,f(n,x(o.PROJECTION),n.handleProjectionChanged_,n),f(n,x(o.TRACKING),n.handleTrackingChanged_,n),void 0!==e.projection&&n.setProjection(e.projection),void 0!==e.trackingOptions&&n.setTrackingOptions(e.trackingOptions),n.setTracking(void 0!==e.tracking&&e.tracking),n}return oj(r,t),r.prototype.disposeInternal=function(){this.setTracking(!1),t.prototype.disposeInternal.call(this)},r.prototype.handleProjectionChanged_=function(){var t=this.getProjection();t&&(this.transform_=Zb(p("EPSG:4326"),t),this.position_&&this.set(o.POSITION,this.transform_(this.position_)))},r.prototype.handleTrackingChanged_=function(){if("geolocation"in navigator){var t=this.getTracking();t&&void 0===this.watchId_?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):t||void 0===this.watchId_||(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}},r.prototype.positionChange_=function(t){var r=t.coords;this.set(o.ACCURACY,r.accuracy),this.set(o.ALTITUDE,null===r.altitude?void 0:r.altitude),this.set(o.ALTITUDE_ACCURACY,null===r.altitudeAccuracy?void 0:r.altitudeAccuracy),this.set(o.HEADING,null===r.heading?void 0:xa(r.heading)),this.position_?(this.position_[0]=r.longitude,this.position_[1]=r.latitude):this.position_=[r.longitude,r.latitude];var n=this.transform_(this.position_);this.set(o.POSITION,n),this.set(o.SPEED,null===r.speed?void 0:r.speed);var e=nj(this.position_,r.accuracy);e.applyTransform(this.transform_),this.set(o.ACCURACY_GEOMETRY,e),this.changed()},r.prototype.positionError_=function(t){this.setTracking(!1),this.dispatchEvent(new Qo(t))},r.prototype.getAccuracy=function(){return this.get(o.ACCURACY)},r.prototype.getAccuracyGeometry=function(){return this.get(o.ACCURACY_GEOMETRY)||null},r.prototype.getAltitude=function(){return this.get(o.ALTITUDE)},r.prototype.getAltitudeAccuracy=function(){return this.get(o.ALTITUDE_ACCURACY)},r.prototype.getHeading=function(){return this.get(o.HEADING)},r.prototype.getPosition=function(){return this.get(o.POSITION)},r.prototype.getProjection=function(){return this.get(o.PROJECTION)},r.prototype.getSpeed=function(){return this.get(o.SPEED)},r.prototype.getTracking=function(){return this.get(o.TRACKING)},r.prototype.getTrackingOptions=function(){return this.get(o.TRACKING_OPTIONS)},r.prototype.setProjection=function(t){this.set(o.PROJECTION,p(t))},r.prototype.setTracking=function(t){this.set(o.TRACKING,t)},r.prototype.setTrackingOptions=function(t){this.set(o.TRACKING_OPTIONS,t)},r}(ga);Xe.default=pj;var Ff={};var Gf={};var ud={};var Hf={};var i={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source"};var Ro=Hf&&Hf.__extends||function(){var t=function(o,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(o,e)};return function(o,e){function r(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),If=function(t){function o(o){var e=t.call(this)||this,r=$({},o);return r[i.OPACITY]=void 0!==o.opacity?o.opacity:1,q("number"==typeof r[i.OPACITY],64),r[i.VISIBLE]=void 0===o.visible||o.visible,r[i.Z_INDEX]=o.zIndex,r[i.MAX_RESOLUTION]=void 0!==o.maxResolution?o.maxResolution:1/0,r[i.MIN_RESOLUTION]=void 0!==o.minResolution?o.minResolution:0,r[i.MIN_ZOOM]=void 0!==o.minZoom?o.minZoom:-1/0,r[i.MAX_ZOOM]=void 0!==o.maxZoom?o.maxZoom:1/0,e.className_=void 0!==r.className?o.className:"ol-layer",delete r.className,e.setProperties(r),e.state_=null,e}return Ro(o,t),o.prototype.getClassName=function(){return this.className_},o.prototype.getLayerState=function(t){var o=this.state_||{layer:this,managed:void 0===t||t,hasOverlay:!1};return o.opacity=D(Math.round(100*this.getOpacity())/100,0,1),o.sourceState=this.getSourceState(),o.visible=this.getVisible(),o.extent=this.getExtent(),o.zIndex=this.getZIndex()||(!1===o.managed?1/0:0),o.maxResolution=this.getMaxResolution(),o.minResolution=Math.max(this.getMinResolution(),0),o.minZoom=this.getMinZoom(),o.maxZoom=this.getMaxZoom(),this.state_=o,o},o.prototype.getLayersArray=function(t){return a()},o.prototype.getLayerStatesArray=function(t){return a()},o.prototype.getExtent=function(){return this.get(i.EXTENT)},o.prototype.getMaxResolution=function(){return this.get(i.MAX_RESOLUTION)},o.prototype.getMinResolution=function(){return this.get(i.MIN_RESOLUTION)},o.prototype.getMinZoom=function(){return this.get(i.MIN_ZOOM)},o.prototype.getMaxZoom=function(){return this.get(i.MAX_ZOOM)},o.prototype.getOpacity=function(){return this.get(i.OPACITY)},o.prototype.getSourceState=function(){return a()},o.prototype.getVisible=function(){return this.get(i.VISIBLE)},o.prototype.getZIndex=function(){return this.get(i.Z_INDEX)},o.prototype.setExtent=function(t){this.set(i.EXTENT,t)},o.prototype.setMaxResolution=function(t){this.set(i.MAX_RESOLUTION,t)},o.prototype.setMinResolution=function(t){this.set(i.MIN_RESOLUTION,t)},o.prototype.setMaxZoom=function(t){this.set(i.MAX_ZOOM,t)},o.prototype.setMinZoom=function(t){this.set(i.MIN_ZOOM,t)},o.prototype.setOpacity=function(t){q("number"==typeof t,64),this.set(i.OPACITY,t)},o.prototype.setVisible=function(t){this.set(i.VISIBLE,t)},o.prototype.setZIndex=function(t){this.set(i.Z_INDEX,t)},o}(ga);Hf.default=If;var Ib={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};var za={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"};var So=ud&&ud.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Jf=function(e){function r(r){var t=this,n=$({},r);delete n.source,(t=e.call(this,n)||this).mapPrecomposeKey_=null,t.mapRenderKey_=null,t.sourceChangeKey_=null,t.renderer_=null,r.render&&(t.render=r.render),r.map&&t.setMap(r.map),f(t,x(i.SOURCE),t.handleSourcePropertyChange_,t);var o=r.source?r.source:null;return t.setSource(o),t}return So(r,e),r.prototype.getLayersArray=function(e){var r=e||[];return r.push(this),r},r.prototype.getLayerStatesArray=function(e){var r=e||[];return r.push(this.getLayerState()),r},r.prototype.getSource=function(){return this.get(i.SOURCE)||null},r.prototype.getSourceState=function(){var e=this.getSource();return e?e.getState():za.UNDEFINED},r.prototype.handleSourceChange_=function(){this.changed()},r.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(l(this.sourceChangeKey_),this.sourceChangeKey_=null);var e=this.getSource();e&&(this.sourceChangeKey_=f(e,g.CHANGE,this.handleSourceChange_,this)),this.changed()},r.prototype.render=function(e,r){var t=this.getRenderer();if(t.prepareFrame(e))return t.renderFrame(e,r)},r.prototype.setMap=function(e){this.mapPrecomposeKey_&&(l(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(l(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=f(e,Ib.PRECOMPOSE,function(e){e.frameState.layerStatesArray.push(this.getLayerState(!1))},this),this.mapRenderKey_=f(this,g.CHANGE,e.render,e),this.changed())},r.prototype.setSource=function(e){this.set(i.SOURCE,e)},r.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},r.prototype.hasRenderer=function(){return!!this.renderer_},r.prototype.createRenderer=function(){return null},r}(If);function Jc(e,r){if(!e.visible)return!1;var t=r.resolution;if(t<e.minResolution||t>=e.maxResolution)return!1;var n=r.zoom;return n>e.minZoom&&n<=e.maxZoom}ud.inView=Jc,ud.default=Jf;var Kf={};var Lf={};function Aa(r){return Array.isArray(r)?rj(r):r}var To=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,Uo=/^([a-z]*)$/i;function Vo(r){return"string"==typeof r?r:rj(r)}function Wo(r){var a=document.createElement("div");if(a.style.color=r,""!==a.style.color){document.body.appendChild(a);var $=getComputedStyle(a).color;return document.body.removeChild(a),$}return""}var Jw=function(){var r={},a=0;return function($){var t;if(r.hasOwnProperty($))t=r[$];else{if(a>=1024){var e=0;for(var X in r)0==(3&e++)&&(delete r[X],--a)}t=Xo($),r[$]=t,++a}return t}}();function Xo(r){var a,$,t,e,X;if(Uo.exec(r)&&(r=Wo(r)),To.exec(r)){var o=r.length-1,n=void 0;n=o<=4?1:2;var i=4===o||8===o;a=parseInt(r.substr(1+0*n,n),16),$=parseInt(r.substr(1+1*n,n),16),t=parseInt(r.substr(1+2*n,n),16),e=i?parseInt(r.substr(1+3*n,n),16):255,1==n&&(a=(a<<4)+a,$=($<<4)+$,t=(t<<4)+t,i&&(e=(e<<4)+e)),X=[a,$,t,e/255]}else 0==r.indexOf("rgba(")?qj(X=r.slice(5,-1).split(",").map(Number)):0==r.indexOf("rgb(")?((X=r.slice(4,-1).split(",").map(Number)).push(1),qj(X)):q(!1,14);return X}function qj(r){return r[0]=D(r[0]+.5|0,0,255),r[1]=D(r[1]+.5|0,0,255),r[2]=D(r[2]+.5|0,0,255),r[3]=D(r[3],0,1),r}function rj(r){var a=r[0];a!=(0|a)&&(a=a+.5|0);var $=r[1];$!=(0|$)&&($=$+.5|0);var t=r[2];return t!=(0|t)&&(t=t+.5|0),"rgba("+a+","+$+","+t+","+(void 0===r[3]?1:r[3])+")"}function Ma(e,t){var r=document.createElement("canvas");return e&&(r.width=e),t&&(r.height=t),r.getContext("2d")}function Yo(e){var t=e.offsetWidth,r=getComputedStyle(e);return t+=parseInt(r.marginLeft,10)+parseInt(r.marginRight,10)}function Zo(e){var t=e.offsetHeight,r=getComputedStyle(e);return t+=parseInt(r.marginTop,10)+parseInt(r.marginBottom,10)}function bc(e,t){var r=t.parentNode;r&&r.replaceChild(e,t)}function vd(e){return e&&e.parentNode?e.parentNode.removeChild(e):null}function sj(e){for(;e.lastChild;)e.removeChild(e.lastChild)}function $o(e,t){for(var r=e.childNodes,o=0;;++o){var $=r[o],n=t[o];if(!$&&!n)break;$!==n&&($?n?e.insertBefore(n,$):(e.removeChild($),--o):e.appendChild(n))}}var G={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};var wd="ol-hidden";var _o="ol-selectable";var Ba="ol-unselectable";var ap="ol-unsupported";var Jb="ol-control";var xd="ol-collapsed";var bp=function(){var $,e={};return function(t){if($||($=document.createElement("div").style),!(t in e)){$.font=t;var S=$.fontFamily,r=$.fontWeight,n=$.fontStyle;if($.font="",!S)return null;var o=S.split(/,\s?/);e[t]={families:o,weight:r,style:n}}return e[t]}}();var Mf={};var Nf={};var cp=Nf&&Nf.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Of=function(t){function e(e){var r=t.call(this)||this;return r.highWaterMark=void 0!==e?e:2048,r.count_=0,r.entries_={},r.oldest_=null,r.newest_=null,r}return cp(e,t),e.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},e.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(g.CLEAR)},e.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},e.prototype.forEach=function(t){for(var e=this.oldest_;e;)t(e.value_,e.key_,this),e=e.newer},e.prototype.get=function(t,e){var r=this.entries_[t];return q(void 0!==r,15),r===this.newest_?r.value_:(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r,r.value_)},e.prototype.remove=function(t){var e=this.entries_[t];return q(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},e.prototype.getCount=function(){return this.count_},e.prototype.getKeys=function(){var t,e=new Array(this.count_),r=0;for(t=this.newest_;t;t=t.older)e[r++]=t.key_;return e},e.prototype.getValues=function(){var t,e=new Array(this.count_),r=0;for(t=this.newest_;t;t=t.older)e[r++]=t.value_;return e},e.prototype.peekLast=function(){return this.oldest_.value_},e.prototype.peekLastKey=function(){return this.oldest_.key_},e.prototype.peekFirstKey=function(){return this.newest_.key_},e.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},e.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},e.prototype.set=function(t,e){q(!(t in this.entries_),16);var r={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[t]=r,++this.count_},e.prototype.setSize=function(t){this.highWaterMark=t},e}(tb);Nf.default=Of;var dp=Mf&&Mf.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),tj=function(t){function e(e){var r=t.call(this,e)||this;return r.consumers={},r}return dp(e,t),e.prototype.clear=function(){this.consumers={},t.prototype.clear.call(this)},e.prototype.get=function(e,r){var o=t.prototype.get.call(this,e),n=ba(r);return n in this.consumers||(this.consumers[n]={}),this.consumers[n][e]=!0,o},e.prototype.prune=function(){t:for(;this.canExpireCache();){var t=this.peekLastKey();for(var e in this.consumers)if(t in this.consumers[e])break t;var r=this.pop();for(var e in r.width=r.height=0,this.consumers)delete this.consumers[e][t]}},e.prototype.release=function(t){delete this.consumers[ba(t)]},e}(Of);Mf.default=tj;var uj="10px sans-serif";var Na="#000";var cc="round";var yd=[];var zd=0;var dc="round";var Kc=10;var Lc="#000";var Mc="center";var Ad="middle";var ec=[0,0,0,0];var Nc=1;var bb=new tj;var ep={};var fp,vj=null,wj={};var gp=function(){var e,t,$=100,r=ep,a="32px ",o=["monospace","serif"],n=o.length,s="wmytzilWMYTZIL@#/&?$%10\uF013";function x(e,$,r){for(var x=xj(),i=!0,l=0;l<n;++l){var p=o[l];if(x.font=e+" "+$+" "+a+p,t=x.measureText(s).width,r!=p){x.font=e+" "+$+" "+a+r+","+p;var I=x.measureText(s).width;i=i&&I!=t}}return!!i}function i(){var t=!0;for(var a in r)r[a]<$&&(x.apply(this,a.split("\n"))?(r[a]=$,$a(wj),vj=null,fp=void 0,bb.getCount()&&bb.clear()):(++r[a],t=!1));t&&(clearInterval(e),e=void 0)}return function(t){var a=bp(t);if(a)for(var o=a.families,n=0,s=o.length;n<s;++n){var l=o[n],p=a.style+"\n"+a.weight+"\n"+l;p in r||(r[p]=$,x(a.style,a.weight,l)||(r[p]=0,void 0===e&&(e=setInterval(i,32))))}}}();function xj(){return vj||(vj=Ma(1,1)),vj}var hp=function(){var e,t=wj;return function($){var r=t[$];return null==r&&(e||((e=document.createElement("div")).innerHTML="M",e.style.margin=e.style.padding="0 !important",e.style.position="absolute !important",e.style.left="-99999px !important"),e.style.font=$,document.body.appendChild(e),r=t[$]=e.offsetHeight,document.body.removeChild(e)),r}}();function yj(e,t){var $=xj();return e!=fp&&($.font=fp=e),$.measureText(t).width}function zj(e,t,$){return t in $?$[t]:$[t]=yj(e,t)}function ip(e,t,$){for(var r=t.length,a=0,o=0;o<r;++o){var n=yj(e,t[o]);a=Math.max(a,n),$.push(n)}return a}function Aj(e,t,$,r){0!==t&&(e.translate($,r),e.rotate(t),e.translate(-$,-r))}var jp=ma();function Bj(e,t,$,r,a,o,n,s,x,i,l){var p;1!=$&&(p=e.globalAlpha,e.globalAlpha=p*$),t&&e.setTransform.apply(e,t),e.drawImage(r,a,o,n,s,x,i,n*l,s*l),1!=$&&(e.globalAlpha=p),t&&e.setTransform.apply(e,jp)}var kp=function(){function t(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale}return t.prototype.clone=function(){return new t({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},t.prototype.getOpacity=function(){return this.opacity_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getAnchor=function(){return a()},t.prototype.getImage=function(t){return a()},t.prototype.getHitDetectionImage=function(t){return a()},t.prototype.getImageState=function(){return a()},t.prototype.getImageSize=function(){return a()},t.prototype.getHitDetectionImageSize=function(){return a()},t.prototype.getOrigin=function(){return a()},t.prototype.getSize=function(){return a()},t.prototype.setOpacity=function(t){this.opacity_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t},t.prototype.listenImageChange=function(t,o){return a()},t.prototype.load=function(){a()},t.prototype.unlistenImageChange=function(t,o){a()},t}();var lp=Lf&&Lf.__extends||function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}(),Cj=function(t){function i(i){var e=this,s=void 0!==i.rotateWithView&&i.rotateWithView;return(e=t.call(this,{opacity:1,rotateWithView:s,rotation:void 0!==i.rotation?i.rotation:0,scale:1})||this).canvas_=null,e.hitDetectionCanvas_=null,e.fill_=void 0!==i.fill?i.fill:null,e.origin_=[0,0],e.points_=i.points,e.radius_=void 0!==i.radius?i.radius:i.radius1,e.radius2_=i.radius2,e.angle_=void 0!==i.angle?i.angle:0,e.stroke_=void 0!==i.stroke?i.stroke:null,e.anchor_=null,e.size_=null,e.imageSize_=null,e.hitDetectionImageSize_=null,e.render(),e}return lp(i,t),i.prototype.clone=function(){var t=new i({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},i.prototype.getAnchor=function(){return this.anchor_},i.prototype.getAngle=function(){return this.angle_},i.prototype.getFill=function(){return this.fill_},i.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},i.prototype.getImage=function(t){return this.canvas_},i.prototype.getImageSize=function(){return this.imageSize_},i.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},i.prototype.getImageState=function(){return G.LOADED},i.prototype.getOrigin=function(){return this.origin_},i.prototype.getPoints=function(){return this.points_},i.prototype.getRadius=function(){return this.radius_},i.prototype.getRadius2=function(){return this.radius2_},i.prototype.getSize=function(){return this.size_},i.prototype.getStroke=function(){return this.stroke_},i.prototype.listenImageChange=function(t,i){},i.prototype.load=function(){},i.prototype.unlistenImageChange=function(t,i){},i.prototype.render=function(){var t,i=cc,e=dc,s=0,o=null,r=0,n=0;this.stroke_&&(null===(t=this.stroke_.getColor())&&(t=Lc),t=Aa(t),void 0===(n=this.stroke_.getWidth())&&(n=Nc),o=this.stroke_.getLineDash(),r=this.stroke_.getLineDashOffset(),void 0===(e=this.stroke_.getLineJoin())&&(e=dc),void 0===(i=this.stroke_.getLineCap())&&(i=cc),void 0===(s=this.stroke_.getMiterLimit())&&(s=Kc));var a=2*(this.radius_+n)+1,l={strokeStyle:t,strokeWidth:n,size:a,lineCap:i,lineDash:o,lineDashOffset:r,lineJoin:e,miterLimit:s},h=Ma(a,a);this.canvas_=h.canvas;var u=a=this.canvas_.width;this.draw_(l,h,0,0),this.createHitDetectionCanvas_(l),this.anchor_=[a/2,a/2],this.size_=[a,a],this.imageSize_=[u,u]},i.prototype.draw_=function(t,i,e,s){var o,r,n;i.setTransform(1,0,0,1,0,0),i.translate(e,s),i.beginPath();var a=this.points_;if(a===1/0)i.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var l=void 0!==this.radius2_?this.radius2_:this.radius_;for(l!==this.radius_&&(a*=2),o=0;o<=a;o++)r=2*o*Math.PI/a-Math.PI/2+this.angle_,n=o%2==0?this.radius_:l,i.lineTo(t.size/2+n*Math.cos(r),t.size/2+n*Math.sin(r))}if(this.fill_){var h=this.fill_.getColor();null===h&&(h=Na),i.fillStyle=Aa(h),i.fill()}this.stroke_&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,i.setLineDash&&t.lineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.lineCap=t.lineCap,i.lineJoin=t.lineJoin,i.miterLimit=t.miterLimit,i.stroke()),i.closePath()},i.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.fill_)this.hitDetectionCanvas_=this.canvas_;else{var i=Ma(t.size,t.size);this.hitDetectionCanvas_=i.canvas,this.drawHitDetectionCanvas_(t,i,0,0)}},i.prototype.drawHitDetectionCanvas_=function(t,i,e,s){i.setTransform(1,0,0,1,0,0),i.translate(e,s),i.beginPath();var o=this.points_;if(o===1/0)i.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var r=void 0!==this.radius2_?this.radius2_:this.radius_;r!==this.radius_&&(o*=2);var n=void 0,a=void 0,l=void 0;for(n=0;n<=o;n++)l=2*n*Math.PI/o-Math.PI/2+this.angle_,a=n%2==0?this.radius_:r,i.lineTo(t.size/2+a*Math.cos(l),t.size/2+a*Math.sin(l))}i.fillStyle=Na,i.fill(),this.stroke_&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,t.lineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.stroke()),i.closePath()},i}(kp);Lf.default=Cj;var mp=Kf&&Kf.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),fc=function(t){function e(e){var r=e||{};return t.call(this,{points:1/0,fill:r.fill,radius:r.radius,stroke:r.stroke})||this}return mp(e,t),e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(Cj);Kf.default=fc;var Kb=function(){function o(o){var r=o||{};this.color_=void 0!==r.color?r.color:null}return o.prototype.clone=function(){var r=this.getColor();return new o({color:Array.isArray(r)?r.slice():r||void 0})},o.prototype.getColor=function(){return this.color_},o.prototype.setColor=function(o){this.color_=o},o}();var cb=function(){function t(t){var i=t||{};this.color_=void 0!==i.color?i.color:null,this.lineCap_=i.lineCap,this.lineDash_=void 0!==i.lineDash?i.lineDash:null,this.lineDashOffset_=i.lineDashOffset,this.lineJoin_=i.lineJoin,this.miterLimit_=i.miterLimit,this.width_=i.width}return t.prototype.clone=function(){var i=this.getColor();return new t({color:Array.isArray(i)?i.slice():i||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},t.prototype.getColor=function(){return this.color_},t.prototype.getLineCap=function(){return this.lineCap_},t.prototype.getLineDash=function(){return this.lineDash_},t.prototype.getLineDashOffset=function(){return this.lineDashOffset_},t.prototype.getLineJoin=function(){return this.lineJoin_},t.prototype.getMiterLimit=function(){return this.miterLimit_},t.prototype.getWidth=function(){return this.width_},t.prototype.setColor=function(t){this.color_=t},t.prototype.setLineCap=function(t){this.lineCap_=t},t.prototype.setLineDash=function(t){this.lineDash_=t},t.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t},t.prototype.setLineJoin=function(t){this.lineJoin_=t},t.prototype.setMiterLimit=function(t){this.miterLimit_=t},t.prototype.setWidth=function(t){this.width_=t},t}();var Y=function(){function t(t){var e=t||{};this.geometry_=null,this.geometryFunction_=Ej,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex}return t.prototype.clone=function(){var e=this.getGeometry();return e&&"object"==typeof e&&(e=e.clone()),new t({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.setRenderer=function(t){this.renderer_=t},t.prototype.getGeometry=function(){return this.geometry_},t.prototype.getGeometryFunction=function(){return this.geometryFunction_},t.prototype.getFill=function(){return this.fill_},t.prototype.setFill=function(t){this.fill_=t},t.prototype.getImage=function(){return this.image_},t.prototype.setImage=function(t){this.image_=t},t.prototype.getStroke=function(){return this.stroke_},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.getText=function(){return this.text_},t.prototype.setText=function(t){this.text_=t},t.prototype.getZIndex=function(){return this.zIndex_},t.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Ej,this.geometry_=t},t.prototype.setZIndex=function(t){this.zIndex_=t},t}();function np(t){var e;if("function"==typeof t)e=t;else{var r;if(Array.isArray(t))r=t;else q("function"==typeof t.getZIndex,41),r=[t];e=function(){return r}}return e}var Dj=null;function op(t,e){if(!Dj){var r=new Kb({color:"rgba(255,255,255,0.4)"}),o=new cb({color:"#3399CC",width:1.25});Dj=[new Y({image:new fc({fill:r,stroke:o,radius:5}),fill:r,stroke:o})]}return Dj}function Oc(){var t={},e=[255,255,255,1],r=[0,153,255,1];return t[b.POLYGON]=[new Y({fill:new Kb({color:[255,255,255,.5]})})],t[b.MULTI_POLYGON]=t[b.POLYGON],t[b.LINE_STRING]=[new Y({stroke:new cb({color:e,width:5})}),new Y({stroke:new cb({color:r,width:3})})],t[b.MULTI_LINE_STRING]=t[b.LINE_STRING],t[b.CIRCLE]=t[b.POLYGON].concat(t[b.LINE_STRING]),t[b.POINT]=[new Y({image:new fc({radius:6,fill:new Kb({color:r}),stroke:new cb({color:e,width:1.5})}),zIndex:1/0})],t[b.MULTI_POINT]=t[b.POINT],t[b.GEOMETRY_COLLECTION]=t[b.POLYGON].concat(t[b.LINE_STRING],t[b.POINT]),t}function Ej(t){return t.getGeometry()}var pp=Gf&&Gf.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Fj={RENDER_ORDER:"renderOrder"},Gj=function(t){function e(e){var r=this,n=e||{},i=$({},n);return delete i.style,delete i.renderBuffer,delete i.updateWhileAnimating,delete i.updateWhileInteracting,(r=t.call(this,i)||this).declutter_=void 0!==n.declutter&&n.declutter,r.renderBuffer_=void 0!==n.renderBuffer?n.renderBuffer:100,r.style_=null,r.styleFunction_=void 0,r.setStyle(n.style),r.updateWhileAnimating_=void 0!==n.updateWhileAnimating&&n.updateWhileAnimating,r.updateWhileInteracting_=void 0!==n.updateWhileInteracting&&n.updateWhileInteracting,r}return pp(e,t),e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(Fj.RENDER_ORDER)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(Fj.RENDER_ORDER,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:op,this.styleFunction_=null===t?void 0:np(this.style_),this.changed()},e}(Jf);Gf.default=Gj;var Pf={};var J={ANIMATING:0,INTERACTING:1};var Qf={};var Hj=function(){function t(){}return t.prototype.drawCustom=function(t,o,e){},t.prototype.drawGeometry=function(t){},t.prototype.setStyle=function(t){},t.prototype.drawCircle=function(t,o){},t.prototype.drawFeature=function(t,o){},t.prototype.drawGeometryCollection=function(t,o){},t.prototype.drawLineString=function(t,o){},t.prototype.drawMultiLineString=function(t,o){},t.prototype.drawMultiPoint=function(t,o){},t.prototype.drawMultiPolygon=function(t,o){},t.prototype.drawPoint=function(t,o){},t.prototype.drawPolygon=function(t,o){},t.prototype.drawText=function(t,o){},t.prototype.setFillStrokeStyle=function(t,o){},t.prototype.setImageStyle=function(t,o){},t.prototype.setTextStyle=function(t,o){},t}();var ca={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Bd=[ca.FILL];var db=[ca.STROKE];var Lb=[ca.BEGIN_PATH];var Ij=[ca.CLOSE_PATH];var qp=Qf&&Qf.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),gc=function(t){function e(e,i,n,r){var o=t.call(this)||this;return o.tolerance=e,o.maxExtent=i,o.pixelRatio=r,o.maxLineWidth=0,o.resolution=n,o.beginGeometryInstruction1_=null,o.beginGeometryInstruction2_=null,o.bufferedMaxExtent_=null,o.instructions=[],o.coordinates=[],o.tmpCoordinate_=[],o.hitDetectionInstructions=[],o.state={},o}return qp(e,t),e.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})},e.prototype.appendFlatCoordinates=function(t,e,i,n,r,o){var s=this.coordinates.length,a=this.getBufferedMaxExtent();o&&(e+=n);var u,$,l,p=t[e],c=t[e+1],h=this.tmpCoordinate_,d=!0;for(u=e+n;u<i;u+=n)h[0]=t[u],h[1]=t[u+1],(l=_e(a,h))!==$?(d&&(this.coordinates[s++]=p,this.coordinates[s++]=c),this.coordinates[s++]=h[0],this.coordinates[s++]=h[1],d=!1):l===E.INTERSECTING?(this.coordinates[s++]=h[0],this.coordinates[s++]=h[1],d=!1):d=!0,p=h[0],c=h[1],$=l;return(r&&d||u===e+n)&&(this.coordinates[s++]=p,this.coordinates[s++]=c),s},e.prototype.drawCustomCoordinates_=function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o],u=this.appendFlatCoordinates(t,e,a,n,!1,!1);r.push(u),e=a}return e},e.prototype.drawCustom=function(t,e,i){this.beginGeometry(e);var n,r,o,s,a,u=t.getType(),$=t.getStride(),l=this.coordinates.length;if(u==b.MULTI_POLYGON){n=(t=t).getOrientedFlatCoordinates(),s=[];var p=t.getEndss();a=0;for(var c=0,h=p.length;c<h;++c){var d=[];a=this.drawCustomCoordinates_(n,a,p[c],$,d),s.push(d)}this.instructions.push([ca.CUSTOM,l,s,t,i,fj])}else u==b.POLYGON||u==b.MULTI_LINE_STRING?(o=[],n=u==b.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),a=this.drawCustomCoordinates_(n,0,t.getEnds(),$,o),this.instructions.push([ca.CUSTOM,l,o,t,i,sd])):u==b.LINE_STRING||u==b.MULTI_POINT?(n=t.getFlatCoordinates(),r=this.appendFlatCoordinates(n,0,n.length,$,!1,!1),this.instructions.push([ca.CUSTOM,l,r,t,i,Hc])):u==b.POINT&&(n=t.getFlatCoordinates(),this.coordinates.push(n[0],n[1]),r=this.coordinates.length,this.instructions.push([ca.CUSTOM,l,r,t,i]));this.endGeometry(e)},e.prototype.beginGeometry=function(t){this.beginGeometryInstruction1_=[ca.BEGIN_GEOMETRY,t,0],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[ca.BEGIN_GEOMETRY,t,0],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},e.prototype.reverseHitDetectionInstructions=function(){var t,e=this.hitDetectionInstructions;e.reverse();var i,n,r=e.length,o=-1;for(t=0;t<r;++t)(n=(i=e[t])[0])==ca.END_GEOMETRY?o=t:n==ca.BEGIN_GEOMETRY&&(i[2]=t,Qn(this.hitDetectionInstructions,o,t),o=-1)},e.prototype.setFillStrokeStyle=function(t,e){var i=this.state;if(t){var n=t.getColor();i.fillStyle=Aa(n||Na)}else i.fillStyle=void 0;if(e){var r=e.getColor();i.strokeStyle=Aa(r||Lc);var o=e.getLineCap();i.lineCap=void 0!==o?o:cc;var s=e.getLineDash();i.lineDash=s?s.slice():yd;var a=e.getLineDashOffset();i.lineDashOffset=a||zd;var u=e.getLineJoin();i.lineJoin=void 0!==u?u:dc;var $=e.getWidth();i.lineWidth=void 0!==$?$:Nc;var l=e.getMiterLimit();i.miterLimit=void 0!==l?l:Kc,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},e.prototype.createFill=function(t){var e=t.fillStyle,i=[ca.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(!0),i},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[ca.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,e){var i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)},e.prototype.updateStrokeStyle=function(t,e){var i=t.strokeStyle,n=t.lineCap,r=t.lineDash,o=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,u=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!Bc(t.currentLineDash,r)||t.currentLineDashOffset!=o||t.currentLineJoin!=s||t.currentLineWidth!=a||t.currentMiterLimit!=u)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=u)},e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[ca.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Ji(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;ld(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(Hj);Qf.default=gc;var Rf={};var rp=Rf&&Rf.__extends||function(){var t=function(i,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(i,o)};return function(i,o){function e(){this.constructor=i}t(i,o),i.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}}(),Jj=function(t){function i(i,o,e,h){var s=t.call(this,i,o,e,h)||this;return s.declutterGroup_=null,s.hitDetectionImage_=null,s.image_=null,s.anchorX_=void 0,s.anchorY_=void 0,s.height_=void 0,s.opacity_=void 0,s.originX_=void 0,s.originY_=void 0,s.rotateWithView_=void 0,s.rotation_=void 0,s.scale_=void 0,s.width_=void 0,s}return rp(i,t),i.prototype.drawCoordinates_=function(t,i,o,e){return this.appendFlatCoordinates(t,i,o,e,!1,!1)},i.prototype.drawPoint=function(t,i){if(this.image_){this.beginGeometry(i);var o=t.getFlatCoordinates(),e=t.getStride(),h=this.coordinates.length,s=this.drawCoordinates_(o,0,o.length,e);this.instructions.push([ca.DRAW_IMAGE,h,s,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([ca.DRAW_IMAGE,h,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(i)}},i.prototype.drawMultiPoint=function(t,i){if(this.image_){this.beginGeometry(i);var o=t.getFlatCoordinates(),e=t.getStride(),h=this.coordinates.length,s=this.drawCoordinates_(o,0,o.length,e);this.instructions.push([ca.DRAW_IMAGE,h,s,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([ca.DRAW_IMAGE,h,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(i)}},i.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,t.prototype.finish.call(this)},i.prototype.setImageStyle=function(t,i){var o=t.getAnchor(),e=t.getSize(),h=t.getHitDetectionImage(1),s=t.getImage(1),r=t.getOrigin();this.anchorX_=o[0],this.anchorY_=o[1],this.declutterGroup_=i,this.hitDetectionImage_=h,this.image_=s,this.height_=e[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScale(),this.width_=e[0]},i}(gc);Rf.default=Jj;var Sf={};var sp=Sf&&Sf.__extends||function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function n(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),Kj=function(t){function i(i,e,n,o){return t.call(this,i,e,n,o)||this}return sp(i,t),i.prototype.drawFlatCoordinates_=function(t,i,e,n){var o=this.coordinates.length,r=this.appendFlatCoordinates(t,i,e,n,!1,!1),s=[ca.MOVE_TO_LINE_TO,o,r];return this.instructions.push(s),this.hitDetectionInstructions.push(s),e},i.prototype.drawLineString=function(t,i){var e=this.state,n=e.strokeStyle,o=e.lineWidth;if(void 0!==n&&void 0!==o){this.updateStrokeStyle(e,this.applyStroke),this.beginGeometry(i),this.hitDetectionInstructions.push([ca.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset],Lb);var r=t.getFlatCoordinates(),s=t.getStride();this.drawFlatCoordinates_(r,0,r.length,s),this.hitDetectionInstructions.push(db),this.endGeometry(i)}},i.prototype.drawMultiLineString=function(t,i){var e=this.state,n=e.strokeStyle,o=e.lineWidth;if(void 0!==n&&void 0!==o){this.updateStrokeStyle(e,this.applyStroke),this.beginGeometry(i),this.hitDetectionInstructions.push([ca.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset],Lb);for(var r=t.getEnds(),s=t.getFlatCoordinates(),u=t.getStride(),a=0,h=0,p=r.length;h<p;++h)a=this.drawFlatCoordinates_(s,a,r[h],u);this.hitDetectionInstructions.push(db),this.endGeometry(i)}},i.prototype.finish=function(){var i=this.state;return null!=i.lastStroke&&i.lastStroke!=this.coordinates.length&&this.instructions.push(db),this.reverseHitDetectionInstructions(),this.state=null,t.prototype.finish.call(this)},i.prototype.applyStroke=function(i){null!=i.lastStroke&&i.lastStroke!=this.coordinates.length&&(this.instructions.push(db),i.lastStroke=this.coordinates.length),i.lastStroke=0,t.prototype.applyStroke.call(this,i),this.instructions.push(Lb)},i}(gc);Sf.default=Kj;var Tf={};var tp=Tf&&Tf.__extends||function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}(),Uf=function(t){function i(i,e,s,n){return t.call(this,i,e,s,n)||this}return tp(i,t),i.prototype.drawFlatCoordinatess_=function(t,i,e,s){var n=this.state,o=void 0!==n.fillStyle,r=null!=n.strokeStyle,l=e.length;this.instructions.push(Lb),this.hitDetectionInstructions.push(Lb);for(var h=0;h<l;++h){var u=e[h],a=this.coordinates.length,$=this.appendFlatCoordinates(t,i,u,s,!0,!r),d=[ca.MOVE_TO_LINE_TO,a,$];this.instructions.push(d),this.hitDetectionInstructions.push(d),r&&(this.instructions.push(Ij),this.hitDetectionInstructions.push(Ij)),i=u}return o&&(this.instructions.push(Bd),this.hitDetectionInstructions.push(Bd)),r&&(this.instructions.push(db),this.hitDetectionInstructions.push(db)),i},i.prototype.drawCircle=function(t,i){var e=this.state,s=e.fillStyle,n=e.strokeStyle;if(void 0!==s||void 0!==n){this.setFillStrokeStyles_(),this.beginGeometry(i),void 0!==e.fillStyle&&this.hitDetectionInstructions.push([ca.SET_FILL_STYLE,Na]),void 0!==e.strokeStyle&&this.hitDetectionInstructions.push([ca.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset]);var o=t.getFlatCoordinates(),r=t.getStride(),l=this.coordinates.length;this.appendFlatCoordinates(o,0,o.length,r,!1,!1);var h=[ca.CIRCLE,l];this.instructions.push(Lb,h),this.hitDetectionInstructions.push(Lb,h),this.hitDetectionInstructions.push(Bd),void 0!==e.fillStyle&&this.instructions.push(Bd),void 0!==e.strokeStyle&&(this.instructions.push(db),this.hitDetectionInstructions.push(db)),this.endGeometry(i)}},i.prototype.drawPolygon=function(t,i){var e=this.state,s=e.fillStyle,n=e.strokeStyle;if(void 0!==s||void 0!==n){this.setFillStrokeStyles_(),this.beginGeometry(i),void 0!==e.fillStyle&&this.hitDetectionInstructions.push([ca.SET_FILL_STYLE,Na]),void 0!==e.strokeStyle&&this.hitDetectionInstructions.push([ca.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset]);var o=t.getEnds(),r=t.getOrientedFlatCoordinates(),l=t.getStride();this.drawFlatCoordinatess_(r,0,o,l),this.endGeometry(i)}},i.prototype.drawMultiPolygon=function(t,i){var e=this.state,s=e.fillStyle,n=e.strokeStyle;if(void 0!==s||void 0!==n){this.setFillStrokeStyles_(),this.beginGeometry(i),void 0!==e.fillStyle&&this.hitDetectionInstructions.push([ca.SET_FILL_STYLE,Na]),void 0!==e.strokeStyle&&this.hitDetectionInstructions.push([ca.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset]);for(var o=t.getEndss(),r=t.getOrientedFlatCoordinates(),l=t.getStride(),h=0,u=0,a=o.length;u<a;++u)h=this.drawFlatCoordinatess_(r,h,o[u],l);this.endGeometry(i)}},i.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var i=this.tolerance;if(0!==i)for(var e=this.coordinates,s=0,n=e.length;s<n;++s)e[s]=Gb(e[s],i);return t.prototype.finish.call(this)},i.prototype.setFillStrokeStyles_=function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)},i}(gc);Tf.default=Uf;var Cd={};function up(t,r,i,$,a){var n,o,h,d,c,e,u,v,p,s=i,x=i,g=0,k=0,m=i;for(n=i;n<$;n+=a){var C=r[n],f=r[n+1];void 0!==d&&(v=C-d,p=f-c,h=Math.sqrt(v*v+p*p),void 0!==e&&(k+=o,Math.acos((e*v+u*p)/(o*h))>t&&(k>g&&(g=k,s=m,x=n),k=0,m=n-a)),o=h,e=v,u=p),d=C,c=f}return(k+=h)>g?[m,n]:[s,x]}var vp={POINT:"point",LINE:"line"};var wp=Cd&&Cd.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ea={};Cd.TEXT_ALIGN=ea,ea.left=0,ea.end=0,ea.center=.5,ea.right=1,ea.start=1,ea.top=0,ea.middle=.5,ea.hanging=.2,ea.alphabetic=.8,ea.ideographic=.8,ea.bottom=1;var Lj=function(t){function e(e,i,r,o){var s=t.call(this,e,i,r,o)||this;return s.declutterGroup_,s.labels_=null,s.text_="",s.textOffsetX_=0,s.textOffsetY_=0,s.textRotateWithView_=void 0,s.textRotation_=0,s.textFillState_=null,s.fillStates={},s.textStrokeState_=null,s.strokeStates={},s.textState_={},s.textStates={},s.textKey_="",s.fillKey_="",s.strokeKey_="",bb.prune(),s}return wp(e,t),e.prototype.finish=function(){var e=t.prototype.finish.call(this);return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e},e.prototype.drawText=function(t,e){var i=this.textFillState_,r=this.textStrokeState_,o=this.textState_;if(""!==this.text_&&o&&(i||r)){var s,l,a=this.coordinates.length,n=t.getType(),$=null,h=2,p=2;if(o.placement===vp.LINE){if(!fa(this.getBufferedMaxExtent(),t.getExtent()))return;var v=void 0;if($=t.getFlatCoordinates(),p=t.getStride(),n==b.LINE_STRING)v=[$.length];else if(n==b.MULTI_LINE_STRING)v=t.getEnds();else if(n==b.POLYGON)v=t.getEnds().slice(0,1);else if(n==b.MULTI_POLYGON){var f=t.getEndss();for(v=[],s=0,l=f.length;s<l;++s)v.push(f[s][0])}this.beginGeometry(e);for(var u=o.textAlign,G=0,_=void 0,x=0,c=v.length;x<c;++x){if(null==u){var d=up(o.maxAngle,$,G,v[x],p);G=d[0],_=d[1]}else _=v[x];for(s=G;s<_;s+=p)this.coordinates.push($[s],$[s+1]);h=this.coordinates.length,G=v[x],this.drawChars_(a,h,this.declutterGroup_),a=h}this.endGeometry(e)}else{var g=null;switch(o.overflow||(g=[]),n){case b.POINT:case b.MULTI_POINT:h=($=t.getFlatCoordinates()).length;break;case b.LINE_STRING:$=t.getFlatMidpoint();break;case b.CIRCLE:$=t.getCenter();break;case b.MULTI_LINE_STRING:h=($=t.getFlatMidpoints()).length;break;case b.POLYGON:$=t.getFlatInteriorPoint(),o.overflow||g.push($[2]/this.resolution),p=3;break;case b.MULTI_POLYGON:var W=t.getFlatInteriorPoints();for($=[],s=0,l=W.length;s<l;s+=3)o.overflow||g.push(W[s+2]/this.resolution),$.push(W[s],W[s+1]);if(0==(h=$.length))return;}h=this.appendFlatCoordinates($,0,h,p,!1,!1),this.saveTextStates_(),(o.backgroundFill||o.backgroundStroke)&&(this.setFillStrokeStyle(o.backgroundFill,o.backgroundStroke),o.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),o.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(e);var S=this.pixelRatio;this.instructions.push([ca.DRAW_IMAGE,a,h,null,NaN,NaN,this.declutterGroup_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1,NaN,o.padding==ec?ec:o.padding.map(function(t){return t*S}),!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,g]),this.hitDetectionInstructions.push([ca.DRAW_IMAGE,a,h,null,NaN,NaN,this.declutterGroup_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1/this.pixelRatio,NaN,o.padding,!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,g]),this.endGeometry(e)}}},e.prototype.saveTextStates_=function(){var t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var o=this.textKey_;o in this.textStates||(this.textStates[o]={font:e.font,textAlign:e.textAlign||Mc,textBaseline:e.textBaseline||Ad,scale:e.scale});var s=this.fillKey_;i&&(s in this.fillStates||(this.fillStates[s]={fillStyle:i.fillStyle}))},e.prototype.drawChars_=function(t,e,i){var r=this.textStrokeState_,o=this.textState_,s=this.strokeKey_,l=this.textKey_,a=this.fillKey_;this.saveTextStates_();var n=this.pixelRatio,$=ea[o.textBaseline],h=this.textOffsetY_*n,p=this.text_,v=o.scale,f=r?r.lineWidth*v/2:0;this.instructions.push([ca.DRAW_CHARS,t,e,$,i,o.overflow,a,o.maxAngle,n,h,s,f*n,p,l,1]),this.hitDetectionInstructions.push([ca.DRAW_CHARS,t,e,$,i,o.overflow,a,o.maxAngle,1,h,s,f,p,l,1/n])},e.prototype.setTextStyle=function(t,e){var i,r,o;if(t){this.declutterGroup_=e;var s=t.getFill();s?((r=this.textFillState_)||(r=this.textFillState_={}),r.fillStyle=Aa(s.getColor()||Na)):r=this.textFillState_=null;var l=t.getStroke();if(l){(o=this.textStrokeState_)||(o=this.textStrokeState_={});var a=l.getLineDash(),n=l.getLineDashOffset(),$=l.getWidth(),h=l.getMiterLimit();o.lineCap=l.getLineCap()||cc,o.lineDash=a?a.slice():yd,o.lineDashOffset=void 0===n?zd:n,o.lineJoin=l.getLineJoin()||dc,o.lineWidth=void 0===$?Nc:$,o.miterLimit=void 0===h?Kc:h,o.strokeStyle=Aa(l.getColor()||Lc)}else o=this.textStrokeState_=null;i=this.textState_;var p=t.getFont()||uj;gp(p);var v=t.getScale();i.overflow=t.getOverflow(),i.font=p,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.textBaseline=t.getTextBaseline()||Ad,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||ec,i.scale=void 0===v?1:v;var f=t.getOffsetX(),u=t.getOffsetY(),G=t.getRotateWithView(),_=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===f?0:f,this.textOffsetY_=void 0===u?0:u,this.textRotateWithView_=void 0!==G&&G,this.textRotation_=void 0===_?0:_,this.strokeKey_=o?("string"==typeof o.strokeStyle?o.strokeStyle:ba(o.strokeStyle))+o.lineCap+o.lineDashOffset+"|"+o.lineWidth+o.lineJoin+o.miterLimit+"["+o.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?"),this.fillKey_=r?"string"==typeof r.fillStyle?r.fillStyle:"|"+ba(r.fillStyle):""}else this.text_=""},e}(gc);Cd.default=Lj;var xp={Circle:Uf,Default:gc,Image:Jj,LineString:Kj,Polygon:Uf,Text:Lj},yp=function(){function e(e,r,t,i,u){this.declutter_=u,this.declutterGroup_=null,this.tolerance_=e,this.maxExtent_=r,this.pixelRatio_=i,this.resolution_=t,this.buildersByZIndex_={}}return e.prototype.addDeclutter=function(e){var r=null;return this.declutter_&&(e?(r=this.declutterGroup_)[4]++:(r=this.declutterGroup_=S()).push(1)),r},e.prototype.finish=function(){var e={};for(var r in this.buildersByZIndex_){e[r]=e[r]||{};var t=this.buildersByZIndex_[r];for(var i in t){var u=t[i].finish();e[r][i]=u}}return e},e.prototype.getBuilder=function(e,r){var t=void 0!==e?e.toString():"0",i=this.buildersByZIndex_[t];void 0===i&&(i={},this.buildersByZIndex_[t]=i);var u=i[r];void 0===u&&(u=new(0,xp[r])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[r]=u);return u},e}();var Pc={};var w={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};var Vf={};function Mj(n,t,r,e){for(var $=n[t],o=n[t+1],i=0,g=t+e;g<r;g+=e){var a=n[g],h=n[g+1];i+=Math.sqrt((a-$)*(a-$)+(h-o)*(h-o)),$=a,o=h}return i}function zp(t,a,r,h,$,e,o,x,M,p,m){for(var n,P,i=[],v=t[a]>t[r-h],w=$.length,l=t[a],s=t[a+1],I=t[a+=h],f=t[a+1],u=0,d=Math.sqrt(Math.pow(I-l,2)+Math.pow(f-s,2)),q=!1,O=0;O<w;++O){for(var T=$[n=v?w-O-1:O],c=x*M(p,T,m),b=e+c/2;a<r-h&&u+d<b;)l=I,s=f,I=t[a+=h],f=t[a+1],u+=d,d=Math.sqrt(Math.pow(I-l,2)+Math.pow(f-s,2));var g=b-u,j=Math.atan2(f-s,I-l);if(v&&(j+=j>0?-Math.PI:Math.PI),void 0!==P){var k=j-P;if(q=q||0!==k,k+=k>Math.PI?-2*Math.PI:k<-Math.PI?2*Math.PI:0,Math.abs(k)>o)return null}P=j;var y=g/d,z=$b(l,I,y),A=$b(s,f,y);i[n]=[z,A,c/2,j,T],e+=c}return q?i:[[i[0][0],i[0][1],i[0][2],i[0][3],$]]}var Wf,Dd={};!function(t,i){"object"==typeof Dd?Dd=i():"function"==typeof Wf&&Wf.amd?Wf(i):(t=t||self).RBush=i()}(Dd,function(){function t(t,r,e,a,h){!function t(n,r,e,a,h){for(;a>e;){if(a-e>600){var o=a-e+1,s=r-e+1,l=Math.log(o),f=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*f*(o-f)/o)*(s-o/2<0?-1:1);t(n,r,Math.max(e,Math.floor(r-s*f/o+u)),Math.min(a,Math.floor(r+(o-s)*f/o+u)),h)}var c=n[r],m=e,p=a;for(i(n,e,r),h(n[a],c)>0&&i(n,e,a);m<p;){for(i(n,m,p),m++,p--;h(n[m],c)<0;)m++;for(;h(n[p],c)>0;)p--}0===h(n[e],c)?i(n,e,p):i(n,++p,a),p<=r&&(e=p+1),r<=p&&(a=p-1)}}(t,r,e||0,a||t.length-1,h||n)}function i(t,i,n){var r=t[i];t[i]=t[n],t[n]=r}function n(t,i){return t<i?-1:t>i?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function e(t,i,n){if(!n)return i.indexOf(t);for(var r=0;r<i.length;r++)if(n(t,i[r]))return r;return-1}function a(t,i){h(t,0,t.children.length,i,t)}function h(t,i,n,r,e){e||(e=p(null)),e.minX=1/0,e.minY=1/0,e.maxX=-1/0,e.maxY=-1/0;for(var a=i;a<n;a++){var h=t.children[a];o(e,t.leaf?r(h):h)}return e}function o(t,i){return t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY),t}function s(t,i){return t.minX-i.minX}function l(t,i){return t.minY-i.minY}function f(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function c(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function m(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(i,n,r,e,a){for(var h=[n,r];h.length;)if(!((r=h.pop())-(n=h.pop())<=e)){var o=n+Math.ceil((r-n)/e/2)*e;t(i,o,n,r,a),h.push(n,o,o,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var i=this.data,n=[];if(!m(t,i))return n;for(var r=this.toBBox,e=[];i;){for(var a=0;a<i.children.length;a++){var h=i.children[a],o=i.leaf?r(h):h;m(t,o)&&(i.leaf?n.push(h):c(t,o)?this._all(h,n):e.push(h))}i=e.pop()}return n},r.prototype.collides=function(t){var i=this.data;if(!m(t,i))return!1;for(var n=[];i;){for(var r=0;r<i.children.length;r++){var e=i.children[r],a=i.leaf?this.toBBox(e):e;if(m(t,a)){if(i.leaf||c(t,a))return!0;n.push(e)}}i=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var i=0;i<t.length;i++)this.insert(t[i]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length){if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=p([]),this},r.prototype.remove=function(t,i){if(!t)return this;for(var n,r,a,h=this.data,o=this.toBBox(t),s=[],l=[];h||s.length;){if(h||(h=s.pop(),r=s[s.length-1],n=l.pop(),a=!0),h.leaf){var f=e(t,h.children,i);if(-1!==f)return h.children.splice(f,1),s.push(h),this._condense(s),this}a||h.leaf||!c(h,o)?r?(n++,h=r.children[n],a=!1):h=null:(s.push(h),l.push(n),n=0,r=h,h=h.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,i){return t.minX-i.minX},r.prototype.compareMinY=function(t,i){return t.minY-i.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,i){for(var n=[];t;)t.leaf?i.push.apply(i,t.children):n.push.apply(n,t.children),t=n.pop();return i},r.prototype._build=function(t,i,n,r){var e,h=n-i+1,o=this._maxEntries;if(h<=o)return a(e=p(t.slice(i,n+1)),this.toBBox),e;r||(r=Math.ceil(Math.log(h)/Math.log(o)),o=Math.ceil(h/Math.pow(o,r-1))),(e=p([])).leaf=!1,e.height=r;var s=Math.ceil(h/o),l=s*Math.ceil(Math.sqrt(o));d(t,i,n,l,this.compareMinX);for(var f=i;f<=n;f+=l){var u=Math.min(f+l-1,n);d(t,f,u,s,this.compareMinY);for(var c=f;c<=u;c+=s){var m=Math.min(c+s-1,u);e.children.push(this._build(t,c,m,r-1))}}return a(e,this.toBBox),e},r.prototype._chooseSubtree=function(t,i,n,r){for(;r.push(i),!i.leaf&&r.length-1!==n;){for(var e=1/0,a=1/0,h=void 0,o=0;o<i.children.length;o++){var s=i.children[o],l=f(s),u=(c=t,m=s,(Math.max(m.maxX,c.maxX)-Math.min(m.minX,c.minX))*(Math.max(m.maxY,c.maxY)-Math.min(m.minY,c.minY))-l);u<a?(a=u,e=l<e?l:e,h=s):u===a&&l<e&&(e=l,h=s)}i=h||i.children[0]}var c,m;return i},r.prototype._insert=function(t,i,n){var r=n?t:this.toBBox(t),e=[],a=this._chooseSubtree(r,this.data,i,e);for(a.children.push(t),o(a,r);i>=0&&e[i].children.length>this._maxEntries;)this._split(e,i),i--;this._adjustParentBBoxes(r,e,i)},r.prototype._split=function(t,i){var n=t[i],r=n.children.length,e=this._minEntries;this._chooseSplitAxis(n,e,r);var h=this._chooseSplitIndex(n,e,r),o=p(n.children.splice(h,n.children.length-h));o.height=n.height,o.leaf=n.leaf,a(n,this.toBBox),a(o,this.toBBox),i?t[i-1].children.push(o):this._splitRoot(n,o)},r.prototype._splitRoot=function(t,i){this.data=p([t,i]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,i,n){for(var r,e,a,o,s,l,u,c=1/0,m=1/0,p=i;p<=n-i;p++){var d=h(t,0,p,this.toBBox),x=h(t,p,n,this.toBBox),v=(e=d,a=x,void 0,void 0,void 0,void 0,o=Math.max(e.minX,a.minX),s=Math.max(e.minY,a.minY),l=Math.min(e.maxX,a.maxX),u=Math.min(e.maxY,a.maxY),Math.max(0,l-o)*Math.max(0,u-s)),M=f(d)+f(x);v<c?(c=v,r=p,m=M<m?M:m):v===c&&M<m&&(m=M,r=p)}return r||n-i},r.prototype._chooseSplitAxis=function(t,i,n){var r=t.leaf?this.compareMinX:s,e=t.leaf?this.compareMinY:l;this._allDistMargin(t,i,n,r)<this._allDistMargin(t,i,n,e)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,i,n,r){t.children.sort(r);for(var e=this.toBBox,a=h(t,0,i,e),s=h(t,n-i,n,e),l=u(a)+u(s),f=i;f<n-i;f++){var c=t.children[f];o(a,t.leaf?e(c):c),l+=u(a)}for(var m=n-i-1;m>=i;m--){var p=t.children[m];o(s,t.leaf?e(p):p),l+=u(s)}return l},r.prototype._adjustParentBBoxes=function(t,i,n){for(var r=n;r>=0;r--)o(i[r],t)},r.prototype._condense=function(t){for(var i=t.length-1,n=void 0;i>=0;i--)0===t[i].children.length?i>0?(n=t[i-1].children).splice(n.indexOf(t[i]),1):this.clear():a(t[i],this.toBBox)},r});var Ap=Vf&&Vf.__extends||function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function r(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Mb=S(),Qc=ma(),Oa=[],Pa=[],Qa=[],Ra=[],Nj=function(t){function i(i,e,r,a){var $=t.call(this)||this;return $.overlaps=r,$.pixelRatio=e,$.resolution=i,$.alignFill_,$.declutterItems=[],$.instructions=a.instructions,$.coordinates=a.coordinates,$.coordinateCache_={},$.renderedTransform_=ma(),$.hitDetectionInstructions=a.hitDetectionInstructions,$.pixelCoordinates_=null,$.viewRotation_=0,$.fillStates=a.fillStates||{},$.strokeStates=a.strokeStates||{},$.textStates=a.textStates||{},$.widths_={},$}return Ap(i,t),i.prototype.disposeInternal=function(){bb.release(this),t.prototype.disposeInternal.call(this)},i.prototype.getTextImage=function(t,i,e,r){var a,$=r+i+t+e+this.pixelRatio;if(!bb.containsKey($)){var o=r?this.strokeStates[r]:null,n=e?this.fillStates[e]:null,s=this.textStates[i],l=this.pixelRatio,p=s.scale*l,T=ea[s.textAlign||Mc],h=r&&o.lineWidth?o.lineWidth:0,L=t.split("\n"),m=L.length,v=[],c=ip(s.font,L,v),Z=hp(s.font),u=Z*m,f=c+h,d=Ma(Math.ceil((f+2)*p),Math.ceil((u+h)*p));a=d.canvas,bb.set($,a),1!=p&&d.scale(p,p),d.font=s.font,r&&(d.strokeStyle=o.strokeStyle,d.lineWidth=h,d.lineCap=o.lineCap,d.lineJoin=o.lineJoin,d.miterLimit=o.miterLimit,d.setLineDash&&o.lineDash.length&&(d.setLineDash(o.lineDash),d.lineDashOffset=o.lineDashOffset)),e&&(d.fillStyle=n.fillStyle),d.textBaseline="middle",d.textAlign="center";var x=.5-T,_=T*f+x*h,g=void 0;if(r)for(g=0;g<m;++g)d.strokeText(L[g],_+x*v[g],.5*(h+Z)+g*Z);if(e)for(g=0;g<m;++g)d.fillText(L[g],_+x*v[g],.5*(h+Z)+g*Z)}return bb.get($,this)},i.prototype.replayTextBackground_=function(t,i,e,r,a,$,o){t.beginPath(),t.moveTo.apply(t,i),t.lineTo.apply(t,e),t.lineTo.apply(t,r),t.lineTo.apply(t,a),t.lineTo.apply(t,i),$&&(this.alignFill_=$[2],this.fill_(t)),o&&(this.setStrokeStyle_(t,o),t.stroke())},i.prototype.replayImage_=function(t,i,e,r,a,$,o,n,s,l,p,T,h,L,m,v,c,Z){var u=c||Z;i-=a*=h,e-=$*=h;var f=m+l>r.width?r.width-l:m,d=n+p>r.height?r.height-p:n,x=v[3]+f*h+v[1],_=v[0]+d*h+v[2],g=i-v[3],y=e-v[0];(u||0!==T)&&(Oa[0]=Ra[0]=g,Oa[1]=Pa[1]=y,Pa[0]=Qa[0]=g+x,Qa[1]=Ra[1]=y+_);var I=null;if(0!==T){var C=i+a,S=e+$;I=Ka(Qc,C,S,1,1,T,-C,-S),da(Qc,Oa),da(Qc,Pa),da(Qc,Qa),da(Qc,Ra),la(Math.min(Oa[0],Pa[0],Qa[0],Ra[0]),Math.min(Oa[1],Pa[1],Qa[1],Ra[1]),Math.max(Oa[0],Pa[0],Qa[0],Ra[0]),Math.max(Oa[1],Pa[1],Qa[1],Ra[1]),Mb)}else la(g,y,g+x,y+_,Mb);var E=t.canvas,k=Z?Z[2]*h/2:0,b=Mb[0]-k<=E.width&&Mb[2]+k>=0&&Mb[1]-k<=E.height&&Mb[3]+k>=0;if(L&&(i=Math.round(i),e=Math.round(e)),o){if(!b&&1==o[4])return;af(o,Mb);var w=b?[t,I?I.slice(0):null,s,r,l,p,f,d,i,e,h]:null;w&&(u&&w.push(c,Z,Oa,Pa,Qa,Ra),o.push(w))}else b&&(u&&this.replayTextBackground_(t,Oa,Pa,Qa,Ra,c,Z),Bj(t,I,s,r,l,p,f,d,i,e,h))},i.prototype.fill_=function(t){if(this.alignFill_){var i=da(this.renderedTransform_,[0,0]),e=512*this.pixelRatio;t.save(),t.translate(i[0]%e,i[1]%e),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()},i.prototype.setStrokeStyle_=function(t,i){t.strokeStyle=i[1],t.lineWidth=i[2],t.lineCap=i[3],t.lineJoin=i[4],t.miterLimit=i[5],t.setLineDash&&(t.lineDashOffset=i[7],t.setLineDash(i[6]))},i.prototype.renderDeclutter=function(t,i,e,r){if(t&&t.length>5){var a=t[4];if(1==a||a==t.length-5){var $={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:i};var $CzwG$$interop$default=Ne(Dd);if(r||(r=new $CzwG$$interop$default.d(9)),!r.collides($)){r.insert($);for(var o=5,n=t.length;o<n;++o){var s=t[o],l=s[0],p=l.globalAlpha;p!==e&&(l.globalAlpha=e),s.length>11&&this.replayTextBackground_(s[0],s[13],s[14],s[15],s[16],s[11],s[12]),Bj.apply(void 0,s),p!==e&&(l.globalAlpha=p)}}t.length=5,Wb(t)}}return r},i.prototype.drawTextImageWithPointPlacement_=function(t,i,e,r){var a=this.textStates[i],$=this.getTextImage(t,i,r,e),o=this.strokeStates[e],n=this.pixelRatio,s=ea[a.textAlign||Mc],l=ea[a.textBaseline||Ad],p=o&&o.lineWidth?o.lineWidth:0;return{label:$,anchorX:s*($.width/n-2*a.scale)+2*(.5-s)*p,anchorY:l*$.height/n+2*(.5-l)*p}},i.prototype.execute_=function(t,i,e,r,a,$,o){var n;this.declutterItems.length=0,this.pixelCoordinates_&&Bc(i,this.renderedTransform_)?n=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),n=Ab(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),so(this.renderedTransform_,i));for(var s,l,p,T,h,L,m,v,c,Z,u,f,d,x,_,g,y=!Vb(e),I=0,C=r.length,S=0,E=0,k=0,b=null,w=null,R=this.coordinateCache_,A=this.viewRotation_,D={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:A},O=this.instructions!=r||this.overlaps?0:200;I<C;){var j=r[I];switch(j[0]){case ca.BEGIN_GEOMETRY:x=j[1],y&&e[ba(x)]||!x.getGeometry()?I=j[2]:void 0===o||fa(o,x.getGeometry().getExtent())?++I:I=j[2]+1;break;case ca.BEGIN_PATH:E>O&&(this.fill_(t),E=0),k>O&&(t.stroke(),k=0),E||k||(t.beginPath(),T=h=NaN),++I;break;case ca.CIRCLE:var q=n[S=j[1]],P=n[S+1],M=n[S+2]-q,W=n[S+3]-P,G=Math.sqrt(M*M+W*W);t.moveTo(q+G,P),t.arc(q,P,G,0,2*Math.PI,!0),++I;break;case ca.CLOSE_PATH:t.closePath(),++I;break;case ca.CUSTOM:S=j[1],s=j[2];var B=j[3],N=j[4],F=6==j.length?j[5]:void 0;D.geometry=B,D.feature=x,I in R||(R[I]=[]);var X=R[I];F?F(n,S,s,2,X):(X[0]=n[S],X[1]=n[S+1],X.length=2),N(X,D),++I;break;case ca.DRAW_IMAGE:S=j[1],s=j[2],c=j[3],l=j[4],p=j[5],v=$?null:j[6];var Y=j[7],H=j[8],U=j[9],J=j[10],K=j[11],V=j[12],z=j[13],Q=j[14];if(!c&&j.length>=19){Z=j[18],u=j[19],f=j[20],d=j[21];var tt=this.drawTextImageWithPointPlacement_(Z,u,f,d);c=j[3]=tt.label;var it=j[22];l=j[4]=(tt.anchorX-it)*this.pixelRatio;var et=j[23];p=j[5]=(tt.anchorY-et)*this.pixelRatio,Y=j[7]=c.height,Q=j[14]=c.width}var rt=void 0;j.length>24&&(rt=j[24]);var at=void 0,$t=void 0,ot=void 0;j.length>16?(at=j[15],$t=j[16],ot=j[17]):(at=ec,$t=ot=!1),K&&(V+=A);for(var nt=0;S<s;S+=2)rt&&rt[nt++]<Q/this.pixelRatio||this.replayImage_(t,n[S],n[S+1],c,l,p,v,Y,H,U,J,V,z,a,Q,at,$t?b:null,ot?w:null);this.declutterItems.push(this,v,x),++I;break;case ca.DRAW_CHARS:var st=j[1],lt=j[2],pt=j[3];v=$?null:j[4];var Tt=j[5];d=j[6];var ht=j[7],Lt=j[8],mt=j[9];f=j[10];var vt=j[11];Z=j[12],u=j[13];var ct=j[14],Zt=this.textStates[u],ut=Zt.font,ft=Zt.scale*Lt,dt=void 0;dt=ut in this.widths_?this.widths_[ut]:this.widths_[ut]={};var xt=Mj(n,st,lt,2),_t=ft*zj(ut,Z,dt);if(Tt||_t<=xt){var gt=this.textStates[u].textAlign,yt=(xt-_t)*ea[gt],It=zp(n,st,lt,2,Z,yt,ht,ft,zj,ut,dt);if(It){var Ct=void 0,St=void 0,Et=void 0,kt=void 0,bt=void 0;if(f)for(Ct=0,St=It.length;Ct<St;++Ct)Et=(bt=It[Ct])[4],kt=this.getTextImage(Et,u,"",f),l=bt[2]+vt,p=pt*kt.height+2*(.5-pt)*vt-mt,this.replayImage_(t,bt[0],bt[1],kt,l,p,v,kt.height,1,0,0,bt[3],ct,!1,kt.width,ec,null,null);if(d)for(Ct=0,St=It.length;Ct<St;++Ct)Et=(bt=It[Ct])[4],kt=this.getTextImage(Et,u,d,""),l=bt[2],p=pt*kt.height-mt,this.replayImage_(t,bt[0],bt[1],kt,l,p,v,kt.height,1,0,0,bt[3],ct,!1,kt.width,ec,null,null)}}this.declutterItems.push(this,v,x),++I;break;case ca.END_GEOMETRY:if(void 0!==$){var wt=$(x=j[1]);if(wt)return wt}++I;break;case ca.FILL:O?E++:this.fill_(t),++I;break;case ca.MOVE_TO_LINE_TO:for(S=j[1],s=j[2],_=n[S],m=(g=n[S+1])+.5|0,(L=_+.5|0)===T&&m===h||(t.moveTo(_,g),T=L,h=m),S+=2;S<s;S+=2)L=(_=n[S])+.5|0,m=(g=n[S+1])+.5|0,S!=s-2&&L===T&&m===h||(t.lineTo(_,g),T=L,h=m);++I;break;case ca.SET_FILL_STYLE:b=j,this.alignFill_=j[2],E&&(this.fill_(t),E=0,k&&(t.stroke(),k=0)),t.fillStyle=j[1],++I;break;case ca.SET_STROKE_STYLE:w=j,k&&(t.stroke(),k=0),this.setStrokeStyle_(t,j),++I;break;case ca.STROKE:O?k++:t.stroke(),++I;break;default:++I;}}E&&this.fill_(t),k&&t.stroke()},i.prototype.execute=function(t,i,e,r,a){this.viewRotation_=e,this.execute_(t,i,r,this.instructions,a,void 0,void 0)},i.prototype.executeHitDetection=function(t,i,e,r,a,$){return this.viewRotation_=e,this.execute_(t,i,r,this.hitDetectionInstructions,!0,a,$)},i}(zc);Vf.default=Nj;var Bp=Pc&&Pc.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t])})(e,t)};return function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),Xf=[w.POLYGON,w.CIRCLE,w.LINE_STRING,w.IMAGE,w.TEXT,w.DEFAULT],Oj=function(r){function e(e,t,o,i,s,$){var a=r.call(this)||this;return a.maxExtent_=e,a.overlaps_=i,a.pixelRatio_=o,a.resolution_=t,a.renderBuffer_=$,a.executorsByZIndex_={},a.hitDetectionContext_=null,a.hitDetectionTransform_=ma(),a.createExecutors_(s),a}return Bp(e,r),e.prototype.clip=function(r,e){var t=this.getClipCoords(e);r.beginPath(),r.moveTo(t[0],t[1]),r.lineTo(t[2],t[3]),r.lineTo(t[4],t[5]),r.lineTo(t[6],t[7]),r.clip()},e.prototype.createExecutors_=function(r){for(var e in r){var t=this.executorsByZIndex_[e];void 0===t&&(this.executorsByZIndex_[e]=t={});var o=r[e];for(var i in o){var s=o[i];t[i]=new Nj(this.resolution_,this.pixelRatio_,this.overlaps_,s)}}},e.prototype.disposeInternal=function(){for(var e in this.executorsByZIndex_){var t=this.executorsByZIndex_[e];for(var o in t)t[o].disposeInternal()}if(this.hitDetectionContext_){var i=this.hitDetectionContext_.canvas;i.width=i.height=0}r.prototype.disposeInternal.call(this)},e.prototype.hasExecutors=function(r){for(var e in this.executorsByZIndex_)for(var t=this.executorsByZIndex_[e],o=0,i=r.length;o<i;++o)if(r[o]in t)return!0;return!1},e.prototype.forEachFeatureAtCoordinate=function(r,e,t,o,i,s,$){var a=2*(o=Math.round(o))+1,n=Ka(this.hitDetectionTransform_,o+.5,o+.5,1/e,-1/e,-t,-r[0],-r[1]);this.hitDetectionContext_||(this.hitDetectionContext_=Ma(a,a));var c,l=this.hitDetectionContext_;l.canvas.width!==a||l.canvas.height!==a?(l.canvas.width=a,l.canvas.height=a):l.clearRect(0,0,a,a),void 0!==this.renderBuffer_&&(c=S(),Xb(c,r),ld(c,e*(this.renderBuffer_+o),c));var p,u=Pj(o);function C(r){for(var e=l.getImageData(0,0,a,a).data,t=0;t<a;t++)for(var o=0;o<a;o++)if(u[t][o]&&e[4*(o*a+t)+3]>0){var i=void 0;return(!$||p!=w.IMAGE&&p!=w.TEXT||-1!==$.indexOf(r))&&(i=s(r)),i||void l.clearRect(0,0,a,a)}}var f,j,v,d,x,h=Object.keys(this.executorsByZIndex_).map(Number);for(h.sort(vb),f=h.length-1;f>=0;--f){var y=h[f].toString();for(v=this.executorsByZIndex_[y],j=Xf.length-1;j>=0;--j)if(void 0!==(d=v[p=Xf[j]])&&(x=d.executeHitDetection(l,n,t,i,C,c)))return x}},e.prototype.getClipCoords=function(r){var e=this.maxExtent_;if(!e)return null;var t=e[0],o=e[1],i=e[2],s=e[3],$=[t,o,t,s,i,s,i,o];return Ab($,0,8,2,r,$),$},e.prototype.isEmpty=function(){return Vb(this.executorsByZIndex_)},e.prototype.execute=function(r,e,t,o,i,s,$){var a=Object.keys(this.executorsByZIndex_).map(Number);a.sort(vb),this.maxExtent_&&(r.save(),this.clip(r,e));var n,c,l,p,u,C,f=s||Xf;for(n=0,c=a.length;n<c;++n){var j=a[n].toString();for(u=this.executorsByZIndex_[j],l=0,p=f.length;l<p;++l){var v=f[l];if(void 0!==(C=u[v]))if(!$||v!=w.IMAGE&&v!=w.TEXT)C.execute(r,e,t,o,i);else{var d=$[j];d?d.push(C,e.slice(0)):$[j]=[C,e.slice(0)]}}}this.maxExtent_&&r.restore()},e}(zc),Yf={0:[[!0]]};function eb(r,e,t){var o,i=Math.floor(r.length/2);if(e>=i)for(o=i;o<e;o++)r[o][t]=!0;else if(e<i)for(o=e+1;o<i;o++)r[o][t]=!0}function Pj(r){if(void 0!==Yf[r])return Yf[r];for(var e=2*r+1,t=new Array(e),o=0;o<e;o++)t[o]=new Array(e);for(var i=r,s=0,$=0;i>=s;)eb(t,r+i,r+s),eb(t,r+s,r+i),eb(t,r-s,r+i),eb(t,r-i,r+s),eb(t,r-i,r-s),eb(t,r-s,r-i),eb(t,r+s,r-i),eb(t,r+i,r-s),2*(($+=1+2*++s)-i)+1>0&&($+=1-2*(i-=1));return Yf[r]=t,t}function Qj(r,e,t,o,i,s){for(var $=Object.keys(r).map(Number).sort(vb),a={},n=0,c=$.length;n<c;++n)for(var l=r[$[n].toString()],p=void 0,u=0,C=l.length;u<C;){var f=l[u++];f!==p&&(p=f,s.push({items:f.declutterItems,opacity:o}));var j=l[u++];f.execute(e,j,t,a,i)}}Pc.getCircleArray=Pj,Pc.replayDeclutter=Qj,Pc.default=Oj;var Zf={};var $f={};var Cp=$f&&$f.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),_f=function(t){function e(e,r,n,o){var $=t.call(this,e)||this;return $.inversePixelTransform=r,$.frameState=n,$.context=o,$}return Cp(e,t),e}(L);$f.default=_f;var ag={};var Dp=ag&&ag.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Rj=function(t){function e(e){var r=t.call(this)||this;return r.layer_=e,r}return Dp(e,t),e.prototype.prepareFrame=function(t){return a()},e.prototype.renderFrame=function(t,e){return a()},e.prototype.loadedTileCallback=function(t,e,r){t[e]||(t[e]={}),t[e][r.tileCoord.toString()]=r},e.prototype.createLoadedTileFinder=function(t,e,r){return function(o,a){var n=this.loadedTileCallback.bind(this,r,o);return t.forEachLoadedTile(e,o,a,n)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,e,r,o,a){},e.prototype.getDataAtPixel=function(t,e,r){return a()},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){t.target.getState()===G.LOADED&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var e=t.getState();return e!=G.LOADED&&e!=G.ERROR&&f(t,g.CHANGE,this.handleImageChange_,this),e==G.IDLE&&(t.load(),e=t.getState()),e==G.LOADED},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==za.READY&&t.changed()},e}(Ue);ag.default=Rj;var Ep=Zf&&Zf.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),bg=function(t){function r(r){var e=t.call(this,r)||this;return e.container=null,e.renderedResolution,e.tempTransform_=ma(),e.pixelTransform=ma(),e.inversePixelTransform=ma(),e.context=null,e.containerReused=!1,e}return Ep(r,t),r.prototype.useContainer=function(t,r,e){var o,n,i=this.getLayer().getClassName();t&&""===t.style.opacity&&t.className===i&&($=t.firstElementChild)instanceof HTMLCanvasElement&&(n=$.getContext("2d"));if(n&&n.canvas.style.transform===qf(r)?(this.container=t,this.context=n,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(o=document.createElement("div")).className=i;var a=o.style;a.position="absolute",a.width="100%",a.height="100%";var $=(n=Ma()).canvas;o.appendChild($),(a=$.style).position="absolute",a.transformOrigin="top left",this.container=o,this.context=n}},r.prototype.clip=function(t,r,e){var o=r.pixelRatio,n=r.size[0]*o/2,i=r.size[1]*o/2,a=r.viewState.rotation,$=wa(e),p=_a(e),s=zb(e),m=Ia(e);da(r.coordinateToPixelTransform,$),da(r.coordinateToPixelTransform,p),da(r.coordinateToPixelTransform,s),da(r.coordinateToPixelTransform,m),t.save(),Aj(t,-a,n,i),t.beginPath(),t.moveTo($[0]*o,$[1]*o),t.lineTo(p[0]*o,p[1]*o),t.lineTo(s[0]*o,s[1]*o),t.lineTo(m[0]*o,m[1]*o),t.clip(),Aj(t,a,n,i)},r.prototype.clipUnrotated=function(t,r,e){var o=wa(e),n=_a(e),i=zb(e),a=Ia(e);da(r.coordinateToPixelTransform,o),da(r.coordinateToPixelTransform,n),da(r.coordinateToPixelTransform,i),da(r.coordinateToPixelTransform,a);var $=this.inversePixelTransform;da($,o),da($,n),da($,i),da($,a),t.save(),t.beginPath(),t.moveTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(i[0]),Math.round(i[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()},r.prototype.dispatchRenderEvent_=function(t,r,e){var o=this.getLayer();if(o.hasListener(t)){var n=new _f(t,this.inversePixelTransform,e,r);o.dispatchEvent(n)}},r.prototype.preRender=function(t,r){this.dispatchRenderEvent_(Ib.PRERENDER,t,r)},r.prototype.postRender=function(t,r){this.dispatchRenderEvent_(Ib.POSTRENDER,t,r)},r.prototype.getRenderTransform=function(t,r,e,o){var n=t.viewState,i=r/2,a=e/2,$=t.pixelRatio/n.resolution,p=-$,s=-n.center[0]+o,m=-n.center[1];return Ka(this.tempTransform_,i,a,$,p,-n.rotation,s,m)},r.prototype.getDataAtPixel=function(t,r,e){var o,n=da(this.inversePixelTransform,t.slice()),i=this.context;try{o=i.getImageData(Math.round(n[0]),Math.round(n[1]),1,1).data}catch(a){return"SecurityError"===a.name?new Uint8Array:o}return 0===o[3]?null:o},r}(Rj);Zf.default=bg;var Fp=.5,Sj={Point:Np,LineString:Kp,Polygon:Pp,MultiPoint:Op,MultiLineString:Lp,MultiPolygon:Mp,GeometryCollection:Jp,Circle:Hp};function Gp(e,r){return parseInt(ba(e),10)-parseInt(ba(r),10)}function Tj(e,r){var t=Uj(e,r);return t*t}function Uj(e,r){return Fp*e/r}function Hp(e,r,t,i){var o=t.getFill(),$=t.getStroke();if(o||$){var a=e.getBuilder(t.getZIndex(),w.CIRCLE);a.setFillStrokeStyle(o,$),a.drawCircle(r,i)}var n=t.getText();if(n){var l=e.getBuilder(t.getZIndex(),w.TEXT);l.setTextStyle(n,e.addDeclutter(!1)),l.drawText(r,i)}}function Vj(e,r,t,i,o,$){var a=!1,n=t.getImage();if(n){var l=n.getImageState();l==G.LOADED||l==G.ERROR?n.unlistenImageChange(o,$):(l==G.IDLE&&n.load(),l=n.getImageState(),n.listenImageChange(o,$),a=!0)}return Ip(e,r,t,i),a}function Ip(e,r,t,i){var o=t.getGeometryFunction()(r);if(o){var $=o.getSimplifiedGeometry(i);if(t.getRenderer())Wj(e,$,t,r);else(0,Sj[$.getType()])(e,$,t,r)}}function Wj(e,r,t,i){if(r.getType()!=b.GEOMETRY_COLLECTION)e.getBuilder(t.getZIndex(),w.DEFAULT).drawCustom(r,i,t.getRenderer());else for(var o=r.getGeometries(),$=0,a=o.length;$<a;++$)Wj(e,o[$],t,i)}function Jp(e,r,t,i){var o,$,a=r.getGeometriesArray();for(o=0,$=a.length;o<$;++o){(0,Sj[a[o].getType()])(e,a[o],t,i)}}function Kp(e,r,t,i){var o=t.getStroke();if(o){var $=e.getBuilder(t.getZIndex(),w.LINE_STRING);$.setFillStrokeStyle(null,o),$.drawLineString(r,i)}var a=t.getText();if(a){var n=e.getBuilder(t.getZIndex(),w.TEXT);n.setTextStyle(a,e.addDeclutter(!1)),n.drawText(r,i)}}function Lp(e,r,t,i){var o=t.getStroke();if(o){var $=e.getBuilder(t.getZIndex(),w.LINE_STRING);$.setFillStrokeStyle(null,o),$.drawMultiLineString(r,i)}var a=t.getText();if(a){var n=e.getBuilder(t.getZIndex(),w.TEXT);n.setTextStyle(a,e.addDeclutter(!1)),n.drawText(r,i)}}function Mp(e,r,t,i){var o=t.getFill(),$=t.getStroke();if($||o){var a=e.getBuilder(t.getZIndex(),w.POLYGON);a.setFillStrokeStyle(o,$),a.drawMultiPolygon(r,i)}var n=t.getText();if(n){var l=e.getBuilder(t.getZIndex(),w.TEXT);l.setTextStyle(n,e.addDeclutter(!1)),l.drawText(r,i)}}function Np(e,r,t,i){var o=t.getImage();if(o){if(o.getImageState()!=G.LOADED)return;var $=e.getBuilder(t.getZIndex(),w.IMAGE);$.setImageStyle(o,e.addDeclutter(!1)),$.drawPoint(r,i)}var a=t.getText();if(a){var n=e.getBuilder(t.getZIndex(),w.TEXT);n.setTextStyle(a,e.addDeclutter(!!o)),n.drawText(r,i)}}function Op(e,r,t,i){var o=t.getImage();if(o){if(o.getImageState()!=G.LOADED)return;var $=e.getBuilder(t.getZIndex(),w.IMAGE);$.setImageStyle(o,e.addDeclutter(!1)),$.drawMultiPoint(r,i)}var a=t.getText();if(a){var n=e.getBuilder(t.getZIndex(),w.TEXT);n.setTextStyle(a,e.addDeclutter(!!o)),n.drawText(r,i)}}function Pp(e,r,t,i){var o=t.getFill(),$=t.getStroke();if(o||$){var a=e.getBuilder(t.getZIndex(),w.POLYGON);a.setFillStrokeStyle(o,$),a.drawPolygon(r,i)}var n=t.getText();if(n){var l=e.getBuilder(t.getZIndex(),w.TEXT);l.setTextStyle(n,e.addDeclutter(!1)),l.drawText(r,i)}}var Qp=Pf&&Pf.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function a(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}(),Xj=function(e){function t(t){var r=e.call(this,t)||this;return r.dirty_=!1,r.renderedRevision_=-1,r.renderedResolution_=NaN,r.renderedExtent_=S(),r.renderedRenderOrder_=null,r.replayGroup_=null,r.replayGroupChanged=!0,r}return Qp(t,e),t.prototype.useContainer=function(t,r,a){a<1&&(t=null),e.prototype.useContainer.call(this,t,r,a)},t.prototype.renderFrame=function(e,t){var r=e.pixelRatio,a=e.layerStatesArray[e.layerIndex];to(this.pixelTransform,1/r,1/r),pf(this.inversePixelTransform,this.pixelTransform),this.useContainer(t,this.pixelTransform,a.opacity);var i=this.context,n=i.canvas,o=this.replayGroup_;if(!o||o.isEmpty())return!this.containerReused&&n.width>0&&(n.width=0),this.container;var s=Math.round(e.size[0]*r),p=Math.round(e.size[1]*r);if(n.width!=s||n.height!=p){n.width=s,n.height=p;var $=qf(this.pixelTransform);n.style.transform!==$&&(n.style.transform=$)}else this.containerReused||i.clearRect(0,0,s,p);this.preRender(i,e);var u=e.extent,d=e.viewState,l=d.projection,h=d.rotation,c=l.getExtent(),f=this.getLayer().getSource(),v=a.extent,y=void 0!==v;y&&this.clip(i,e,v);var C=e.viewHints,g=!(C[J.ANIMATING]||C[J.INTERACTING]),m=this.getRenderTransform(e,s,p,0),Q=a.managed?e.skippedFeatureUids:{},_=this.getLayer().getDeclutter()?{}:null;if(o.execute(i,m,h,Q,g,void 0,_),f.getWrapX()&&l.canWrapX()&&!yb(c,u)){for(var x=u[0],R=H(c),w=0,G=void 0;x<c[0];){G=R*--w;var I=this.getRenderTransform(e,s,p,G);o.execute(i,I,h,Q,g,void 0,_),x+=R}for(w=0,x=u[2];x>c[2];){G=R*++w;var E=this.getRenderTransform(e,s,p,G);o.execute(i,E,h,Q,g,void 0,_),x-=R}}if(_){var T=e.viewHints,A=!(T[J.ANIMATING]||T[J.INTERACTING]);Qj(_,i,h,1,A,e.declutterItems)}y&&i.restore(),this.postRender(i,e);var F=a.opacity,S=this.container;return F!==parseFloat(S.style.opacity)&&(S.style.opacity=1===F?"":F),this.container},t.prototype.forEachFeatureAtCoordinate=function(e,t,r,a,i){if(this.replayGroup_){var n=t.viewState.resolution,o=t.viewState.rotation,s=this.getLayer(),p={};return this.replayGroup_.forEachFeatureAtCoordinate(e,n,o,r,{},function(e){var t=ba(e);if(!(t in p))return p[t]=!0,a(e,s)},s.getDeclutter()?i:null)}},t.prototype.handleFontsChanged=function(){var e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()},t.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},t.prototype.prepareFrame=function(e){var t=this.getLayer(),r=t.getSource(),a=e.viewHints[J.ANIMATING],i=e.viewHints[J.INTERACTING],n=t.getUpdateWhileAnimating(),o=t.getUpdateWhileInteracting();if(!this.dirty_&&!n&&a||!o&&i)return!0;var s=e.extent,p=e.viewState,$=p.projection,u=p.resolution,d=e.pixelRatio,l=t.getRevision(),h=t.getRenderBuffer(),c=t.getRenderOrder();void 0===c&&(c=Gp);var f=ld(s,h*u),v=p.projection.getExtent();if(r.getWrapX()&&p.projection.canWrapX()&&!yb(v,e.extent)){var y=H(v),C=Math.max(H(f)/2,y);f[0]=v[0]-C,f[2]=v[2]+C}if(!this.dirty_&&this.renderedResolution_==u&&this.renderedRevision_==l&&this.renderedRenderOrder_==c&&yb(this.renderedExtent_,f))return this.replayGroupChanged=!1,!0;this.replayGroup_&&this.replayGroup_.dispose(),this.replayGroup_=null,this.dirty_=!1;var g=new yp(Uj(u,d),f,u,d,t.getDeclutter());r.loadFeatures(f,u,$);var m=function(e){var r,a=e.getStyleFunction()||t.getStyleFunction();if(a&&(r=a(e,u)),r){var i=this.renderFeature(e,u,d,r,g);this.dirty_=this.dirty_||i}}.bind(this);if(c){var Q=[];r.forEachFeatureInExtent(f,function(e){Q.push(e)}),Q.sort(c);for(var _=0,x=Q.length;_<x;++_)m(Q[_])}else r.forEachFeatureInExtent(f,m);var R=g.finish(),w=new Oj(f,u,d,r.getOverlaps(),R,t.getRenderBuffer());return this.renderedResolution_=u,this.renderedRevision_=l,this.renderedRenderOrder_=c,this.renderedExtent_=f,this.replayGroup_=w,this.replayGroupChanged=!0,!0},t.prototype.renderFeature=function(e,t,r,a,i){if(!a)return!1;var n=!1;if(Array.isArray(a))for(var o=0,s=a.length;o<s;++o)n=Vj(i,e,a[o],Tj(t,r),this.handleStyleImageChange_,this)||n;else n=Vj(i,e,a,Tj(t,r),this.handleStyleImageChange_,this);return n},t}(bg);Pf.default=Xj;var Rp=Ff&&Ff.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function o(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),fb=function(e){function r(r){return e.call(this,r)||this}return Rp(r,e),r.prototype.createRenderer=function(){return new Xj(this)},r}(Gj);Ff.default=fb;function Yj(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}function Sp(t,e){var r=e.getRadius(),$=e.getCenter(),o=$[0],n=$[1],M=t[0]-o,s=t[1]-n;0===M&&0===s&&(M=1);var a=Math.sqrt(M*M+s*s);return[o+r*M/a,n+r*s/a]}function Ed(t,e){var r,$,o=t[0],n=t[1],M=e[0],s=e[1],a=M[0],p=M[1],C=s[0],i=s[1],x=C-a,c=i-p,u=0===x&&0===c?0:(x*(o-a)+c*(n-p))/(x*x+c*c||0);return u<=0?(r=a,$=p):u>=1?(r=C,$=i):(r=a+u*x,$=p+u*c),[r,$]}function Ca(t,e){for(var r=!0,$=t.length-1;$>=0;--$)if(t[$]!=e[$]){r=!1;break}return r}function Fd(t,e){var r=Math.cos(e),$=Math.sin(e),o=t[0]*r-t[1]*$,n=t[1]*r+t[0]*$;return t[0]=o,t[1]=n,t}function Tp(t,e){return t[0]*=e,t[1]*=e,t}function Z(t,e){var r=t[0]-e[0],$=t[1]-e[1];return r*r+$*$}function Rc(t,e){return Math.sqrt(Z(t,e))}function Sc(t,e){return Z(t,Ed(t,e))}function Tc(r,e,n){var t=void 0!==n?r.toFixed(n):""+r,s=t.indexOf(".");return(s=-1===s?t.length:s)>e?t:new Array(1+e-s).join("0")+t}var cg={};function Zj(r,e,t,i,n,$){var o=NaN,l=NaN,a=(t-e)/i;if(1===a)o=r[e],l=r[e+1];else if(2==a)o=(1-n)*r[e]+n*r[e+i],l=(1-n)*r[e+1]+n*r[e+i+1];else if(0!==a){for(var u=r[e],p=r[e+1],f=0,s=[0],R=e+i;R<t;R+=i){var T=r[R],V=r[R+1];f+=Math.sqrt((T-u)*(T-u)+(V-p)*(V-p)),s.push(f),u=T,p=V}var v=n*f,c=Pn(s,v);if(c<0){var g=(v-s[-c-2])/(s[-c-1]-s[-c-2]),x=e+(-c-2)*i;o=$b(r[x],r[x+i],g),l=$b(r[x+1],r[x+i+1],g)}else o=r[e+c*i],l=r[e+c*i+1]}return $?($[0]=o,$[1]=l,$):[o,l]}function dg(r,e,t,i,n,$){if(t==e)return null;var o;if(n<r[e+i-1])return $?((o=r.slice(e,e+i))[i-1]=n,o):null;if(r[t-1]<n)return $?((o=r.slice(t-i,t))[i-1]=n,o):null;if(n==r[e+i-1])return r.slice(e,e+i);for(var l=e/i,a=t/i;l<a;){var u=l+a>>1;n<r[(u+1)*i-1]?a=u:l=u+1}var p=r[l*i-1];if(n==p)return r.slice((l-1)*i,(l-1)*i+i);var f=(n-p)/(r[(l+1)*i-1]-p);o=[];for(var s=0;s<i-1;++s)o.push($b(r[(l-1)*i+s],r[l*i+s],f));return o.push(n),o}function Up(r,e,t,i,n,$,o){if(o)return dg(r,e,t[t.length-1],i,n,$);var l;if(n<r[i-1])return $?((l=r.slice(0,i))[i-1]=n,l):null;if(r[r.length-1]<n)return $?((l=r.slice(r.length-i))[i-1]=n,l):null;for(var a=0,u=t.length;a<u;++a){var p=t[a];if(e!=p){if(n<r[e+i-1])return null;if(n<=r[p-1])return dg(r,e,p,i,n,!1);e=p}}return null}var Vp=cg&&cg.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),Da=function(t){function e(e,i){var o=t.call(this)||this;return o.flatMidpoint_=null,o.flatMidpointRevision_=-1,o.maxDelta_=-1,o.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?o.setCoordinates(e,i):o.setFlatCoordinates(i,e),o}return Vp(e,t),e.prototype.appendCoordinate=function(t){this.flatCoordinates?X(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,o){return o<xb(this.getExtent(),t,e)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(tf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),vf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,o))},e.prototype.forEachSegment=function(t){return jj(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,e){if(this.layout!=u.XYM&&this.layout!=u.XYZM)return null;var i=void 0!==e&&e;return dg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i)},e.prototype.getCoordinates=function(){return Hc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,e){return Zj(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e)},e.prototype.getLength=function(){return Mj(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=yf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,u.XY)},e.prototype.getType=function(){return b.LINE_STRING},e.prototype.intersectsExtent=function(t){return td(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=rd(this.flatCoordinates,0,t,this.stride),this.changed()},e}(La);cg.default=Da;var Gd={};function $j(e,r,t,o){return function(i,$,a){var s=new XMLHttpRequest;s.open("GET","function"==typeof e?e(i,$,a):e,!0),r.getType()==Nb.ARRAY_BUFFER&&(s.responseType="arraybuffer"),s.onload=function(e){if(!s.status||s.status>=200&&s.status<300){var $=r.getType(),n=void 0;$==Nb.JSON||$==Nb.TEXT?n=s.responseText:$==Nb.XML?(n=s.responseXML)||(n=new DOMParser().parseFromString(s.responseText,"application/xml")):$==Nb.ARRAY_BUFFER&&(n=s.response),n?t.call(this,r.readFeatures(n,{extent:i,featureProjection:a}),r.readProjection(n)):o.call(this)}else o.call(this)}.bind(this),s.onerror=function(){o.call(this)}.bind(this),s.send()}}function _j(e,r){return $j(e,r,function(e,r){"function"==typeof this.addFeatures&&this.addFeatures(e)},Ha)}var Nb={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};function Wp(t,e){return[[-1/0,-1/0,1/0,1/0]]}var eg={};var Xp=eg&&eg.__extends||function(){var t=function(r,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])})(r,o)};return function(r,o){function e(){this.constructor=r}t(r,o),r.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}}(),fg=function(t){function r(r){var o=t.call(this)||this;return o.projection_=p(r.projection),o.attributions_=ak(r.attributions),o.attributionsCollapsible_=void 0===r.attributionsCollapsible||r.attributionsCollapsible,o.loading=!1,o.state_=void 0!==r.state?r.state:za.READY,o.wrapX_=void 0!==r.wrapX&&r.wrapX,o}return Xp(r,t),r.prototype.getAttributions=function(){return this.attributions_},r.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},r.prototype.getProjection=function(){return this.projection_},r.prototype.getResolutions=function(){return a()},r.prototype.getState=function(){return this.state_},r.prototype.getWrapX=function(){return this.wrapX_},r.prototype.refresh=function(){this.changed()},r.prototype.setAttributions=function(t){this.attributions_=ak(t),this.changed()},r.prototype.setState=function(t){this.state_=t,this.changed()},r}(ga);function ak(t){return t?Array.isArray(t)?function(r){return t}:"function"==typeof t?t:function(r){return[t]}:null}eg.default=fg;var pa={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature"};var Hd=function(){function t(t){var $CzwG$$interop$default=Ne(Dd);this.rbush_=new $CzwG$$interop$default.d(t),this.items_={}}return t.prototype.insert=function(t,r){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:r};this.rbush_.insert(e),this.items_[ba(r)]=e},t.prototype.load=function(t,r){for(var e=new Array(r.length),n=0,i=r.length;n<i;n++){var o=t[n],s=r[n],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};e[n]=u,this.items_[ba(s)]=u}this.rbush_.load(e)},t.prototype.remove=function(t){var r=ba(t),e=this.items_[r];return delete this.items_[r],null!==this.rbush_.remove(e)},t.prototype.update=function(t,r){var e=this.items_[ba(r)],n=[e.minX,e.minY,e.maxX,e.maxY];Cc(n,t)||(this.remove(r),this.insert(t,r))},t.prototype.getAll=function(){return this.rbush_.all().map(function(t){return t.value})},t.prototype.getInExtent=function(t){var r={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(r).map(function(t){return t.value})},t.prototype.forEach=function(t){return this.forEach_(this.getAll(),t)},t.prototype.forEachInExtent=function(t,r){return this.forEach_(this.getInExtent(t),r)},t.prototype.forEach_=function(t,r){for(var e,n=0,i=t.length;n<i;n++)if(e=r(t[n]))return e;return e},t.prototype.isEmpty=function(){return Vb(this.items_)},t.prototype.clear=function(){this.rbush_.clear(),this.items_={}},t.prototype.getExtent=function(t){var r=this.rbush_.toJSON();return la(r.minX,r.minY,r.maxX,r.maxY,t)},t.prototype.concat=function(t){for(var r in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[r]=t.items_[r]},t}();var bk=Gd&&Gd.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),hc=function(e){function t(t,r){var o=e.call(this,t)||this;return o.feature=r,o}return bk(t,e),t}(L);Gd.VectorSourceEvent=hc;var gb=function(e){function t(t){var r=this,o=t||{};(r=e.call(this,{attributions:o.attributions,projection:void 0,state:za.READY,wrapX:void 0===o.wrapX||o.wrapX})||this).loader_=Ha,r.format_=o.format,r.overlaps_=null==o.overlaps||o.overlaps,r.url_=o.url,void 0!==o.loader?r.loader_=o.loader:void 0!==r.url_&&(q(r.format_,7),r.loader_=_j(r.url_,r.format_)),r.strategy_=void 0!==o.strategy?o.strategy:Wp;var i,n,s=void 0===o.useSpatialIndex||o.useSpatialIndex;return r.featuresRtree_=s?new Hd:null,r.loadedExtentsRtree_=new Hd,r.nullGeometryFeatures_={},r.idIndex_={},r.uidIndex_={},r.featureChangeKeys_={},r.featuresCollection_=null,Array.isArray(o.features)?n=o.features:o.features&&(n=(i=o.features).getArray()),s||void 0!==i||(i=new M(n)),void 0!==n&&r.addFeaturesInternal(n),void 0!==i&&r.bindFeaturesCollection_(i),r}return bk(t,e),t.prototype.addFeature=function(e){this.addFeatureInternal(e),this.changed()},t.prototype.addFeatureInternal=function(e){var t=ba(e);if(this.addToIndex_(t,e)){this.setupChangeEvents_(t,e);var r=e.getGeometry();if(r){var o=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(o,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new hc(pa.ADDFEATURE,e))}else this.featuresCollection_&&this.featuresCollection_.remove(e)},t.prototype.setupChangeEvents_=function(e,t){this.featureChangeKeys_[e]=[f(t,g.CHANGE,this.handleFeatureChange_,this),f(t,rb.PROPERTYCHANGE,this.handleFeatureChange_,this)]},t.prototype.addToIndex_=function(e,t){var r=!0,o=t.getId();return void 0!==o&&(o.toString()in this.idIndex_?r=!1:this.idIndex_[o.toString()]=t),r&&(q(!(e in this.uidIndex_),30),this.uidIndex_[e]=t),r},t.prototype.addFeatures=function(e){this.addFeaturesInternal(e),this.changed()},t.prototype.addFeaturesInternal=function(e){for(var t=[],r=[],o=[],i=0,n=e.length;i<n;i++){var s=e[i],a=ba(s);this.addToIndex_(a,s)&&r.push(s)}i=0;for(var u=r.length;i<u;i++){s=r[i],a=ba(s);this.setupChangeEvents_(a,s);var $=s.getGeometry();if($){var p=$.getExtent();t.push(p),o.push(s)}else this.nullGeometryFeatures_[a]=s}this.featuresRtree_&&this.featuresRtree_.load(t,o);i=0;for(var l=r.length;i<l;i++)this.dispatchEvent(new hc(pa.ADDFEATURE,r[i]))},t.prototype.bindFeaturesCollection_=function(e){var t=!1;f(this,pa.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),f(this,pa.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),f(e,C.ADD,function(e){t||(t=!0,this.addFeature(e.element),t=!1)},this),f(e,C.REMOVE,function(e){t||(t=!0,this.removeFeature(e.element),t=!1)},this),this.featuresCollection_=e},t.prototype.clear=function(e){if(e){for(var t in this.featureChangeKeys_){this.featureChangeKeys_[t].forEach(l)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(var r in this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this)),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var o=new hc(pa.CLEAR);this.dispatchEvent(o),this.changed()},t.prototype.forEachFeature=function(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},t.prototype.forEachFeatureAtCoordinateDirect=function(e,t){var r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(r){return r.getGeometry().intersectsCoordinate(e)?t(r):void 0})},t.prototype.forEachFeatureInExtent=function(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},t.prototype.forEachFeatureIntersectingExtent=function(e,t){return this.forEachFeatureInExtent(e,function(r){if(r.getGeometry().intersectsExtent(e)){var o=t(r);if(o)return o}})},t.prototype.getFeaturesCollection=function(){return this.featuresCollection_},t.prototype.getFeatures=function(){var e;return this.featuresCollection_?e=this.featuresCollection_.getArray():this.featuresRtree_&&(e=this.featuresRtree_.getAll(),Vb(this.nullGeometryFeatures_)||X(e,Se(this.nullGeometryFeatures_))),e},t.prototype.getFeaturesAtCoordinate=function(e){var t=[];return this.forEachFeatureAtCoordinateDirect(e,function(e){t.push(e)}),t},t.prototype.getFeaturesInExtent=function(e){return this.featuresRtree_.getInExtent(e)},t.prototype.getClosestFeatureToCoordinate=function(e,t){var r=e[0],o=e[1],i=null,n=[NaN,NaN],s=1/0,a=[-1/0,-1/0,1/0,1/0],u=t||W;return this.featuresRtree_.forEachInExtent(a,function(e){if(u(e)){var t=e.getGeometry(),$=s;if((s=t.closestPointXY(r,o,n,s))<$){i=e;var p=Math.sqrt(s);a[0]=r-p,a[1]=o-p,a[2]=r+p,a[3]=o+p}}}),i},t.prototype.getExtent=function(e){return this.featuresRtree_.getExtent(e)},t.prototype.getFeatureById=function(e){var t=this.idIndex_[e.toString()];return void 0!==t?t:null},t.prototype.getFeatureByUid=function(e){var t=this.uidIndex_[e];return void 0!==t?t:null},t.prototype.getFormat=function(){return this.format_},t.prototype.getOverlaps=function(){return this.overlaps_},t.prototype.getUrl=function(){return this.url_},t.prototype.handleFeatureChange_=function(e){var t=e.target,r=ba(t),o=t.getGeometry();if(o){var i=o.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(i,t)):this.featuresRtree_&&this.featuresRtree_.update(i,t)}else r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[r]=t);var n=t.getId();if(void 0!==n){var s=n.toString();this.idIndex_[s]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[s]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[r]=t;this.changed(),this.dispatchEvent(new hc(pa.CHANGEFEATURE,t))},t.prototype.hasFeature=function(e){var t=e.getId();return void 0!==t?t in this.idIndex_:ba(e)in this.uidIndex_},t.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&Vb(this.nullGeometryFeatures_)},t.prototype.loadFeatures=function(e,t,r){var o=this.loadedExtentsRtree_,i=this.strategy_(e,t);this.loading=!1;for(var n=function(e,n){var a=i[e];o.forEachInExtent(a,function(e){return yb(e.extent,a)})||(s.loader_.call(s,a,t,r),o.insert(a,{extent:a.slice()}),s.loading=s.loader_!==Ha)},s=this,a=0,u=i.length;a<u;++a)n(a)},t.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),e.prototype.refresh.call(this)},t.prototype.removeLoadedExtent=function(e){var t,r=this.loadedExtentsRtree_;r.forEachInExtent(e,function(r){if(Cc(r.extent,e))return t=r,!0}),t&&r.remove(t)},t.prototype.removeFeature=function(e){var t=ba(e);t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.removeFeatureInternal(e),this.changed()},t.prototype.removeFeatureInternal=function(e){var t=ba(e);this.featureChangeKeys_[t].forEach(l),delete this.featureChangeKeys_[t];var r=e.getId();void 0!==r&&delete this.idIndex_[r.toString()],delete this.uidIndex_[t],this.dispatchEvent(new hc(pa.REMOVEFEATURE,e))},t.prototype.removeFromIdIndex_=function(e){var t=!1;for(var r in this.idIndex_)if(this.idIndex_[r]===e){delete this.idIndex_[r],t=!0;break}return t},t.prototype.setLoader=function(e){this.loader_=e},t.prototype.setUrl=function(e){q(this.format_,7),this.setLoader(_j(e,this.format_))},t}(fg);Gd.default=gb;var Id={};var gg={};var Yp=gg&&gg.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),ck=function(t){function e(e,r,o,n){var i=t.call(this)||this;return i.extent=e,i.pixelRatio_=o,i.resolution=r,i.state=n,i}return Yp(e,t),e.prototype.changed=function(){this.dispatchEvent(g.CHANGE)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return a()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){a()},e}(tb);gg.default=ck;var ic="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",Zp=-1!==ic.indexOf("firefox");var $p=-1!==ic.indexOf("safari")&&-1==ic.indexOf("chrom");var _p=-1!==ic.indexOf("webkit")&&-1==ic.indexOf("edge");var aq=-1!==ic.indexOf("macintosh");var Jd=window.devicePixelRatio||1;var dk="undefined"!=typeof Image&&Image.prototype.decode;var bq=Id&&Id.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),cq=function(t){function e(e,n,i,r,o,a){var $=t.call(this,e,n,i,G.IDLE)||this;return $.src_=r,$.image_=new Image,null!==o&&($.image_.crossOrigin=o),$.unlisten_=null,$.state=G.IDLE,$.imageLoadFunction_=a,$}return bq(e,t),e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=G.ERROR,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=va(this.extent)/this.image_.height),this.state=G.LOADED,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state!=G.IDLE&&this.state!=G.ERROR||(this.state=G.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=hg(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(ck);function hg(t,e,n){var i=t;if(i.src&&dk){var r=i.decode(),o=!0;return r.then(function(){o&&e()}).catch(function(t){o&&("EncodingError"===t.name&&"Invalid image type."===t.message?e():n())}),function(){o=!1}}var a=[yc(i,g.LOAD,e),yc(i,g.ERROR,n)];return function(){a.forEach(l)}}Id.listenImage=hg,Id.default=cq;var ig={};var jg={};var aa={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5};function ek($){return Math.pow($,3)}function Ob($){return 1-ek(1-$)}function dq($){return 3*$*$-2*$*$*$}function eq($){return $}var fq=jg&&jg.__extends||function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function r(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),kg=function(t){function i(i,e,r){var n=t.call(this)||this,o=r||{};return n.tileCoord=i,n.state=e,n.interimTile=null,n.hifi=!0,n.key="",n.transition_=void 0===o.transition?250:o.transition,n.transitionStarts_={},n}return fq(i,t),i.prototype.changed=function(){this.dispatchEvent(g.CHANGE)},i.prototype.getKey=function(){return this.key+"/"+this.tileCoord},i.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==aa.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this},i.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,i=this;do{if(t.getState()==aa.LOADED){t.interimTile=null;break}t.getState()==aa.LOADING?i=t:t.getState()==aa.IDLE?i.interimTile=t.interimTile:i=t,t=i.interimTile}while(t)}},i.prototype.getTileCoord=function(){return this.tileCoord},i.prototype.getState=function(){return this.state},i.prototype.setState=function(t){this.state=t,this.changed()},i.prototype.load=function(){a()},i.prototype.getAlpha=function(t,i){if(!this.transition_)return 1;var e=this.transitionStarts_[t];if(e){if(-1===e)return 1}else e=i,this.transitionStarts_[t]=e;var r=i-e+1e3/60;return r>=this.transition_?1:ek(r/this.transition_)},i.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},i.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},i}(tb);jg.default=kg;var gq=ig&&ig.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),fk=function(t){function e(e,i,n,r,s,a){var o=t.call(this,e,i,a)||this;return o.crossOrigin_=r,o.src_=n,o.image_=new Image,null!==r&&(o.image_.crossOrigin=r),o.unlisten_=null,o.tileLoadFunction_=s,o}return gq(e,t),e.prototype.disposeInternal=function(){this.state==aa.LOADING&&(this.unlistenImage_(),this.image_=gk()),this.interimTile&&this.interimTile.dispose(),this.state=aa.ABORT,this.changed(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.image_},e.prototype.getKey=function(){return this.src_},e.prototype.handleImageError_=function(){this.state=aa.ERROR,this.unlistenImage_(),this.image_=gk(),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=aa.LOADED:this.state=aa.EMPTY,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==aa.ERROR&&(this.state=aa.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==aa.IDLE&&(this.state=aa.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=hg(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(kg);function gk(){var t=Ma(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}ig.default=fk;var hq=function(){function t(t,i,n){this.decay_=t,this.minVelocity_=i,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}return t.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},t.prototype.update=function(t,i){this.points_.push(t,i,Date.now())},t.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,i=this.points_.length-3;if(this.points_[i+2]<t)return!1;for(var n=i-3;n>0&&this.points_[n+2]>t;)n-=3;var e=this.points_[i+2]-this.points_[n+2];if(e<1e3/60)return!1;var s=this.points_[i]-this.points_[n],o=this.points_[i+1]-this.points_[n+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/e,this.initialVelocity_>this.minVelocity_},t.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},t.prototype.getAngle=function(){return this.angle_},t}();var lg={};var mg={};var ng={};var og={};var iq=og&&og.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Uc=function(t){function e(e,r,n){var o=t.call(this,e)||this;return o.map=r,o.frameState=void 0!==n?n:null,o}return iq(e,t),e}(L);og.default=Uc;var jq=ng&&ng.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),pg=function(t){function e(e,o,r,n,p){var i=t.call(this,e,o,p)||this;return i.originalEvent=r,i.pixel=o.getEventPixel(r),i.coordinate=o.getCoordinateFromPixel(i.pixel),i.dragging=void 0!==n&&n,i}return jq(e,t),e.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},e}(Uc);ng.default=pg;var qg={};var d={SINGLECLICK:"singleclick",CLICK:g.CLICK,DBLCLICK:g.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var rg={};var kq=rg&&rg.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),Sa=function(t){function r(r,e,n,o,s){var $=t.call(this,r,e,n.originalEvent,o,s)||this;return $.pointerEvent=n,$}return kq(r,t),r}(pg);rg.default=Sa;var Q={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var sg={};var jc={};var Kd=function(){function t(t,e){this.dispatcher=t,this.mapping_=e}return t.prototype.getEvents=function(){return Object.keys(this.mapping_)},t.prototype.getHandlerForEvent=function(t){return this.mapping_[t]},t}();var lq=jc&&jc.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),hb=1;jc.POINTER_ID=hb;var tg="mouse";jc.POINTER_TYPE=tg;var hk=25;function mq(t){if(!this.isEventSimulatedFromTouch_(t)){hb.toString()in this.pointerMap&&this.cancel(t);var e=ib(t,this.dispatcher);this.pointerMap[hb.toString()]=t,this.dispatcher.down(e,t)}}function nq(t){if(!this.isEventSimulatedFromTouch_(t)){var e=ib(t,this.dispatcher);this.dispatcher.move(e,t)}}function oq(t){if(!this.isEventSimulatedFromTouch_(t)){var e=this.pointerMap[hb.toString()];if(e&&e.button===t.button){var r=ib(t,this.dispatcher);this.dispatcher.up(r,t),this.cleanupMouse()}}}function pq(t){if(!this.isEventSimulatedFromTouch_(t)){var e=ib(t,this.dispatcher);this.dispatcher.enterOver(e,t)}}function qq(t){if(!this.isEventSimulatedFromTouch_(t)){var e=ib(t,this.dispatcher);this.dispatcher.leaveOut(e,t)}}var ik=function(t){function e(e){var r=this,o={mousedown:mq,mousemove:nq,mouseup:oq,mouseover:pq,mouseout:qq};return(r=t.call(this,e,o)||this).pointerMap=e.pointerMap,r.lastTouches=[],r}return lq(e,t),e.prototype.isEventSimulatedFromTouch_=function(t){for(var e=this.lastTouches,r=t.clientX,o=t.clientY,$=0,n=e.length,i=void 0;$<n&&(i=e[$]);$++){var p=Math.abs(r-i[0]),a=Math.abs(o-i[1]);if(p<=hk&&a<=hk)return!0}return!1},e.prototype.cancel=function(t){var e=ib(t,this.dispatcher);this.dispatcher.cancel(e,t),this.cleanupMouse()},e.prototype.cleanupMouse=function(){delete this.pointerMap[hb.toString()]},e}(Kd);function ib(t,e){var r=e.cloneEvent(t,t),o=r.preventDefault;return r.preventDefault=function(){t.preventDefault(),o()},r.pointerId=hb,r.isPrimary=!0,r.pointerType=tg,r}jc.prepareEvent=ib,jc.default=ik;var ug={};var rq=ug&&ug.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),sq=["","unavailable","touch","pen","mouse"];function tq(t){this.pointerMap[t.pointerId.toString()]=t;var e=this.prepareEvent_(t);this.dispatcher.down(e,t)}function uq(t){var e=this.prepareEvent_(t);this.dispatcher.move(e,t)}function vq(t){var e=this.prepareEvent_(t);this.dispatcher.up(e,t),this.cleanup(t.pointerId)}function wq(t){var e=this.prepareEvent_(t);this.dispatcher.leaveOut(e,t)}function xq(t){var e=this.prepareEvent_(t);this.dispatcher.enterOver(e,t)}function yq(t){var e=this.prepareEvent_(t);this.dispatcher.cancel(e,t),this.cleanup(t.pointerId)}function zq(t){var e=this.dispatcher.makeEvent("lostpointercapture",t,t);this.dispatcher.dispatchEvent(e)}function Aq(t){var e=this.dispatcher.makeEvent("gotpointercapture",t,t);this.dispatcher.dispatchEvent(e)}var jk=function(t){function e(e){var r=this,n={MSPointerDown:tq,MSPointerMove:uq,MSPointerUp:vq,MSPointerOut:wq,MSPointerOver:xq,MSPointerCancel:yq,MSGotPointerCapture:Aq,MSLostPointerCapture:zq};return(r=t.call(this,e,n)||this).pointerMap=e.pointerMap,r}return rq(e,t),e.prototype.prepareEvent_=function(t){var e=t;return"number"==typeof t.pointerType&&((e=this.dispatcher.cloneEvent(t,t)).pointerType=sq[t.pointerType]),e},e.prototype.cleanup=function(t){delete this.pointerMap[t.toString()]},e}(Kd);ug.default=jk;var vg={};var Bq=vg&&vg.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function Cq(t){this.dispatcher.fireNativeEvent(t)}function Dq(t){this.dispatcher.fireNativeEvent(t)}function Eq(t){this.dispatcher.fireNativeEvent(t)}function Fq(t){this.dispatcher.fireNativeEvent(t)}function Gq(t){this.dispatcher.fireNativeEvent(t)}function Hq(t){this.dispatcher.fireNativeEvent(t)}function Iq(t){this.dispatcher.fireNativeEvent(t)}function Jq(t){this.dispatcher.fireNativeEvent(t)}var kk=function(t){function e(e){var r={pointerdown:Cq,pointermove:Dq,pointerup:Eq,pointerout:Fq,pointerover:Gq,pointercancel:Hq,gotpointercapture:Jq,lostpointercapture:Iq};return t.call(this,e,r)||this}return Bq(e,t),e}(Kd);vg.default=kk;var wg={};var Kq=wg&&wg.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Lq=!1,lk=function(e){function t(t,n,r){var i=e.call(this,t)||this;i.originalEvent=n;var a=r||{};return i.buttons=Mq(a),i.pressure=Nq(a,i.buttons),i.bubbles="bubbles"in a&&a.bubbles,i.cancelable="cancelable"in a&&a.cancelable,i.view="view"in a?a.view:null,i.detail="detail"in a?a.detail:null,i.screenX="screenX"in a?a.screenX:0,i.screenY="screenY"in a?a.screenY:0,i.clientX="clientX"in a?a.clientX:0,i.clientY="clientY"in a?a.clientY:0,i.ctrlKey="ctrlKey"in a&&a.ctrlKey,i.altKey="altKey"in a&&a.altKey,i.shiftKey="shiftKey"in a&&a.shiftKey,i.metaKey="metaKey"in a&&a.metaKey,i.button="button"in a?a.button:0,i.relatedTarget="relatedTarget"in a?a.relatedTarget:null,i.pointerId="pointerId"in a?a.pointerId:0,i.width="width"in a?a.width:0,i.height="height"in a?a.height:0,i.tiltX="tiltX"in a?a.tiltX:0,i.tiltY="tiltY"in a?a.tiltY:0,i.pointerType="pointerType"in a?a.pointerType:"",i.hwTimestamp="hwTimestamp"in a?a.hwTimestamp:0,i.isPrimary="isPrimary"in a&&a.isPrimary,n.preventDefault&&(i.preventDefault=function(){n.preventDefault()}),i}return Kq(t,e),t}(L);function Mq(e){var t;if(e.buttons||Lq)t=e.buttons;else switch(e.which){case 1:t=1;break;case 2:t=4;break;case 3:t=2;break;default:t=0;}return t}function Nq(e,t){return e.pressure?e.pressure:t?.5:0}!function(){try{var e=new MouseEvent("click",{buttons:1});Lq=1===e.buttons}catch(t){}}(),wg.default=lk;var xg={};var Oq=xg&&xg.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Pq=200,Qq="touch";function Rq(t){this.vacuumTouches_(t),this.setPrimaryTouch_(t.changedTouches[0]),this.dedupSynthMouse_(t),this.clickCount_++,this.processTouches_(t,this.overDown_)}function Sq(t){this.processTouches_(t,this.moveOverOut_)}function Tq(t){this.dedupSynthMouse_(t),this.processTouches_(t,this.upOut_)}function Uq(t){this.processTouches_(t,this.cancelOut_)}var mk=function(t){function e(e,r){var o=this,i={touchstart:Rq,touchmove:Sq,touchend:Tq,touchcancel:Uq};return(o=t.call(this,e,i)||this).pointerMap=e.pointerMap,o.mouseSource=r,o.firstTouchId_=void 0,o.clickCount_=0,o.resetId_,o.dedupTimeout_=2500,o}return Oq(e,t),e.prototype.isPrimaryTouch_=function(t){return this.firstTouchId_===t.identifier},e.prototype.setPrimaryTouch_=function(t){var e=Object.keys(this.pointerMap).length;(0===e||1===e&&hb.toString()in this.pointerMap)&&(this.firstTouchId_=t.identifier,this.cancelResetClickCount_())},e.prototype.removePrimaryPointer_=function(t){t.isPrimary&&(this.firstTouchId_=void 0,this.resetClickCount_())},e.prototype.resetClickCount_=function(){this.resetId_=setTimeout(this.resetClickCountHandler_.bind(this),Pq)},e.prototype.resetClickCountHandler_=function(){this.clickCount_=0,this.resetId_=void 0},e.prototype.cancelResetClickCount_=function(){void 0!==this.resetId_&&clearTimeout(this.resetId_)},e.prototype.touchToPointer_=function(t,e){var r=this.dispatcher.cloneEvent(t,e);return r.pointerId=e.identifier+2,r.bubbles=!0,r.cancelable=!0,r.detail=this.clickCount_,r.button=0,r.buttons=1,r.width=e.radiusX||0,r.height=e.radiusY||0,r.pressure=e.force||.5,r.isPrimary=this.isPrimaryTouch_(e),r.pointerType=Qq,r.clientX=e.clientX,r.clientY=e.clientY,r.screenX=e.screenX,r.screenY=e.screenY,r},e.prototype.processTouches_=function(t,e){var r=Array.prototype.slice.call(t.changedTouches),o=r.length;function i(){t.preventDefault()}for(var n=0;n<o;++n){var c=this.touchToPointer_(t,r[n]);c.preventDefault=i,e.call(this,t,c)}},e.prototype.findTouch_=function(t,e){for(var r=t.length,o=0;o<r;o++){if(t[o].identifier===e)return!0}return!1},e.prototype.vacuumTouches_=function(t){var e=t.touches,r=Object.keys(this.pointerMap),o=r.length;if(o>=e.length){for(var i=[],n=0;n<o;++n){var c=Number(r[n]),s=this.pointerMap[c];c==hb||this.findTouch_(e,c-2)||i.push(s.out)}for(n=0;n<i.length;++n)this.cancelOut_(t,i[n])}},e.prototype.overDown_=function(t,e){this.pointerMap[e.pointerId]={target:e.target,out:e,outTarget:e.target},this.dispatcher.over(e,t),this.dispatcher.enter(e,t),this.dispatcher.down(e,t)},e.prototype.moveOverOut_=function(t,e){var r=e,o=this.pointerMap[r.pointerId];if(o){var i=o.out,n=o.outTarget;this.dispatcher.move(r,t),i&&n!==r.target&&(i.relatedTarget=r.target,r.relatedTarget=n,i.target=n,r.target?(this.dispatcher.leaveOut(i,t),this.dispatcher.enterOver(r,t)):(r.target=n,r.relatedTarget=null,this.cancelOut_(t,r))),o.out=r,o.outTarget=r.target}},e.prototype.upOut_=function(t,e){this.dispatcher.up(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},e.prototype.cancelOut_=function(t,e){this.dispatcher.cancel(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},e.prototype.cleanUpPointer_=function(t){delete this.pointerMap[t.pointerId],this.removePrimaryPointer_(t)},e.prototype.dedupSynthMouse_=function(t){var e=this.mouseSource.lastTouches,r=t.changedTouches[0];if(this.isPrimaryTouch_(r)){var o=[r.clientX,r.clientY];e.push(o),setTimeout(function(){Rn(e,o)},this.dedupTimeout_)}},e}(Kd);xg.default=mk;var Vq=sg&&sg.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),yg=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]],Ld=function(t){function e(e){var r=t.call(this)||this;return r.element_=e,r.pointerMap={},r.eventMap_={},r.eventSourceList_=[],r.registerSources(),r}return Vq(e,t),e.prototype.registerSources=function(){if("PointerEvent"in window)this.registerSource("native",new kk(this));else if(window.navigator.msPointerEnabled)this.registerSource("ms",new jk(this));else{var t=new ik(this);this.registerSource("mouse",t),"ontouchstart"in window&&this.registerSource("touch",new mk(this,t))}this.register_()},e.prototype.registerSource=function(t,e){var r=e,n=r.getEvents();n&&(n.forEach(function(t){var e=r.getHandlerForEvent(t);e&&(this.eventMap_[t]=e.bind(r))}.bind(this)),this.eventSourceList_.push(r))},e.prototype.register_=function(){for(var t=this.eventSourceList_.length,e=0;e<t;e++){var r=this.eventSourceList_[e];this.addEvents_(r.getEvents())}},e.prototype.unregister_=function(){for(var t=this.eventSourceList_.length,e=0;e<t;e++){var r=this.eventSourceList_[e];this.removeEvents_(r.getEvents())}},e.prototype.eventHandler_=function(t){var e=t.type,r=this.eventMap_[e];r&&r(t)},e.prototype.addEvents_=function(t){t.forEach(function(t){f(this.element_,t,this.eventHandler_,this)}.bind(this))},e.prototype.removeEvents_=function(t){t.forEach(function(t){ka(this.element_,t,this.eventHandler_,this)}.bind(this))},e.prototype.cloneEvent=function(t,e){for(var r={},n=0,o=yg.length;n<o;n++){var i=yg[n][0];r[i]=t[i]||e[i]||yg[n][1]}return r},e.prototype.down=function(t,e){this.fireEvent(Q.POINTERDOWN,t,e)},e.prototype.move=function(t,e){this.fireEvent(Q.POINTERMOVE,t,e)},e.prototype.up=function(t,e){this.fireEvent(Q.POINTERUP,t,e)},e.prototype.enter=function(t,e){t.bubbles=!1,this.fireEvent(Q.POINTERENTER,t,e)},e.prototype.leave=function(t,e){t.bubbles=!1,this.fireEvent(Q.POINTERLEAVE,t,e)},e.prototype.over=function(t,e){t.bubbles=!0,this.fireEvent(Q.POINTEROVER,t,e)},e.prototype.out=function(t,e){t.bubbles=!0,this.fireEvent(Q.POINTEROUT,t,e)},e.prototype.cancel=function(t,e){this.fireEvent(Q.POINTERCANCEL,t,e)},e.prototype.leaveOut=function(t,e){this.out(t,e),this.contains_(t.target,t.relatedTarget)||this.leave(t,e)},e.prototype.enterOver=function(t,e){this.over(t,e),this.contains_(t.target,t.relatedTarget)||this.enter(t,e)},e.prototype.contains_=function(t,e){return!(!t||!e)&&t.contains(e)},e.prototype.makeEvent=function(t,e,r){return new lk(t,r,e)},e.prototype.fireEvent=function(t,e,r){var n=this.makeEvent(t,e,r);this.dispatchEvent(n)},e.prototype.fireNativeEvent=function(t){var e=this.makeEvent(t.type,t,t);this.dispatchEvent(e)},e.prototype.wrapMouseEvent=function(t,e){return this.makeEvent(t,ib(e,this),e)},e.prototype.disposeInternal=function(){this.unregister_(),t.prototype.disposeInternal.call(this)},e}(tb);sg.default=Ld;var Wq=qg&&qg.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),nk=function(t){function e(e,i){var n=t.call(this)||this;n.map_=e,n.clickTimeoutId_,n.dragging_=!1,n.dragListenerKeys_=[],n.moveTolerance_=i?i*Jd:Jd,n.down_=null;var r=n.map_.getViewport();return n.activePointers_=0,n.trackedTouches_={},n.pointerEventHandler_=new Ld(r),n.documentPointerEventHandler_=null,n.pointerdownListenerKey_=f(n.pointerEventHandler_,Q.POINTERDOWN,n.handlePointerDown_,n),n.relayedListenerKey_=f(n.pointerEventHandler_,Q.POINTERMOVE,n.relayEvent_,n),n}return Wq(e,t),e.prototype.emulateClick_=function(t){var e=new Sa(d.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Sa(d.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var e=new Sa(d.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var e=t;e.type==d.POINTERUP||e.type==d.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==d.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new Sa(d.POINTERUP,this.map_,t);this.dispatchEvent(e),e.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(l),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null,this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null)},e.prototype.isMouseActionButton_=function(t){return 0===t.button},e.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);var e=new Sa(d.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&(this.documentPointerEventHandler_=new Ld(document),this.dragListenerKeys_.push(f(this.documentPointerEventHandler_,d.POINTERMOVE,this.handlePointerMove_,this),f(this.documentPointerEventHandler_,d.POINTERUP,this.handlePointerUp_,this),f(this.pointerEventHandler_,d.POINTERCANCEL,this.handlePointerUp_,this)))},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var e=new Sa(d.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}},e.prototype.relayEvent_=function(t){var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new Sa(t.type,this.map_,t,e))},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(l(this.relayedListenerKey_),this.relayedListenerKey_=null),this.pointerdownListenerKey_&&(l(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(l),this.dragListenerKeys_.length=0,this.documentPointerEventHandler_&&(this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null),this.pointerEventHandler_&&(this.pointerEventHandler_.dispose(),this.pointerEventHandler_=null),t.prototype.disposeInternal.call(this)},e}(tb);qg.default=nk;var kc={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"};var N={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};var zg={};var Md=1/0;var Xq=function(){function t(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return t.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,$a(this.queuedElements_)},t.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var n=this.keyFunction_(i);return delete this.queuedElements_[n],i},t.prototype.enqueue=function(t){q(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=Md&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},t.prototype.getCount=function(){return this.elements_.length},t.prototype.getLeftChildIndex_=function(t){return 2*t+1},t.prototype.getRightChildIndex_=function(t){return 2*t+2},t.prototype.getParentIndex_=function(t){return t-1>>1},t.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},t.prototype.isEmpty=function(){return 0===this.elements_.length},t.prototype.isKeyQueued=function(t){return t in this.queuedElements_},t.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},t.prototype.siftUp_=function(t){for(var e=this.elements_,i=this.priorities_,n=e.length,r=e[t],s=i[t],o=t;t<n>>1;){var u=this.getLeftChildIndex_(t),h=this.getRightChildIndex_(t),p=h<n&&i[h]<i[u]?h:u;e[t]=e[p],i[t]=i[p],t=p}e[t]=r,i[t]=s,this.siftDown_(o,t)},t.prototype.siftDown_=function(t,e){for(var i=this.elements_,n=this.priorities_,r=i[e],s=n[e];e>t;){var o=this.getParentIndex_(e);if(!(n[o]>s))break;i[e]=i[o],n[e]=n[o],e=o}i[e]=r,n[e]=s},t.prototype.reprioritize=function(){var t,e,i,n=this.priorityFunction_,r=this.elements_,s=this.priorities_,o=0,u=r.length;for(e=0;e<u;++e)(i=n(t=r[e]))==Md?delete this.queuedElements_[this.keyFunction_(t)]:(s[o]=i,r[o++]=t);r.length=o,s.length=o,this.heapify_()},t}();var Yq=zg&&zg.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ok=function(t){function e(e,i){var r=t.call(this,function(t){return e.apply(null,t)},function(t){return t[0].getKey()})||this;return r.tileChangeCallback_=i,r.tilesLoading_=0,r.tilesLoadingKeys_={},r}return Yq(e,t),e.prototype.enqueue=function(e){var i=t.prototype.enqueue.call(this,e);if(i){var r=e[0];f(r,g.CHANGE,this.handleTileChange,this)}return i},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var e=t.target,i=e.getState();if(e.hifi&&i===aa.LOADED||i===aa.ERROR||i===aa.EMPTY||i===aa.ABORT){ka(e,g.CHANGE,this.handleTileChange,this);var r=e.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,e){for(var i,r,n,o=0,a=!1;this.tilesLoading_<t&&o<e&&this.getCount()>0;)n=(r=this.dequeue()[0]).getKey(),(i=r.getState())===aa.ABORT?a=!0:i!==aa.IDLE||n in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[n]=!0,++this.tilesLoading_,++o,r.load());0===o&&a&&this.tileChangeCallback_()},e}(Xq);zg.default=ok;var Pb={};var Zq=42;var Ag=256;function pk(t,$,e){return function(r,a,o,n){if(r){var f=$?0:o[0]*a,x=$?0:o[1]*a,E=t[0]+f/2,p=t[2]-f/2,B=t[1]+x/2,P=t[3]-x/2;E>p&&(E=p=(p+E)/2),B>P&&(B=P=(P+B)/2);var c=D(r[0],E,p),h=D(r[1],B,P),m=30*a;return n&&e&&(c+=-m*Math.log(1+Math.max(0,E-r[0])/m)+m*Math.log(1+Math.max(0,r[0]-p)/m),h+=-m*Math.log(1+Math.max(0,B-r[1])/m)+m*Math.log(1+Math.max(0,r[1]-P)/m)),[c,h]}}}function $q(t){return t}function Bg(t,e,o){var r=H(e)/o[0],$=va(e)/o[1];return Math.min(t,Math.min(r,$))}function Cg(t,e,o){var r=Math.min(t,e);return r*=Math.log(1+50*Math.max(0,t/e-1))/50+1,o&&(r=Math.max(r,o),r/=Math.log(1+50*Math.max(0,o/t-1))/50+1),D(r,o/2,2*e)}function _q(t,e,o){return function(r,$,a,u){if(void 0!==r){var i=t[0],n=t[t.length-1],x=o?Bg(i,o,a):i;if(u)return void 0===e||e?Cg(r,x,n):D(r,n,x);var p=Math.min(x,r),l=Math.floor(Ye(t,p,$));return t[l]}}}function ar(t,e,o,r,$){return function(a,u,i,n){if(void 0!==a){var x=$?Bg(e,$,i):e,p=void 0!==o?o:0;if(n)return void 0===r||r?Cg(a,x,p):D(a,p,x);var l=-u*(.5-1e-9)+.5,m=Math.min(x,a),O=Math.floor(Math.log(e/m)/Math.log(t)+l),c=e/Math.pow(t,O);return D(c,p,x)}}}function qk(t,e,o,r){return function($,a,u,i){if(void 0!==$){var n=r?Bg(t,r,u):t;return(void 0===o||o)&&i?Cg($,n,e):D($,e,n)}}}function Dg(e){return void 0!==e?0:void 0}function rk(e){return void 0!==e?e:void 0}function br(e){var o=2*Math.PI/e;return function(e,r){return r?e:void 0!==e?e=Math.floor(e/o+.5)*o:void 0}}function cr(e){var o=e||xa(5);return function(e,r){return r?e:void 0!==e?Math.abs(e)<=o?0:e:void 0}}var ha={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};var dr=Pb&&Pb.__extends||function(){var t=function(o,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(o,e)};return function(o,e){function i(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),Eg=0,Fg=function(t){function o(o){var e=t.call(this)||this,i=$({},o);return e.hints_=[0,0],e.animations_=[],e.updateAnimationKey_,e.projection_=jf(i.projection,"EPSG:3857"),e.targetCenter_=null,e.targetResolution_,e.targetRotation_,e.applyOptions_(i),e}return dr(o,t),o.prototype.applyOptions_=function(t){var o=tk(t);this.maxResolution_=o.maxResolution,this.minResolution_=o.minResolution,this.zoomFactor_=o.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=o.minZoom;var e=sk(t),i=o.constraint,r=uk(t);this.constraints_={center:e,resolution:i,rotation:r},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenter(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom),this.resolveConstraints(0),this.setProperties({}),this.options_=t},o.prototype.getUpdatedOptions_=function(t){var o=$({},this.options_);return void 0!==o.resolution?o.resolution=this.getResolution():o.zoom=this.getZoom(),o.center=this.getCenter(),o.rotation=this.getRotation(),$({},o,t)},o.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0),this.animate_.apply(this,arguments)},o.prototype.animate_=function(t){var o,e=arguments.length;if(e>1&&"function"==typeof arguments[e-1]&&(o=arguments[e-1],--e),!this.isDef()){var i=arguments[e-1];return i.center&&this.setCenter(i.center),void 0!==i.zoom&&this.setZoom(i.zoom),void 0!==i.rotation&&this.setRotation(i.rotation),void(o&&Nd(o,!0))}for(var r=Date.now(),n=this.targetCenter_.slice(),s=this.targetResolution_,a=this.targetRotation_,p=[],u=0;u<e;++u){var $=arguments[u],h={start:r,complete:!1,anchor:$.anchor,duration:void 0!==$.duration?$.duration:1e3,easing:$.easing||dq,callback:o};if($.center&&(h.sourceCenter=n,h.targetCenter=$.center.slice(),n=h.targetCenter),void 0!==$.zoom?(h.sourceResolution=s,h.targetResolution=this.getResolutionForZoom($.zoom),s=h.targetResolution):$.resolution&&(h.sourceResolution=s,h.targetResolution=$.resolution,s=h.targetResolution),void 0!==$.rotation){h.sourceRotation=a;var l=Db($.rotation-a+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=a+l,a=h.targetRotation}vk(h)?h.complete=!0:r+=h.duration,p.push(h)}this.animations_.push(p),this.setHint(J.ANIMATING,1),this.updateAnimations_()},o.prototype.getAnimating=function(){return this.hints_[J.ANIMATING]>0},o.prototype.getInteracting=function(){return this.hints_[J.INTERACTING]>0},o.prototype.cancelAnimations=function(){this.setHint(J.ANIMATING,-this.hints_[J.ANIMATING]);for(var t=0,o=this.animations_.length;t<o;++t){var e=this.animations_[t];e[0].callback&&Nd(e[0].callback,!1)}this.animations_.length=0},o.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),o=!1,e=this.animations_.length-1;e>=0;--e){for(var i=this.animations_[e],r=!0,n=0,s=i.length;n<s;++n){var a=i[n];if(!a.complete){var p=t-a.start,u=a.duration>0?p/a.duration:1;u>=1?(a.complete=!0,u=1):r=!1;var $=a.easing(u);if(a.sourceCenter){var h=a.sourceCenter[0],l=a.sourceCenter[1],c=h+$*(a.targetCenter[0]-h),m=l+$*(a.targetCenter[1]-l);this.targetCenter_=[c,m]}if(a.sourceResolution&&a.targetResolution){var g=1===$?a.targetResolution:a.sourceResolution+$*(a.targetResolution-a.sourceResolution);if(a.anchor){var _=this.getSizeFromViewport_(this.getRotation()),R=this.constraints_.resolution(g,0,_,!0);this.targetCenter_=this.calculateCenterZoom(R,a.anchor)}this.targetResolution_=g,this.applyTargetState_(!0)}if(void 0!==a.sourceRotation&&void 0!==a.targetRotation){var v=1===$?Db(a.targetRotation+Math.PI,2*Math.PI)-Math.PI:a.sourceRotation+$*(a.targetRotation-a.sourceRotation);if(a.anchor){var d=this.constraints_.rotation(v,!0);this.targetCenter_=this.calculateCenterRotate(d,a.anchor)}this.targetRotation_=v}if(this.applyTargetState_(!0),o=!0,!a.complete)break}}if(r){this.animations_[e]=null,this.setHint(J.ANIMATING,-1);var X=i[0].callback;X&&Nd(X,!0)}}this.animations_=this.animations_.filter(Boolean),o&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},o.prototype.calculateCenterRotate=function(t,o){var e,i=this.getCenter();return void 0!==i&&(e=[i[0]-o[0],i[1]-o[1]],Fd(e,t-this.getRotation()),Yj(e,o)),e},o.prototype.calculateCenterZoom=function(t,o){var e,i=this.getCenter(),r=this.getResolution();void 0!==i&&void 0!==r&&(e=[o[0]-t*(o[0]-i[0])/r,o[1]-t*(o[1]-i[1])/r]);return e},o.prototype.getSizeFromViewport_=function(t){var o=[100,100],e=".ol-viewport[data-view=\""+ba(this)+"\"]",i=document.querySelector(e);if(i){var r=getComputedStyle(i);o[0]=parseInt(r.width,10),o[1]=parseInt(r.height,10)}if(t){var n=o[0],s=o[1];o[0]=Math.abs(n*Math.cos(t))+Math.abs(s*Math.sin(t)),o[1]=Math.abs(n*Math.sin(t))+Math.abs(s*Math.cos(t))}return o},o.prototype.getCenter=function(){return this.get(ha.CENTER)},o.prototype.getConstraints=function(){return this.constraints_},o.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},o.prototype.calculateExtent=function(t){var o=t||this.getSizeFromViewport_(),e=this.getCenter();q(e,1);var i=this.getResolution();q(void 0!==i,2);var r=this.getRotation();return q(void 0!==r,3),Ni(e,i,r,o)},o.prototype.getMaxResolution=function(){return this.maxResolution_},o.prototype.getMinResolution=function(){return this.minResolution_},o.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},o.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},o.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},o.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},o.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},o.prototype.getProjection=function(){return this.projection_},o.prototype.getResolution=function(){return this.get(ha.RESOLUTION)},o.prototype.getResolutions=function(){return this.resolutions_},o.prototype.getResolutionForExtent=function(t,o){var e=o||this.getSizeFromViewport_(),i=H(t)/e[0],r=va(t)/e[1];return Math.max(i,r)},o.prototype.getResolutionForValueFunction=function(t){var o=t||2,e=this.maxResolution_,i=this.minResolution_,r=Math.log(e/i)/Math.log(o);return function(t){return e/Math.pow(o,t*r)}},o.prototype.getRotation=function(){return this.get(ha.ROTATION)},o.prototype.getValueForResolutionFunction=function(t){var o=t||2,e=this.maxResolution_,i=this.minResolution_,r=Math.log(e/i)/Math.log(o);return function(t){return Math.log(e/t)/Math.log(o)/r}},o.prototype.getState=function(){var t=this.getCenter(),o=this.getProjection(),e=this.getResolution(),i=this.getRotation();return{center:t.slice(0),projection:void 0!==o?o:null,resolution:e,rotation:i,zoom:this.getZoom()}},o.prototype.getZoom=function(){var t,o=this.getResolution();return void 0!==o&&(t=this.getZoomForResolution(o)),t},o.prototype.getZoomForResolution=function(t){var o,e,i=this.minZoom_||0;if(this.resolutions_){var r=Ye(this.resolutions_,t,1);i=r,o=this.resolutions_[r],e=r==this.resolutions_.length-1?2:o/this.resolutions_[r+1]}else o=this.maxResolution_,e=this.zoomFactor_;return i+Math.log(o/t)/Math.log(e)},o.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var o=D(Math.floor(t),0,this.resolutions_.length-2),e=this.resolutions_[o]/this.resolutions_[o+1];return this.resolutions_[o]/Math.pow(e,D(t-o,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},o.prototype.fit=function(t,o){var e,i=o||{},r=i.size;r||(r=this.getSizeFromViewport_()),q(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t)?(q(!cf(t),25),e=Ic(t)):t.getType()===b.CIRCLE?(t=t.getExtent(),(e=Ic(t)).rotate(this.getRotation(),Yb(t))):e=t;var n,s=void 0!==i.padding?i.padding:[0,0,0,0],a=void 0!==i.nearest&&i.nearest;n=void 0!==i.minResolution?i.minResolution:void 0!==i.maxZoom?this.getResolutionForZoom(i.maxZoom):0;for(var p=e.getFlatCoordinates(),u=this.getRotation(),$=Math.cos(-u),h=Math.sin(-u),l=1/0,c=1/0,m=-1/0,g=-1/0,_=e.getStride(),R=0,v=p.length;R<v;R+=_){var d=p[R]*$-p[R+1]*h,X=p[R]*h+p[R+1]*$;l=Math.min(l,d),c=Math.min(c,X),m=Math.max(m,d),g=Math.max(g,X)}var y=this.getResolutionForExtent([l,c,m,g],[r[0]-s[1]-s[3],r[1]-s[0]-s[2]]);y=isNaN(y)?n:Math.max(y,n),y=this.getConstrainedResolution(y,a?0:1),h=-h;var f=(l+m)/2,C=(c+g)/2,x=[(f+=(s[1]-s[3])/2*y)*$-(C+=(s[0]-s[2])/2*y)*h,C*$+f*h],M=i.callback?i.callback:Ha;void 0!==i.duration?this.animate_({resolution:y,center:this.getConstrainedCenter(x,y),duration:i.duration,easing:i.easing},M):(this.targetResolution_=y,this.targetCenter_=x,this.applyTargetState_(!1,!0),Nd(M,!0))},o.prototype.centerOn=function(t,o,e){var i=this.getRotation(),r=Math.cos(-i),n=Math.sin(-i),s=t[0]*r-t[1]*n,a=t[1]*r+t[0]*n,p=this.getResolution(),u=(s+=(o[0]/2-e[0])*p)*r-(a+=(e[1]-o[1]/2)*p)*(n=-n),$=a*r+s*n;this.setCenter([u,$])},o.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()},o.prototype.adjustCenter=function(t){var o=this.targetCenter_;this.setCenter([o[0]+t[0],o[1]+t[1]])},o.prototype.adjustResolution=function(t,o){var e=this.getAnimating()||this.getInteracting(),i=this.getSizeFromViewport_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,i,e);void 0!==o&&(this.targetCenter_=this.calculateCenterZoom(r,o)),this.targetResolution_*=t,this.applyTargetState_()},o.prototype.adjustZoom=function(t,o){this.adjustResolution(Math.pow(this.zoomFactor_,-t),o)},o.prototype.adjustRotation=function(t,o){var e=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+t,e);void 0!==o&&(this.targetCenter_=this.calculateCenterRotate(i,o)),this.targetRotation_+=t,this.applyTargetState_()},o.prototype.setCenter=function(t){this.targetCenter_=t,this.applyTargetState_()},o.prototype.setHint=function(t,o){return this.hints_[t]+=o,this.changed(),this.hints_[t]},o.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},o.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},o.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},o.prototype.applyTargetState_=function(t,o){var e=this.getAnimating()||this.getInteracting()||o,i=this.constraints_.rotation(this.targetRotation_,e),r=this.getSizeFromViewport_(i),n=this.constraints_.resolution(this.targetResolution_,0,r,e),s=this.constraints_.center(this.targetCenter_,n,r,e);this.get(ha.ROTATION)!==i&&this.set(ha.ROTATION,i),this.get(ha.RESOLUTION)!==n&&this.set(ha.RESOLUTION,n),this.get(ha.CENTER)&&Ca(this.get(ha.CENTER),s)||this.set(ha.CENTER,s),this.getAnimating()&&!t&&this.cancelAnimations()},o.prototype.resolveConstraints=function(t,o,e){var i=void 0!==t?t:200,r=o||0,n=this.constraints_.rotation(this.targetRotation_),s=this.getSizeFromViewport_(n),a=this.constraints_.resolution(this.targetResolution_,r,s),p=this.constraints_.center(this.targetCenter_,a,s);if(0===i)return this.targetResolution_=a,this.targetRotation_=n,this.targetCenter_=p,void this.applyTargetState_();this.getResolution()===a&&this.getRotation()===n&&this.getCenter()&&Ca(this.getCenter(),p)||(this.getAnimating()&&this.cancelAnimations(),this.animate_({rotation:n,center:p,resolution:a,duration:i,easing:Ob,anchor:e}))},o.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(J.INTERACTING,1)},o.prototype.endInteraction=function(t,o,e){this.setHint(J.INTERACTING,-1),this.resolveConstraints(t,o,e)},o.prototype.getConstrainedCenter=function(t,o){var e=this.getSizeFromViewport_(this.getRotation());return this.constraints_.center(t,o||this.getResolution(),e)},o.prototype.getConstrainedZoom=function(t,o){var e=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(e))},o.prototype.getConstrainedResolution=function(t,o){var e=o||0,i=this.getSizeFromViewport_(this.getRotation());return this.constraints_.resolution(t,e,i)},o}(ga);function Nd(t,o){setTimeout(function(){t(o)},0)}function sk(t){if(void 0!==t.extent){var o=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return pk(t.extent,t.constrainOnlyCenter,o)}var e=jf(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){var i=e.getExtent().slice();return i[0]=-1/0,i[2]=1/0,pk(i,!1,!1)}return $q}function tk(t){var o,e,i,r=void 0!==t.minZoom?t.minZoom:Eg,n=void 0!==t.maxZoom?t.maxZoom:28,s=void 0!==t.zoomFactor?t.zoomFactor:2,a=void 0!==t.multiWorld&&t.multiWorld,p=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint;if(void 0!==t.resolutions){var u=t.resolutions;e=u[r],i=void 0!==u[n]?u[n]:u[u.length-1],o=t.constrainResolution?_q(u,p,!t.constrainOnlyCenter&&t.extent):qk(e,i,p,!t.constrainOnlyCenter&&t.extent)}else{var $=jf(t.projection,"EPSG:3857"),h=$.getExtent(),l=(h?Math.max(H(h),va(h)):360*ya[P.DEGREES]/$.getMetersPerUnit())/Ag/Math.pow(2,Eg),c=l/Math.pow(2,28-Eg);if(void 0!==(e=t.maxResolution)?r=0:e=l/Math.pow(s,r),void 0===(i=t.minResolution)&&(i=void 0!==t.maxZoom?void 0!==t.maxResolution?e/Math.pow(s,n):l/Math.pow(s,n):c),n=r+Math.floor(Math.log(e/i)/Math.log(s)),i=e/Math.pow(s,n-r),t.constrainResolution)o=ar(s,e,i,p,!t.constrainOnlyCenter&&t.extent);else{var m=t.constrainOnlyCenter,g=t.extent;a||g||!$.isGlobal()||(m=!1,g=$.getExtent()),o=qk(e,i,p,!m&&g)}}return{constraint:o,maxResolution:e,minResolution:i,minZoom:r,zoomFactor:s}}function uk(t){if(void 0===t.enableRotation||t.enableRotation){var o=t.constrainRotation;return void 0===o||!0===o?cr():!1===o?rk:"number"==typeof o?br(o):rk}return Dg}function vk(t){return!(t.sourceCenter&&t.targetCenter&&!Ca(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}Pb.createCenterConstraint=sk,Pb.createResolutionConstraint=tk,Pb.createRotationConstraint=uk,Pb.isNoopAnimation=vk,Pb.default=Fg;var Gg={};var er=Gg&&Gg.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Hg={LAYERS:"layers"},wk=function(e){function t(t){var r=this,i=t||{},n=$({},i);delete n.layers;var s=i.layers;return(r=e.call(this,n)||this).layersListenerKeys_=[],r.listenerKeys_={},f(r,x(Hg.LAYERS),r.handleLayersChanged_,r),s?Array.isArray(s)?s=new M(s.slice(),{unique:!0}):q("function"==typeof s.getArray,43):s=new M(void 0,{unique:!0}),r.setLayers(s),r}return er(t,e),t.prototype.handleLayerChange_=function(){this.changed()},t.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(l),this.layersListenerKeys_.length=0;var e=this.getLayers();for(var t in this.layersListenerKeys_.push(f(e,C.ADD,this.handleLayersAdd_,this),f(e,C.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[t].forEach(l);$a(this.listenerKeys_);for(var r=e.getArray(),i=0,n=r.length;i<n;i++){var s=r[i];this.listenerKeys_[ba(s)]=[f(s,rb.PROPERTYCHANGE,this.handleLayerChange_,this),f(s,g.CHANGE,this.handleLayerChange_,this)]}this.changed()},t.prototype.handleLayersAdd_=function(e){var t=e.element;this.listenerKeys_[ba(t)]=[f(t,rb.PROPERTYCHANGE,this.handleLayerChange_,this),f(t,g.CHANGE,this.handleLayerChange_,this)],this.changed()},t.prototype.handleLayersRemove_=function(e){var t=e.element,r=ba(t);this.listenerKeys_[r].forEach(l),delete this.listenerKeys_[r],this.changed()},t.prototype.getLayers=function(){return this.get(Hg.LAYERS)},t.prototype.setLayers=function(e){this.set(Hg.LAYERS,e)},t.prototype.getLayersArray=function(e){var t=void 0!==e?e:[];return this.getLayers().forEach(function(e){e.getLayersArray(t)}),t},t.prototype.getLayerStatesArray=function(e){var t=void 0!==e?e:[],r=t.length;this.getLayers().forEach(function(e){e.getLayerStatesArray(t)});for(var i=this.getLayerState(),n=r,s=t.length;n<s;n++){var o=t[n];o.opacity*=i.opacity,o.visible=o.visible&&i.visible,o.maxResolution=Math.min(o.maxResolution,i.maxResolution),o.minResolution=Math.max(o.minResolution,i.minResolution),o.minZoom=Math.max(o.minZoom,i.minZoom),o.maxZoom=Math.min(o.maxZoom,i.maxZoom),void 0!==i.extent&&(void 0!==o.extent?o.extent=Dc(o.extent,i.extent):o.extent=i.extent)}return t},t.prototype.getSourceState=function(){return za.READY},t}(If);Gg.default=wk;function fr($){return $[0]>0&&$[1]>0}function gr($,r,e){return void 0===e&&(e=[0,0]),e[0]=$[0]*r+.5|0,e[1]=$[1]*r+.5|0,e}function jb($,r){return Array.isArray($)?$:(void 0===r?r=[$,$]:r[0]=r[1]=$,r)}var hr=mg&&mg.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ig=function(e){function t(t){var i=e.call(this)||this,r=ir(t);for(var n in i.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,i.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:Jd,i.animationDelayKey_,i.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(i),i.coordinateToPixelTransform_=ma(),i.pixelToCoordinateTransform_=ma(),i.frameIndex_=0,i.frameState_=null,i.previousExtent_=null,i.viewPropertyListenerKey_=null,i.viewChangeListenerKey_=null,i.layerGroupPropertyListenerKeys_=null,i.viewport_=document.createElement("div"),i.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),i.viewport_.style.position="relative",i.viewport_.style.overflow="hidden",i.viewport_.style.width="100%",i.viewport_.style.height="100%",i.viewport_.style.msTouchAction="none",i.viewport_.style.touchAction="none",i.overlayContainer_=document.createElement("div"),i.overlayContainer_.style.position="absolute",i.overlayContainer_.style.zIndex="0",i.overlayContainer_.style.width="100%",i.overlayContainer_.style.height="100%",i.overlayContainer_.className="ol-overlaycontainer",i.viewport_.appendChild(i.overlayContainer_),i.overlayContainerStopEvent_=document.createElement("div"),i.overlayContainerStopEvent_.style.position="absolute",i.overlayContainerStopEvent_.style.zIndex="0",i.overlayContainerStopEvent_.style.width="100%",i.overlayContainerStopEvent_.style.height="100%",i.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",i.viewport_.appendChild(i.overlayContainerStopEvent_),i.mapBrowserEventHandler_=new nk(i,t.moveTolerance),d)f(i.mapBrowserEventHandler_,d[n],i.handleMapBrowserEvent,i);return i.keyboardEventTarget_=r.keyboardEventTarget,i.keyHandlerKeys_=null,f(i.viewport_,g.CONTEXTMENU,i.handleBrowserEvent,i),f(i.viewport_,g.WHEEL,i.handleBrowserEvent,i),f(i.viewport_,g.MOUSEWHEEL,i.handleBrowserEvent,i),i.controls=r.controls||new M,i.interactions=r.interactions||new M,i.labelCache_=null,i.labelCacheListenerKey_,i.overlays_=r.overlays,i.overlayIdIndex_={},i.renderer_=null,i.handleResize_,i.focus_=null,i.postRenderFunctions_=[],i.tileQueue_=new ok(i.getTilePriority.bind(i),i.handleTileChange_.bind(i)),i.skippedFeatureUids_={},f(i,x(N.LAYERGROUP),i.handleLayerGroupChanged_,i),f(i,x(N.VIEW),i.handleViewChanged_,i),f(i,x(N.SIZE),i.handleSizeChanged_,i),f(i,x(N.TARGET),i.handleTargetChanged_,i),i.setProperties(r.values),i.controls.forEach(function(e){e.setMap(this)}.bind(i)),f(i.controls,C.ADD,function(e){e.element.setMap(this)},i),f(i.controls,C.REMOVE,function(e){e.element.setMap(null)},i),i.interactions.forEach(function(e){e.setMap(this)}.bind(i)),f(i.interactions,C.ADD,function(e){e.element.setMap(this)},i),f(i.interactions,C.REMOVE,function(e){e.element.setMap(null)},i),i.overlays_.forEach(i.addOverlayInternal_.bind(i)),f(i.overlays_,C.ADD,function(e){this.addOverlayInternal_(e.element)},i),f(i.overlays_,C.REMOVE,function(e){var t=e.element.getId();void 0!==t&&delete this.overlayIdIndex_[t.toString()],e.element.setMap(null)},i),i}return hr(t,e),t.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},t.prototype.addControl=function(e){this.getControls().push(e)},t.prototype.addInteraction=function(e){this.getInteractions().push(e)},t.prototype.addLayer=function(e){this.getLayerGroup().getLayers().push(e)},t.prototype.addOverlay=function(e){this.getOverlays().push(e)},t.prototype.addOverlayInternal_=function(e){var t=e.getId();void 0!==t&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)},t.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),ka(this.viewport_,g.CONTEXTMENU,this.handleBrowserEvent,this),ka(this.viewport_,g.WHEEL,this.handleBrowserEvent,this),ka(this.viewport_,g.MOUSEWHEEL,this.handleBrowserEvent,this),void 0!==this.handleResize_&&(removeEventListener(g.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.setTarget(null),e.prototype.disposeInternal.call(this)},t.prototype.forEachFeatureAtPixel=function(e,t,i){if(this.frameState_){var r=this.getCoordinateFromPixel(e),n=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=void 0!==i.layerFilter?i.layerFilter:W;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,n,t,null,o,null)}},t.prototype.getFeaturesAtPixel=function(e,t){var i=null;return this.forEachFeatureAtPixel(e,function(e){i||(i=[]),i.push(e)},t),i},t.prototype.forEachLayerAtPixel=function(e,t,i){if(this.frameState_){var r=i||{},n=void 0!==r.hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=r.layerFilter||W;return this.renderer_.forEachLayerAtPixel(e,this.frameState_,n,t,o)}},t.prototype.hasFeatureAtPixel=function(e,t){if(!this.frameState_)return!1;var i=this.getCoordinateFromPixel(e),r=void 0!==(t=void 0!==t?t:{}).layerFilter?t.layerFilter:W,n=void 0!==t.hitTolerance?t.hitTolerance*this.frameState_.pixelRatio:0;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,n,r,null)},t.prototype.getEventCoordinate=function(e){return this.getCoordinateFromPixel(this.getEventPixel(e))},t.prototype.getEventPixel=function(e){var t=this.viewport_.getBoundingClientRect(),i="changedTouches"in e?e.changedTouches[0]:e;return[i.clientX-t.left,i.clientY-t.top]},t.prototype.getTarget=function(){return this.get(N.TARGET)},t.prototype.getTargetElement=function(){var e=this.getTarget();return void 0!==e?"string"==typeof e?document.getElementById(e):e:null},t.prototype.getCoordinateFromPixel=function(e){var t=this.frameState_;return t?da(t.pixelToCoordinateTransform,e.slice()):null},t.prototype.getControls=function(){return this.controls},t.prototype.getOverlays=function(){return this.overlays_},t.prototype.getOverlayById=function(e){var t=this.overlayIdIndex_[e.toString()];return void 0!==t?t:null},t.prototype.getInteractions=function(){return this.interactions},t.prototype.getLayerGroup=function(){return this.get(N.LAYERGROUP)},t.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},t.prototype.getLoading=function(){for(var e=this.getLayerGroup().getLayerStatesArray(),t=0,i=e.length;t<i;++t){var r=e[t].layer.getSource();if(r&&r.loading)return!0}return!1},t.prototype.getPixelFromCoordinate=function(e){var t=this.frameState_;return t?da(t.coordinateToPixelTransform,e.slice(0,2)):null},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.getSize=function(){return this.get(N.SIZE)},t.prototype.getView=function(){return this.get(N.VIEW)},t.prototype.getViewport=function(){return this.viewport_},t.prototype.getOverlayContainer=function(){return this.overlayContainer_},t.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},t.prototype.getTilePriority=function(e,t,i,r){var n=this.frameState_;if(!(n&&t in n.wantedTiles))return Md;if(!n.wantedTiles[t][e.getKey()])return Md;var o=i[0]-n.focus[0],a=i[1]-n.focus[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r},t.prototype.handleBrowserEvent=function(e,t){var i=t||e.type,r=new pg(i,this,e);this.handleMapBrowserEvent(r)},t.prototype.handleMapBrowserEvent=function(e){if(this.frameState_){for(var t=e.originalEvent.target;t instanceof HTMLElement;){if(t.parentElement===this.overlayContainerStopEvent_)return;t=t.parentElement}this.focus_=e.coordinate,e.frameState=this.frameState_;var i=this.getInteractions().getArray();if(!1!==this.dispatchEvent(e))for(var r=i.length-1;r>=0;r--){var n=i[r];if(n.getActive())if(!n.handleEvent(e))break}}},t.prototype.handlePostRender=function(){var e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){var i=this.maxTilesLoading_,r=i;if(e){var n=e.viewHints;if(n[J.ANIMATING]||n[J.INTERACTING]){var o=!dk&&Date.now()-e.time>8;i=o?0:8,r=o?0:2}}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,r))}!e||!this.hasListener(Ib.RENDERCOMPLETE)||e.animate||this.tileQueue_.getTilesLoading()||this.getLoading()||this.renderer_.dispatchRenderEvent(Ib.RENDERCOMPLETE,e);for(var a=this.postRenderFunctions_,s=0,p=a.length;s<p;++s)a[s](this,e);a.length=0},t.prototype.handleSizeChanged_=function(){this.getView()&&this.getView().resolveConstraints(0),this.render()},t.prototype.handleTargetChanged_=function(){var e;if(this.getTarget()&&(e=this.getTargetElement()),this.keyHandlerKeys_){for(var t=0,i=this.keyHandlerKeys_.length;t<i;++t)l(this.keyHandlerKeys_[t]);this.keyHandlerKeys_=null}if(e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer());var r=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.keyHandlerKeys_=[f(r,g.KEYDOWN,this.handleBrowserEvent,this),f(r,g.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(g.RESIZE,this.handleResize_,!1))}else this.renderer_&&(this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),vd(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(g.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},t.prototype.handleTileChange_=function(){this.render()},t.prototype.handleViewPropertyChanged_=function(){this.render()},t.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(l(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(l(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var e=this.getView();e&&(this.viewport_.setAttribute("data-view",ba(e)),this.viewPropertyListenerKey_=f(e,rb.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=f(e,g.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()},t.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(l),this.layerGroupPropertyListenerKeys_=null);var e=this.getLayerGroup();e&&(this.layerGroupPropertyListenerKeys_=[f(e,rb.PROPERTYCHANGE,this.render,this),f(e,g.CHANGE,this.render,this)]),this.render()},t.prototype.isRendered=function(){return!!this.frameState_},t.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},t.prototype.redrawText=function(){for(var e=this.getLayerGroup().getLayerStatesArray(),t=0,i=e.length;t<i;++t){var r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}},t.prototype.render=function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},t.prototype.removeControl=function(e){return this.getControls().remove(e)},t.prototype.removeInteraction=function(e){return this.getInteractions().remove(e)},t.prototype.removeLayer=function(e){return this.getLayerGroup().getLayers().remove(e)},t.prototype.removeOverlay=function(e){return this.getOverlays().remove(e)},t.prototype.renderFrame_=function(e){var t,i=this.getSize(),r=this.getView(),n=S(),o=this.frameState_,a=null;if(void 0!==i&&fr(i)&&r&&r.isDef()){var s=r.getHints(this.frameState_?this.frameState_.viewHints:void 0);t=r.getState(),a={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterItems:o?o.declutterItems:[],extent:n,focus:this.focus_?this.focus_:t.center,index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:i,skippedFeatureUids:this.skippedFeatureUids_,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:t,viewHints:s,wantedTiles:{}}}if(a&&(a.extent=Ni(t.center,t.resolution,t.rotation,a.size,n)),this.frameState_=a,this.renderer_.renderFrame(a),a){if(a.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,a.postRenderFunctions),o)(!this.previousExtent_||!cf(this.previousExtent_)&&!Cc(a.extent,this.previousExtent_))&&(this.dispatchEvent(new Uc(kc.MOVESTART,this,o)),this.previousExtent_=Wb(this.previousExtent_));this.previousExtent_&&!a.viewHints[J.ANIMATING]&&!a.viewHints[J.INTERACTING]&&!Cc(a.extent,this.previousExtent_)&&(this.dispatchEvent(new Uc(kc.MOVEEND,this,a)),Ji(a.extent,this.previousExtent_))}this.dispatchEvent(new Uc(kc.POSTRENDER,this,a)),setTimeout(this.handlePostRender.bind(this),0)},t.prototype.setLayerGroup=function(e){this.set(N.LAYERGROUP,e)},t.prototype.setSize=function(e){this.set(N.SIZE,e)},t.prototype.setTarget=function(e){this.set(N.TARGET,e)},t.prototype.setView=function(e){this.set(N.VIEW,e)},t.prototype.skipFeature=function(e){this.skippedFeatureUids_[ba(e)]=!0,this.render()},t.prototype.updateSize=function(){var e=this.getTargetElement();if(e){var t=getComputedStyle(e);this.setSize([e.offsetWidth-parseFloat(t.borderLeftWidth)-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)-parseFloat(t.borderRightWidth),e.offsetHeight-parseFloat(t.borderTopWidth)-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom)-parseFloat(t.borderBottomWidth)])}else this.setSize(void 0)},t.prototype.unskipFeature=function(e){delete this.skippedFeatureUids_[ba(e)],this.render()},t}(ga);function ir(e){var t=null;void 0!==e.keyboardEventTarget&&(t="string"==typeof e.keyboardEventTarget?document.getElementById(e.keyboardEventTarget):e.keyboardEventTarget);var i,r,n,o={},a=e.layers&&"function"==typeof e.layers.getLayers?e.layers:new wk({layers:e.layers});return o[N.LAYERGROUP]=a,o[N.TARGET]=e.target,o[N.VIEW]=void 0!==e.view?e.view:new Fg,void 0!==e.controls&&(Array.isArray(e.controls)?i=new M(e.controls.slice()):(q("function"==typeof e.controls.getArray,47),i=e.controls)),void 0!==e.interactions&&(Array.isArray(e.interactions)?r=new M(e.interactions.slice()):(q("function"==typeof e.interactions.getArray,48),r=e.interactions)),void 0!==e.overlays?Array.isArray(e.overlays)?n=new M(e.overlays.slice()):(q("function"==typeof e.overlays.getArray,49),n=e.overlays):n=new M,{controls:i,interactions:r,keyboardEventTarget:t,overlays:n,values:o}}mg.default=Ig;function jr(o){var i=o||{},r=new M;return(void 0===i.zoom||i.zoom)&&r.push(new Bk(i.zoomOptions)),(void 0===i.rotate||i.rotate)&&r.push(new zk(i.rotateOptions)),(void 0===i.attribution||i.attribution)&&r.push(new xk(i.attributionOptions)),r}var Od={};var Jg={};var kr=Jg&&Jg.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ea=function(e){function t(t){var r=e.call(this)||this;return r.element=t.element?t.element:null,r.target_=null,r.map_=null,r.listenerKeys=[],r.render=t.render?t.render:Ha,t.target&&r.setTarget(t.target),r}return kr(t,e),t.prototype.disposeInternal=function(){vd(this.element),e.prototype.disposeInternal.call(this)},t.prototype.getMap=function(){return this.map_},t.prototype.setMap=function(e){this.map_&&vd(this.element);for(var t=0,r=this.listenerKeys.length;t<r;++t)l(this.listenerKeys[t]);(this.listenerKeys.length=0,this.map_=e,this.map_)&&((this.target_?this.target_:e.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Ha&&this.listenerKeys.push(f(e,kc.POSTRENDER,this.render,this)),e.render())},t.prototype.setTarget=function(e){this.target_="string"==typeof e?document.getElementById(e):e},t}(ga);Jg.default=Ea;var lr=Od&&Od.__extends||function(){var e=function(t,l){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var l in t)t.hasOwnProperty(l)&&(e[l]=t[l])})(t,l)};return function(t,l){function r(){this.constructor=t}e(t,l),t.prototype=null===l?Object.create(l):(r.prototype=l.prototype,new r)}}(),xk=function(e){function t(t){var l=this,r=t||{};(l=e.call(this,{element:document.createElement("div"),render:r.render||yk,target:r.target})||this).ulElement_=document.createElement("ul"),l.collapsed_=void 0===r.collapsed||r.collapsed,l.overrideCollapsible_=void 0!==r.collapsible,l.collapsible_=void 0===r.collapsible||r.collapsible,l.collapsible_||(l.collapsed_=!1);var o=void 0!==r.className?r.className:"ol-attribution",i=void 0!==r.tipLabel?r.tipLabel:"Attributions",s=void 0!==r.collapseLabel?r.collapseLabel:"\xBB";"string"==typeof s?(l.collapseLabel_=document.createElement("span"),l.collapseLabel_.textContent=s):l.collapseLabel_=s;var a=void 0!==r.label?r.label:"i";"string"==typeof a?(l.label_=document.createElement("span"),l.label_.textContent=a):l.label_=a;var n=l.collapsible_&&!l.collapsed_?l.collapseLabel_:l.label_,p=document.createElement("button");p.setAttribute("type","button"),p.title=i,p.appendChild(n),f(p,g.CLICK,l.handleClick_,l);var c=o+" "+Ba+" "+Jb+(l.collapsed_&&l.collapsible_?" "+xd:"")+(l.collapsible_?"":" ol-uncollapsible"),$=l.element;return $.className=c,$.appendChild(l.ulElement_),$.appendChild(p),l.renderedAttributions_=[],l.renderedVisible_=!0,l}return lr(t,e),t.prototype.collectSourceAttributions_=function(e){for(var t={},l=[],r=e.layerStatesArray,o=0,i=r.length;o<i;++o){var s=r[o];if(Jc(s,e.viewState)){var a=s.layer.getSource();if(a){var n=a.getAttributions();if(n){var p=n(e);if(p)if(this.overrideCollapsible_||!1!==a.getAttributionsCollapsible()||this.setCollapsible(!1),Array.isArray(p))for(var c=0,$=p.length;c<$;++c)p[c]in t||(l.push(p[c]),t[p[c]]=!0);else p in t||(l.push(p),t[p]=!0)}}}}return l},t.prototype.updateElement_=function(e){if(e){var t=this.collectSourceAttributions_(e),l=t.length>0;if(this.renderedVisible_!=l&&(this.element.style.display=l?"":"none",this.renderedVisible_=l),!Bc(t,this.renderedAttributions_)){sj(this.ulElement_);for(var r=0,o=t.length;r<o;++r){var i=document.createElement("li");i.innerHTML=t[r],this.ulElement_.appendChild(i)}this.renderedAttributions_=t}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},t.prototype.handleClick_=function(e){e.preventDefault(),this.handleToggle_()},t.prototype.handleToggle_=function(){this.element.classList.toggle(xd),this.collapsed_?bc(this.collapseLabel_,this.label_):bc(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},t.prototype.getCollapsible=function(){return this.collapsible_},t.prototype.setCollapsible=function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())},t.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()},t.prototype.getCollapsed=function(){return this.collapsed_},t}(Ea);function yk(e){this.updateElement_(e.frameState)}Od.render=yk,Od.default=xk;var Pd={};var mr=Pd&&Pd.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),zk=function(t){function e(e){var r=this,o=e||{};r=t.call(this,{element:document.createElement("div"),render:o.render||Ak,target:o.target})||this;var a=void 0!==o.className?o.className:"ol-rotate",i=void 0!==o.label?o.label:"\u21E7";r.label_=null,"string"==typeof i?(r.label_=document.createElement("span"),r.label_.className="ol-compass",r.label_.textContent=i):(r.label_=i,r.label_.classList.add("ol-compass"));var n=o.tipLabel?o.tipLabel:"Reset rotation",s=document.createElement("button");s.className=a+"-reset",s.setAttribute("type","button"),s.title=n,s.appendChild(r.label_),f(s,g.CLICK,r.handleClick_,r);var l=a+" "+Ba+" "+Jb,u=r.element;return u.className=l,u.appendChild(s),r.callResetNorth_=o.resetNorth?o.resetNorth:void 0,r.duration_=void 0!==o.duration?o.duration:250,r.autoHide_=void 0===o.autoHide||o.autoHide,r.rotation_=void 0,r.autoHide_&&r.element.classList.add(wd),r}return mr(e,t),e.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap().getView();t&&void 0!==t.getRotation()&&(this.duration_>0?t.animate({rotation:0,duration:this.duration_,easing:Ob}):t.setRotation(0))},e}(Ea);function Ak(t){var e=t.frameState;if(e){var r=e.viewState.rotation;if(r!=this.rotation_){var o="rotate("+r+"rad)";if(this.autoHide_){var a=this.element.classList.contains(wd);a||0!==r?a&&0!==r&&this.element.classList.remove(wd):this.element.classList.add(wd)}this.label_.style.transform=o}this.rotation_=r}}Pd.render=Ak,Pd.default=zk;var Kg={};var nr=Kg&&Kg.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Bk=function(e){function t(t){var o=this,n=t||{};o=e.call(this,{element:document.createElement("div"),target:n.target})||this;var r=void 0!==n.className?n.className:"ol-zoom",i=void 0!==n.delta?n.delta:1,a=void 0!==n.zoomInLabel?n.zoomInLabel:"+",p=void 0!==n.zoomOutLabel?n.zoomOutLabel:"\u2212",$=void 0!==n.zoomInTipLabel?n.zoomInTipLabel:"Zoom in",l=void 0!==n.zoomOutTipLabel?n.zoomOutTipLabel:"Zoom out",s=document.createElement("button");s.className=r+"-in",s.setAttribute("type","button"),s.title=$,s.appendChild("string"==typeof a?document.createTextNode(a):a),f(s,g.CLICK,o.handleClick_.bind(o,i));var u=document.createElement("button");u.className=r+"-out",u.setAttribute("type","button"),u.title=l,u.appendChild("string"==typeof p?document.createTextNode(p):p),f(u,g.CLICK,o.handleClick_.bind(o,-i));var d=r+" "+Ba+" "+Jb,c=o.element;return c.className=d,c.appendChild(s),c.appendChild(u),o.duration_=void 0!==n.duration?n.duration:250,o}return nr(t,e),t.prototype.handleClick_=function(e,t){t.preventDefault(),this.zoomByDelta_(e)},t.prototype.zoomByDelta_=function(e){var t=this.getMap().getView();if(t){var o=t.getZoom();if(void 0!==o){var n=t.getConstrainedZoom(o+e);this.duration_>0?(t.getAnimating()&&t.cancelAnimations(),t.animate({zoom:n,duration:this.duration_,easing:Ob})):t.setZoom(n)}}},t}(Ea);Kg.default=Bk;var Lg={};var or=Lg&&Lg.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function l(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(l.prototype=r.prototype,new l)}}(),Ck=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"],pr=function(e){function t(t){var r=this,l=t||{};(r=e.call(this,{element:document.createElement("div"),target:l.target})||this).cssClassName_=void 0!==l.className?l.className:"ol-full-screen";var s=void 0!==l.label?l.label:"\u2922";r.labelNode_="string"==typeof s?document.createTextNode(s):s;var n=void 0!==l.labelActive?l.labelActive:"\xD7";r.labelActiveNode_="string"==typeof n?document.createTextNode(n):n,r.button_=document.createElement("button");var a=l.tipLabel?l.tipLabel:"Toggle full-screen";r.setClassName_(r.button_,Mg()),r.button_.setAttribute("type","button"),r.button_.title=a,r.button_.appendChild(r.labelNode_),f(r.button_,g.CLICK,r.handleClick_,r);var u=r.cssClassName_+" "+Ba+" "+Jb+" "+(Dk()?"":ap),o=r.element;return o.className=u,o.appendChild(r.button_),r.keys_=void 0!==l.keys&&l.keys,r.source_=l.source,r}return or(t,e),t.prototype.handleClick_=function(e){e.preventDefault(),this.handleFullScreen_()},t.prototype.handleFullScreen_=function(){if(Dk()){var e=this.getMap();if(e)if(Mg())rr();else{var t=void 0;t=this.source_?"string"==typeof this.source_?document.getElementById(this.source_):this.source_:e.getTargetElement(),this.keys_?qr(t):Ek(t)}}},t.prototype.handleFullScreenChange_=function(){var e=this.getMap();Mg()?(this.setClassName_(this.button_,!0),bc(this.labelActiveNode_,this.labelNode_)):(this.setClassName_(this.button_,!1),bc(this.labelNode_,this.labelActiveNode_)),e&&e.updateSize()},t.prototype.setClassName_=function(e,t){var r=this.cssClassName_+"-true",l=this.cssClassName_+"-false",s=t?r:l;e.classList.remove(r),e.classList.remove(l),e.classList.add(s)},t.prototype.setMap=function(t){if(e.prototype.setMap.call(this,t),t)for(var r=0,l=Ck.length;r<l;++r)this.listenerKeys.push(f(document,Ck[r],this.handleFullScreenChange_,this))},t}(Ea);function Dk(){var e=document.body;return!!(e.webkitRequestFullscreen||e.msRequestFullscreen&&document.msFullscreenEnabled||e.requestFullscreen&&document.fullscreenEnabled)}function Mg(){return!!(document.webkitIsFullScreen||document.msFullscreenElement||document.fullscreenElement)}function Ek(e){e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}function qr(e){e.webkitRequestFullscreen?e.webkitRequestFullscreen():Ek(e)}function rr(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}Lg.default=pr;var Qd={};var sr=Qd&&Qd.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Ng="projection",Fk="coordinateFormat",tr=function(t){function e(e){var r=this,o=e||{},n=document.createElement("div");return n.className=void 0!==o.className?o.className:"ol-mouse-position",r=t.call(this,{element:n,render:o.render||Gk,target:o.target})||this,f(r,x(Ng),r.handleProjectionChanged_,r),o.coordinateFormat&&r.setCoordinateFormat(o.coordinateFormat),o.projection&&r.setProjection(o.projection),r.undefinedHTML_=void 0!==o.undefinedHTML?o.undefinedHTML:"&#160;",r.renderOnMouseOut_=!!r.undefinedHTML_,r.renderedHTML_=n.innerHTML,r.mapProjection_=null,r.transform_=null,r}return sr(e,t),e.prototype.handleProjectionChanged_=function(){this.transform_=null},e.prototype.getCoordinateFormat=function(){return this.get(Fk)},e.prototype.getProjection=function(){return this.get(Ng)},e.prototype.handleMouseMove=function(t){var e=this.getMap();this.updateHTML_(e.getEventPixel(t))},e.prototype.handleMouseOut=function(t){this.updateHTML_(null)},e.prototype.setMap=function(e){if(t.prototype.setMap.call(this,e),e){var r=e.getViewport();this.listenerKeys.push(f(r,g.MOUSEMOVE,this.handleMouseMove,this),f(r,g.TOUCHSTART,this.handleMouseMove,this)),this.renderOnMouseOut_&&this.listenerKeys.push(f(r,g.MOUSEOUT,this.handleMouseOut,this),f(r,g.TOUCHEND,this.handleMouseOut,this))}},e.prototype.setCoordinateFormat=function(t){this.set(Fk,t)},e.prototype.setProjection=function(t){this.set(Ng,p(t))},e.prototype.updateHTML_=function(t){var e=this.undefinedHTML_;if(t&&this.mapProjection_){if(!this.transform_){var r=this.getProjection();this.transform_=r?Zb(this.mapProjection_,r):gf}var o=this.getMap().getCoordinateFromPixel(t);if(o){this.transform_(o,o);var n=this.getCoordinateFormat();e=n?n(o):o.toString()}}this.renderedHTML_&&e===this.renderedHTML_||(this.element.innerHTML=e,this.renderedHTML_=e)},e}(Ea);function Gk(t){var e=t.frameState;e?this.mapProjection_!=e.viewState.projection&&(this.mapProjection_=e.viewState.projection,this.transform_=null):this.mapProjection_=null}Qd.render=Gk,Qd.default=tr;var Rd={};var Og={};var Pg={};var ur=function(){function e(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return e.prototype.clear=function(){this.cache_={},this.cacheSize_=0},e.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},e.prototype.expire=function(){if(this.canExpireCache()){var e=0;for(var t in this.cache_){var r=this.cache_[t];0!=(3&e++)||r.hasListener()||(delete this.cache_[t],--this.cacheSize_)}}},e.prototype.get=function(e,t,r){var i=Hk(e,t,r);return i in this.cache_?this.cache_[i]:null},e.prototype.set=function(e,t,r,i){var a=Hk(e,t,r);this.cache_[a]=i,++this.cacheSize_},e.prototype.setSize=function(e){this.maxCacheSize_=e,this.expire()},e}();function Hk(e,t,r){return t+":"+e+":"+(r?Vo(r):"null")}var Ik=new ur;function vr(e,t){t&&t.clear();for(var r=e.declutterItems,$=r.length-1;$>=0;--$)for(var o=r[$],n=o.items,i=0,a=n.length;i<a;i+=3)t=n[i].renderDeclutter(n[i+1],n[i+2],o.opacity,t);return r.length=0,t}var Qg={};var wr=Qg&&Qg.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),xr=function(t){function e(e,i,o,a,n){var r=t.call(this)||this;return r.context_=e,r.pixelRatio_=i,r.extent_=o,r.transform_=a,r.viewRotation_=n,r.contextFillState_=null,r.contextStrokeState_=null,r.contextTextState_=null,r.fillState_=null,r.strokeState_=null,r.image_=null,r.imageAnchorX_=0,r.imageAnchorY_=0,r.imageHeight_=0,r.imageOpacity_=0,r.imageOriginX_=0,r.imageOriginY_=0,r.imageRotateWithView_=!1,r.imageRotation_=0,r.imageScale_=0,r.imageWidth_=0,r.text_="",r.textOffsetX_=0,r.textOffsetY_=0,r.textRotateWithView_=!1,r.textRotation_=0,r.textScale_=0,r.textFillState_=null,r.textStrokeState_=null,r.textState_=null,r.pixelCoordinates_=[],r.tmpLocalTransform_=ma(),r}return wr(e,t),e.prototype.drawImages_=function(t,e,i,o){if(this.image_){var a=Ab(t,e,i,2,this.transform_,this.pixelCoordinates_),n=this.context_,r=this.tmpLocalTransform_,s=n.globalAlpha;1!=this.imageOpacity_&&(n.globalAlpha=s*this.imageOpacity_);var l=this.imageRotation_;this.imageRotateWithView_&&(l+=this.viewRotation_);for(var h=0,_=a.length;h<_;h+=2){var x=a[h]-this.imageAnchorX_,f=a[h+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_){var m=x+this.imageAnchorX_,g=f+this.imageAnchorY_;Ka(r,m,g,this.imageScale_,this.imageScale_,l,-m,-g),n.setTransform.apply(n,r)}n.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,x,f,this.imageWidth_,this.imageHeight_)}0===l&&1==this.imageScale_||n.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(n.globalAlpha=s)}},e.prototype.drawText_=function(t,e,i,o){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var a=Ab(t,e,i,o,this.transform_,this.pixelCoordinates_),n=this.context_,r=this.textRotation_;for(this.textRotateWithView_&&(r+=this.viewRotation_);e<i;e+=o){var s=a[e]+this.textOffsetX_,l=a[e+1]+this.textOffsetY_;if(0!==r||1!=this.textScale_){var h=Ka(this.tmpLocalTransform_,s,l,this.textScale_,this.textScale_,r,-s,-l);n.setTransform.apply(n,h)}this.textStrokeState_&&n.strokeText(this.text_,s,l),this.textFillState_&&n.fillText(this.text_,s,l)}0===r&&1==this.textScale_||n.setTransform(1,0,0,1,0,0)}},e.prototype.moveToLineTo_=function(t,e,i,o,a){var n=this.context_,r=Ab(t,e,i,o,this.transform_,this.pixelCoordinates_);n.moveTo(r[0],r[1]);var s=r.length;a&&(s-=2);for(var l=2;l<s;l+=2)n.lineTo(r[l],r[l+1]);return a&&n.closePath(),i},e.prototype.drawRings_=function(t,e,i,o){for(var a=0,n=i.length;a<n;++a)e=this.moveToLineTo_(t,e,i[a],o,!0);return e},e.prototype.drawCircle=function(t){if(fa(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=aj(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],o=e[3]-e[1],a=Math.sqrt(i*i+o*o),n=this.context_;n.beginPath(),n.arc(e[0],e[1],a,0,2*Math.PI),this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.drawGeometry=function(t){switch(t.getType()){case b.POINT:this.drawPoint(t);break;case b.LINE_STRING:this.drawLineString(t);break;case b.POLYGON:this.drawPolygon(t);break;case b.MULTI_POINT:this.drawMultiPoint(t);break;case b.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case b.MULTI_POLYGON:this.drawMultiPolygon(t);break;case b.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case b.CIRCLE:this.drawCircle(t);}},e.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&fa(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},e.prototype.drawGeometryCollection=function(t){for(var e=t.getGeometriesArray(),i=0,o=e.length;i<o;++i)this.drawGeometry(e[i])},e.prototype.drawPoint=function(t){var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawMultiPoint=function(t){var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawLineString=function(t){if(fa(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var o=t.getFlatMidpoint();this.drawText_(o,0,2,2)}}},e.prototype.drawMultiLineString=function(t){var e=t.getExtent();if(fa(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,o=t.getFlatCoordinates(),a=0,n=t.getEnds(),r=t.getStride();i.beginPath();for(var s=0,l=n.length;s<l;++s)a=this.moveToLineTo_(o,a,n[s],r,!1);i.stroke()}if(""!==this.text_){var h=t.getFlatMidpoints();this.drawText_(h,0,h.length,2)}}},e.prototype.drawPolygon=function(t){if(fa(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(fa(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getOrientedFlatCoordinates(),o=0,a=t.getEndss(),n=t.getStride();e.beginPath();for(var r=0,s=a.length;r<s;++r){var l=a[r];o=this.drawRings_(i,o,l,n)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var h=t.getFlatInteriorPoints();this.drawText_(h,0,h.length,2)}}},e.prototype.setContextFillState_=function(t){var e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=e.lineCap=t.lineCap),e.setLineDash&&(Bc(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset=t.lineDashOffset)),i.lineJoin!=t.lineJoin&&(i.lineJoin=e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var e=this.context_,i=this.contextTextState_,o=t.textAlign?t.textAlign:Mc;i?(i.font!=t.font&&(i.font=e.font=t.font),i.textAlign!=o&&(i.textAlign=e.textAlign=o),i.textBaseline!=t.textBaseline&&(i.textBaseline=e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=o,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:o,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,e){if(t){var i=t.getColor();this.fillState_={fillStyle:Aa(i||Na)}}else this.fillState_=null;if(e){var o=e.getColor(),a=e.getLineCap(),n=e.getLineDash(),r=e.getLineDashOffset(),s=e.getLineJoin(),l=e.getWidth(),h=e.getMiterLimit();this.strokeState_={lineCap:void 0!==a?a:cc,lineDash:n||yd,lineDashOffset:r||zd,lineJoin:void 0!==s?s:dc,lineWidth:this.pixelRatio_*(void 0!==l?l:Nc),miterLimit:void 0!==h?h:Kc,strokeStyle:Aa(o||Lc)}}else this.strokeState_=null},e.prototype.setImageStyle=function(t){if(t){var e=t.getAnchor(),i=t.getImage(1),o=t.getOrigin(),a=t.getSize();this.imageAnchorX_=e[0],this.imageAnchorY_=e[1],this.imageHeight_=a[1],this.image_=i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=o[0],this.imageOriginY_=o[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScale()*this.pixelRatio_,this.imageWidth_=a[0]}else this.image_=null},e.prototype.setTextStyle=function(t){if(t){var e=t.getFill();if(e){var i=e.getColor();this.textFillState_={fillStyle:Aa(i||Na)}}else this.textFillState_=null;var o=t.getStroke();if(o){var a=o.getColor(),n=o.getLineCap(),r=o.getLineDash(),s=o.getLineDashOffset(),l=o.getLineJoin(),h=o.getWidth(),_=o.getMiterLimit();this.textStrokeState_={lineCap:void 0!==n?n:cc,lineDash:r||yd,lineDashOffset:s||zd,lineJoin:void 0!==l?l:dc,lineWidth:void 0!==h?h:Nc,miterLimit:void 0!==_?_:Kc,strokeStyle:Aa(a||Lc)}}else this.textStrokeState_=null;var x=t.getFont(),f=t.getOffsetX(),m=t.getOffsetY(),g=t.getRotateWithView(),$=t.getRotation(),p=t.getScale(),S=t.getText(),c=t.getTextAlign(),d=t.getTextBaseline();this.textState_={font:void 0!==x?x:uj,textAlign:void 0!==c?c:Mc,textBaseline:void 0!==d?d:Ad},this.text_=void 0!==S?S:"",this.textOffsetX_=void 0!==f?this.pixelRatio_*f:0,this.textOffsetY_=void 0!==m?this.pixelRatio_*m:0,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0!==$?$:0,this.textScale_=this.pixelRatio_*(void 0!==p?p:1)}else this.text_=""},e}(Hj);Qg.default=xr;var yr=Pg&&Pg.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function o(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),Jk=function(e){function r(r){var t=e.call(this)||this;return t.map_=r,t.declutterTree_=null,t}return yr(r,e),r.prototype.dispatchRenderEvent=function(e,r){a()},r.prototype.calculateMatrices2D=function(e){var r=e.viewState,t=e.coordinateToPixelTransform,o=e.pixelToCoordinateTransform;Ka(t,e.size[0]/2,e.size[1]/2,1/r.resolution,-1/r.resolution,-r.rotation,-r.center[0],-r.center[1]),pf(o,t)},r.prototype.forEachFeatureAtCoordinate=function(e,r,t,o,n,a,i){var $,c=r.viewState;function p(e,t,a){if(!(ba(t)in r.skippedFeatureUids)||e)return o.call(n,t,e?a:null)}var f=c.projection,u=e;if(f.canWrapX()){var s=f.getExtent(),l=H(s),C=e[0];if(C<s[0]||C>s[2])u=[C+l*Math.ceil((s[0]-C)/l),e[1]]}var b,R,d=r.layerStatesArray,h=d.length;for(this.declutterTree_&&(b=this.declutterTree_.all().map(function(e){return e.value})),R=h-1;R>=0;--R){var m=d[R],v=m.layer;if(v.hasRenderer()&&Jc(m,c)&&a.call(i,v)){var y=v.getRenderer(),_=v.getSource();if(y&&_){var x=p.bind(null,m.managed);$=y.forEachFeatureAtCoordinate(_.getWrapX()?u:e,r,t,x,b)}if($)return $}}},r.prototype.forEachLayerAtPixel=function(e,r,t,o,n){return a()},r.prototype.hasFeatureAtCoordinate=function(e,r,t,o,n){return void 0!==this.forEachFeatureAtCoordinate(e,r,t,W,this,o,n)},r.prototype.getMap=function(){return this.map_},r.prototype.renderFrame=function(e){this.declutterTree_=vr(e,this.declutterTree_)},r.prototype.scheduleExpireIconCache=function(e){Ik.canExpireCache()&&e.postRenderFunctions.push(zr)},r}(zc);function zr(e,r){Ik.expire()}Pg.default=Jk;var Ar=Og&&Og.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Rg=function(e){function r(r){var t=e.call(this,r)||this;t.labelCacheKey_=f(bb,g.CLEAR,r.redrawText.bind(r)),t.element_=document.createElement("div");var n=t.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",t.element_.className=Ba+" ol-layers";var i=r.getViewport();return i.insertBefore(t.element_,i.firstChild||null),t.children_=[],t.renderedVisible_=!0,t}return Ar(r,e),r.prototype.dispatchRenderEvent=function(e,r){var t=this.getMap();if(t.hasListener(e)){var n=new _f(e,void 0,r);t.dispatchEvent(n)}},r.prototype.disposeInternal=function(){l(this.labelCacheKey_),e.prototype.disposeInternal.call(this)},r.prototype.renderFrame=function(r){if(r){this.calculateMatrices2D(r),this.dispatchRenderEvent(Ib.PRECOMPOSE,r);var t=r.layerStatesArray.sort(function(e,r){return e.zIndex-r.zIndex}),n=r.viewState;this.children_.length=0;for(var i=!1,a=null,s=0,l=t.length;s<l;++s){var o=t[s];if(i=i||o.hasOverlay,r.layerIndex=s,Jc(o,n)&&(o.sourceState==za.READY||o.sourceState==za.UNDEFINED)){var h=o.layer.render(r,a);h&&(h===a&&s!=l-1||2!==h.childElementCount||i||h.removeChild(h.lastElementChild),h!==a&&(this.children_.push(h),i=!1,a=h))}}e.prototype.renderFrame.call(this,r),$o(this.element_,this.children_),this.dispatchRenderEvent(Ib.POSTCOMPOSE,r),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(r)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)},r.prototype.forEachLayerAtPixel=function(e,r,t,n,i){for(var a=r.viewState,s=r.layerStatesArray,l=s.length-1;l>=0;--l){var o=s[l],h=o.layer;if(h.hasRenderer()&&Jc(o,a)&&i(h)){var $=h.getRenderer().getDataAtPixel(e,r,t);if($){var p=n(h,$);if(p)return p}}}},r}(Jk);Og.default=Rg;var Sg={};var U={BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right",CENTER_LEFT:"center-left",CENTER_CENTER:"center-center",CENTER_RIGHT:"center-right",TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right"};var Br=Sg&&Sg.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),O={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"},Kk=function(t){function e(e){var i=t.call(this)||this;return i.options=e,i.id=e.id,i.insertFirst=void 0===e.insertFirst||e.insertFirst,i.stopEvent=void 0===e.stopEvent||e.stopEvent,i.element=document.createElement("div"),i.element.className=void 0!==e.className?e.className:"ol-overlay-container "+_o,i.element.style.position="absolute",i.autoPan=void 0!==e.autoPan&&e.autoPan,i.autoPanAnimation=e.autoPanAnimation||{},i.autoPanMargin=void 0!==e.autoPanMargin?e.autoPanMargin:20,i.rendered={bottom_:"",left_:"",right_:"",top_:"",visible:!0},i.mapPostrenderListenerKey=null,f(i,x(O.ELEMENT),i.handleElementChanged,i),f(i,x(O.MAP),i.handleMapChanged,i),f(i,x(O.OFFSET),i.handleOffsetChanged,i),f(i,x(O.POSITION),i.handlePositionChanged,i),f(i,x(O.POSITIONING),i.handlePositioningChanged,i),void 0!==e.element&&i.setElement(e.element),i.setOffset(void 0!==e.offset?e.offset:[0,0]),i.setPositioning(void 0!==e.positioning?e.positioning:U.TOP_LEFT),void 0!==e.position&&i.setPosition(e.position),i}return Br(e,t),e.prototype.getElement=function(){return this.get(O.ELEMENT)},e.prototype.getId=function(){return this.id},e.prototype.getMap=function(){return this.get(O.MAP)},e.prototype.getOffset=function(){return this.get(O.OFFSET)},e.prototype.getPosition=function(){return this.get(O.POSITION)},e.prototype.getPositioning=function(){return this.get(O.POSITIONING)},e.prototype.handleElementChanged=function(){sj(this.element);var t=this.getElement();t&&this.element.appendChild(t)},e.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(vd(this.element),l(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t=this.getMap();if(t){this.mapPostrenderListenerKey=f(t,kc.POSTRENDER,this.render,this),this.updatePixelPosition();var e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element)}},e.prototype.render=function(){this.updatePixelPosition()},e.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},e.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.get(O.POSITION)&&this.autoPan&&this.panIntoView()},e.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},e.prototype.setElement=function(t){this.set(O.ELEMENT,t)},e.prototype.setMap=function(t){this.set(O.MAP,t)},e.prototype.setOffset=function(t){this.set(O.OFFSET,t)},e.prototype.setPosition=function(t){this.set(O.POSITION,t)},e.prototype.panIntoView=function(){var t=this.getMap();if(t&&t.getTargetElement()){var e=this.getRect(t.getTargetElement(),t.getSize()),i=this.getElement(),o=this.getRect(i,[Yo(i),Zo(i)]),n=this.autoPanMargin;if(!yb(e,o)){var r=o[0]-e[0],s=e[2]-o[2],a=o[1]-e[1],p=e[3]-o[3],$=[0,0];if(r<0?$[0]=r-n:s<0&&($[0]=Math.abs(s)+n),a<0?$[1]=a-n:p<0&&($[1]=Math.abs(p)+n),0!==$[0]||0!==$[1]){var u=t.getView().getCenter(),d=t.getPixelFromCoordinate(u),h=[d[0]+$[0],d[1]+$[1]];t.getView().animate({center:t.getCoordinateFromPixel(h),duration:this.autoPanAnimation.duration,easing:this.autoPanAnimation.easing})}}}},e.prototype.getRect=function(t,e){var i=t.getBoundingClientRect(),o=i.left+window.pageXOffset,n=i.top+window.pageYOffset;return[o,n,o+e[0],n+e[1]]},e.prototype.setPositioning=function(t){this.set(O.POSITIONING,t)},e.prototype.setVisible=function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)},e.prototype.updatePixelPosition=function(){var t=this.getMap(),e=this.getPosition();if(t&&t.isRendered()&&e){var i=t.getPixelFromCoordinate(e),o=t.getSize();this.updateRenderedPosition(i,o)}else this.setVisible(!1)},e.prototype.updateRenderedPosition=function(t,e){var i=this.element.style,o=this.getOffset(),n=this.getPositioning();this.setVisible(!0);var r=o[0],s=o[1];if(n==U.BOTTOM_RIGHT||n==U.CENTER_RIGHT||n==U.TOP_RIGHT){""!==this.rendered.left_&&(this.rendered.left_=i.left="");var a=Math.round(e[0]-t[0]-r)+"px";this.rendered.right_!=a&&(this.rendered.right_=i.right=a)}else{""!==this.rendered.right_&&(this.rendered.right_=i.right=""),n!=U.BOTTOM_CENTER&&n!=U.CENTER_CENTER&&n!=U.TOP_CENTER||(r-=this.element.offsetWidth/2);var p=Math.round(t[0]+r)+"px";this.rendered.left_!=p&&(this.rendered.left_=i.left=p)}if(n==U.BOTTOM_LEFT||n==U.BOTTOM_CENTER||n==U.BOTTOM_RIGHT){""!==this.rendered.top_&&(this.rendered.top_=i.top="");var $=Math.round(e[1]-t[1]-s)+"px";this.rendered.bottom_!=$&&(this.rendered.bottom_=i.bottom=$)}else{""!==this.rendered.bottom_&&(this.rendered.bottom_=i.bottom=""),n!=U.CENTER_LEFT&&n!=U.CENTER_CENTER&&n!=U.CENTER_RIGHT||(s-=this.element.offsetHeight/2);var u=Math.round(t[1]+s)+"px";this.rendered.top_!=u&&(this.rendered.top_=i.top=u)}},e.prototype.getOptions=function(){return this.options},e}(ga);Sg.default=Kk;var Lk=Rd&&Rd.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),Sd=.75,Vc=.1,Cr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Lk(t,e),t.prototype.createRenderer=function(){return new Rg(this)},t}(Ig),Dr=function(e){function t(t){var o=this,i=t||{};(o=e.call(this,{element:document.createElement("div"),render:i.render||Mk,target:i.target})||this).collapsed_=void 0===i.collapsed||i.collapsed,o.collapsible_=void 0===i.collapsible||i.collapsible,o.collapsible_||(o.collapsed_=!1);var r=void 0!==i.className?i.className:"ol-overviewmap",a=void 0!==i.tipLabel?i.tipLabel:"Overview map",n=void 0!==i.collapseLabel?i.collapseLabel:"\xAB";"string"==typeof n?(o.collapseLabel_=document.createElement("span"),o.collapseLabel_.textContent=n):o.collapseLabel_=n;var l=void 0!==i.label?i.label:"\xBB";"string"==typeof l?(o.label_=document.createElement("span"),o.label_.textContent=l):o.label_=l;var p=o.collapsible_&&!o.collapsed_?o.collapseLabel_:o.label_,s=document.createElement("button");s.setAttribute("type","button"),s.title=a,s.appendChild(p),f(s,g.CLICK,o.handleClick_,o),o.ovmapDiv_=document.createElement("div"),o.ovmapDiv_.className="ol-overviewmap-map",o.ovmap_=new Cr({view:i.view});var $=o.ovmap_;i.layers&&i.layers.forEach(function(e){$.addLayer(e)});var c=document.createElement("div");c.className="ol-overviewmap-box",c.style.boxSizing="border-box",o.boxOverlay_=new Kk({position:[0,0],positioning:U.BOTTOM_LEFT,element:c}),o.ovmap_.addOverlay(o.boxOverlay_);var d=r+" "+Ba+" "+Jb+(o.collapsed_&&o.collapsible_?" "+xd:"")+(o.collapsible_?"":" ol-uncollapsible"),v=o.element;v.className=d,v.appendChild(o.ovmapDiv_),v.appendChild(s);var x=o,_=o.boxOverlay_,h=o.boxOverlay_.getElement(),u=function(e){var t,o={clientX:(t=e).clientX-h.offsetWidth/2,clientY:t.clientY+h.offsetHeight/2},i=$.getEventCoordinate(o);_.setPosition(i)},m=function(e){var t=$.getEventCoordinate(e);x.getMap().getView().setCenter(t),window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",m)};return h.addEventListener("mousedown",function(){window.addEventListener("mousemove",u),window.addEventListener("mouseup",m)}),o}return Lk(t,e),t.prototype.setMap=function(t){var o=this.getMap();if(t!==o){if(o){var i=o.getView();i&&this.unbindView_(i),this.ovmap_.setTarget(null)}if(e.prototype.setMap.call(this,t),t){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(f(t,rb.PROPERTYCHANGE,this.handleMapPropertyChange_,this));var r=t.getView();r&&(this.bindView_(r),r.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_()))}}},t.prototype.handleMapPropertyChange_=function(e){if(e.key===N.VIEW){var t=e.oldValue;t&&this.unbindView_(t);var o=this.getMap().getView();this.bindView_(o)}},t.prototype.bindView_=function(e){f(e,x(ha.ROTATION),this.handleRotationChanged_,this)},t.prototype.unbindView_=function(e){ka(e,x(ha.ROTATION),this.handleRotationChanged_,this)},t.prototype.handleRotationChanged_=function(){this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())},t.prototype.validateExtent_=function(){var e=this.getMap(),t=this.ovmap_;if(e.isRendered()&&t.isRendered()){var o=e.getSize(),i=e.getView().calculateExtent(o),r=t.getSize(),a=t.getView().calculateExtent(r),n=t.getPixelFromCoordinate(wa(i)),l=t.getPixelFromCoordinate(zb(i)),p=Math.abs(n[0]-l[0]),s=Math.abs(n[1]-l[1]),$=r[0],c=r[1];p<$*Vc||s<c*Vc||p>$*Sd||s>c*Sd?this.resetExtent_():yb(a,i)||this.recenter_()}},t.prototype.resetExtent_=function(){if(0!==Sd&&0!==Vc){var e=this.getMap(),t=this.ovmap_,o=e.getSize(),i=e.getView().calculateExtent(o),r=t.getView(),a=Math.log(Sd/Vc)/Math.LN2,n=1/(Math.pow(2,a/2)*Vc);Oi(i,n),r.fit(i)}},t.prototype.recenter_=function(){var e=this.getMap(),t=this.ovmap_,o=e.getView();t.getView().setCenter(o.getCenter())},t.prototype.updateBox_=function(){var e=this.getMap(),t=this.ovmap_;if(e.isRendered()&&t.isRendered()){var o=e.getSize(),i=e.getView(),r=t.getView(),a=i.getRotation(),n=this.boxOverlay_,l=this.boxOverlay_.getElement(),p=i.calculateExtent(o),s=r.getResolution(),$=Ia(p),c=_a(p),d=this.calculateCoordinateRotate_(a,$);n.setPosition(d),l&&(l.style.width=Math.abs(($[0]-c[0])/s)+"px",l.style.height=Math.abs((c[1]-$[1])/s)+"px")}},t.prototype.calculateCoordinateRotate_=function(e,t){var o,i=this.getMap().getView().getCenter();return i&&(o=[t[0]-i[0],t[1]-i[1]],Fd(o,e),Yj(o,i)),o},t.prototype.handleClick_=function(e){e.preventDefault(),this.handleToggle_()},t.prototype.handleToggle_=function(){this.element.classList.toggle(xd),this.collapsed_?bc(this.collapseLabel_,this.label_):bc(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;var e=this.ovmap_;this.collapsed_||e.isRendered()||(e.updateSize(),this.resetExtent_(),yc(e,kc.POSTRENDER,function(e){this.updateBox_()},this))},t.prototype.getCollapsible=function(){return this.collapsible_},t.prototype.setCollapsible=function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())},t.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()},t.prototype.getCollapsed=function(){return this.collapsed_},t.prototype.getOverviewMap=function(){return this.ovmap_},t}(Ea);function Mk(e){this.validateExtent_(),this.updateBox_()}Rd.render=Mk,Rd.default=Dr;var Wc={};var Er=Wc&&Wc.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function s(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(s.prototype=r.prototype,new s)}}(),Tg="units",kb={DEGREES:"degrees",IMPERIAL:"imperial",NAUTICAL:"nautical",METRIC:"metric",US:"us"};Wc.Units=kb;var Fr=[1,2,5],Gr=function(e){function t(t){var r=this,s=t||{},i=void 0!==s.className?s.className:s.bar?"ol-scale-bar":"ol-scale-line";return(r=e.call(this,{element:document.createElement("div"),render:s.render||Nk,target:s.target})||this).innerElement_=document.createElement("div"),r.innerElement_.className=i+"-inner",r.element.className=i+" "+Ba,r.element.appendChild(r.innerElement_),r.viewState_=null,r.minWidth_=void 0!==s.minWidth?s.minWidth:64,r.renderedVisible_=!1,r.renderedWidth_=void 0,r.renderedHTML_="",f(r,x(Tg),r.handleUnitsChanged_,r),r.setUnits(s.units||kb.METRIC),r.scaleBar_=s.bar||!1,r.scaleBarSteps_=s.steps||4,r.scaleBarText_=s.text||!1,r}return Er(t,e),t.prototype.getUnits=function(){return this.get(Tg)},t.prototype.handleUnitsChanged_=function(){this.updateElement_()},t.prototype.setUnits=function(e){this.set(Tg,e)},t.prototype.updateElement_=function(){var e=this.viewState_;if(e){var t=e.center,r=e.projection,s=this.getUnits(),i=s==kb.DEGREES?P.DEGREES:P.METERS,n=hf(r,e.resolution,t,i),a=this.minWidth_*n,o="";if(s==kb.DEGREES){var $=ya[P.DEGREES];(a*=$)<$/60?(o="\u2033",n*=3600):a<$?(o="\u2032",n*=60):o="\xB0"}else s==kb.IMPERIAL?a<.9144?(o="in",n/=.0254):a<1609.344?(o="ft",n/=.3048):(o="mi",n/=1609.344):s==kb.NAUTICAL?(n/=1852,o="nm"):s==kb.METRIC?a<.001?(o="\u03BCm",n*=1e6):a<1?(o="mm",n*=1e3):a<1e3?o="m":(o="km",n/=1e3):s==kb.US?a<.9144?(o="in",n*=39.37):a<1609.344?(o="ft",n/=.30480061):(o="mi",n/=1609.3472):q(!1,33);for(var l,p,d,c,h=3*Math.floor(Math.log(this.minWidth_*n)/Math.log(10));;){d=Math.floor(h/3);var u=Math.pow(10,d);if(l=Fr[(h%3+3)%3]*u,p=Math.round(l/n),isNaN(p))return this.element.style.display="none",void(this.renderedVisible_=!1);if(p>=this.minWidth_)break;++h}c=this.scaleBar_?this.createScaleBar(p,l,o):l.toFixed(d<0?-d:0)+" "+o,this.renderedHTML_!=c&&(this.innerElement_.innerHTML=c,this.renderedHTML_=c),this.renderedWidth_!=p&&(this.innerElement_.style.width=p+"px",this.renderedWidth_=p),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},t.prototype.createScaleBar=function(e,t,r){for(var s="1 : "+Math.round(this.getScaleForResolution()).toLocaleString(),i=[],n=e/this.scaleBarSteps_,a="#ffffff",o=0;o<this.scaleBarSteps_;o++)0===o&&i.push(this.createMarker("absolute",o)),i.push("<div><div class=\"ol-scale-singlebar\" style=\"width: "+n+"px;background-color: "+a+";\"></div>"+this.createMarker("relative",o)+(o%2==0||2===this.scaleBarSteps_?this.createStepText(o,e,!1,t,r):"")+"</div>"),o===this.scaleBarSteps_-1&&i.push(this.createStepText(o+1,e,!0,t,r)),a="#ffffff"===a?"#000000":"#ffffff";return"<div style=\"display: flex;\">"+(this.scaleBarText_?"<div class=\"ol-scale-text\" style=\"width: "+e+"px;\">"+s+"</div>":"")+i.join("")+"</div>"},t.prototype.createMarker=function(e,t){return"<div class=\"ol-scale-step-marker\" style=\"position: "+e+";top: "+("absolute"===e?3:-10)+"px;\"></div>"},t.prototype.createStepText=function(e,t,r,s,i){var n=(0===e?0:Math.round(s/this.scaleBarSteps_*e*100)/100)+(0===e?"":" "+i);return"<div class=\"ol-scale-step-text\" style=\"margin-left: "+(0===e?-3:t/this.scaleBarSteps_*-1)+"px;text-align: "+(0===e?"left":"center")+"; min-width: "+(0===e?0:t/this.scaleBarSteps_*2)+"px;left: "+(r?t+"px":"unset")+";\">"+n+"</div>"},t.prototype.getScaleForResolution=function(){var e=this.getMap().getView().getResolution(),t=this.viewState_.projection.getMetersPerUnit();return parseFloat(e.toString())*t*39.37*(25.4/.28)},t}(Ea);function Nk(e){var t=e.frameState;this.viewState_=t?t.viewState:null,this.updateElement_()}Wc.render=Nk,Wc.default=Gr;var Td={};var Hr=Td&&Td.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Xc={VERTICAL:0,HORIZONTAL:1},Ir=function(t){function e(e){var i=this,r=e||{};(i=t.call(this,{element:document.createElement("div"),render:r.render||Ok})||this).dragListenerKeys_=[],i.currentResolution_=void 0,i.direction_=Xc.VERTICAL,i.dragging_,i.heightLimit_=0,i.widthLimit_=0,i.startX_,i.startY_,i.thumbSize_=null,i.sliderInitialized_=!1,i.duration_=void 0!==r.duration?r.duration:200;var o=void 0!==r.className?r.className:"ol-zoomslider",n=document.createElement("button");n.setAttribute("type","button"),n.className=o+"-thumb "+Ba;var a=i.element;return a.className=o+" "+Ba+" "+Jb,a.appendChild(n),i.dragger_=new Ld(a),f(i.dragger_,Q.POINTERDOWN,i.handleDraggerStart_,i),f(i.dragger_,Q.POINTERMOVE,i.handleDraggerDrag_,i),f(i.dragger_,Q.POINTERUP,i.handleDraggerEnd_,i),f(a,g.CLICK,i.handleContainerClick_,i),f(n,g.CLICK,Kn),i}return Hr(e,t),e.prototype.disposeInternal=function(){this.dragger_.dispose(),t.prototype.disposeInternal.call(this)},e.prototype.setMap=function(e){t.prototype.setMap.call(this,e),e&&e.render()},e.prototype.initSlider_=function(){var t=this.element,e=t.offsetWidth,i=t.offsetHeight,r=t.firstElementChild,o=getComputedStyle(r),n=r.offsetWidth+parseFloat(o.marginRight)+parseFloat(o.marginLeft),a=r.offsetHeight+parseFloat(o.marginTop)+parseFloat(o.marginBottom);this.thumbSize_=[n,a],e>i?(this.direction_=Xc.HORIZONTAL,this.widthLimit_=e-n):(this.direction_=Xc.VERTICAL,this.heightLimit_=i-a),this.sliderInitialized_=!0},e.prototype.handleContainerClick_=function(t){var e=this.getMap().getView(),i=this.getRelativePosition_(t.offsetX-this.thumbSize_[0]/2,t.offsetY-this.thumbSize_[1]/2),r=this.getResolutionForPosition_(i),o=e.getConstrainedZoom(e.getZoomForResolution(r));e.animate({zoom:o,duration:this.duration_,easing:Ob})},e.prototype.handleDraggerStart_=function(t){if(!this.dragging_&&t.originalEvent.target===this.element.firstElementChild){var e=this.element.firstElementChild;if(this.getMap().getView().beginInteraction(),this.startX_=t.clientX-parseFloat(e.style.left),this.startY_=t.clientY-parseFloat(e.style.top),this.dragging_=!0,0===this.dragListenerKeys_.length){var i=this.handleDraggerDrag_,r=this.handleDraggerEnd_;this.dragListenerKeys_.push(f(document,g.MOUSEMOVE,i,this),f(document,Q.POINTERMOVE,i,this),f(document,g.MOUSEUP,r,this),f(document,Q.POINTERUP,r,this))}}},e.prototype.handleDraggerDrag_=function(t){if(this.dragging_){var e=t.clientX-this.startX_,i=t.clientY-this.startY_,r=this.getRelativePosition_(e,i);this.currentResolution_=this.getResolutionForPosition_(r),this.getMap().getView().setResolution(this.currentResolution_)}},e.prototype.handleDraggerEnd_=function(t){this.dragging_&&(this.getMap().getView().endInteraction(),this.dragging_=!1,this.startX_=void 0,this.startY_=void 0,this.dragListenerKeys_.forEach(l),this.dragListenerKeys_.length=0)},e.prototype.setThumbPosition_=function(t){var e=this.getPositionForResolution_(t),i=this.element.firstElementChild;this.direction_==Xc.HORIZONTAL?i.style.left=this.widthLimit_*e+"px":i.style.top=this.heightLimit_*e+"px"},e.prototype.getRelativePosition_=function(t,e){var i;return i=this.direction_===Xc.HORIZONTAL?t/this.widthLimit_:e/this.heightLimit_,D(i,0,1)},e.prototype.getResolutionForPosition_=function(t){return this.getMap().getView().getResolutionForValueFunction()(1-t)},e.prototype.getPositionForResolution_=function(t){var e=this.getMap().getView().getValueForResolutionFunction();return D(1-e(t),0,1)},e}(Ea);function Ok(t){if(t.frameState){this.sliderInitialized_||this.initSlider_();var e=t.frameState.viewState.resolution;this.currentResolution_=e,this.setThumbPosition_(e)}}Td.render=Ok,Td.default=Ir;var Ug={};var Jr=Ug&&Ug.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Kr=function(t){function e(e){var n=this,o=e||{};(n=t.call(this,{element:document.createElement("div"),target:o.target})||this).extent=o.extent?o.extent:null;var r=void 0!==o.className?o.className:"ol-zoom-extent",i=void 0!==o.label?o.label:"E",a=void 0!==o.tipLabel?o.tipLabel:"Fit to extent",b=document.createElement("button");b.setAttribute("type","button"),b.title=a,b.appendChild("string"==typeof i?document.createTextNode(i):i),f(b,g.CLICK,n.handleClick_,n);var $=r+" "+Ba+" "+Jb,p=n.element;return p.className=$,p.appendChild(b),n}return Jr(e,t),e.prototype.handleClick_=function(t){t.preventDefault(),this.handleZoomToExtent()},e.prototype.handleZoomToExtent=function(){var t=this.getMap().getView(),e=this.extent?this.extent:t.getProjection().getExtent();t.fit(e)},e}(Ea);Ug.default=Kr;function Lr(t){var o=t||{},r=new M,e=new hq(-.005,.05,100);return(void 0===o.altShiftDragRotate||o.altShiftDragRotate)&&r.push(new Yk),(void 0===o.doubleClickZoom||o.doubleClickZoom)&&r.push(new Qk({delta:o.zoomDelta,duration:o.zoomDuration})),(void 0===o.dragPan||o.dragPan)&&r.push(new Xk({condition:o.onFocusOnly?Rk:void 0,kinetic:e})),(void 0===o.pinchRotate||o.pinchRotate)&&r.push(new el),(void 0===o.pinchZoom||o.pinchZoom)&&r.push(new fl({duration:o.zoomDuration})),(void 0===o.keyboard||o.keyboard)&&(r.push(new bl),r.push(new cl({delta:o.zoomDelta,duration:o.zoomDuration}))),(void 0===o.mouseWheelZoom||o.mouseWheelZoom)&&r.push(new dl({condition:o.onFocusOnly?Rk:void 0,duration:o.zoomDuration})),(void 0===o.shiftDragZoom||o.shiftDragZoom)&&r.push(new al({duration:o.zoomDuration})),r}var Vg={};var Yc={};var Ud={ACTIVE:"active"};var Mr=Yc&&Yc.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),lb=function(t){function e(e){var o=t.call(this)||this;return e.handleEvent&&(o.handleEvent=e.handleEvent),o.map_=null,o.setActive(!0),o}return Mr(e,t),e.prototype.getActive=function(){return this.get(Ud.ACTIVE)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(Ud.ACTIVE,t)},e.prototype.setMap=function(t){this.map_=t},e}(ga);function Pk(t,e,o){var r=t.getCenter();if(r){var n=[r[0]+e[0],r[1]+e[1]];t.animate_({duration:void 0!==o?o:250,easing:eq,center:t.getConstrainedCenter(n)})}}function Vd(t,e,o,r){var n=t.getZoom();if(void 0!==n){var c=t.getConstrainedZoom(n+e),i=t.getResolutionForZoom(c);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:i,anchor:o,duration:void 0!==r?r:250,easing:Ob})}}Yc.pan=Pk,Yc.zoomByDelta=Vd,Yc.default=lb;var Nr=Vg&&Vg.__extends||function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),Qk=function(t){function n(n){var e=t.call(this,{handleEvent:Or})||this,o=n||{};return e.delta_=o.delta?o.delta:1,e.duration_=void 0!==o.duration?o.duration:250,e}return Nr(n,t),n}(lb);function Or(t){var n=!1;if(t.type==d.DBLCLICK){var e=t.originalEvent,o=t.map,r=t.coordinate,a=e.shiftKey?-this.delta_:this.delta_,$=o.getView();Vd($,a,r,this.duration_),t.preventDefault(),n=!0}return!n}Vg.default=Qk;var Wg={};var Pr=function(e){var t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey};var Qr=function(e){var t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey};var Rk=function(e){return e.target.getTargetElement()===document.activeElement};var Wd=W;var Sk=function(e){var t=e.originalEvent;return 0==t.button&&!(_p&&aq&&t.ctrlKey)};var Tk=sb;var Rr=function(e){return"pointermove"==e.type};var Uk=function(e){return e.type==d.SINGLECLICK};var Xg=function(e){var t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey};var Xd=function(e){var t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey};var Vk=function(e){var t=e.originalEvent.target.tagName;return"INPUT"!==t&&"SELECT"!==t&&"TEXTAREA"!==t};var Ta=function(e){var t=e.pointerEvent;return q(void 0!==t,56),"mouse"==t.pointerType};var Wk=function(e){var t=e.pointerEvent;return q(void 0!==t,56),t.isPrimary&&0===t.button};var Yd={};var Sr=Yd&&Yd.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ia=function(e){function t(t){var n=this,r=t||{};return n=e.call(this,r)||this,r.handleDownEvent&&(n.handleDownEvent=r.handleDownEvent),r.handleDragEvent&&(n.handleDragEvent=r.handleDragEvent),r.handleMoveEvent&&(n.handleMoveEvent=r.handleMoveEvent),r.handleUpEvent&&(n.handleUpEvent=r.handleUpEvent),r.stopDown&&(n.stopDown=r.stopDown),n.handlingDownUpSequence=!1,n.trackedPointers_={},n.targetPointers=[],n}return Sr(t,e),t.prototype.handleDownEvent=function(e){return!1},t.prototype.handleDragEvent=function(e){},t.prototype.handleEvent=function(e){if(!e.pointerEvent)return!0;var t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==d.POINTERDRAG)this.handleDragEvent(e);else if(e.type==d.POINTERUP){var n=this.handleUpEvent(e);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(e.type==d.POINTERDOWN){var r=this.handleDownEvent(e);r&&e.preventDefault(),this.handlingDownUpSequence=r,t=this.stopDown(r)}else e.type==d.POINTERMOVE&&this.handleMoveEvent(e);return!t},t.prototype.handleMoveEvent=function(e){},t.prototype.handleUpEvent=function(e){return!1},t.prototype.stopDown=function(e){return e},t.prototype.updateTrackedPointers_=function(e){if(Tr(e)){var t=e.pointerEvent,n=t.pointerId.toString();e.type==d.POINTERUP?delete this.trackedPointers_[n]:e.type==d.POINTERDOWN?this.trackedPointers_[n]=t:n in this.trackedPointers_&&(this.trackedPointers_[n]=t),this.targetPointers=Se(this.trackedPointers_)}},t}(lb);function Zd(e){for(var t=e.length,n=0,r=0,o=0;o<t;o++)n+=e[o].clientX,r+=e[o].clientY;return[n/t,r/t]}function Tr(e){var t=e.type;return t===d.POINTERDOWN||t===d.POINTERDRAG||t===d.POINTERUP}Yd.centroid=Zd,Yd.default=ia;var Ur=Wg&&Wg.__extends||function(){var t=function(i,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(i,n)};return function(i,n){function e(){this.constructor=i}t(i,n),i.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),Xk=function(t){function i(i){var n=t.call(this,{stopDown:sb})||this,e=i||{};return n.kinetic_=e.kinetic,n.lastCentroid=null,n.lastPointersCount_,n.panning_=!1,n.condition_=e.condition?e.condition:Vr,n.noKinetic_=!1,n}return Ur(i,t),i.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var i=this.targetPointers,n=Zd(i);if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){var e=[this.lastCentroid[0]-n[0],n[1]-this.lastCentroid[1]],r=t.map.getView();Tp(e,r.getResolution()),Fd(e,r.getRotation()),r.adjustCenter(e)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=n,this.lastPointersCount_=i.length},i.prototype.handleUpEvent=function(t){var i=t.map,n=i.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var e=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=n.getCenter(),s=i.getPixelFromCoordinate(o),a=i.getCoordinateFromPixel([s[0]-e*Math.cos(r),s[1]-e*Math.sin(r)]);n.animate({center:n.getConstrainedCenter(a),duration:500,easing:Ob})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},i.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var i=t.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},i}(ia);function Vr(t){return Xg(t)&&Wk(t)}Wg.default=Xk;var Yg={};var Wr=Yg&&Yg.__extends||function(){var t=function(n,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])})(n,o)};return function(n,o){function e(){this.constructor=n}t(n,o),n.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}}(),Yk=function(t){function n(n){var o=this,e=n||{};return(o=t.call(this,{stopDown:sb})||this).condition_=e.condition?e.condition:Qr,o.lastAngle_=void 0,o.duration_=void 0!==e.duration?e.duration:250,o}return Wr(n,t),n.prototype.handleDragEvent=function(t){if(Ta(t)){var n=t.map,o=n.getView();if(o.getConstraints().rotation!==Dg){var e=n.getSize(),r=t.pixel,i=Math.atan2(e[1]/2-r[1],r[0]-e[0]/2);if(void 0!==this.lastAngle_){var a=i-this.lastAngle_;o.adjustRotation(-a)}this.lastAngle_=i}}},n.prototype.handleUpEvent=function(t){return!Ta(t)||(t.map.getView().endInteraction(this.duration_),!1)},n.prototype.handleDownEvent=function(t){return!!Ta(t)&&!(!Sk(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0)},n}(ia);Yg.default=Yk;var Zg={};var $g={};var _g={};var Xr=_g&&_g.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Zk=function(t){function e(e){var r=t.call(this)||this;return r.geometry_=null,r.element_=document.createElement("div"),r.element_.style.position="absolute",r.element_.className="ol-box "+e,r.map_=null,r.startPixel_=null,r.endPixel_=null,r}return Xr(e,t),e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,r=this.element_.style;r.left=Math.min(t[0],e[0])+"px",r.top=Math.min(t[1],e[1])+"px",r.width=Math.abs(e[0]-t[0])+"px",r.height=Math.abs(e[1]-t[1])+"px"},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left=e.top=e.width=e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,r=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixel,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new oa([r])},e.prototype.getGeometry=function(){return this.geometry_},e}(zc);_g.default=Zk;var $k=$g&&$g.__extends||function(){var t=function(n,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])})(n,o)};return function(n,o){function e(){this.constructor=n}t(n,o),n.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}}(),ah={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend"},bh=function(t){function n(n,o,e){var r=t.call(this,n)||this;return r.coordinate=o,r.mapBrowserEvent=e,r}return $k(n,t),n}(L),_k=function(t){function n(n){var o=t.call(this)||this,e=n||{};return o.box_=new Zk(e.className||"ol-dragbox"),o.minArea_=void 0!==e.minArea?e.minArea:64,o.onBoxEnd_=e.onBoxEnd?e.onBoxEnd:Ha,o.startPixel_=null,o.condition_=e.condition?e.condition:Wd,o.boxEndCondition_=e.boxEndCondition?e.boxEndCondition:o.defaultBoxEndCondition,o}return $k(n,t),n.prototype.defaultBoxEndCondition=function(t,n,o){var e=o[0]-n[0],r=o[1]-n[1];return e*e+r*r>=this.minArea_},n.prototype.getGeometry=function(){return this.box_.getGeometry()},n.prototype.handleDragEvent=function(t){Ta(t)&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new bh(ah.BOXDRAG,t.coordinate,t)))},n.prototype.handleUpEvent=function(t){return!Ta(t)||(this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd_(t),this.dispatchEvent(new bh(ah.BOXEND,t.coordinate,t))),!1)},n.prototype.handleDownEvent=function(t){return!!Ta(t)&&!(!Sk(t)||!this.condition_(t))&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new bh(ah.BOXSTART,t.coordinate,t)),!0)},n}(ia);$g.default=_k;var Yr=Zg&&Zg.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),al=function(t){function e(e){var o=this,r=e||{},n=r.condition?r.condition:Xd;return(o=t.call(this,{condition:n,className:r.className||"ol-dragzoom",minArea:r.minArea,onBoxEnd:Zr})||this).duration_=void 0!==r.duration?r.duration:200,o.out_=void 0!==r.out&&r.out,o}return Yr(e,t),e}(_k);function Zr(){var t=this.getMap(),e=t.getView(),o=t.getSize(),r=this.getGeometry().getExtent();if(this.out_){var n=e.calculateExtent(o),i=Un([t.getPixelFromCoordinate(Ia(r)),t.getPixelFromCoordinate(_a(r))]),u=e.getResolutionForExtent(i,o);Oi(n,1/u),r=n}var $=e.getConstrainedResolution(e.getResolutionForExtent(r,o)),a=e.getConstrainedCenter(Yb(r),$);e.animate({resolution:$,center:a,duration:this.duration_,easing:Ob})}Zg.default=al;var ch={};var Qb={LEFT:37,UP:38,RIGHT:39,DOWN:40};var $r=ch&&ch.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),bl=function(t){function e(e){var o=t.call(this,{handleEvent:_r})||this,r=e||{};return o.defaultCondition_=function(t){return Xg(t)&&Vk(t)},o.condition_=void 0!==r.condition?r.condition:o.defaultCondition_,o.duration_=void 0!==r.duration?r.duration:100,o.pixelDelta_=void 0!==r.pixelDelta?r.pixelDelta:128,o}return $r(e,t),e}(lb);function _r(t){var e=!1;if(t.type==g.KEYDOWN){var o=t.originalEvent.keyCode;if(this.condition_(t)&&(o==Qb.DOWN||o==Qb.LEFT||o==Qb.RIGHT||o==Qb.UP)){var r=t.map.getView(),n=r.getResolution()*this.pixelDelta_,i=0,$=0;o==Qb.DOWN?$=-n:o==Qb.LEFT?i=-n:o==Qb.RIGHT?i=n:$=n;var s=[i,$];Fd(s,r.getRotation()),Pk(r,s,this.duration_),t.preventDefault(),e=!0}}return!e}ch.default=bl;var dh={};var as=dh&&dh.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),cl=function(t){function e(e){var r=t.call(this,{handleEvent:bs})||this,n=e||{};return r.condition_=n.condition?n.condition:Vk,r.delta_=n.delta?n.delta:1,r.duration_=void 0!==n.duration?n.duration:100,r}return as(e,t),e}(lb);function bs(t){var e=!1;if(t.type==g.KEYDOWN||t.type==g.KEYPRESS){var r=t.originalEvent.charCode;if(this.condition_(t)&&(r=="+".charCodeAt(0)||r=="-".charCodeAt(0))){var n=t.map,o=r=="+".charCodeAt(0)?this.delta_:-this.delta_,i=n.getView();Vd(i,o,void 0,this.duration_),t.preventDefault(),e=!0}}return!e}dh.default=cl;var $d={};var cs=$d&&$d.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),_d={TRACKPAD:"trackpad",WHEEL:"wheel"};$d.Mode=_d;var dl=function(t){function e(e){var o=this,i=e||{};return(o=t.call(this,i)||this).totalDelta_=0,o.lastDelta_=0,o.maxDelta_=void 0!==i.maxDelta?i.maxDelta:1,o.duration_=void 0!==i.duration?i.duration:250,o.timeout_=void 0!==i.timeout?i.timeout:80,o.useAnchor_=void 0===i.useAnchor||i.useAnchor,o.condition_=i.condition?i.condition:Wd,o.lastAnchor_=null,o.startTime_=void 0,o.timeoutId_,o.mode_=void 0,o.trackpadEventGap_=400,o.trackpadTimeoutId_,o.trackpadDeltaPerZoom_=300,o}return cs(e,t),e.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().endInteraction(void 0,Math.sign(this.lastDelta_),this.lastAnchor_)},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;var e=t.type;if(e!==g.WHEEL&&e!==g.MOUSEWHEEL)return!0;t.preventDefault();var o,i=t.map,r=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==g.WHEEL?(o=r.deltaY,Zp&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(o/=Jd),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(o*=40)):t.type==g.MOUSEWHEEL&&(o=-r.wheelDeltaY,$p&&(o/=3)),0===o)return!1;this.lastDelta_=o;var a=Date.now();if(void 0===this.startTime_&&(this.startTime_=a),(!this.mode_||a-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(o)<4?_d.TRACKPAD:_d.WHEEL),this.mode_===_d.TRACKPAD){var n=i.getView();return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):n.beginInteraction(),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.trackpadEventGap_),n.adjustZoom(-o/this.trackpadDeltaPerZoom_,this.lastAnchor_),this.startTime_=a,!1}this.totalDelta_+=o;var s=Math.max(this.timeout_-(a-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),s),!1},e.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();var o=D(this.totalDelta_,-this.maxDelta_,this.maxDelta_);Vd(e,-o,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(lb);$d.default=dl;var eh={};var ds=eh&&eh.__extends||function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),el=function(t){function n(n){var e=this,r=n||{},o=r;return o.stopDown||(o.stopDown=sb),(e=t.call(this,o)||this).anchor_=null,e.lastAngle_=void 0,e.rotating_=!1,e.rotationDelta_=0,e.threshold_=void 0!==r.threshold?r.threshold:.3,e.duration_=void 0!==r.duration?r.duration:250,e}return ds(n,t),n.prototype.handleDragEvent=function(t){var n=0,e=this.targetPointers[0],r=this.targetPointers[1],o=Math.atan2(r.clientY-e.clientY,r.clientX-e.clientX);if(void 0!==this.lastAngle_){var i=o-this.lastAngle_;this.rotationDelta_+=i,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=i}this.lastAngle_=o;var a=t.map,s=a.getView();if(s.getConstraints().rotation!==Dg){var h=a.getViewport().getBoundingClientRect(),l=Zd(this.targetPointers);l[0]-=h.left,l[1]-=h.top,this.anchor_=a.getCoordinateFromPixel(l),this.rotating_&&(a.render(),s.adjustRotation(n,this.anchor_))}},n.prototype.handleUpEvent=function(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)},n.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var n=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1},n}(ia);eh.default=el;var fh={};var es=fh&&fh.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fl=function(t){function e(e){var n=this,r=e||{},o=r;return o.stopDown||(o.stopDown=sb),(n=t.call(this,o)||this).anchor_=null,n.duration_=void 0!==r.duration?r.duration:400,n.lastDistance_=void 0,n.lastScaleDelta_=1,n}return es(e,t),e.prototype.handleDragEvent=function(t){var e=1,n=this.targetPointers[0],r=this.targetPointers[1],o=n.clientX-r.clientX,i=n.clientY-r.clientY,a=Math.sqrt(o*o+i*i);void 0!==this.lastDistance_&&(e=this.lastDistance_/a),this.lastDistance_=a;var s=t.map,c=s.getView();1!=e&&(this.lastScaleDelta_=e);var l=s.getViewport().getBoundingClientRect(),u=Zd(this.targetPointers);u[0]-=l.left,u[1]-=l.top,this.anchor_=s.getCoordinateFromPixel(u),s.render(),c.adjustResolution(e,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,n),!1}return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},e}(ia);fh.default=fl;var gh={};var gl=gh&&gh.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function c(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(c.prototype=r.prototype,new c)}}(),fs={ADD_FEATURES:"addfeatures"},gs=function(t){function e(e,r,c,n){var o=t.call(this,e)||this;return o.features=c,o.file=r,o.projection=n,o}return gl(e,t),e}(L),hs=function(t){function e(e){var r=this,c=e||{};return(r=t.call(this,{handleEvent:W})||this).formatConstructors_=c.formatConstructors?c.formatConstructors:[],r.projection_=c.projection?p(c.projection):null,r.dropListenKeys_=null,r.source_=c.source||null,r.target=c.target?c.target:null,r}return gl(e,t),e.prototype.handleResult_=function(t,e){var r=e.target.result,c=this.getMap(),n=this.projection_;n||(n=c.getView().getProjection());for(var o=this.formatConstructors_,i=[],s=0,$=o.length;s<$;++s){var a=new o[s];if((i=this.tryReadFeatures_(a,r,{featureProjection:n}))&&i.length>0)break}this.source_&&(this.source_.clear(),this.source_.addFeatures(i)),this.dispatchEvent(new gs(fs.ADD_FEATURES,t,i,n))},e.prototype.registerListeners_=function(){var t=this.getMap();if(t){var e=this.target?this.target:t.getViewport();this.dropListenKeys_=[f(e,g.DROP,is,this),f(e,g.DRAGENTER,hh,this),f(e,g.DRAGOVER,hh,this),f(e,g.DROP,hh,this)]}},e.prototype.setActive=function(e){t.prototype.setActive.call(this,e),e?this.registerListeners_():this.unregisterListeners_()},e.prototype.setMap=function(e){this.unregisterListeners_(),t.prototype.setMap.call(this,e),this.getActive()&&this.registerListeners_()},e.prototype.tryReadFeatures_=function(t,e,r){try{return t.readFeatures(e,r)}catch(c){return null}},e.prototype.unregisterListeners_=function(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(l),this.dropListenKeys_=null)},e}(lb);function is(t){for(var e=t.dataTransfer.files,r=0,c=e.length;r<c;++r){var n=e.item(r),o=new FileReader;o.addEventListener(g.LOAD,this.handleResult_.bind(this,n)),o.readAsText(n)}}function hh(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"}gh.default=hs;var ih={};var js=ih&&ih.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ks=function(t){function e(e){var n=this,i=e||{};return(n=t.call(this,i)||this).condition_=i.condition?i.condition:Xd,n.lastAngle_=void 0,n.lastMagnitude_=void 0,n.lastScaleDelta_=0,n.duration_=void 0!==i.duration?i.duration:400,n}return js(e,t),e.prototype.handleDragEvent=function(t){if(Ta(t)){var e=t.map,n=e.getSize(),i=t.pixel,o=i[0]-n[0]/2,a=n[1]/2-i[1],r=Math.atan2(a,o),s=Math.sqrt(o*o+a*a),l=e.getView();if(void 0!==this.lastAngle_){var u=this.lastAngle_-r;l.adjustRotation(u)}this.lastAngle_=r,void 0!==this.lastMagnitude_&&l.adjustResolution(this.lastMagnitude_/s),void 0!==this.lastMagnitude_&&(this.lastScaleDelta_=this.lastMagnitude_/s),this.lastMagnitude_=s}},e.prototype.handleUpEvent=function(t){if(!Ta(t))return!0;var e=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,n),this.lastScaleDelta_=0,!1},e.prototype.handleDownEvent=function(t){return!!Ta(t)&&!!this.condition_(t)&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,this.lastMagnitude_=void 0,!0)},e}(ia);ih.default=ks;var Zc={};var jh={};var ls=jh&&jh.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),ae=function(t){function e(e,r,o){var i=t.call(this)||this;if(void 0!==o&&void 0===r)i.setFlatCoordinates(o,e);else{var s=r||0;i.setCenterAndRadius(e,s,o)}return i}return ls(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),void 0,this.layout)},e.prototype.closestPointXY=function(t,e,r,o){var i=this.flatCoordinates,s=t-i[0],n=e-i[1],a=s*s+n*n;if(a<o){if(0===a)for(var p=0;p<this.stride;++p)r[p]=i[p];else{var d=this.getRadius()/Math.sqrt(a);r[0]=i[0]+d*s,r[1]=i[1]+d*n;for(p=2;p<this.stride;++p)r[p]=i[p]}return r.length=this.stride,a}return o},e.prototype.containsXY=function(t,e){var r=this.flatCoordinates,o=t-r[0],i=e-r[1];return o*o+i*i<=this.getRadiusSquared_()},e.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.computeExtent=function(t){var e=this.flatCoordinates,r=e[this.stride]-e[0];return la(e[0]-r,e[1]-r,e[0]+r,e[1]+r,t)},e.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},e.prototype.getRadiusSquared_=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},e.prototype.getType=function(){return b.CIRCLE},e.prototype.intersectsExtent=function(t){var e=this.getExtent();if(fa(t,e)){var r=this.getCenter();return t[0]<=r[0]&&t[2]>=r[0]||t[1]<=r[1]&&t[3]>=r[1]||Mi(t,this.intersectsCoordinate.bind(this))}return!1},e.prototype.setCenter=function(t){var e=this.stride,r=this.flatCoordinates[e]-this.flatCoordinates[0],o=t.slice();o[e]=o[0]+r;for(var i=1;i<e;++i)o[e+i]=t[i];this.setFlatCoordinates(this.layout,o),this.changed()},e.prototype.setCenterAndRadius=function(t,e,r){this.setLayout(r,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var o=this.flatCoordinates,i=ej(o,0,t,this.stride);o[i++]=o[0]+e;for(var s=1,n=this.stride;s<n;++s)o[i++]=o[s];o.length=i,this.changed()},e.prototype.getCoordinates=function(){return null},e.prototype.setCoordinates=function(t,e){},e.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},e.prototype.rotate=function(t,e){var r=this.getCenter(),o=this.getStride();this.setCenter(Pi(r,0,r.length,o,t,e,r)),this.changed()},e.prototype.translate=function(t,e){var r=this.getCenter(),o=this.getStride();this.setCenter(Qi(r,0,r.length,o,t,e,r)),this.changed()},e}(La);ae.prototype.transform,jh.default=ae;var kh={};var ms=kh&&kh.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),be=function(t){function e(e,r,i){var o=t.call(this)||this;if(o.ends_=[],o.maxDelta_=-1,o.maxDeltaRevision_=-1,Array.isArray(e[0]))o.setCoordinates(e,r);else if(void 0!==r&&i)o.setFlatCoordinates(r,e),o.ends_=i;else{for(var s=o.getLayout(),n=e,a=[],l=[],$=0,p=n.length;$<p;++$){var d=n[$];0===$&&(s=d.getLayout()),X(a,d.getFlatCoordinates()),l.push(a.length)}o.setFlatCoordinates(s,a),o.ends_=l}return o}return ms(e,t),e.prototype.appendLineString=function(t){this.flatCoordinates?X(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,r,i){return i<xb(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(uf(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),wf(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,r,i))},e.prototype.getCoordinateAtM=function(t,e,r){if(this.layout!=u.XYM&&this.layout!=u.XYZM||0===this.flatCoordinates.length)return null;var i=void 0!==e&&e,o=void 0!==r&&r;return Up(this.flatCoordinates,0,this.ends_,this.stride,t,i,o)},e.prototype.getCoordinates=function(){return sd(this.flatCoordinates,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new Da(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,e=this.ends_,r=this.layout,i=[],o=0,s=0,n=e.length;s<n;++s){var a=e[s],l=new Da(t.slice(o,a),r);i.push(l),o=a}return i},e.prototype.getFlatMidpoints=function(){for(var t=[],e=this.flatCoordinates,r=0,i=this.ends_,o=this.stride,s=0,n=i.length;s<n;++s){var a=i[s],l=Zj(e,r,a,o,.5);X(t,l),r=a}return t},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[],i=[];return r.length=Co(this.flatCoordinates,0,this.ends_,this.stride,t,r,0,i),new e(r,u.XY,i)},e.prototype.getType=function(){return b.MULTI_LINE_STRING},e.prototype.intersectsExtent=function(t){return Ko(this.flatCoordinates,0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=xf(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===r.length?0:r[r.length-1],this.changed()},e}(La);kh.default=be;var lh={};var ns=lh&&lh.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),ce=function(t){function e(e,r){var o=t.call(this)||this;return r&&!Array.isArray(e[0])?o.setFlatCoordinates(r,e):o.setCoordinates(e,r),o}return ns(e,t),e.prototype.appendPoint=function(t){this.flatCoordinates?X(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,r,o){if(o<xb(this.getExtent(),t,e))return o;for(var i=this.flatCoordinates,n=this.stride,s=0,a=i.length;s<a;s+=n){var l=Cb(t,e,i[s],i[s+1]);if(l<o){o=l;for(var d=0;d<n;++d)r[d]=i[s+d];r.length=n}}return o},e.prototype.getCoordinates=function(){return Hc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getPoint=function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new na(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},e.prototype.getPoints=function(){for(var t=this.flatCoordinates,e=this.layout,r=this.stride,o=[],i=0,n=t.length;i<n;i+=r){var s=new na(t.slice(i,i+r),e);o.push(s)}return o},e.prototype.getType=function(){return b.MULTI_POINT},e.prototype.intersectsExtent=function(t){for(var e=this.flatCoordinates,r=this.stride,o=0,i=e.length;o<i;o+=r){var n=e[o],s=e[o+1];if($e(t,n,s))return!0}return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=rd(this.flatCoordinates,0,t,this.stride),this.changed()},e}(La);lh.default=ce;var mh={};function os(r,e,t,$){for(var j=[],n=S(),a=0,i=t.length;a<i;++a){var m=t[a];n=Ki(r,e,m[0],$),j.push((n[0]+n[2])/2,(n[1]+n[3])/2),e=m[m.length-1]}return j}var ps=mh&&mh.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),nh=function(t){function e(e,i,r){var s=t.call(this)||this;if(s.endss_=[],s.flatInteriorPointsRevision_=-1,s.flatInteriorPoints_=null,s.maxDelta_=-1,s.maxDeltaRevision_=-1,s.orientedRevision_=-1,s.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){for(var n=s.getLayout(),o=e,a=[],l=[],$=0,h=o.length;$<h;++$){var p=o[$];0===$&&(n=p.getLayout());for(var d=a.length,u=p.getEnds(),f=0,c=u.length;f<c;++f)u[f]+=d;X(a,p.getFlatCoordinates()),l.push(u)}i=n,e=a,r=l}return void 0!==i&&r?(s.setFlatCoordinates(i,e),s.endss_=r):s.setCoordinates(e,i),s}return ps(e,t),e.prototype.appendPolygon=function(t){var e;if(this.flatCoordinates){var i=this.flatCoordinates.length;X(this.flatCoordinates,t.getFlatCoordinates());for(var r=0,s=(e=t.getEnds().slice()).length;r<s;++r)e[r]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()},e.prototype.clone=function(){for(var t=this.endss_.length,i=new Array(t),r=0;r<t;++r)i[r]=this.endss_[r].slice();return new e(this.flatCoordinates.slice(),this.layout,i)},e.prototype.closestPointXY=function(t,e,i,r){return r<xb(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(zo(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ao(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,r))},e.prototype.containsXY=function(t,e){return Io(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)},e.prototype.getArea=function(){return yo(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),mj(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,fj(e,0,this.endss_,this.stride)},e.prototype.getEndss=function(){return this.endss_},e.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=os(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Jo(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},e.prototype.getInteriorPoints=function(){return new ce(this.getFlatInteriorPoints().slice(),u.XYM)},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;No(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=mj(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],r=[];return i.length=Eo(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),i,0,r),new e(i,u.XY,r)},e.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;var e;if(0===t)e=0;else{var i=this.endss_[t-1];e=i[i.length-1]}var r=this.endss_[t].slice(),s=r[r.length-1];if(0!==e)for(var n=0,o=r.length;n<o;++n)r[n]-=e;return new oa(this.flatCoordinates.slice(e,s),this.layout,r)},e.prototype.getPolygons=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.endss_,r=[],s=0,n=0,o=i.length;n<o;++n){var a=i[n].slice(),l=a[a.length-1];if(0!==s)for(var $=0,h=a.length;$<h;++$)a[$]-=s;var p=new oa(e.slice(s,l),t,a);r.push(p),s=l}return r},e.prototype.getType=function(){return b.MULTI_POLYGON},e.prototype.intersectsExtent=function(t){return Mo(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=Bo(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{var r=i[i.length-1];this.flatCoordinates.length=0===r.length?0:r[r.length-1]}this.changed()},e}(La);mh.default=nh;var hl=Zc&&Zc.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),v={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",CIRCLE:"Circle"},oh={DRAWSTART:"drawstart",DRAWEND:"drawend"},ph=function(e){function t(t,i){var r=e.call(this,t)||this;return r.feature=i,r}return hl(t,e),t}(L),qs=function(e){function t(t){var i=this,r=t;r.stopDown||(r.stopDown=sb),(i=e.call(this,r)||this).shouldHandle_=!1,i.downPx_=null,i.downTimeout_,i.lastDragTime_,i.freehand_=!1,i.source_=t.source?t.source:null,i.features_=t.features?t.features:null,i.snapTolerance_=t.snapTolerance?t.snapTolerance:12,i.type_=t.type,i.mode_=us(i.type_),i.stopClick_=!!t.stopClick,i.minPoints_=t.minPoints?t.minPoints:i.mode_===v.POLYGON?3:2,i.maxPoints_=t.maxPoints?t.maxPoints:1/0,i.finishCondition_=t.finishCondition?t.finishCondition:W;var o=t.geometryFunction;if(!o)if(i.type_===b.CIRCLE)o=function(e,t){var i=t||new ae([NaN,NaN]),r=Z(e[0],e[1]);return i.setCenterAndRadius(e[0],Math.sqrt(r)),i};else{var s,n=i.mode_;n===v.POINT?s=na:n===v.LINE_STRING?s=Da:n===v.POLYGON&&(s=oa),o=function(e,t){var i=t;return i?n===v.POLYGON?e[0].length?i.setCoordinates([e[0].concat([e[0][0]])]):i.setCoordinates([]):i.setCoordinates(e):i=new s(e),i}}return i.geometryFunction_=o,i.dragVertexDelay_=void 0!==t.dragVertexDelay?t.dragVertexDelay:500,i.finishCoordinate_=null,i.sketchFeature_=null,i.sketchPoint_=null,i.sketchCoords_=null,i.sketchLine_=null,i.sketchLineCoords_=null,i.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,i.overlay_=new fb({source:new gb({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:rs(),updateWhileInteracting:!0}),i.geometryName_=t.geometryName,i.condition_=t.condition?t.condition:Xg,i.freehandCondition_,t.freehand?i.freehandCondition_=Wd:i.freehandCondition_=t.freehandCondition?t.freehandCondition:Xd,f(i,x(Ud.ACTIVE),i.updateState_,i),i}return hl(t,e),t.prototype.setMap=function(t){e.prototype.setMap.call(this,t),this.updateState_()},t.prototype.getOverlay=function(){return this.overlay_},t.prototype.handleEvent=function(t){t.originalEvent.type===g.CONTEXTMENU&&t.preventDefault(),this.freehand_=this.mode_!==v.POINT&&this.freehandCondition_(t);var i=t.type===d.POINTERMOVE,r=!0;!this.freehand_&&this.lastDragTime_&&t.type===d.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,i=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0));return this.freehand_&&t.type===d.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t),r=!1):this.freehand_&&t.type===d.POINTERDOWN?r=!1:i?(r=t.type===d.POINTERMOVE)&&this.freehand_?r=this.handlePointerMove_(t):(t.pointerEvent.pointerType==tg||t.type===d.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(t):t.type===d.DBLCLICK&&(r=!1),e.prototype.handleEvent.call(this,t)&&r},t.prototype.handleDownEvent=function(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new Sa(d.POINTERMOVE,e.map,e.pointerEvent,!1,e.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)},t.prototype.handleUpEvent=function(e){var t=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);var i=this.mode_===v.CIRCLE;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||i?this.finishDrawing():this.atFinish_(e)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e):(this.startDrawing_(e),this.mode_===v.POINT&&this.finishDrawing()),t=!1):this.freehand_&&(this.finishCoordinate_=null,this.abortDrawing_()),!t&&this.stopClick_&&e.stopPropagation(),t},t.prototype.handlePointerMove_=function(e){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var t=this.downPx_,i=e.pixel,r=t[0]-i[0],o=t[1]-i[1],s=r*r+o*o;if(this.shouldHandle_=this.freehand_?s>this.squaredClickTolerance_:s<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(e):this.createOrUpdateSketchPoint_(e),!0},t.prototype.atFinish_=function(e){var t=!1;if(this.sketchFeature_){var i=!1,r=[this.finishCoordinate_];if(this.mode_===v.LINE_STRING)i=this.sketchCoords_.length>this.minPoints_;else if(this.mode_===v.POLYGON){var o=this.sketchCoords_;i=o[0].length>this.minPoints_,r=[o[0][0],o[0][o[0].length-2]]}if(i)for(var s=e.map,n=0,a=r.length;n<a;n++){var $=r[n],h=s.getPixelFromCoordinate($),l=e.pixel,L=l[0]-h[0],p=l[1]-h[1],_=this.freehand_?1:this.snapTolerance_;if(t=Math.sqrt(L*L+p*p)<=_){this.finishCoordinate_=$;break}}}return t},t.prototype.createOrUpdateSketchPoint_=function(e){var t=e.coordinate.slice();this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new K(new na(t)),this.updateSketchFeatures_())},t.prototype.startDrawing_=function(e){var t=e.coordinate;this.finishCoordinate_=t,this.mode_===v.POINT?this.sketchCoords_=t.slice():this.mode_===v.POLYGON?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new K(new Da(this.sketchLineCoords_)));var i=this.geometryFunction_(this.sketchCoords_);this.sketchFeature_=new K,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new ph(oh.DRAWSTART,this.sketchFeature_))},t.prototype.modifyDrawing_=function(e){var t,i,r,o=e.coordinate,s=this.sketchFeature_.getGeometry();(this.mode_===v.POINT?i=this.sketchCoords_:this.mode_===v.POLYGON?(i=(t=this.sketchCoords_[0])[t.length-1],this.atFinish_(e)&&(o=this.finishCoordinate_.slice())):i=(t=this.sketchCoords_)[t.length-1],i[0]=o[0],i[1]=o[1],this.geometryFunction_(this.sketchCoords_,s),this.sketchPoint_)&&this.sketchPoint_.getGeometry().setCoordinates(o);if(s.getType()==b.POLYGON&&this.mode_!==v.POLYGON){this.sketchLine_||(this.sketchLine_=new K);var n=s.getLinearRing(0);(r=this.sketchLine_.getGeometry())?(r.setFlatCoordinates(n.getLayout(),n.getFlatCoordinates()),r.changed()):(r=new Da(n.getFlatCoordinates(),n.getLayout()),this.sketchLine_.setGeometry(r))}else this.sketchLineCoords_&&(r=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_);this.updateSketchFeatures_()},t.prototype.addToDrawing_=function(e){var t,i,r=e.coordinate,o=this.sketchFeature_.getGeometry();this.mode_===v.LINE_STRING?(this.finishCoordinate_=r.slice(),(i=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?i.pop():t=!0),i.push(r.slice()),this.geometryFunction_(i,o)):this.mode_===v.POLYGON&&((i=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?i.pop():t=!0),i.push(r.slice()),t&&(this.finishCoordinate_=i[0]),this.geometryFunction_(this.sketchCoords_,o)),this.updateSketchFeatures_(),t&&this.finishDrawing()},t.prototype.removeLastPoint=function(){if(this.sketchFeature_){var e,t=this.sketchFeature_.getGeometry();this.mode_===v.LINE_STRING?((e=this.sketchCoords_).splice(-2,1),this.geometryFunction_(e,t),e.length>=2&&(this.finishCoordinate_=e[e.length-2].slice())):this.mode_===v.POLYGON&&((e=this.sketchCoords_[0]).splice(-2,1),this.sketchLine_.getGeometry().setCoordinates(e),this.geometryFunction_(this.sketchCoords_,t)),0===e.length&&(this.finishCoordinate_=null),this.updateSketchFeatures_()}},t.prototype.finishDrawing=function(){var e=this.abortDrawing_();if(e){var t=this.sketchCoords_,i=e.getGeometry();this.mode_===v.LINE_STRING?(t.pop(),this.geometryFunction_(t,i)):this.mode_===v.POLYGON&&(t[0].pop(),this.geometryFunction_(t,i),t=i.getCoordinates()),this.type_===b.MULTI_POINT?e.setGeometry(new ce([t])):this.type_===b.MULTI_LINE_STRING?e.setGeometry(new be([t])):this.type_===b.MULTI_POLYGON&&e.setGeometry(new nh([t])),this.dispatchEvent(new ph(oh.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e)}},t.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var e=this.sketchFeature_;return e&&(this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0)),e},t.prototype.extend=function(e){var t=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=t.getCoordinates();var i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new ph(oh.DRAWSTART,this.sketchFeature_))},t.prototype.updateSketchFeatures_=function(){var e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);var t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)},t.prototype.updateState_=function(){var e=this.getMap(),t=this.getActive();e&&t||this.abortDrawing_(),this.overlay_.setMap(t?e:null)},t}(ia);function rs(){var e=Oc();return function(t,i){return e[t.getGeometry().getType()]}}function ss(e,t){return function(i,r){var o=i[0],s=i[1],n=Math.sqrt(Z(o,s)),a=r||Df(new ae(o),e),$=t;if(!t){var h=s[0]-o[0],l=s[1]-o[1];$=Math.atan(l/h)-(h<0?Math.PI:0)}return Ef(a,o,n,$),a}}function ts(){return function(e,t){var i=A(e),r=[[Ia(i),zb(i),_a(i),wa(i),Ia(i)]],o=t;return o?o.setCoordinates(r):o=new oa(r),o}}function us(e){var t;return e===b.POINT||e===b.MULTI_POINT?t=v.POINT:e===b.LINE_STRING||e===b.MULTI_LINE_STRING?t=v.LINE_STRING:e===b.POLYGON||e===b.MULTI_POLYGON?t=v.POLYGON:e===b.CIRCLE&&(t=v.CIRCLE),t}Zc.createRegularPolygon=ss,Zc.createBox=ts,Zc.default=qs;var qh={};var il=qh&&qh.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),vs={EXTENTCHANGED:"extentchanged"},ws=function(e){function t(t){var r=e.call(this,vs.EXTENTCHANGED)||this;return r.extent=t,r}return il(t,e),t}(L),xs=function(e){function t(t){var r=this,n=t||{};return(r=e.call(this,n)||this).extent_=null,r.pointerHandler_=null,r.pixelTolerance_=void 0!==n.pixelTolerance?n.pixelTolerance:10,r.snappedToVertex_=!1,r.extentFeature_=null,r.vertexFeature_=null,t||(t={}),r.extentOverlay_=new fb({source:new gb({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.boxStyle?t.boxStyle:ys(),updateWhileAnimating:!0,updateWhileInteracting:!0}),r.vertexOverlay_=new fb({source:new gb({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.pointerStyle?t.pointerStyle:zs(),updateWhileAnimating:!0,updateWhileInteracting:!0}),t.extent&&r.setExtent(t.extent),r}return il(t,e),t.prototype.snapToVertex_=function(e,t){var r=t.getCoordinateFromPixel(e),n=this.getExtent();if(n){var o=As(n);o.sort(function(e,t){return Sc(r,e)-Sc(r,t)});var i=o[0],a=Ed(r,i),$=t.getPixelFromCoordinate(a);if(Rc(e,$)<=this.pixelTolerance_){var p=t.getPixelFromCoordinate(i[0]),u=t.getPixelFromCoordinate(i[1]),l=Z($,p),y=Z($,u),s=Math.sqrt(Math.min(l,y));return this.snappedToVertex_=s<=this.pixelTolerance_,this.snappedToVertex_&&(a=l>y?i[1]:i[0]),a}}return null},t.prototype.handlePointerMove_=function(e){var t=e.pixel,r=e.map,n=this.snapToVertex_(t,r);n||(n=r.getCoordinateFromPixel(t)),this.createOrUpdatePointerFeature_(n)},t.prototype.createOrUpdateExtentFeature_=function(e){var t=this.extentFeature_;return t?e?t.setGeometry(Ic(e)):t.setGeometry(void 0):(t=e?new K(Ic(e)):new K({}),this.extentFeature_=t,this.extentOverlay_.getSource().addFeature(t)),t},t.prototype.createOrUpdatePointerFeature_=function(e){var t=this.vertexFeature_;t?t.getGeometry().setCoordinates(e):(t=new K(new na(e)),this.vertexFeature_=t,this.vertexOverlay_.getSource().addFeature(t));return t},t.prototype.handleEvent=function(t){return!t.pointerEvent||(t.type!=d.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),e.prototype.handleEvent.call(this,t),!1)},t.prototype.handleDownEvent=function(e){var t=e.pixel,r=e.map,n=this.getExtent(),o=this.snapToVertex_(t,r),i=function(e){var t=null,r=null;return e[0]==n[0]?t=n[2]:e[0]==n[2]&&(t=n[0]),e[1]==n[1]?r=n[3]:e[1]==n[3]&&(r=n[1]),null!==t&&null!==r?[t,r]:null};if(o&&n){var a=o[0]==n[0]||o[0]==n[2]?o[0]:null,$=o[1]==n[1]||o[1]==n[3]?o[1]:null;null!==a&&null!==$?this.pointerHandler_=jl(i(o)):null!==a?this.pointerHandler_=kl(i([a,n[1]]),i([a,n[3]])):null!==$&&(this.pointerHandler_=kl(i([n[0],$]),i([n[2],$])))}else o=r.getCoordinateFromPixel(t),this.setExtent([o[0],o[1],o[0],o[1]]),this.pointerHandler_=jl(o);return!0},t.prototype.handleDragEvent=function(e){if(this.pointerHandler_){var t=e.coordinate;this.setExtent(this.pointerHandler_(t)),this.createOrUpdatePointerFeature_(t)}return!0},t.prototype.handleUpEvent=function(e){this.pointerHandler_=null;var t=this.getExtent();return t&&0!==bf(t)||this.setExtent(null),!1},t.prototype.setMap=function(t){this.extentOverlay_.setMap(t),this.vertexOverlay_.setMap(t),e.prototype.setMap.call(this,t)},t.prototype.getExtent=function(){return this.extent_},t.prototype.setExtent=function(e){this.extent_=e||null,this.createOrUpdateExtentFeature_(e),this.dispatchEvent(new ws(this.extent_))},t}(ia);function ys(){var e=Oc();return function(t,r){return e[b.POLYGON]}}function zs(){var e=Oc();return function(t,r){return e[b.POINT]}}function jl(e){return function(t){return A([e,t])}}function kl(e,t){return e[0]==t[0]?function(r){return A([e,[r[0],t[1]]])}:e[1]==t[1]?function(r){return A([e,[t[0],r[1]]])}:null}function As(e){return[[[e[0],e[1]],[e[0],e[3]]],[[e[0],e[3]],[e[2],e[3]]],[[e[2],e[3]],[e[2],e[1]]],[[e[2],e[1]],[e[0],e[1]]]]}qh.default=xs;var de={};var ll=de&&de.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ml=0,$c=1,rh={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"},ee=function(e){function t(t,r,i){var o=e.call(this,t)||this;return o.features=r,o.mapBrowserEvent=i,o}return ll(t,e),t}(L);de.ModifyEvent=ee;var Bs=function(e){function t(t){var r,i=e.call(this,t)||this;if(i.condition_=t.condition?t.condition:Wk,i.defaultDeleteCondition_=function(e){return Pr(e)&&Uk(e)},i.deleteCondition_=t.deleteCondition?t.deleteCondition:i.defaultDeleteCondition_,i.insertVertexCondition_=t.insertVertexCondition?t.insertVertexCondition:Wd,i.vertexFeature_=null,i.vertexSegments_=null,i.lastPixel_=[0,0],i.ignoreNextSingleClick_=!1,i.modified_=!1,i.rBush_=new Hd,i.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,i.snappedToVertex_=!1,i.changingFeature_=!1,i.dragSegments_=[],i.overlay_=new fb({source:new gb({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:Ds(),updateWhileAnimating:!0,updateWhileInteracting:!0}),i.SEGMENT_WRITERS_={Point:i.writePointGeometry_,LineString:i.writeLineStringGeometry_,LinearRing:i.writeLineStringGeometry_,Polygon:i.writePolygonGeometry_,MultiPoint:i.writeMultiPointGeometry_,MultiLineString:i.writeMultiLineStringGeometry_,MultiPolygon:i.writeMultiPolygonGeometry_,Circle:i.writeCircleGeometry_,GeometryCollection:i.writeGeometryCollectionGeometry_},i.source_=null,t.source?(i.source_=t.source,r=new M(i.source_.getFeatures()),f(i.source_,pa.ADDFEATURE,i.handleSourceAdd_,i),f(i.source_,pa.REMOVEFEATURE,i.handleSourceRemove_,i)):r=t.features,!r)throw new Error("The modify interaction requires features or a source");return i.features_=r,i.features_.forEach(i.addFeature_.bind(i)),f(i.features_,C.ADD,i.handleFeatureAdd_,i),f(i.features_,C.REMOVE,i.handleFeatureRemove_,i),i.lastPointerEvent_=null,i}return ll(t,e),t.prototype.addFeature_=function(e){var t=e.getGeometry();t&&t.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[t.getType()].call(this,e,t);var r=this.getMap();r&&r.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,r),f(e,g.CHANGE,this.handleFeatureChange_,this)},t.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new ee(rh.MODIFYSTART,this.features_,e)))},t.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),ka(e,g.CHANGE,this.handleFeatureChange_,this)},t.prototype.removeFeatureSegmentData_=function(e){var t=this.rBush_,r=[];t.forEach(function(t){e===t.feature&&r.push(t)});for(var i=r.length-1;i>=0;--i){for(var o=r[i],n=this.dragSegments_.length-1;n>=0;--n)this.dragSegments_[n][0]===o&&this.dragSegments_.splice(n,1);t.remove(o)}},t.prototype.setActive=function(t){this.vertexFeature_&&!t&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.prototype.setActive.call(this,t)},t.prototype.setMap=function(t){this.overlay_.setMap(t),e.prototype.setMap.call(this,t)},t.prototype.getOverlay=function(){return this.overlay_},t.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},t.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},t.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},t.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){var t=e.target;this.removeFeature_(t),this.addFeature_(t)}},t.prototype.handleFeatureRemove_=function(e){var t=e.element;this.removeFeature_(t)},t.prototype.writePointGeometry_=function(e,t){var r=t.getCoordinates(),i={feature:e,geometry:t,segment:[r,r]};this.rBush_.insert(t.getExtent(),i)},t.prototype.writeMultiPointGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length;i<o;++i){var n=r[i],a={feature:e,geometry:t,depth:[i],index:i,segment:[n,n]};this.rBush_.insert(t.getExtent(),a)}},t.prototype.writeLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length-1;i<o;++i){var n=r.slice(i,i+2),a={feature:e,geometry:t,index:i,segment:n};this.rBush_.insert(A(n),a)}},t.prototype.writeMultiLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length;i<o;++i)for(var n=r[i],a=0,s=n.length-1;a<s;++a){var $=n.slice(a,a+2),p={feature:e,geometry:t,depth:[i],index:a,segment:$};this.rBush_.insert(A($),p)}},t.prototype.writePolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length;i<o;++i)for(var n=r[i],a=0,s=n.length-1;a<s;++a){var $=n.slice(a,a+2),p={feature:e,geometry:t,depth:[i],index:a,segment:$};this.rBush_.insert(A($),p)}},t.prototype.writeMultiPolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length;i<o;++i)for(var n=r[i],a=0,s=n.length;a<s;++a)for(var $=n[a],p=0,u=$.length-1;p<u;++p){var h=$.slice(p,p+2),d={feature:e,geometry:t,depth:[a,i],index:p,segment:h};this.rBush_.insert(A(h),d)}},t.prototype.writeCircleGeometry_=function(e,t){var r=t.getCenter(),i={feature:e,geometry:t,index:ml,segment:[r,r]},o={feature:e,geometry:t,index:$c,segment:[r,r]},n=[i,o];i.featureSegments=o.featureSegments=n,this.rBush_.insert(md(r),i),this.rBush_.insert(t.getExtent(),o)},t.prototype.writeGeometryCollectionGeometry_=function(e,t){for(var r=t.getGeometriesArray(),i=0;i<r.length;++i)this.SEGMENT_WRITERS_[r[i].getType()].call(this,e,r[i])},t.prototype.createOrUpdateVertexFeature_=function(e){var t=this.vertexFeature_;t?t.getGeometry().setCoordinates(e):(t=new K(new na(e)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t));return t},t.prototype.handleEvent=function(t){return!t.pointerEvent||(this.lastPointerEvent_=t,t.map.getView().getInteracting()||t.type!=d.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),this.vertexFeature_&&this.deleteCondition_(t)&&(r=!(t.type!=d.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),t.type==d.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),e.prototype.handleEvent.call(this,t)&&!r);var r},t.prototype.handleDragEvent=function(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e);for(var t=e.coordinate,r=0,i=this.dragSegments_.length;r<i;++r){for(var o=this.dragSegments_[r],n=o[0],a=n.depth,s=n.geometry,$=void 0,p=n.segment,u=o[1];t.length<s.getStride();)t.push(p[u][t.length]);switch(s.getType()){case b.POINT:$=t,p[0]=p[1]=t;break;case b.MULTI_POINT:($=s.getCoordinates())[n.index]=t,p[0]=p[1]=t;break;case b.LINE_STRING:($=s.getCoordinates())[n.index+u]=t,p[u]=t;break;case b.MULTI_LINE_STRING:case b.POLYGON:($=s.getCoordinates())[a[0]][n.index+u]=t,p[u]=t;break;case b.MULTI_POLYGON:($=s.getCoordinates())[a[1]][a[0]][n.index+u]=t,p[u]=t;break;case b.CIRCLE:p[0]=p[1]=t,n.index===ml?(this.changingFeature_=!0,s.setCenter(t),this.changingFeature_=!1):(this.changingFeature_=!0,s.setRadius(Rc(s.getCenter(),t)),this.changingFeature_=!1);}$&&this.setGeometryCoordinates_(s,$)}this.createOrUpdateVertexFeature_(t)},t.prototype.handleDownEvent=function(e){if(!this.condition_(e))return!1;this.handlePointerAtPixel_(e.pixel,e.map);var t=e.map.getCoordinateFromPixel(e.pixel);this.dragSegments_.length=0,this.modified_=!1;var r=this.vertexFeature_;if(r){var i=[],o=r.getGeometry().getCoordinates(),n=A([o]),a=this.rBush_.getInExtent(n),s={};a.sort(Cs);for(var $=0,p=a.length;$<p;++$){var u=a[$],h=u.segment,d=ba(u.feature),m=u.depth;if(m&&(d+="-"+m.join("-")),s[d]||(s[d]=new Array(2)),u.geometry.getType()===b.CIRCLE&&u.index===$c){var l=ol(t,u);Ca(l,o)&&!s[d][0]&&(this.dragSegments_.push([u,0]),s[d][0]=u)}else if(Ca(h[0],o)&&!s[d][0])this.dragSegments_.push([u,0]),s[d][0]=u;else if(Ca(h[1],o)&&!s[d][1]){if((u.geometry.getType()===b.LINE_STRING||u.geometry.getType()===b.MULTI_LINE_STRING)&&s[d][0]&&0===s[d][0].index)continue;this.dragSegments_.push([u,1]),s[d][1]=u}else ba(h)in this.vertexSegments_&&!s[d][0]&&!s[d][1]&&this.insertVertexCondition_(e)&&i.push([u,o])}i.length&&this.willModifyFeatures_(e);for(var g=i.length-1;g>=0;--g)this.insertVertex_.apply(this,i[g])}return!!this.vertexFeature_},t.prototype.handleUpEvent=function(e){for(var t=this.dragSegments_.length-1;t>=0;--t){var r=this.dragSegments_[t][0],i=r.geometry;if(i.getType()===b.CIRCLE){var o=i.getCenter(),n=r.featureSegments[0],a=r.featureSegments[1];n.segment[0]=n.segment[1]=o,a.segment[0]=a.segment[1]=o,this.rBush_.update(md(o),n),this.rBush_.update(i.getExtent(),a)}else this.rBush_.update(A(r.segment),r)}return this.modified_&&(this.dispatchEvent(new ee(rh.MODIFYEND,this.features_,e)),this.modified_=!1),!1},t.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map)},t.prototype.handlePointerAtPixel_=function(e,t){var r=t.getCoordinateFromPixel(e),i=ld(md(r),t.getView().getResolution()*this.pixelTolerance_),o=this.rBush_.getInExtent(i);if(o.length>0){o.sort(function(e,t){return nl(r,e)-nl(r,t)});var n=o[0],a=n.segment,s=ol(r,n),$=t.getPixelFromCoordinate(s),p=Rc(e,$);if(p<=this.pixelTolerance_){var u={};if(n.geometry.getType()===b.CIRCLE&&n.index===$c)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(s);else{var h=t.getPixelFromCoordinate(a[0]),d=t.getPixelFromCoordinate(a[1]),m=Z($,h),l=Z($,d);p=Math.sqrt(Math.min(m,l)),this.snappedToVertex_=p<=this.pixelTolerance_,this.snappedToVertex_&&(s=m>l?a[1]:a[0]),this.createOrUpdateVertexFeature_(s);for(var g=1,_=o.length;g<_;++g){var c=o[g].segment;if(!(Ca(a[0],c[0])&&Ca(a[1],c[1])||Ca(a[0],c[1])&&Ca(a[1],c[0])))break;u[ba(c)]=!0}}return u[ba(a)]=!0,void(this.vertexSegments_=u)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},t.prototype.insertVertex_=function(e,t){for(var r,i=e.segment,o=e.feature,n=e.geometry,a=e.depth,s=e.index;t.length<n.getStride();)t.push(0);switch(n.getType()){case b.MULTI_LINE_STRING:case b.POLYGON:(r=n.getCoordinates())[a[0]].splice(s+1,0,t);break;case b.MULTI_POLYGON:(r=n.getCoordinates())[a[1]][a[0]].splice(s+1,0,t);break;case b.LINE_STRING:(r=n.getCoordinates()).splice(s+1,0,t);break;default:return;}this.setGeometryCoordinates_(n,r);var $=this.rBush_;$.remove(e),this.updateSegmentIndices_(n,s,a,1);var p={segment:[i[0],t],feature:o,geometry:n,depth:a,index:s};$.insert(A(p.segment),p),this.dragSegments_.push([p,1]);var u={segment:[t,i[1]],feature:o,geometry:n,depth:a,index:s+1};$.insert(A(u.segment),u),this.dragSegments_.push([u,0]),this.ignoreNextSingleClick_=!0},t.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=d.POINTERDRAG){var e=this.lastPointerEvent_;this.willModifyFeatures_(e);var t=this.removeVertex_();return this.dispatchEvent(new ee(rh.MODIFYEND,this.features_,e)),this.modified_=!1,t}return!1},t.prototype.removeVertex_=function(){var e,t,r,i,o,n,a,s,$,p,u,h=this.dragSegments_,d={},m=!1;for(o=h.length-1;o>=0;--o)p=(r=h[o])[0],u=ba(p.feature),p.depth&&(u+="-"+p.depth.join("-")),u in d||(d[u]={}),0===r[1]?(d[u].right=p,d[u].index=p.index):1==r[1]&&(d[u].left=p,d[u].index=p.index+1);for(u in d){switch($=d[u].right,a=d[u].left,(s=(n=d[u].index)-1)<0&&(s=0),e=t=(i=(p=void 0!==a?a:$).geometry).getCoordinates(),m=!1,i.getType()){case b.MULTI_LINE_STRING:t[p.depth[0]].length>2&&(t[p.depth[0]].splice(n,1),m=!0);break;case b.LINE_STRING:t.length>2&&(t.splice(n,1),m=!0);break;case b.MULTI_POLYGON:e=e[p.depth[1]];case b.POLYGON:(e=e[p.depth[0]]).length>4&&(n==e.length-1&&(n=0),e.splice(n,1),m=!0,0===n&&(e.pop(),e.push(e[0]),s=e.length-1));}if(m){this.setGeometryCoordinates_(i,t);var l=[];if(void 0!==a&&(this.rBush_.remove(a),l.push(a.segment[0])),void 0!==$&&(this.rBush_.remove($),l.push($.segment[1])),void 0!==a&&void 0!==$){var g={depth:p.depth,feature:p.feature,geometry:p.geometry,index:s,segment:l};this.rBush_.insert(A(g.segment),g)}this.updateSegmentIndices_(i,n,p.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),h.length=0}}return m},t.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},t.prototype.updateSegmentIndices_=function(e,t,r,i){this.rBush_.forEachInExtent(e.getExtent(),function(o){o.geometry===e&&(void 0===r||void 0===o.depth||Bc(o.depth,r))&&o.index>t&&(o.index+=i)})},t}(ia);function Cs(e,t){return e.index-t.index}function nl(e,t){var r=t.geometry;if(r.getType()===b.CIRCLE){var i=r;if(t.index===$c){var o=Z(i.getCenter(),e),n=Math.sqrt(o)-i.getRadius();return n*n}}return Sc(e,t.segment)}function ol(e,t){var r=t.geometry;return r.getType()===b.CIRCLE&&t.index===$c?r.getClosestPoint(e):Ed(e,t.segment)}function Ds(){var e=Oc();return function(t,r){return e[b.POINT]}}de.default=Bs;var sh={};var pl=sh&&sh.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Es={SELECT:"select"},Fs=function(e){function t(t,r,i,o){var n=e.call(this,t)||this;return n.selected=r,n.deselected=i,n.mapBrowserEvent=o,n}return pl(t,e),t}(L),Gs=function(e){function t(t){var r=e.call(this,{handleEvent:Hs})||this,i=t||{};r.condition_=i.condition?i.condition:Uk,r.addCondition_=i.addCondition?i.addCondition:Tk,r.removeCondition_=i.removeCondition?i.removeCondition:Tk,r.toggleCondition_=i.toggleCondition?i.toggleCondition:Xd,r.multi_=!!i.multi&&i.multi,r.filter_=i.filter?i.filter:W,r.hitTolerance_=i.hitTolerance?i.hitTolerance:0;var o,n=new fb({source:new gb({useSpatialIndex:!1,features:i.features,wrapX:i.wrapX}),style:i.style?i.style:Is(),updateWhileAnimating:!0,updateWhileInteracting:!0});if(r.featureOverlay_=n,i.layers){if("function"==typeof i.layers)o=i.layers;else{var a=i.layers;o=function(e){return wb(a,e)}}}else o=W;r.layerFilter_=o,r.featureLayerAssociation_={};var $=r.getFeatures();return f($,C.ADD,r.addFeature_,r),f($,C.REMOVE,r.removeFeature_,r),r}return pl(t,e),t.prototype.addFeatureLayerAssociation_=function(e,t){this.featureLayerAssociation_[ba(e)]=t},t.prototype.getFeatures=function(){return this.featureOverlay_.getSource().getFeaturesCollection()},t.prototype.getHitTolerance=function(){return this.hitTolerance_},t.prototype.getLayer=function(e){return this.featureLayerAssociation_[ba(e)]},t.prototype.getOverlay=function(){return this.featureOverlay_},t.prototype.setHitTolerance=function(e){this.hitTolerance_=e},t.prototype.setMap=function(t){var r=this.getMap(),i=this.getFeatures();r&&i.forEach(r.unskipFeature.bind(r)),e.prototype.setMap.call(this,t),this.featureOverlay_.setMap(t),t&&i.forEach(t.skipFeature.bind(t))},t.prototype.addFeature_=function(e){var t=this.getMap();t&&t.skipFeature(e.element)},t.prototype.removeFeature_=function(e){var t=this.getMap();t&&t.unskipFeature(e.element)},t.prototype.removeFeatureLayerAssociation_=function(e){delete this.featureLayerAssociation_[ba(e)]},t}(lb);function Hs(e){if(!this.condition_(e))return!0;var t=this.addCondition_(e),r=this.removeCondition_(e),i=this.toggleCondition_(e),o=!t&&!r&&!i,n=e.map,a=this.getFeatures(),$=[],s=[];if(o){$a(this.featureLayerAssociation_),n.forEachFeatureAtPixel(e.pixel,function(e,t){if(this.filter_(e,t))return s.push(e),this.addFeatureLayerAssociation_(e,t),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var l=a.getLength()-1;l>=0;--l){var u=a.item(l),p=s.indexOf(u);p>-1?s.splice(p,1):(a.remove(u),$.push(u))}0!==s.length&&a.extend(s)}else{n.forEachFeatureAtPixel(e.pixel,function(e,o){if(this.filter_(e,o))return!t&&!i||wb(a.getArray(),e)?(r||i)&&wb(a.getArray(),e)&&($.push(e),this.removeFeatureLayerAssociation_(e)):(s.push(e),this.addFeatureLayerAssociation_(e,o)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var c=$.length-1;c>=0;--c)a.remove($[c]);a.extend(s)}return(s.length>0||$.length>0)&&this.dispatchEvent(new Fs(Es.SELECT,s,$,e)),Rr(e)}function Is(){var e=Oc();return X(e[b.POLYGON],e[b.LINE_STRING]),X(e[b.GEOMETRY_COLLECTION],e[b.LINE_STRING]),function(t,r){return t.getGeometry()?e[t.getGeometry().getType()]:null}}sh.default=Gs;var th={};var Js=th&&th.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();function ql(e){return e.feature?e.feature:e.element?e.element:void 0}var Ks=function(e){function t(t){var r=this,i=t||{},o=i;return o.handleDownEvent||(o.handleDownEvent=W),o.stopDown||(o.stopDown=sb),(r=e.call(this,o)||this).source_=i.source?i.source:null,r.vertex_=void 0===i.vertex||i.vertex,r.edge_=void 0===i.edge||i.edge,r.features_=i.features?i.features:null,r.featuresListenerKeys_=[],r.featureChangeListenerKeys_={},r.indexedFeaturesExtents_={},r.pendingFeatures_={},r.pixelCoordinate_=null,r.pixelTolerance_=void 0!==i.pixelTolerance?i.pixelTolerance:10,r.sortByDistance_=Ls.bind(r),r.rBush_=new Hd,r.SEGMENT_WRITERS_={Point:r.writePointGeometry_,LineString:r.writeLineStringGeometry_,LinearRing:r.writeLineStringGeometry_,Polygon:r.writePolygonGeometry_,MultiPoint:r.writeMultiPointGeometry_,MultiLineString:r.writeMultiLineStringGeometry_,MultiPolygon:r.writeMultiPolygonGeometry_,GeometryCollection:r.writeGeometryCollectionGeometry_,Circle:r.writeCircleGeometry_},r}return Js(t,e),t.prototype.addFeature=function(e,t){var r=void 0===t||t,i=ba(e),o=e.getGeometry();if(o){var n=this.SEGMENT_WRITERS_[o.getType()];n&&(this.indexedFeaturesExtents_[i]=o.getExtent(S()),n.call(this,e,o))}r&&(this.featureChangeListenerKeys_[i]=f(e,g.CHANGE,this.handleFeatureChange_,this))},t.prototype.forEachFeatureAdd_=function(e){this.addFeature(e)},t.prototype.forEachFeatureRemove_=function(e){this.removeFeature(e)},t.prototype.getFeatures_=function(){var e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e},t.prototype.handleEvent=function(t){var r=this.snapTo(t.pixel,t.coordinate,t.map);return r.snapped&&(t.coordinate=r.vertex.slice(0,2),t.pixel=r.vertexPixel),e.prototype.handleEvent.call(this,t)},t.prototype.handleFeatureAdd_=function(e){var t=ql(e);this.addFeature(t)},t.prototype.handleFeatureRemove_=function(e){var t=ql(e);this.removeFeature(t)},t.prototype.handleFeatureChange_=function(e){var t=e.target;if(this.handlingDownUpSequence){var r=ba(t);r in this.pendingFeatures_||(this.pendingFeatures_[r]=t)}else this.updateFeature_(t)},t.prototype.handleUpEvent=function(e){var t=Se(this.pendingFeatures_);return t.length&&(t.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1},t.prototype.removeFeature=function(e,t){var r=void 0===t||t,i=ba(e),o=this.indexedFeaturesExtents_[i];if(o){var n=this.rBush_,a=[];n.forEachInExtent(o,function(t){e===t.feature&&a.push(t)});for(var s=a.length-1;s>=0;--s)n.remove(a[s])}r&&(l(this.featureChangeListenerKeys_[i]),delete this.featureChangeListenerKeys_[i])},t.prototype.setMap=function(t){var r=this.getMap(),i=this.featuresListenerKeys_,o=this.getFeatures_();r&&(i.forEach(l),i.length=0,o.forEach(this.forEachFeatureRemove_.bind(this))),e.prototype.setMap.call(this,t),t&&(this.features_?i.push(f(this.features_,C.ADD,this.handleFeatureAdd_,this),f(this.features_,C.REMOVE,this.handleFeatureRemove_,this)):this.source_&&i.push(f(this.source_,pa.ADDFEATURE,this.handleFeatureAdd_,this),f(this.source_,pa.REMOVEFEATURE,this.handleFeatureRemove_,this)),o.forEach(this.forEachFeatureAdd_.bind(this)))},t.prototype.snapTo=function(e,t,r){var i=r.getCoordinateFromPixel([e[0]-this.pixelTolerance_,e[1]+this.pixelTolerance_]),o=r.getCoordinateFromPixel([e[0]+this.pixelTolerance_,e[1]-this.pixelTolerance_]),n=A([i,o]),a=this.rBush_.getInExtent(n);this.vertex_&&!this.edge_&&(a=a.filter(function(e){return e.feature.getGeometry().getType()!==b.CIRCLE}));var s,u,$,p,l=!1,h=null,c=null;if(a.length>0){this.pixelCoordinate_=t,a.sort(this.sortByDistance_);var d=a[0].segment,_=a[0].feature.getGeometry().getType()===b.CIRCLE;this.vertex_&&!this.edge_?(s=r.getPixelFromCoordinate(d[0]),u=r.getPixelFromCoordinate(d[1]),$=Z(e,s),p=Z(e,u),Math.sqrt(Math.min($,p))<=this.pixelTolerance_&&(l=!0,h=$>p?d[1]:d[0],c=r.getPixelFromCoordinate(h))):this.edge_&&(h=_?Sp(t,a[0].feature.getGeometry()):Ed(t,d),c=r.getPixelFromCoordinate(h),Rc(e,c)<=this.pixelTolerance_&&(l=!0,this.vertex_&&!_&&(s=r.getPixelFromCoordinate(d[0]),u=r.getPixelFromCoordinate(d[1]),$=Z(c,s),p=Z(c,u),Math.sqrt(Math.min($,p))<=this.pixelTolerance_&&(h=$>p?d[1]:d[0],c=r.getPixelFromCoordinate(h))))),l&&(c=[Math.round(c[0]),Math.round(c[1])])}return{snapped:l,vertex:h,vertexPixel:c}},t.prototype.updateFeature_=function(e){this.removeFeature(e,!1),this.addFeature(e,!1)},t.prototype.writeCircleGeometry_=function(e,t){for(var r=Df(t).getCoordinates()[0],i=0,o=r.length-1;i<o;++i){var n=r.slice(i,i+2),a={feature:e,segment:n};this.rBush_.insert(A(n),a)}},t.prototype.writeGeometryCollectionGeometry_=function(e,t){for(var r=t.getGeometriesArray(),i=0;i<r.length;++i){var o=this.SEGMENT_WRITERS_[r[i].getType()];o&&o.call(this,e,r[i])}},t.prototype.writeLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length-1;i<o;++i){var n=r.slice(i,i+2),a={feature:e,segment:n};this.rBush_.insert(A(n),a)}},t.prototype.writeMultiLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length;i<o;++i)for(var n=r[i],a=0,s=n.length-1;a<s;++a){var u=n.slice(a,a+2),$={feature:e,segment:u};this.rBush_.insert(A(u),$)}},t.prototype.writeMultiPointGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length;i<o;++i){var n=r[i],a={feature:e,segment:[n,n]};this.rBush_.insert(t.getExtent(),a)}},t.prototype.writeMultiPolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length;i<o;++i)for(var n=r[i],a=0,s=n.length;a<s;++a)for(var u=n[a],$=0,p=u.length-1;$<p;++$){var l=u.slice($,$+2),h={feature:e,segment:l};this.rBush_.insert(A(l),h)}},t.prototype.writePointGeometry_=function(e,t){var r=t.getCoordinates(),i={feature:e,segment:[r,r]};this.rBush_.insert(t.getExtent(),i)},t.prototype.writePolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length;i<o;++i)for(var n=r[i],a=0,s=n.length-1;a<s;++a){var u=n.slice(a,a+2),$={feature:e,segment:u};this.rBush_.insert(A(u),$)}},t}(ia);function Ls(e,t){return Sc(this.pixelCoordinate_,e.segment)-Sc(this.pixelCoordinate_,t.segment)}th.default=Ks;var fe={};var rl=fe&&fe.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function a(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}(),uh={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"},ge=function(t){function e(e,r,a){var n=t.call(this,e)||this;return n.features=r,n.coordinate=a,n}return rl(e,t),e}(L);fe.TranslateEvent=ge;var Ms=function(t){function e(e){var r,a=this,n=e||{};if((a=t.call(this,n)||this).lastCoordinate_=null,a.features_=void 0!==n.features?n.features:null,n.layers){if("function"==typeof n.layers)r=n.layers;else{var s=n.layers;r=function(t){return wb(s,t)}}}else r=W;return a.layerFilter_=r,a.filter_=n.filter?n.filter:W,a.hitTolerance_=n.hitTolerance?n.hitTolerance:0,a.lastFeature_=null,f(a,x(Ud.ACTIVE),a.handleActiveChanged_,a),a}return rl(e,t),e.prototype.handleDownEvent=function(t){if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);var e=this.features_||new M([this.lastFeature_]);return this.dispatchEvent(new ge(uh.TRANSLATESTART,e,t.coordinate)),!0}return!1},e.prototype.handleUpEvent=function(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);var e=this.features_||new M([this.lastFeature_]);return this.dispatchEvent(new ge(uh.TRANSLATEEND,e,t.coordinate)),!0}return!1},e.prototype.handleDragEvent=function(t){if(this.lastCoordinate_){var e=t.coordinate,r=e[0]-this.lastCoordinate_[0],a=e[1]-this.lastCoordinate_[1],n=this.features_||new M([this.lastFeature_]);n.forEach(function(t){var e=t.getGeometry();e.translate(r,a),t.setGeometry(e)}),this.lastCoordinate_=e,this.dispatchEvent(new ge(uh.TRANSLATING,n,e))}},e.prototype.handleMoveEvent=function(t){var e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")},e.prototype.featuresAtPixel_=function(t,e){return e.forEachFeatureAtPixel(t,function(t,e){if(this.filter_(t,e)&&(!this.features_||wb(this.features_.getArray(),t)))return t}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},e.prototype.getHitTolerance=function(){return this.hitTolerance_},e.prototype.setHitTolerance=function(t){this.hitTolerance_=t},e.prototype.setMap=function(e){var r=this.getMap();t.prototype.setMap.call(this,e),this.updateState_(r)},e.prototype.handleActiveChanged_=function(){this.updateState_(null)},e.prototype.updateState_=function(t){var e=this.getMap(),r=this.getActive();e&&r||(e=e||t)&&e.getViewport().classList.remove("ol-grab","ol-grabbing")},e}(ia);fe.default=Ms;var Ns=lg&&lg.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),sl=function(t){function r(r){return(r=$({},r)).controls||(r.controls=jr()),r.interactions||(r.interactions=Lr()),t.call(this,r)||this}return Ns(r,t),r.prototype.createRenderer=function(){return new Rg(this)},r}(Ig);lg.default=sl;var vh={};function tl(e,t,$,r){return void 0!==r?(r[0]=e,r[1]=t,r[2]=$,r):[e,t,$]}function he(e,t,$){return e+"/"+t+"/"+$}function ul(e){return he(e[0],e[1],e[2])}function Os(e){return e.split("/").map(Number)}function Ps(e){return(e[1]<<e[0])+e[2]}function Qs(e,t){var $=e[0],r=e[1],n=e[2];if(t.getMinZoom()>$||$>t.getMaxZoom())return!1;var o,y=t.getExtent();return!(o=y?t.getTileRangeForExtentAndZ(y,$):t.getFullTileRange($))||o.containsXY(r,n)}var Rs=vh&&vh.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),wh=function(t){function e(e){return t.call(this,e)||this}return Rs(e,t),e.prototype.expireCache=function(t){for(;this.canExpireCache();){if(this.peekLast().getKey()in t)break;this.pop().dispose()}},e.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=this.peekFirstKey(),e=Os(t)[0];this.forEach(function(t){t.tileCoord[0]!==e&&(this.remove(ul(t.tileCoord)),t.dispose())}.bind(this))}},e}(Of);vh.default=wh;var xh=function(){function t(t,i,n,m){this.minX=t,this.maxX=i,this.minY=n,this.maxY=m}return t.prototype.contains=function(t){return this.containsXY(t[1],t[2])},t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},t.prototype.containsXY=function(t,i){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY},t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},t.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},t.prototype.getHeight=function(){return this.maxY-this.minY+1},t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},t.prototype.getWidth=function(){return this.maxX-this.minX+1},t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},t}();function yh(t,i,n,m,e){return void 0!==e?(e.minX=t,e.maxX=i,e.minY=n,e.maxY=m,e):new xh(t,i,n,m)}function Ss(e,r){var t=/\{z\}/g,o=/\{x\}/g,$=/\{y\}/g,n=/\{-y\}/g;return function(a,l,p){return a?e.replace(t,a[0].toString()).replace(o,a[1].toString()).replace($,a[2].toString()).replace(n,function(){var e=a[0],t=r.getFullTileRange(e);return q(t,55),(t.getHeight()-a[2]-1).toString()}):void 0}}function vl(e,r){for(var t=e.length,o=new Array(t),$=0;$<t;++$)o[$]=Ss(e[$],r);return Ts(o)}function Ts(e){return 1===e.length?e[0]:function(r,t,o){if(r){var $=Ps(r),n=Db($,e.length);return e[n](r,t,o)}}}function Us(e,r,t){}function Vs(e){var r=[],t=/\{([a-z])-([a-z])\}/.exec(e);if(t){var o=t[1].charCodeAt(0),$=t[2].charCodeAt(0),n=void 0;for(n=o;n<=$;++n)r.push(e.replace(t[0],String.fromCharCode(n)));return r}if(t=t=/\{(\d+)-(\d+)\}/.exec(e)){for(var a=parseInt(t[2],10),l=parseInt(t[1],10);l<=a;l++)r.push(e.replace(t[0],l.toString()));return r}return r.push(e),r}function Ws(e,t,o,n){var r=document.createElement("script"),i="olc_"+ba(t);function c(){delete window[i],r.parentNode.removeChild(r)}r.async=!0,r.src=e+(-1==e.indexOf("?")?"?":"&")+(n||"callback")+"="+i;var $=setTimeout(function(){c(),o&&o()},1e4);window[i]=function(e){clearTimeout($),c(),t(e)},document.getElementsByTagName("head")[0].appendChild(r)}var zh={};var Xs=.5;var Ua=!0;var Ah={};function Ys(e,t,r,a){var o=eo(r,t,e),$=hf(t,a,r),n=t.getMetersPerUnit();void 0!==n&&($*=n);var i=e.getMetersPerUnit();void 0!==i&&($/=i);var O=e.getExtent();if(!O||Ze(O,o)){var l=hf(e,$,o)/$;isFinite(l)&&l>0&&($/=l)}return $}function Bh(e,t,r,a){var o=r-e,$=a-t,n=Math.sqrt(o*o+$*$);return[Math.round(r+o/n),Math.round(a+$/n)]}function Zs(e,t,r,a,o,$,n,i,O,l,s){var c=Ma(Math.round(r*e),Math.round(r*t));if(0===O.length)return c.canvas;c.scale(r,r);var p=S();O.forEach(function(e,t,r){af(p,e.extent)});var u=H(p),k=va(p),g=Ma(Math.round(r*u/a),Math.round(r*k/a)),v=r/a;O.forEach(function(e,t,r){var a=e.extent[0]-p[0],o=-(e.extent[3]-p[3]),$=H(e.extent),n=va(e.extent);g.drawImage(e.image,l,l,e.image.width-2*l,e.image.height-2*l,a*v,o*v,$*v,n*v)});var B=wa(n);return i.getTriangles().forEach(function(e,t,o){var n=e.source,i=e.target,O=n[0][0],l=n[0][1],s=n[1][0],u=n[1][1],k=n[2][0],v=n[2][1],m=(i[0][0]-B[0])/$,h=-(i[0][1]-B[1])/$,d=(i[1][0]-B[0])/$,f=-(i[1][1]-B[1])/$,x=(i[2][0]-B[0])/$,P=-(i[2][1]-B[1])/$,C=O,M=l;O=0,l=0,s-=C,u-=M,k-=C,v-=M;var T=io([[s,u,0,0,d-m],[k,v,0,0,x-m],[0,0,s,u,f-h],[0,0,k,v,P-h]]);if(T){c.save(),c.beginPath();var E=(m+d+x)/3,j=(h+f+P)/3,q=Bh(E,j,m,h),R=Bh(E,j,d,f),S=Bh(E,j,x,P);c.moveTo(R[0],R[1]),c.lineTo(q[0],q[1]),c.lineTo(S[0],S[1]),c.clip(),c.transform(T[0],T[2],T[1],T[3],m,h),c.translate(p[0]-C,p[3]-M),c.scale(a/r,-a/r),c.drawImage(g.canvas,0,0),c.restore()}}),s&&(c.save(),c.strokeStyle="black",c.lineWidth=1,i.getTriangles().forEach(function(e,t,r){var a=e.target,o=(a[0][0]-B[0])/$,n=-(a[0][1]-B[1])/$,i=(a[1][0]-B[0])/$,O=-(a[1][1]-B[1])/$,l=(a[2][0]-B[0])/$,s=-(a[2][1]-B[1])/$;c.beginPath(),c.moveTo(i,O),c.lineTo(o,n),c.lineTo(l,s),c.closePath(),c.stroke()}),c.restore()),c.canvas}var $s=10,wl=.25,_s=function(){function t(t,r,i,o,e){this.sourceProj_=t,this.targetProj_=r;var s={},d=nd(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var r=t[0]+"/"+t[1];return s[r]||(s[r]=d(t)),s[r]},this.maxSourceExtent_=o,this.errorThresholdSquared_=e*e,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!o&&!!this.sourceProj_.getExtent()&&H(o)==H(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?H(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?H(this.targetProj_.getExtent()):null;var a=wa(i),n=_a(i),h=zb(i),$=Ia(i),u=this.transformInv_(a),m=this.transformInv_(n),g=this.transformInv_(h),_=this.transformInv_($);if(this.addQuad_(a,n,h,$,u,m,g,_,$s),this.wrapsXInSource_){var c=1/0;this.triangles_.forEach(function(t,r,i){c=Math.min(c,t.source[0][0],t.source[1][0],t.source[2][0])}),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-c>this.sourceWorldWidth_/2){var r=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];r[0][0]-c>this.sourceWorldWidth_/2&&(r[0][0]-=this.sourceWorldWidth_),r[1][0]-c>this.sourceWorldWidth_/2&&(r[1][0]-=this.sourceWorldWidth_),r[2][0]-c>this.sourceWorldWidth_/2&&(r[2][0]-=this.sourceWorldWidth_);var i=Math.min(r[0][0],r[1][0],r[2][0]);Math.max(r[0][0],r[1][0],r[2][0])-i<this.sourceWorldWidth_/2&&(t.source=r)}}.bind(this))}s={}}return t.prototype.addTriangle_=function(t,r,i,o,e,s){this.triangles_.push({source:[o,e,s],target:[t,r,i]})},t.prototype.addQuad_=function(t,r,i,o,e,s,d,a,n){var h=A([e,s,d,a]),$=this.sourceWorldWidth_?H(h)/this.sourceWorldWidth_:null,u=this.sourceWorldWidth_,m=this.sourceProj_.canWrapX()&&$>.5&&$<1,g=!1;if(n>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var _=A([t,r,i,o]);g=H(_)/this.targetWorldWidth_>wl||g}!m&&this.sourceProj_.isGlobal()&&$&&(g=$>wl||g)}if(g||!this.maxSourceExtent_||fa(h,this.maxSourceExtent_)){if(!(g||isFinite(e[0])&&isFinite(e[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(d[0])&&isFinite(d[1])&&isFinite(a[0])&&isFinite(a[1]))){if(!(n>0))return;g=!0}if(n>0){if(!g){var c=[(t[0]+i[0])/2,(t[1]+i[1])/2],l=this.transformInv_(c),p=void 0;if(m)p=(Db(e[0],u)+Db(d[0],u))/2-Db(l[0],u);else p=(e[0]+d[0])/2-l[0];var f=(e[1]+d[1])/2-l[1];g=p*p+f*f>this.errorThresholdSquared_}if(g){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){var W=[(r[0]+i[0])/2,(r[1]+i[1])/2],v=this.transformInv_(W),I=[(o[0]+t[0])/2,(o[1]+t[1])/2],x=this.transformInv_(I);this.addQuad_(t,r,W,I,e,s,v,x,n-1),this.addQuad_(I,W,i,o,x,v,d,a,n-1)}else{var E=[(t[0]+r[0])/2,(t[1]+r[1])/2],j=this.transformInv_(E),S=[(i[0]+o[0])/2,(i[1]+o[1])/2],T=this.transformInv_(S);this.addQuad_(t,E,S,o,e,j,T,a,n-1),this.addQuad_(E,r,i,S,j,s,d,T,n-1)}return}}if(m){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(t,i,o,e,d,a),this.addTriangle_(t,r,i,e,s,d)}},t.prototype.calculateSourceExtent=function(){var t=S();return this.triangles_.forEach(function(r,i,o){var e=r.source;Xb(t,e[0]),Xb(t,e[1]),Xb(t,e[2])}),t},t.prototype.getTriangles=function(){return this.triangles_},t}();var at=Ah&&Ah.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),xl=function(t){function e(e,o,r,i,p,s,$,n,a,l,u){var c=t.call(this,p,aa.IDLE)||this;c.renderEdges_=void 0!==u&&u,c.pixelRatio_=$,c.gutter_=n,c.canvas_=null,c.sourceTileGrid_=o,c.targetTileGrid_=i,c.wrappedTileCoord_=s||p,c.sourceTiles_=[],c.sourcesListenerKeys_=null,c.sourceZ_=0;var _=i.getTileCoordExtent(c.wrappedTileCoord_),T=c.targetTileGrid_.getExtent(),M=c.sourceTileGrid_.getExtent(),h=T?Dc(_,T):_;if(0===bf(h))return c.state=aa.EMPTY,c;var g=e.getExtent();g&&(M=M?Dc(M,g):g);var m=i.getResolution(c.wrappedTileCoord_[0]),d=Yb(h),f=Ys(e,r,d,m);if(!isFinite(f)||f<=0)return c.state=aa.EMPTY,c;var E=void 0!==l?l:Xs;if(c.triangulation_=new _s(e,r,h,M,f*E),0===c.triangulation_.getTriangles().length)return c.state=aa.EMPTY,c;c.sourceZ_=o.getZForResolution(f);var v=c.triangulation_.calculateSourceExtent();if(M&&(e.canWrapX()?(v[1]=D(v[1],M[1],M[3]),v[3]=D(v[3],M[1],M[3])):v=Dc(v,M)),bf(v)){for(var S=o.getTileRangeForExtentAndZ(v,c.sourceZ_),y=S.minX;y<=S.maxX;y++)for(var x=S.minY;x<=S.maxY;x++){var R=a(c.sourceZ_,y,x,$);R&&c.sourceTiles_.push(R)}0===c.sourceTiles_.length&&(c.state=aa.EMPTY)}else c.state=aa.EMPTY;return c}return at(e,t),e.prototype.disposeInternal=function(){this.state==aa.LOADING&&this.unlistenSources_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(e,o,r){e&&e.getState()==aa.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=aa.ERROR;else{var e=this.wrappedTileCoord_[0],o=this.targetTileGrid_.getTileSize(e),r="number"==typeof o?o:o[0],i="number"==typeof o?o:o[1],p=this.targetTileGrid_.getResolution(e),s=this.sourceTileGrid_.getResolution(this.sourceZ_),$=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Zs(r,i,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),p,$,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=aa.LOADED}this.changed()},e.prototype.load=function(){if(this.state==aa.IDLE){this.state=aa.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,o,r){var i=e.getState();if(i==aa.IDLE||i==aa.LOADING){t++;var p=f(e,g.CHANGE,function(o){var r=e.getState();r!=aa.LOADED&&r!=aa.ERROR&&r!=aa.EMPTY||(l(p),0===--t&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(p)}}.bind(this)),this.sourceTiles_.forEach(function(t,e,o){t.getState()==aa.IDLE&&t.load()}),0===t&&setTimeout(this.reproject_.bind(this),0)}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(l),this.sourcesListenerKeys_=null},e}(kg);Ah.default=xl;var Ch={};var ie={};function yl(r){var e=r.getDefaultTileGrid();return e||(e=et(r),r.setDefaultTileGrid(e)),e}function bt(r,e,t){var o=e[0],$=r.getTileCoordCenter(e),i=Dh(t);if(Ze(i,$))return e;var n=H(i),g=Math.ceil((i[0]-$[0])/n);return $[0]+=n*g,r.getTileCoordForCoordAndZ($,o)}function ct(r,e,t,o){var $=void 0!==o?o:Ec.TOP_LEFT,i=zl(r,e,t);return new Al({extent:r,origin:Xn(r,$),resolutions:i,tileSize:t})}function dt(r){var e=r||{},t=e.extent||p("EPSG:3857").getExtent(),o={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:zl(t,e.maxZoom,e.tileSize)};return new Al(o)}function zl(r,e,t){for(var o=void 0!==e?e:Zq,$=va(r),i=H(r),n=jb(void 0!==t?t:Ag),g=Math.max(i/n[0],$/n[1]),p=o+1,N=new Array(p),J=0;J<p;++J)N[J]=g/Math.pow(2,J);return N}function et(r,e,t,o){return ct(Dh(r),e,t,o)}function Dh(r){var e=(r=p(r)).getExtent();if(!e){var t=180*ya[P.DEGREES]/r.getMetersPerUnit();e=la(-t,-t,t,t)}return e}var ft=[0,0,0],Al=function(){function t(t){var i;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,q(Sn(this.resolutions_,function(t,i){return i-t},!0),17),!t.origins)for(var e=0,o=this.resolutions_.length-1;e<o;++e)if(i){if(this.resolutions_[e]/this.resolutions_[e+1]!==i){i=void 0;break}}else i=this.resolutions_[e]/this.resolutions_[e+1];this.zoomFactor_=i,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,q(this.origins_.length==this.resolutions_.length,20));var r=t.extent;void 0===r||this.origin_||this.origins_||(this.origin_=wa(r)),q(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,q(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:Ag,q(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==r?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(function(t,i){return new xh(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))},this):r&&this.calculateTileRanges_(r)}return t.prototype.forEachTileCoord=function(t,i,e){for(var o=this.getTileRangeForExtentAndZ(t,i),r=o.minX,n=o.maxX;r<=n;++r)for(var s=o.minY,l=o.maxY;s<=l;++s)e([i,r,s])},t.prototype.forEachTileCoordParentTileRange=function(t,i,e,o){var r,n,s,l=null,h=t[0]-1;for(2===this.zoomFactor_?(n=t[1],s=t[2]):l=this.getTileCoordExtent(t,o);h>=this.minZoom;){if(2===this.zoomFactor_?(n=Math.floor(n/2),s=Math.floor(s/2),r=yh(n,n,s,s,e)):r=this.getTileRangeForExtentAndZ(l,h,e),i(h,r))return!0;--h}return!1},t.prototype.getExtent=function(){return this.extent_},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},t.prototype.getResolution=function(t){return this.resolutions_[t]},t.prototype.getResolutions=function(){return this.resolutions_},t.prototype.getTileCoordChildTileRange=function(t,i,e){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var o=2*t[1],r=2*t[2];return yh(o,o+1,r,r+1,i)}var n=this.getTileCoordExtent(t,e);return this.getTileRangeForExtentAndZ(n,t[0]+1,i)}return null},t.prototype.getTileRangeExtent=function(t,i,e){var o=this.getOrigin(t),r=this.getResolution(t),n=jb(this.getTileSize(t),this.tmpSize_),s=o[0]+i.minX*n[0]*r,l=o[0]+(i.maxX+1)*n[0]*r,h=o[1]+i.minY*n[1]*r,a=o[1]+(i.maxY+1)*n[1]*r;return la(s,h,l,a,e)},t.prototype.getTileRangeForExtentAndZ=function(t,i,e){var o=ft;this.getTileCoordForXYAndZ_(t[0],t[3],i,!1,o);var r=o[1],n=o[2];return this.getTileCoordForXYAndZ_(t[2],t[1],i,!0,o),yh(r,o[1],n,o[2],e)},t.prototype.getTileCoordCenter=function(t){var i=this.getOrigin(t[0]),e=this.getResolution(t[0]),o=jb(this.getTileSize(t[0]),this.tmpSize_);return[i[0]+(t[1]+.5)*o[0]*e,i[1]-(t[2]+.5)*o[1]*e]},t.prototype.getTileCoordExtent=function(t,i){var e=this.getOrigin(t[0]),o=this.getResolution(t[0]),r=jb(this.getTileSize(t[0]),this.tmpSize_),n=e[0]+t[1]*r[0]*o,s=e[1]-(t[2]+1)*r[1]*o,l=n+r[0]*o,h=s+r[1]*o;return la(n,s,l,h,i)},t.prototype.getTileCoordForCoordAndResolution=function(t,i,e){return this.getTileCoordForXYAndResolution_(t[0],t[1],i,!1,e)},t.prototype.getTileCoordForXYAndResolution_=function(t,i,e,o,r){var n=this.getZForResolution(e),s=e/this.getResolution(n),l=this.getOrigin(n),h=jb(this.getTileSize(n),this.tmpSize_),a=o?.5:0,u=o?.5:0,$=Math.floor((t-l[0])/e+a),g=Math.floor((l[1]-i)/e+u),p=s*$/h[0],m=s*g/h[1];return o?(p=Math.ceil(p)-1,m=Math.ceil(m)-1):(p=Math.floor(p),m=Math.floor(m)),tl(n,p,m,r)},t.prototype.getTileCoordForXYAndZ_=function(t,i,e,o,r){var n=this.getOrigin(e),s=this.getResolution(e),l=jb(this.getTileSize(e),this.tmpSize_),h=o?.5:0,a=o?.5:0,u=Math.floor((t-n[0])/s+h),$=Math.floor((n[1]-i)/s+a),g=u/l[0],p=$/l[1];return o?(g=Math.ceil(g)-1,p=Math.ceil(p)-1):(g=Math.floor(g),p=Math.floor(p)),tl(e,g,p,r)},t.prototype.getTileCoordForCoordAndZ=function(t,i,e){return this.getTileCoordForXYAndZ_(t[0],t[1],i,!1,e)},t.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},t.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},t.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},t.prototype.getZForResolution=function(t,i){var e=Ye(this.resolutions_,t,i||0);return D(e,this.minZoom,this.maxZoom)},t.prototype.calculateTileRanges_=function(t){for(var i=this.resolutions_.length,e=new Array(i),o=this.minZoom;o<i;++o)e[o]=this.getTileRangeForExtentAndZ(t,o);this.fullTileRanges_=e},t}();var Bl=ie&&ie.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Cl=function(e){function t(t){var i=e.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX})||this;i.opaque_=void 0!==t.opaque&&t.opaque,i.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,i.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;var r=t.cacheSize;if(void 0===r){var o=[256,256],n=t.tileGrid;n&&jb(n.getTileSize(n.getMinZoom()),o);var s="undefined"!=typeof screen,a=s?screen.availWidth||screen.width:1920,p=s?screen.availHeight||screen.height:1080;r=4*Math.ceil(a/o[0])*Math.ceil(p/o[1])}return i.tileCache=new wh(r),i.tmpSize=[0,0],i.key_=t.key||"",i.tileOptions={transition:t.transition},i.zDirection=t.zDirection?t.zDirection:0,i}return Bl(t,e),t.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},t.prototype.expireCache=function(e,t){var i=this.getTileCacheForProjection(e);i&&i.expireCache(t)},t.prototype.forEachLoadedTile=function(e,t,i,r){var o=this.getTileCacheForProjection(e);if(!o)return!1;for(var n,s,a,p=!0,c=i.minX;c<=i.maxX;++c)for(var l=i.minY;l<=i.maxY;++l)s=he(t,c,l),a=!1,o.containsKey(s)&&(a=(n=o.get(s)).getState()===aa.LOADED)&&(a=!1!==r(n)),a||(p=!1);return p},t.prototype.getGutterForProjection=function(e){return 0},t.prototype.getKey=function(){return this.key_},t.prototype.setKey=function(e){this.key_!==e&&(this.key_=e,this.changed())},t.prototype.getOpaque=function(e){return this.opaque_},t.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},t.prototype.getTile=function(e,t,i,r,o){return a()},t.prototype.getTileGrid=function(){return this.tileGrid},t.prototype.getTileGridForProjection=function(e){return this.tileGrid?this.tileGrid:yl(e)},t.prototype.getTileCacheForProjection=function(e){var t=this.getProjection();return t&&!Bb(t,e)?null:this.tileCache},t.prototype.getTilePixelRatio=function(e){return this.tilePixelRatio_},t.prototype.getTilePixelSize=function(e,t,i){var r=this.getTileGridForProjection(i),o=this.getTilePixelRatio(t),n=jb(r.getTileSize(e),this.tmpSize);return 1==o?n:gr(n,o,this.tmpSize)},t.prototype.getTileCoordForTileUrlFunction=function(e,t){var i=void 0!==t?t:this.getProjection(),r=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=bt(r,e,i)),Qs(e,r)?e:null},t.prototype.clear=function(){this.tileCache.clear()},t.prototype.refresh=function(){this.clear(),e.prototype.refresh.call(this)},t.prototype.useTile=function(e,t,i,r){},t}(fg),Dl=function(e){function t(t,i){var r=e.call(this,t)||this;return r.tile=i,r}return Bl(t,e),t}(L);ie.TileSourceEvent=Dl,ie.default=Cl;var Eh={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};var gt=Ch&&Ch.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),El=function(t){function e(e){var i=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this;return i.generateTileUrlFunction_=!e.tileUrlFunction,i.tileLoadFunction=e.tileLoadFunction,i.tileUrlFunction=e.tileUrlFunction?e.tileUrlFunction.bind(i):Us,i.urls=null,e.urls?i.setUrls(e.urls):e.url&&i.setUrl(e.url),i.tileLoadingKeys_={},i}return gt(e,t),e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var e,i=t.target,r=ba(i),n=i.getState();n==aa.LOADING?(this.tileLoadingKeys_[r]=!0,e=Eh.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],e=n==aa.ERROR?Eh.TILELOADERROR:n==aa.LOADED||n==aa.ABORT?Eh.TILELOADEND:void 0),null!=e&&this.dispatchEvent(new Dl(e,i))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},e.prototype.setUrl=function(t){var e=this.urls=Vs(t);this.setUrls(e)},e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(vl(t,this.tileGrid),e):this.setKey(e)},e.prototype.useTile=function(t,e,i){var r=he(t,e,i);this.tileCache.containsKey(r)&&this.tileCache.get(r)},e}(Cl);Ch.default=El;var ht=zh&&zh.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Fl=function(e){function t(t){var r=e.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:it,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this;return r.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,r.tileClass=void 0!==t.tileClass?t.tileClass:fk,r.tileCacheForProjection={},r.tileGridForProjection={},r.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,r.renderReprojectionEdges_=!1,r}return ht(t,e),t.prototype.canExpireCache=function(){if(!Ua)return e.prototype.canExpireCache.call(this);if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},t.prototype.expireCache=function(t,r){if(Ua){var i=this.getTileCacheForProjection(t);for(var o in this.tileCache.expireCache(this.tileCache==i?r:{}),this.tileCacheForProjection){var n=this.tileCacheForProjection[o];n.expireCache(n==i?r:{})}}else e.prototype.expireCache.call(this,t,r)},t.prototype.getGutterForProjection=function(e){return Ua&&this.getProjection()&&e&&!Bb(this.getProjection(),e)?0:this.getGutter()},t.prototype.getGutter=function(){return 0},t.prototype.getOpaque=function(t){return!(Ua&&this.getProjection()&&t&&!Bb(this.getProjection(),t))&&e.prototype.getOpaque.call(this,t)},t.prototype.getTileGridForProjection=function(t){if(!Ua)return e.prototype.getTileGridForProjection.call(this,t);var r=this.getProjection();if(!this.tileGrid||r&&!Bb(r,t)){var i=ba(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=yl(t)),this.tileGridForProjection[i]}return this.tileGrid},t.prototype.getTileCacheForProjection=function(t){if(!Ua)return e.prototype.getTileCacheForProjection.call(this,t);var r=this.getProjection();if(!r||Bb(r,t))return this.tileCache;var i=ba(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new wh(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]},t.prototype.createTile_=function(e,t,r,i,o,n){var l=[e,t,r],c=this.getTileCoordForTileUrlFunction(l,o),a=c?this.tileUrlFunction(c,i,o):void 0,s=new this.tileClass(l,void 0!==a?aa.IDLE:aa.EMPTY,void 0!==a?a:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return s.key=n,f(s,g.CHANGE,this.handleTileChange,this),s},t.prototype.getTile=function(e,t,r,i,o){var n=this.getProjection();if(Ua&&n&&o&&!Bb(n,o)){var l=this.getTileCacheForProjection(o),c=[e,t,r],a=void 0,s=ul(c);l.containsKey(s)&&(a=l.get(s));var $=this.getKey();if(a&&a.key==$)return a;var p=this.getTileGridForProjection(n),h=this.getTileGridForProjection(o),u=this.getTileCoordForTileUrlFunction(c,o),T=new xl(n,p,o,h,c,u,this.getTilePixelRatio(i),this.getGutter(),function(e,t,r,i){return this.getTileInternal(e,t,r,i,n)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return T.key=$,a?(T.interimTile=a,T.refreshInterimChain(),l.replace(s,T)):l.set(s,T),T}return this.getTileInternal(e,t,r,i,n||o)},t.prototype.getTileInternal=function(e,t,r,i,o){var n=null,l=he(e,t,r),c=this.getKey();if(this.tileCache.containsKey(l)){if((n=this.tileCache.get(l)).key!=c){var a=n;n=this.createTile_(e,t,r,i,o,c),a.getState()==aa.IDLE?n.interimTile=a.interimTile:n.interimTile=a,n.refreshInterimChain(),this.tileCache.replace(l,n)}}else n=this.createTile_(e,t,r,i,o,c),this.tileCache.set(l,n);return n},t.prototype.setRenderReprojectionEdges=function(e){if(Ua&&this.renderReprojectionEdges_!=e){for(var t in this.renderReprojectionEdges_=e,this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}},t.prototype.setTileGridForProjection=function(e,t){if(Ua){var r=p(e);if(r){var i=ba(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=t)}}},t}(El);function it(e,t){e.getImage().src=t}zh.default=Fl;var jt=!0;try{new ImageData(10,10)}catch(_){jt=!1}var kt=document.createElement("canvas").getContext("2d");function lt(a,e,r){if(jt)return new ImageData(a,e,r);var t=kt.createImageData(e,r);return t.data.set(a),t}var mt=lt;var nt=mt;function Gl(e){var t=!0;try{new ImageData(10,10)}catch(a){t=!1}function r(e,r,a){return t?new ImageData(e,r,a):{data:e,width:r,height:a}}return function(t){var a,i,s=t.buffers,n=t.meta,o=t.imageOps,u=t.width,h=t.height,f=s.length,p=s[0].byteLength;if(o){var $=new Array(f);for(i=0;i<f;++i)$[i]=r(new Uint8ClampedArray(s[i]),u,h);a=e($,n).data}else{a=new Uint8ClampedArray(p);var c=new Array(f),_=new Array(f);for(i=0;i<f;++i)c[i]=new Uint8ClampedArray(s[i]),_[i]=[0,0,0,0];for(var v=0;v<p;v+=4){for(var l=0;l<f;++l){var g=c[l];_[l][0]=g[v],_[l][1]=g[v+1],_[l][2]=g[v+2],_[l][3]=g[v+3]}var d=e(_,n);a[v]=d[0],a[v+1]=d[1],a[v+2]=d[2],a[v+3]=d[3]}}return a.buffer}}function ot(e,t){var r=Object.keys(e.lib||{}).map(function(t){return"var "+t+" = "+e.lib[t].toString()+";"}).concat(["var __minion__ = ("+Gl.toString()+")(",e.operation.toString(),");","self.addEventListener(\"message\", function(event) {","  var buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),a=new Blob(r,{type:"text/javascript"}),i=URL.createObjectURL(a),s=new Worker(i);return s.addEventListener("message",t),s}function pt(e,t){var r=Gl(e.operation);return{postMessage:function(e){setTimeout(function(){t({data:{buffer:r(e),meta:e.meta}})},0)}}}function lc(e){var t;this._imageOps=!!e.imageOps;var r=[];if(t=0===e.threads?0:this._imageOps?1:e.threads||1)for(var a=0;a<t;++a)r[a]=ot(e,this._onWorkerMessage.bind(this,a));else r[0]=pt(e,this._onWorkerMessage.bind(this,0));this._workers=r,this._queue=[],this._maxQueueLength=e.queue||1/0,this._running=0,this._dataLookup={},this._job=null}lc.prototype.process=function(e,t,r){this._enqueue({inputs:e,meta:t,callback:r}),this._dispatch()},lc.prototype.destroy=function(){for(var e in this)this[e]=null;this._destroyed=!0},lc.prototype._enqueue=function(e){for(this._queue.push(e);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)},lc.prototype._dispatch=function(){if(0===this._running&&this._queue.length>0){var e=this._job=this._queue.shift(),t=e.inputs[0].width,r=e.inputs[0].height,a=e.inputs.map(function(e){return e.data.buffer}),i=this._workers.length;if(this._running=i,1===i)this._workers[0].postMessage({buffers:a,meta:e.meta,imageOps:this._imageOps,width:t,height:r},a);else for(var s=e.inputs[0].data.length,n=4*Math.ceil(s/4/i),o=0;o<i;++o){for(var u=o*n,h=[],f=0,p=a.length;f<p;++f)h.push(a[o].slice(u,u+n));this._workers[o].postMessage({buffers:h,meta:e.meta,imageOps:this._imageOps,width:t,height:r},h)}}},lc.prototype._onWorkerMessage=function(e,t){this._destroyed||(this._dataLookup[e]=t.data,--this._running,0===this._running&&this._resolveJob())},lc.prototype._resolveJob=function(){var e,t,r=this._job,a=this._workers.length;if(1===a)e=new Uint8ClampedArray(this._dataLookup[0].buffer),t=this._dataLookup[0].meta;else{var i=r.inputs[0].data.length;e=new Uint8ClampedArray(i),t=new Array(i);for(var s=4*Math.ceil(i/4/a),n=0;n<a;++n){var o=this._dataLookup[n].buffer,u=n*s;e.set(new Uint8ClampedArray(o),u),t[n]=this._dataLookup[n].meta}}this._job=null,this._dataLookup={},r.callback(null,nt(e,r.inputs[0].width,r.inputs[0].height),t),this._dispatch()};var Fh={};var Gh={};var je={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};var qt=Gh&&Gh.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t])})(e,t)};return function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),Hl=function(r){function e(e){var t=this,o=e||{},n=$({},o);return delete n.preload,delete n.useInterimTilesOnError,(t=r.call(this,n)||this).setPreload(void 0!==o.preload?o.preload:0),t.setUseInterimTilesOnError(void 0===o.useInterimTilesOnError||o.useInterimTilesOnError),t}return qt(e,r),e.prototype.getPreload=function(){return this.get(je.PRELOAD)},e.prototype.setPreload=function(r){this.set(je.PRELOAD,r)},e.prototype.getUseInterimTilesOnError=function(){return this.get(je.USE_INTERIM_TILES_ON_ERROR)},e.prototype.setUseInterimTilesOnError=function(r){this.set(je.USE_INTERIM_TILES_ON_ERROR,r)},e}(Jf);Gh.default=Hl;var Hh={};var rt=Hh&&Hh.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ih=function(e){function t(t){var r=e.call(this,t)||this;return r.extentChanged=!0,r.renderedExtent_=null,r.renderedRevision,r.renderedTiles=[],r.newTiles_=!1,r.tmpExtent=S(),r.tmpTileRange_=new xh(0,0,0,0),r}return rt(t,e),t.prototype.isDrawableTile=function(e){var t=this.getLayer(),r=e.getState(),i=t.getUseInterimTilesOnError();return r==aa.LOADED||r==aa.EMPTY||r==aa.ERROR&&!i},t.prototype.getTile=function(e,t,r,i){var o=i.pixelRatio,n=i.viewState.projection,a=this.getLayer(),s=a.getSource().getTile(e,t,r,o,n);return s.getState()==aa.ERROR&&(a.getUseInterimTilesOnError()?a.getPreload()>0&&(this.newTiles_=!0):s.setState(aa.LOADED)),this.isDrawableTile(s)||(s=s.getInterimTile()),s},t.prototype.loadedTileCallback=function(t,r,i){return!!this.isDrawableTile(i)&&e.prototype.loadedTileCallback.call(this,t,r,i)},t.prototype.prepareFrame=function(e){return!0},t.prototype.renderFrame=function(e,t){var r=e.layerStatesArray[e.layerIndex],i=e.viewState,o=i.projection,n=i.resolution,a=i.center,s=i.rotation,l=e.pixelRatio,p=this.getLayer(),$=p.getSource(),d=$.getRevision(),h=$.getTileGridForProjection(o),u=h.getZForResolution(n,$.zDirection),c=h.getResolution(u),g=e.extent;r.extent&&(g=Dc(g,r.extent));var T=$.getTilePixelRatio(l),m=Math.round(e.size[0]*T),S=Math.round(e.size[1]*T);s&&(m=S=Math.round(Math.sqrt(m*m+S*S)));var f=c*m/2/T,v=c*S/2/T,I=[a[0]-f,a[1]-v,a[0]+f,a[1]+v],P=h.getTileRangeForExtentAndZ(g,u),x={};x[u]={};var y=this.createLoadedTileFinder($,o,x),R=this.tmpExtent,_=this.tmpTileRange_;this.newTiles_=!1;for(var w=P.minX;w<=P.maxX;++w)for(var C=P.minY;C<=P.maxY;++C){var E=this.getTile(u,w,C,e);if(this.isDrawableTile(E)){var j=ba(this);if(E.getState()==aa.LOADED){x[u][E.tileCoord.toString()]=E;var b=E.inTransition(j);this.newTiles_||!b&&-1!==this.renderedTiles.indexOf(E)||(this.newTiles_=!0)}if(1===E.getAlpha(j,e.time))continue}var O=h.getTileCoordChildTileRange(E.tileCoord,_,R),A=!1;O&&(A=y(u+1,O)),A||h.forEachTileCoordParentTileRange(E.tileCoord,y,_,R)}var D=c/n;Ka(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/T,1/T,s,-m/2,-S/2),this.useContainer(t,this.pixelTransform,r.opacity);var L=this.context,M=L.canvas;pf(this.inversePixelTransform,this.pixelTransform),Ka(this.tempTransform_,m/2,S/2,D,D,0,-m/2,-S/2),M.width!=m||M.height!=S?(M.width=m,M.height=S):this.containerReused||L.clearRect(0,0,m,S),r.extent&&this.clipUnrotated(L,e,r.extent),this.preRender(L,e),this.renderedTiles.length=0;var U,q,F,k=Object.keys(x).map(Number);k.sort(vb),1!==r.opacity||this.containerReused&&!$.getOpaque(e.viewState.projection)?(U=[],q=[]):k=k.reverse();for(var z=k.length-1;z>=0;--z){var Y=k[z],Z=$.getTilePixelSize(Y,l,o),K=h.getResolution(Y)/c,X=Z[0]*K*D,G=Z[1]*K*D,Q=h.getTileCoordForCoordAndZ(wa(I),Y),W=h.getTileCoordExtent(Q),N=da(this.tempTransform_,[T*(W[0]-I[0])/c,T*(I[3]-W[3])/c]),B=T*$.getGutterForProjection(o),H=x[Y];for(var J in H){var V=(E=H[J]).tileCoord,ee=N[0]-(Q[1]-V[1])*X,te=Math.round(ee+X),re=N[1]-(Q[2]-V[2])*G,ie=Math.round(re+G),oe=te-(w=Math.round(ee)),ne=ie-(C=Math.round(re)),ae=u===Y;if(!(b=ae&&1!==E.getAlpha(ba(this),e.time)))if(U){L.save(),F=[w,C,w+oe,C,w+oe,C+ne,w,C+ne];for(var se=0,le=U.length;se<le;++se)if(u!==Y&&Y<q[se]){var pe=U[se];L.beginPath(),L.moveTo(F[0],F[1]),L.lineTo(F[2],F[3]),L.lineTo(F[4],F[5]),L.lineTo(F[6],F[7]),L.moveTo(pe[6],pe[7]),L.lineTo(pe[4],pe[5]),L.lineTo(pe[2],pe[3]),L.lineTo(pe[0],pe[1]),L.clip()}U.push(F),q.push(Y)}else L.clearRect(w,C,oe,ne);this.drawTileImage(E,e,w,C,oe,ne,B,ae,r.opacity),U&&!b&&L.restore(),this.renderedTiles.push(E),this.updateUsedTiles(e.usedTiles,$,E)}}this.renderedRevision=d,this.renderedResolution=c,this.extentChanged=!this.renderedExtent_||!Cc(this.renderedExtent_,I),this.renderedExtent_=I,this.manageTilePyramid(e,$,h,l,o,g,u,p.getPreload()),this.updateCacheSize_(e,$),this.scheduleExpireCache(e,$),this.postRender(L,e),r.extent&&L.restore();var $e=qf(this.pixelTransform);return $e!==M.style.transform&&(M.style.transform=$e),this.container},t.prototype.drawTileImage=function(e,t,r,i,o,n,a,s,l){var p=this.getTileImage(e);if(p){var $=ba(this),d=s?e.getAlpha($,t.time):1,h=l*d,u=h!==this.context.globalAlpha;u&&(this.context.save(),this.context.globalAlpha=h),this.context.drawImage(p,a,a,p.width-2*a,p.height-2*a,r,i,o,n),u&&this.context.restore(),1!==d?t.animate=!0:s&&e.endTransition($)}},t.prototype.getImage=function(){var e=this.context;return e?e.canvas:null},t.prototype.getTileImage=function(e){return e.getImage()},t.prototype.scheduleExpireCache=function(e,t){if(t.canExpireCache()){var r=function(e,t,r){var i=ba(e);i in r.usedTiles&&e.expireCache(r.viewState.projection,r.usedTiles[i])}.bind(null,t);e.postRenderFunctions.push(r)}},t.prototype.updateUsedTiles=function(e,t,r){var i=ba(t);i in e||(e[i]={}),e[i][r.getKey()]=!0},t.prototype.updateCacheSize_=function(e,t){var r=ba(t),i=0;r in e.usedTiles&&(i+=Object.keys(e.usedTiles[r]).length),r in e.wantedTiles&&(i+=Object.keys(e.wantedTiles[r]).length);var o=t.tileCache;o.highWaterMark<i&&(o.highWaterMark=i)},t.prototype.manageTilePyramid=function(e,t,r,i,o,n,a,s,l){var p=ba(t);p in e.wantedTiles||(e.wantedTiles[p]={});var $,d,h,u,c,g,T=e.wantedTiles[p],m=e.tileQueue;for(g=r.getMinZoom();g<=a;++g)for(d=r.getTileRangeForExtentAndZ(n,g,d),h=r.getResolution(g),u=d.minX;u<=d.maxX;++u)for(c=d.minY;c<=d.maxY;++c)a-g<=s?(($=t.getTile(g,u,c,i,o)).getState()==aa.IDLE&&(T[$.getKey()]=!0,m.isKeyQueued($.getKey())||m.enqueue([$,p,r.getTileCoordCenter($.tileCoord),h])),void 0!==l&&l($)):t.useTile(g,u,c,o)},t}(bg);Ih.prototype.getLayer,Hh.default=Ih;var st=Fh&&Fh.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t])})(e,t)};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Il=function(r){function e(e){return r.call(this,e)||this}return st(e,r),e.prototype.createRenderer=function(){return new Ih(this)},e}(Hl);Fh.default=Il;var Jh={};var tt=Jh&&Jh.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Jl=function(t){function e(e){var r=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,projection:p("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:za.LOADING,tileLoadFunction:e.tileLoadFunction,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition})||this;if(r.tileJSON_=null,r.tileSize_=e.tileSize,e.url){if(e.jsonp)Ws(e.url,r.handleTileJSONResponse.bind(r),r.handleTileJSONError.bind(r));else{var i=new XMLHttpRequest;i.addEventListener("load",r.onXHRLoad_.bind(r)),i.addEventListener("error",r.onXHRError_.bind(r)),i.open("GET",e.url),i.send()}}else e.tileJSON?r.handleTileJSONResponse(e.tileJSON):q(!1,51);return r}return tt(e,t),e.prototype.onXHRLoad_=function(t){var e=t.target;if(!e.status||e.status>=200&&e.status<300){var r=void 0;try{r=JSON.parse(e.responseText)}catch(i){return void this.handleTileJSONError()}this.handleTileJSONResponse(r)}else this.handleTileJSONError()},e.prototype.onXHRError_=function(t){this.handleTileJSONError()},e.prototype.getTileJSON=function(){return this.tileJSON_},e.prototype.handleTileJSONResponse=function(t){var e,r=p("EPSG:4326"),i=this.getProjection();if(void 0!==t.bounds){var o=Zb(r,i);e=$n(t.bounds,o)}var n=t.minzoom||0,s=t.maxzoom||22,c=dt({extent:Dh(i),maxZoom:s,minZoom:n,tileSize:this.tileSize_});if(this.tileGrid=c,this.tileUrlFunction=vl(t.tiles,c),void 0!==t.attribution&&!this.getAttributions()){var a=void 0!==e?e:r.getExtent();this.setAttributions(function(e){return fa(a,e.extent)?[t.attribution]:null})}this.tileJSON_=t,this.setState(za.READY)},e.prototype.handleTileJSONError=function(){this.setState(za.ERROR)},e}(Fl);Jh.default=Jl;var Kl=function(){function t(){this.dataProjection=null,this.defaultFeatureProjection=null}return t.prototype.getReadOptions=function(t,e){var r;if(e){var o=e.dataProjection?p(e.dataProjection):this.readProjection(t);e.extent&&o&&o.getUnits()===P.TILE_PIXELS&&(o=p(o)).setWorldExtent(e.extent),r={dataProjection:o,featureProjection:e.featureProjection}}return this.adaptOptions(r)},t.prototype.adaptOptions=function(t){return $({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},t)},t.prototype.getType=function(){return a()},t.prototype.readFeature=function(t,e){return a()},t.prototype.readFeatures=function(t,e){return a()},t.prototype.readGeometry=function(t,e){return a()},t.prototype.readProjection=function(t){return a()},t.prototype.writeFeature=function(t,e){return a()},t.prototype.writeFeatures=function(t,e){return a()},t.prototype.writeGeometry=function(t,e){return a()},t}();function mb(t,e,r){var o,n=r?p(r.featureProjection):null,i=r?p(r.dataProjection):null;if(o=n&&i&&!Bb(n,i)?(e?t.clone():t).transform(e?n:i,e?i:n):t,e&&r&&void 0!==r.decimals){var u=Math.pow(10,r.decimals);o===t&&(o=t.clone()),o.applyTransform(function(t){for(var e=0,r=t.length;e<r;++e)t[e]=Math.round(t[e]*u)/u;return t})}return o}var Kh={};var ut=Kh&&Kh.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),Ll=function(t){function r(){return t.call(this)||this}return ut(r,t),r.prototype.getType=function(){return Nb.JSON},r.prototype.readFeature=function(t,r){return this.readFeatureFromObject(ke(t),this.getReadOptions(t,r))},r.prototype.readFeatures=function(t,r){return this.readFeaturesFromObject(ke(t),this.getReadOptions(t,r))},r.prototype.readFeatureFromObject=function(t,r){return a()},r.prototype.readFeaturesFromObject=function(t,r){return a()},r.prototype.readGeometry=function(t,r){return this.readGeometryFromObject(ke(t),this.getReadOptions(t,r))},r.prototype.readGeometryFromObject=function(t,r){return a()},r.prototype.readProjection=function(t){return this.readProjectionFromObject(ke(t))},r.prototype.readProjectionFromObject=function(t){return a()},r.prototype.writeFeature=function(t,r){return JSON.stringify(this.writeFeatureObject(t,r))},r.prototype.writeFeatureObject=function(t,r){return a()},r.prototype.writeFeatures=function(t,r){return JSON.stringify(this.writeFeaturesObject(t,r))},r.prototype.writeFeaturesObject=function(t,r){return a()},r.prototype.writeGeometry=function(t,r){return JSON.stringify(this.writeGeometryObject(t,r))},r.prototype.writeGeometryObject=function(t,r){return a()},r}(Kl);function ke(t){if("string"==typeof t){var r=JSON.parse(t);return r||null}return null!==t?t:null}Kh.default=Ll;var Lh={};var Mh={};var vt=Mh&&Mh.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ml=function(e){function t(t){var r=e.call(this)||this;return r.geometries_=t||null,r.listenGeometriesChange_(),r}return vt(t,e),t.prototype.unlistenGeometriesChange_=function(){if(this.geometries_)for(var e=0,t=this.geometries_.length;e<t;++e)ka(this.geometries_[e],g.CHANGE,this.changed,this)},t.prototype.listenGeometriesChange_=function(){if(this.geometries_)for(var e=0,t=this.geometries_.length;e<t;++e)f(this.geometries_[e],g.CHANGE,this.changed,this)},t.prototype.clone=function(){var e=new t(null);return e.setGeometries(this.geometries_),e},t.prototype.closestPointXY=function(e,t,r,i){if(i<xb(this.getExtent(),e,t))return i;for(var o=this.geometries_,n=0,s=o.length;n<s;++n)i=o[n].closestPointXY(e,t,r,i);return i},t.prototype.containsXY=function(e,t){for(var r=this.geometries_,i=0,o=r.length;i<o;++i)if(r[i].containsXY(e,t))return!0;return!1},t.prototype.computeExtent=function(e){Wb(e);for(var t=this.geometries_,r=0,i=t.length;r<i;++r)af(e,t[r].getExtent());return e},t.prototype.getGeometries=function(){return Nl(this.geometries_)},t.prototype.getGeometriesArray=function(){return this.geometries_},t.prototype.getSimplifiedGeometry=function(e){if(this.simplifiedGeometryRevision!=this.getRevision()&&($a(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;var r=e.toString();if(this.simplifiedGeometryCache.hasOwnProperty(r))return this.simplifiedGeometryCache[r];for(var i=[],o=this.geometries_,n=!1,s=0,p=o.length;s<p;++s){var a=o[s],g=a.getSimplifiedGeometry(e);i.push(g),g!==a&&(n=!0)}if(n){var h=new t(null);return h.setGeometriesArray(i),this.simplifiedGeometryCache[r]=h,h}return this.simplifiedGeometryMaxMinSquaredTolerance=e,this},t.prototype.getType=function(){return b.GEOMETRY_COLLECTION},t.prototype.intersectsExtent=function(e){for(var t=this.geometries_,r=0,i=t.length;r<i;++r)if(t[r].intersectsExtent(e))return!0;return!1},t.prototype.isEmpty=function(){return 0===this.geometries_.length},t.prototype.rotate=function(e,t){for(var r=this.geometries_,i=0,o=r.length;i<o;++i)r[i].rotate(e,t);this.changed()},t.prototype.scale=function(e,t,r){var i=r;i||(i=Yb(this.getExtent()));for(var o=this.geometries_,n=0,s=o.length;n<s;++n)o[n].scale(e,t,i);this.changed()},t.prototype.setGeometries=function(e){this.setGeometriesArray(Nl(e))},t.prototype.setGeometriesArray=function(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()},t.prototype.applyTransform=function(e){for(var t=this.geometries_,r=0,i=t.length;r<i;++r)t[r].applyTransform(e);this.changed()},t.prototype.translate=function(e,t){for(var r=this.geometries_,i=0,o=r.length;i<o;++i)r[i].translate(e,t);this.changed()},t.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),e.prototype.disposeInternal.call(this)},t}(rf);function Nl(e){for(var t=[],r=0,i=e.length;r<i;++r)t.push(e[r].clone());return t}Mh.default=Ml;var wt=Lh&&Lh.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function o(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),Ol=function(e){function r(r){var t=this,o=r||{};return(t=e.call(this)||this).dataProjection=p(o.dataProjection?o.dataProjection:"EPSG:4326"),o.featureProjection&&(t.defaultFeatureProjection=p(o.featureProjection)),t.geometryName_=o.geometryName,t.extractGeometryName_=o.extractGeometryName,t}return wt(r,e),r.prototype.readFeatureFromObject=function(e,r){var t=null,o=Nh((t="Feature"===e.type?e:{type:"Feature",geometry:e,properties:null}).geometry,r),i=new K;return this.geometryName_?i.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in t!==void 0&&i.setGeometryName(t.geometry_name),i.setGeometry(o),"id"in t&&i.setId(t.id),t.properties&&i.setProperties(t.properties,!0),i},r.prototype.readFeaturesFromObject=function(e,r){var t=null;if("FeatureCollection"===e.type){t=[];for(var o=e.features,i=0,$=o.length;i<$;++i)t.push(this.readFeatureFromObject(o[i],r))}else t=[this.readFeatureFromObject(e,r)];return t},r.prototype.readGeometryFromObject=function(e,r){return Nh(e,r)},r.prototype.readProjectionFromObject=function(e){var r,t=e.crs;return t?"name"==t.type?r=p(t.properties.name):q(!1,36):r=this.dataProjection,r},r.prototype.writeFeatureObject=function(e,r){r=this.adaptOptions(r);var t={type:"Feature",geometry:null,properties:null},o=e.getId();void 0!==o&&(t.id=o);var i=e.getGeometry();i&&(t.geometry=Oh(i,r));var $=e.getProperties();return delete $[e.getGeometryName()],Vb($)||(t.properties=$),t},r.prototype.writeFeaturesObject=function(e,r){r=this.adaptOptions(r);for(var t=[],o=0,i=e.length;o<i;++o)t.push(this.writeFeatureObject(e[o],r));return{type:"FeatureCollection",features:t}},r.prototype.writeGeometryObject=function(e,r){return Oh(e,this.adaptOptions(r))},r}(Ll);function Nh(e,r){if(!e)return null;var t;switch(e.type){case b.POINT:t=yt(e);break;case b.LINE_STRING:t=zt(e);break;case b.POLYGON:t=Dt(e);break;case b.MULTI_POINT:t=Bt(e);break;case b.MULTI_LINE_STRING:t=At(e);break;case b.MULTI_POLYGON:t=Ct(e);break;case b.GEOMETRY_COLLECTION:t=xt(e);break;default:throw new Error("Unsupported GeoJSON type: "+e.type);}return mb(t,!1,r)}function xt(e,r){var t=e.geometries.map(function(e){return Nh(e,r)});return new Ml(t)}function yt(e){return new na(e.coordinates)}function zt(e){return new Da(e.coordinates)}function At(e){return new be(e.coordinates)}function Bt(e){return new ce(e.coordinates)}function Ct(e){return new nh(e.coordinates)}function Dt(e){return new oa(e.coordinates)}function Oh(e,r){var t,o=(e=mb(e,!0,r)).getType();switch(o){case b.POINT:t=Jt(e,r);break;case b.LINE_STRING:t=Ft(e,r);break;case b.POLYGON:t=Kt(e,r);break;case b.MULTI_POINT:t=Ht(e,r);break;case b.MULTI_LINE_STRING:t=Gt(e,r);break;case b.MULTI_POLYGON:t=It(e,r);break;case b.GEOMETRY_COLLECTION:t=Et(e,r);break;case b.CIRCLE:t={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+o);}return t}function Et(e,r){return{type:"GeometryCollection",geometries:e.getGeometriesArray().map(function(e){var t=$({},r);return delete t.featureProjection,Oh(e,t)})}}function Ft(e,r){return{type:"LineString",coordinates:e.getCoordinates()}}function Gt(e,r){return{type:"MultiLineString",coordinates:e.getCoordinates()}}function Ht(e,r){return{type:"MultiPoint",coordinates:e.getCoordinates()}}function It(e,r){var t;return r&&(t=r.rightHanded),{type:"MultiPolygon",coordinates:e.getCoordinates(t)}}function Jt(e,r){return{type:"Point",coordinates:e.getCoordinates()}}function Kt(e,r){var t;return r&&(t=r.rightHanded),{type:"Polygon",coordinates:e.getCoordinates(t)}}Lh.default=Ol;var Ph={};var _c=document.implementation.createDocument("","",null);var Pl="http://www.w3.org/2001/XMLSchema-instance";function Qh(e,r){return _c.createElementNS(e,r)}function le(e,r){return Ql(e,r,[]).join("")}function Ql(e,r,t){if(e.nodeType==Node.CDATA_SECTION_NODE||e.nodeType==Node.TEXT_NODE)r?t.push(String(e.nodeValue).replace(/(\r\n|\r|\n)/g,"")):t.push(e.nodeValue);else{var $=void 0;for($=e.firstChild;$;$=$.nextSibling)Ql($,r,t)}return t}function me(e){return"documentElement"in e}function ne(e){return new DOMParser().parseFromString(e,"application/xml")}function Rh(e,r){return function(t,$){var o=e.call(void 0!==r?r:this,t,$);void 0!==o&&$[$.length-1].push(o)}}function h(e,r,t){return function($,o){var n=e.call(void 0!==t?t:this,$,o);void 0!==n&&(o[o.length-1][void 0!==r?r:$.localName]=n)}}function c(e,r){return function(t,$,o){e.call(void 0!==r?r:this,t,$,o),o[o.length-1].node.appendChild(t)}}function Rl(e,r){var t,$;return function(r,o,n){if(void 0===t){t={};var p={};p[r.localName]=e,t[r.namespaceURI]=p,$=Sh(r.localName)}Sl(t,$,o,n)}}function Sh(e,r){var t=e;return function(e,$,o){var n=$[$.length-1].node,p=t;return void 0===p&&(p=o),Qh(void 0!==r?r:n.namespaceURI,p)}}var oe=Sh();function Th(e,r){for(var t=r.length,$=new Array(t),o=0;o<t;++o)$[o]=e[r[o]];return $}function I(e,r,t){var $,o,n=void 0!==t?t:{};for($=0,o=e.length;$<o;++$)n[e[$]]=r;return n}function Uh(e,r,t,$){var o;for(o=r.firstElementChild;o;o=o.nextElementSibling){var n=e[o.namespaceURI];if(void 0!==n){var p=n[o.localName];void 0!==p&&p.call($,o,t)}}}function mc(e,r,t,$,o){return $.push(e),Uh(r,t,$,o),$.pop()}function Sl(e,r,t,$,o,n){for(var p,a,i=(void 0!==o?o:t).length,O=0;O<i;++O)void 0!==(p=t[O])&&void 0!==(a=r.call(void 0!==n?n:this,p,$,void 0!==o?o[O]:void 0))&&e[a.namespaceURI][a.localName].call(n,a,p,$)}function nc(e,r,t,$,o,n,p){return o.push(e),Sl(r,t,$,o,n,p),o.pop()}var Lt=Ph&&Ph.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t])})(e,t)};return function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),Tl=function(r){function e(){var e=r.call(this)||this;return e.xmlSerializer_=new XMLSerializer,e}return Lt(e,r),e.prototype.getType=function(){return Nb.XML},e.prototype.readFeature=function(r,e){if(r){if("string"==typeof r){var t=ne(r);return this.readFeatureFromDocument(t,e)}return me(r)?this.readFeatureFromDocument(r,e):this.readFeatureFromNode(r,e)}return null},e.prototype.readFeatureFromDocument=function(r,e){var t=this.readFeaturesFromDocument(r,e);return t.length>0?t[0]:null},e.prototype.readFeatureFromNode=function(r,e){return null},e.prototype.readFeatures=function(r,e){if(r){if("string"==typeof r){var t=ne(r);return this.readFeaturesFromDocument(t,e)}return me(r)?this.readFeaturesFromDocument(r,e):this.readFeaturesFromNode(r,e)}return[]},e.prototype.readFeaturesFromDocument=function(r,e){for(var t=[],o=r.firstChild;o;o=o.nextSibling)o.nodeType==Node.ELEMENT_NODE&&X(t,this.readFeaturesFromNode(o,e));return t},e.prototype.readFeaturesFromNode=function(r,e){return a()},e.prototype.readGeometry=function(r,e){if(r){if("string"==typeof r){var t=ne(r);return this.readGeometryFromDocument(t,e)}return me(r)?this.readGeometryFromDocument(r,e):this.readGeometryFromNode(r,e)}return null},e.prototype.readGeometryFromDocument=function(r,e){return null},e.prototype.readGeometryFromNode=function(r,e){return null},e.prototype.readProjection=function(r){if(r){if("string"==typeof r){var e=ne(r);return this.readProjectionFromDocument(e)}return me(r)?this.readProjectionFromDocument(r):this.readProjectionFromNode(r)}return null},e.prototype.readProjectionFromDocument=function(r){return this.dataProjection},e.prototype.readProjectionFromNode=function(r){return this.dataProjection},e.prototype.writeFeature=function(r,e){var t=this.writeFeatureNode(r,e);return this.xmlSerializer_.serializeToString(t)},e.prototype.writeFeatureNode=function(r,e){return null},e.prototype.writeFeatures=function(r,e){var t=this.writeFeaturesNode(r,e);return this.xmlSerializer_.serializeToString(t)},e.prototype.writeFeaturesNode=function(r,e){return null},e.prototype.writeGeometry=function(r,e){var t=this.writeGeometryNode(r,e);return this.xmlSerializer_.serializeToString(t)},e.prototype.writeGeometryNode=function(r,e){return null},e}(Kl);Ph.default=Tl;function Vh(e){var t=le(e,!1),o=Date.parse(t);return isNaN(o)?void 0:o/1e3}function Va(e){return Mt(le(e,!1))}function Mt(e){var t=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(e);return t?parseFloat(t[1]):void 0}function pe(e){return Nt(le(e,!1))}function Nt(e){var t=/^\s*(\d+)\s*$/.exec(e);return t?parseInt(t[1],10):void 0}function r(e){return le(e,!1).trim()}function Ot(e,t){var o=new Date(1e3*t),r=o.getUTCFullYear()+"-"+Tc(o.getUTCMonth()+1,2)+"-"+Tc(o.getUTCDate(),2)+"T"+Tc(o.getUTCHours(),2)+":"+Tc(o.getUTCMinutes(),2)+":"+Tc(o.getUTCSeconds(),2)+"Z";e.appendChild(_c.createTextNode(r))}function Rb(e,t){var o=t.toPrecision();e.appendChild(_c.createTextNode(o))}function qe(e,t){var o=t.toString();e.appendChild(_c.createTextNode(o))}function t(e,t){e.appendChild(_c.createTextNode(t))}var Wh={};var Pt=Wh&&Wh.__extends||function(){var e=function($,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,$){e.__proto__=$}||function(e,$){for(var r in $)$.hasOwnProperty(r)&&(e[r]=$[r])})($,r)};return function($,r){function t(){this.constructor=$}e($,r),$.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}(),n=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],Qt="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",Rt={rte:Vl,trk:Wl,wpt:Xl},St=I(n,{rte:Rh(Vl),trk:Rh(Wl),wpt:Rh(Xl)}),Tt=I(n,{text:h(r,"linkText"),type:h(r,"linkType")}),Ut=I(n,{rte:c(pu),trk:c(qu),wpt:c(su)}),Ul=function(e){function $($){var r=e.call(this)||this,t=$||{};return r.dataProjection=p("EPSG:4326"),r.readExtensions_=t.readExtensions,r}return Pt($,e),$.prototype.handleReadExtensions_=function(e){e||(e=[]);for(var $=0,r=e.length;$<r;++$){var t=e[$];if(this.readExtensions_){var i=t.get("extensionsNode_")||null;this.readExtensions_(t,i)}t.set("extensionsNode_",void 0)}},$.prototype.readFeatureFromNode=function(e,$){if(!wb(n,e.namespaceURI))return null;var r=Rt[e.localName];if(!r)return null;var t=r(e,[this.getReadOptions(e,$)]);return t?(this.handleReadExtensions_([t]),t):null},$.prototype.readFeaturesFromNode=function(e,$){if(!wb(n,e.namespaceURI))return[];if("gpx"==e.localName){var r=mc([],St,e,[this.getReadOptions(e,$)]);return r?(this.handleReadExtensions_(r),r):[]}return[]},$.prototype.writeFeaturesNode=function(e,$){$=this.adaptOptions($);var r=Qh("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",Pl),r.setAttributeNS(Pl,"xsi:schemaLocation",Qt),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),nc({node:r},Ut,lu,e,[$]),r},$}(Tl),Vt=I(n,{name:h(r),cmt:h(r),desc:h(r),src:h(r),link:Zh,number:h(pe),extensions:$h,type:h(r),rtept:mu}),Wt=I(n,{ele:h(Va),time:h(Vh)}),Xt=I(n,{name:h(r),cmt:h(r),desc:h(r),src:h(r),link:Zh,number:h(pe),type:h(r),extensions:$h,trkseg:ou}),Yt=I(n,{trkpt:nu}),Zt=I(n,{ele:h(Va),time:h(Vh)}),$t=I(n,{ele:h(Va),time:h(Vh),magvar:h(Va),geoidheight:h(Va),name:h(r),cmt:h(r),desc:h(r),src:h(r),link:Zh,sym:h(r),type:h(r),fix:h(r),sat:h(pe),hdop:h(Va),vdop:h(Va),pdop:h(Va),ageofdgpsdata:h(Va),dgpsid:h(pe),extensions:$h}),_t=["text","type"],au=I(n,{text:c(t),type:c(t)}),bu=I(n,["name","cmt","desc","src","link","number","type","rtept"]),cu=I(n,{name:c(t),cmt:c(t),desc:c(t),src:c(t),link:c(_h),number:c(qe),type:c(t),rtept:Rl(c(ai))}),du=I(n,["ele","time"]),eu=I(n,["name","cmt","desc","src","link","number","type","trkseg"]),fu=I(n,{name:c(t),cmt:c(t),desc:c(t),src:c(t),link:c(_h),number:c(qe),type:c(t),trkseg:Rl(c(ru))}),gu=Sh("trkpt"),hu=I(n,{trkpt:c(ai)}),iu=I(n,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),ju=I(n,{ele:c(Rb),time:c(Ot),magvar:c(Rb),geoidheight:c(Rb),name:c(t),cmt:c(t),desc:c(t),src:c(t),link:c(_h),sym:c(t),type:c(t),fix:c(t),sat:c(qe),hdop:c(Rb),vdop:c(Rb),pdop:c(Rb),ageofdgpsdata:c(Rb),dgpsid:c(qe)}),ku={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function lu(e,$,r){var t=e.getGeometry();if(t){var i=ku[t.getType()];if(i){var o=$[$.length-1].node;return Qh(o.namespaceURI,i)}}}function Xh(e,$,r,t){return e.push(parseFloat(r.getAttribute("lon")),parseFloat(r.getAttribute("lat"))),"ele"in t?(e.push(t.ele),delete t.ele,$.hasZ=!0):e.push(0),"time"in t?(e.push(t.time),delete t.time,$.hasM=!0):e.push(0),e}function Yh(e,$,r){var t=u.XY,i=2;if(e.hasZ&&e.hasM?(t=u.XYZM,i=4):e.hasZ?(t=u.XYZ,i=3):e.hasM&&(t=u.XYM,i=3),4!==i){for(var o=0,a=$.length/4;o<a;o++)$[o*i]=$[4*o],$[o*i+1]=$[4*o+1],e.hasZ&&($[o*i+2]=$[4*o+2]),e.hasM&&($[o*i+2]=$[4*o+3]);if($.length=$.length/4*i,r)for(o=0,a=r.length;o<a;o++)r[o]=r[o]/4*i}return t}function Zh(e,$){var r=$[$.length-1],t=e.getAttribute("href");null!==t&&(r.link=t),Uh(Tt,e,$)}function $h(e,$){$[$.length-1].extensionsNode_=e}function mu(e,$){var r=mc({},Wt,e,$);if(r){var t=$[$.length-1];Xh(t.flatCoordinates,t.layoutOptions,e,r)}}function nu(e,$){var r=mc({},Zt,e,$);if(r){var t=$[$.length-1];Xh(t.flatCoordinates,t.layoutOptions,e,r)}}function ou(e,$){var r=$[$.length-1];Uh(Yt,e,$);var t=r.flatCoordinates;r.ends.push(t.length)}function Vl(e,$){var r=$[0],t=mc({flatCoordinates:[],layoutOptions:{}},Vt,e,$);if(t){var i=t.flatCoordinates;delete t.flatCoordinates;var o=t.layoutOptions;delete t.layoutOptions;var a=Yh(o,i),p=new Da(i,a);mb(p,!1,r);var v=new K(p);return v.setProperties(t,!0),v}}function Wl(e,$){var r=$[0],t=mc({flatCoordinates:[],ends:[],layoutOptions:{}},Xt,e,$);if(t){var i=t.flatCoordinates;delete t.flatCoordinates;var o=t.ends;delete t.ends;var a=t.layoutOptions;delete t.layoutOptions;var p=Yh(a,i,o),v=new be(i,p,o);mb(v,!1,r);var g=new K(v);return g.setProperties(t,!0),g}}function Xl(e,$){var r=$[0],t=mc({},$t,e,$);if(t){var i={},o=Xh([],i,e,t),a=Yh(i,o),p=new na(o,a);mb(p,!1,r);var v=new K(p);return v.setProperties(t,!0),v}}function _h(e,$,r){e.setAttribute("href",$);var t=r[r.length-1].properties,i=[t.linkText,t.linkType];nc({node:e},au,oe,i,r,_t)}function ai(e,$,r){var t=r[r.length-1],i=t.node.namespaceURI,o=t.properties;switch(e.setAttributeNS(null,"lat",String($[1])),e.setAttributeNS(null,"lon",String($[0])),t.geometryLayout){case u.XYZM:0!==$[3]&&(o.time=$[3]);case u.XYZ:0!==$[2]&&(o.ele=$[2]);break;case u.XYM:0!==$[2]&&(o.time=$[2]);}var a="rtept"==e.nodeName?du[i]:iu[i],p=Th(o,a);nc({node:e,properties:o},ju,oe,p,r,a)}function pu(e,$,r){var t=r[0],i=$.getProperties(),o={node:e};o.properties=i;var a=$.getGeometry();if(a.getType()==b.LINE_STRING){var p=mb(a,!0,t);o.geometryLayout=p.getLayout(),i.rtept=p.getCoordinates()}var v=r[r.length-1].node,g=bu[v.namespaceURI],O=Th(i,g);nc(o,cu,oe,O,r,g)}function qu(e,$,r){var t=r[0],i=$.getProperties(),o={node:e};o.properties=i;var a=$.getGeometry();if(a.getType()==b.MULTI_LINE_STRING){var p=mb(a,!0,t);i.trkseg=p.getLineStrings()}var v=r[r.length-1].node,g=eu[v.namespaceURI],O=Th(i,g);nc(o,fu,oe,O,r,g)}function ru(e,$,r){var t={node:e};t.geometryLayout=$.getLayout(),t.properties={},nc(t,hu,gu,$.getCoordinates(),r)}function su(e,$,r){var t=r[0],i=r[r.length-1];i.properties=$.getProperties();var o=$.getGeometry();if(o.getType()==b.POINT){var a=mb(o,!0,t);i.geometryLayout=a.getLayout(),ai(e,a.getCoordinates(),r)}}Wh.default=Ul;var Yl=function(t,r,o,a,$){var e,p,J=8*$-a-1,N=(1<<J)-1,h=N>>1,M=-7,w=o?$-1:0,f=o?-1:1,i=t[r+w];for(w+=f,e=i&(1<<-M)-1,i>>=-M,M+=J;M>0;e=256*e+t[r+w],w+=f,M-=8);for(p=e&(1<<-M)-1,e>>=-M,M+=a;M>0;p=256*p+t[r+w],w+=f,M-=8);if(0===e)e=1-h;else{if(e===N)return p?NaN:1/0*(i?-1:1);p+=Math.pow(2,a),e-=h}return(i?-1:1)*p*Math.pow(2,e-a)};var Zl=function(t,r,o,a,$,e){var p,J,N,h=8*e-$-1,M=(1<<h)-1,w=M>>1,f=23===$?Math.pow(2,-24)-Math.pow(2,-77):0,i=a?0:e-1,g=a?1:-1,s=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(J=isNaN(r)?1:0,p=M):(p=Math.floor(Math.log(r)/Math.LN2),r*(N=Math.pow(2,-p))<1&&(p--,N*=2),(r+=p+w>=1?f/N:f*Math.pow(2,1-w))*N>=2&&(p++,N/=2),p+w>=M?(J=0,p=M):p+w>=1?(J=(r*N-1)*Math.pow(2,$),p+=w):(J=r*Math.pow(2,w-1)*Math.pow(2,$),p=0));$>=8;t[o+i]=255&J,i+=g,J/=256,$-=8);for(p=p<<$|J,h+=$;h>0;t[o+i]=255&p,i+=g,p/=256,h-=8);t[o+i-g]|=128*s};function m(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}m.Varint=0,m.Fixed64=1,m.Bytes=2,m.Fixed32=5;var bi=4294967296,$l=1/bi;function tu(t,i,r){var e,a,s=r.buf;if(e=(112&(a=s[r.pos++]))>>4,a<128)return oc(t,e,i);if(e|=(127&(a=s[r.pos++]))<<3,a<128)return oc(t,e,i);if(e|=(127&(a=s[r.pos++]))<<10,a<128)return oc(t,e,i);if(e|=(127&(a=s[r.pos++]))<<17,a<128)return oc(t,e,i);if(e|=(127&(a=s[r.pos++]))<<24,a<128)return oc(t,e,i);if(e|=(1&(a=s[r.pos++]))<<31,a<128)return oc(t,e,i);throw new Error("Expected varint not more than 10 bytes")}function Wa(t){return t.type===m.Bytes?t.readVarint()+t.pos:t.pos+1}function oc(t,i,r){return r?4294967296*i+(t>>>0):4294967296*(i>>>0)+(t>>>0)}function uu(t,i){var r,e;if(t>=0?(r=t%4294967296|0,e=t/4294967296|0):(e=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:(r=0,e=e+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),vu(r,e,i),wu(e,i)}function vu(t,i,r){r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos]=127&t}function wu(t,i){var r=(7&t)<<4;i.buf[i.pos++]|=r|((t>>>=3)?128:0),t&&(i.buf[i.pos++]=127&t|((t>>>=7)?128:0),t&&(i.buf[i.pos++]=127&t|((t>>>=7)?128:0),t&&(i.buf[i.pos++]=127&t|((t>>>=7)?128:0),t&&(i.buf[i.pos++]=127&t|((t>>>=7)?128:0),t&&(i.buf[i.pos++]=127&t)))))}function _l(t,i,r){var e=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));r.realloc(e);for(var a=r.pos-1;a>=t;a--)r.buf[a+e]=r.buf[a]}function xu(t,i){for(var r=0;r<t.length;r++)i.writeVarint(t[r])}function yu(t,i){for(var r=0;r<t.length;r++)i.writeSVarint(t[r])}function zu(t,i){for(var r=0;r<t.length;r++)i.writeFloat(t[r])}function Au(t,i){for(var r=0;r<t.length;r++)i.writeDouble(t[r])}function Bu(t,i){for(var r=0;r<t.length;r++)i.writeBoolean(t[r])}function Cu(t,i){for(var r=0;r<t.length;r++)i.writeFixed32(t[r])}function Du(t,i){for(var r=0;r<t.length;r++)i.writeSFixed32(t[r])}function Eu(t,i){for(var r=0;r<t.length;r++)i.writeFixed64(t[r])}function Fu(t,i){for(var r=0;r<t.length;r++)i.writeSFixed64(t[r])}function re(t,i){return(t[i]|t[i+1]<<8|t[i+2]<<16)+16777216*t[i+3]}function pc(t,i,r){t[r]=i,t[r+1]=i>>>8,t[r+2]=i>>>16,t[r+3]=i>>>24}function am(t,i){return(t[i]|t[i+1]<<8|t[i+2]<<16)+(t[i+3]<<24)}function Gu(t,i,r){for(var e="",a=i;a<r;){var s,n,f,$=t[a],o=null,h=$>239?4:$>223?3:$>191?2:1;if(a+h>r)break;1===h?$<128&&(o=$):2===h?128==(192&(s=t[a+1]))&&(o=(31&$)<<6|63&s)<=127&&(o=null):3===h?(s=t[a+1],n=t[a+2],128==(192&s)&&128==(192&n)&&((o=(15&$)<<12|(63&s)<<6|63&n)<=2047||o>=55296&&o<=57343)&&(o=null)):4===h&&(s=t[a+1],n=t[a+2],f=t[a+3],128==(192&s)&&128==(192&n)&&128==(192&f)&&((o=(15&$)<<18|(63&s)<<12|(63&n)<<6|63&f)<=65535||o>=1114112)&&(o=null)),null===o?(o=65533,h=1):o>65535&&(o-=65536,e+=String.fromCharCode(o>>>10&1023|55296),o=56320|1023&o),e+=String.fromCharCode(o),a+=h}return e}function Hu(t,i,r){for(var e,a,s=0;s<i.length;s++){if((e=i.charCodeAt(s))>55295&&e<57344){if(!a){e>56319||s+1===i.length?(t[r++]=239,t[r++]=191,t[r++]=189):a=e;continue}if(e<56320){t[r++]=239,t[r++]=191,t[r++]=189,a=e;continue}e=a-55296<<10|e-56320|65536,a=null}else a&&(t[r++]=239,t[r++]=191,t[r++]=189,a=null);e<128?t[r++]=e:(e<2048?t[r++]=e>>6|192:(e<65536?t[r++]=e>>12|224:(t[r++]=e>>18|240,t[r++]=e>>12&63|128),t[r++]=e>>6&63|128),t[r++]=63&e|128)}return r}m.prototype={destroy:function(){this.buf=null},readFields:function(t,i,r){for(r=r||this.length;this.pos<r;){var e=this.readVarint(),a=e>>3,s=this.pos;this.type=7&e,t(a,i,this),this.pos===s&&this.skip(e)}return i},readMessage:function(t,i){return this.readFields(t,i,this.readVarint()+this.pos)},readFixed32:function(){var t=re(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=am(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=re(this.buf,this.pos)+re(this.buf,this.pos+4)*bi;return this.pos+=8,t},readSFixed64:function(){var t=re(this.buf,this.pos)+am(this.buf,this.pos+4)*bi;return this.pos+=8,t},readFloat:function(){var t=Yl(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Yl(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var i,r,e=this.buf;return i=127&(r=e[this.pos++]),r<128?i:(i|=(127&(r=e[this.pos++]))<<7,r<128?i:(i|=(127&(r=e[this.pos++]))<<14,r<128?i:(i|=(127&(r=e[this.pos++]))<<21,r<128?i:tu(i|=(15&(r=e[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,i=Gu(this.buf,this.pos,t);return this.pos=t,i},readBytes:function(){var t=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,t);return this.pos=t,i},readPackedVarint:function(t,i){if(this.type!==m.Bytes)return t.push(this.readVarint(i));var r=Wa(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(i));return t},readPackedSVarint:function(t){if(this.type!==m.Bytes)return t.push(this.readSVarint());var i=Wa(this);for(t=t||[];this.pos<i;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==m.Bytes)return t.push(this.readBoolean());var i=Wa(this);for(t=t||[];this.pos<i;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==m.Bytes)return t.push(this.readFloat());var i=Wa(this);for(t=t||[];this.pos<i;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==m.Bytes)return t.push(this.readDouble());var i=Wa(this);for(t=t||[];this.pos<i;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==m.Bytes)return t.push(this.readFixed32());var i=Wa(this);for(t=t||[];this.pos<i;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==m.Bytes)return t.push(this.readSFixed32());var i=Wa(this);for(t=t||[];this.pos<i;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==m.Bytes)return t.push(this.readFixed64());var i=Wa(this);for(t=t||[];this.pos<i;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==m.Bytes)return t.push(this.readSFixed64());var i=Wa(this);for(t=t||[];this.pos<i;)t.push(this.readSFixed64());return t},skip:function(t){var i=7&t;if(i===m.Varint)for(;this.buf[this.pos++]>127;);else if(i===m.Bytes)this.pos=this.readVarint()+this.pos;else if(i===m.Fixed32)this.pos+=4;else{if(i!==m.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(t,i){this.writeVarint(t<<3|i)},realloc:function(t){for(var i=this.length||16;i<this.pos+t;)i*=2;if(i!==this.length){var r=new Uint8Array(i);r.set(this.buf),this.buf=r,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),pc(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),pc(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),pc(this.buf,-1&t,this.pos),pc(this.buf,Math.floor(t*$l),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),pc(this.buf,-1&t,this.pos),pc(this.buf,Math.floor(t*$l),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?uu(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var i=this.pos;this.pos=Hu(this.buf,t,this.pos);var r=this.pos-i;r>=128&&_l(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),Zl(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Zl(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var i=t.length;this.writeVarint(i),this.realloc(i);for(var r=0;r<i;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,i){this.pos++;var r=this.pos;t(i,this);var e=this.pos-r;e>=128&&_l(r,e,this),this.pos=r-1,this.writeVarint(e),this.pos+=e},writeMessage:function(t,i,r){this.writeTag(t,m.Bytes),this.writeRawMessage(i,r)},writePackedVarint:function(t,i){i.length&&this.writeMessage(t,xu,i)},writePackedSVarint:function(t,i){i.length&&this.writeMessage(t,yu,i)},writePackedBoolean:function(t,i){i.length&&this.writeMessage(t,Bu,i)},writePackedFloat:function(t,i){i.length&&this.writeMessage(t,zu,i)},writePackedDouble:function(t,i){i.length&&this.writeMessage(t,Au,i)},writePackedFixed32:function(t,i){i.length&&this.writeMessage(t,Cu,i)},writePackedSFixed32:function(t,i){i.length&&this.writeMessage(t,Du,i)},writePackedFixed64:function(t,i){i.length&&this.writeMessage(t,Eu,i)},writePackedSFixed64:function(t,i){i.length&&this.writeMessage(t,Fu,i)},writeBytesField:function(t,i){this.writeTag(t,m.Bytes),this.writeBytes(i)},writeFixed32Field:function(t,i){this.writeTag(t,m.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(t,i){this.writeTag(t,m.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(t,i){this.writeTag(t,m.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(t,i){this.writeTag(t,m.Fixed64),this.writeSFixed64(i)},writeVarintField:function(t,i){this.writeTag(t,m.Varint),this.writeVarint(i)},writeSVarintField:function(t,i){this.writeTag(t,m.Varint),this.writeSVarint(i)},writeStringField:function(t,i){this.writeTag(t,m.Bytes),this.writeString(i)},writeFloatField:function(t,i){this.writeTag(t,m.Fixed32),this.writeFloat(i)},writeDoubleField:function(t,i){this.writeTag(t,m.Fixed64),this.writeDouble(i)},writeBooleanField:function(t,i){this.writeVarintField(t,Boolean(i))}};var nb={};const bm=new Y({image:new fc({radius:10,fill:new Kb({color:"#fff"})})}),Iu=[bm,new Y({image:new fc({radius:8,fill:new Kb({color:"#f54435"})})})],Ju=[bm,new Y({image:new fc({radius:8,fill:new Kb({color:"#56b151"})})})],Ku=[new Y({stroke:new cb({color:"#fff",width:8,lineDash:[8,14]})}),new Y({stroke:new cb({color:"#f54435",width:4,lineDash:[8,14]})})],Lu=[new Y({stroke:new cb({color:"#fff",width:8})}),new Y({stroke:new cb({color:"#3399CCFF",width:4})})];nb.track=Lu;const Mu=[new Y({fill:new Kb({color:"#3399CC33"})})];function Nu($){if($.get("visible"))return $.get("outside")?Iu:Ju}function Ou($){if($.get("visible"))return $.get("outside")?Ku:null}nb.buffer=Mu,nb.position=Nu,nb.shortestLine=Ou;const Pu="pk.eyJ1IjoiZnJlZGoiLCJhIjoiMndGNGNINCJ9.yG14Tih1Vtuge0hsjL0grA",ad=new Fg({center:[0,0],zoom:0});const ci=new sl({controls:[],layers:[new Il({preload:1/0,source:new Jl({url:`https://api.mapbox.com/v4/mapbox.outdoors.json?secure&access_token=${Pu}`,crossOrigin:"anonymous"})})],view:ad});function Qu(e,r,t){const o=new Ol({featureProjection:r}),$=o.writeGeometryObject(e);return o.readFeature(Ru($,t/1e3)).getGeometry().getCoordinates()}function Ru(r,e,t){var o=(t=t||{}).units,$=t.steps||64;if(!r)throw new Error("geojson is required");if("object"!=typeof t)throw new Error("options must be an object");if("number"!=typeof $)throw new Error("steps must be an number");if(void 0===e)throw new Error("radius is required");if($<=0)throw new Error("steps must be greater than 0");$=$||64,o=o||"kilometers";var a=[];switch(r.type){case"GeometryCollection":return im(r,function(r){var t=se(r,e,o,$);t&&a.push(t)}),ei(a);case"FeatureCollection":return hm(r,function(r){var t=se(r,e,o,$);t&&hm(t,function(r){r&&a.push(r)})}),ei(a);}return se(r,e,o,$)}function se(r,e,t,o){var $,a=r.properties||{},i="Feature"===r.type?r.geometry:r;if("GeometryCollection"===i.type){var n=[];return im(r,function(r){var $=se(r,e,t,o);$&&n.push($)}),ei(n)}var u=gm(r),p=u[1]>50&&u[3]>50;$=p?{type:i.type,coordinates:dm(i.coordinates,fm(i))}:Wu(i);var c,C=new qc.GeoJSONReader().read($),f=Uu(Vu(e,t),"meters"),s=qc.BufferOp.bufferOp(C,f);if(!cm((s=new qc.GeoJSONWriter().write(s)).coordinates))return(c=p?{type:s.type,coordinates:em(s.coordinates,fm(i))}:Xu(s)).geometry?c:km(c,a)}function cm(r){return Array.isArray(r[0])?cm(r[0]):isNaN(r[0])}function dm(r,e){return"object"!=typeof r[0]?e(r):r.map(function(r){return dm(r,e)})}function em(r,e){return"object"!=typeof r[0]?e.invert(r):r.map(function(r){return em(r,e)})}function fm(r){var e=Su(r).geometry.coordinates.reverse(),t=e.map(function(r){return-r});return Dw().center(e).rotate(t).scale(R)}function Su(r,e){if(e=e||{},!ue(e))throw new Error("options is invalid");var $=e.properties;if(!r)throw new Error("geojson is required");var o=gm(r),t=(o[0]+o[2])/2,s=(o[1]+o[3])/2;return Tu([t,s],$)}function gm($){var r=[1/0,1/0,-1/0,-1/0];return di($,function($){r[0]>$[0]&&(r[0]=$[0]),r[1]>$[1]&&(r[1]=$[1]),r[2]<$[0]&&(r[2]=$[0]),r[3]<$[1]&&(r[3]=$[1])}),r}function di(e,t,r){if(null!==e)for(var o,n,i,$,a,c,u,l,s=0,p=0,g=e.type,f="FeatureCollection"===g,h="Feature"===g,d=f?e.features.length:1,V=0;V<d;V++){a=(l=!!(u=f?e.features[V].geometry:h?e.geometry:e)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var W=0;W<a;W++){var x=0,m=0;if(null!==($=l?u.geometries[W]:u)){c=$.coordinates;var y=$.type;switch(s=!r||"Polygon"!==y&&"MultiPolygon"!==y?0:1,y){case null:break;case"Point":if(!1===t(c,p,V,x,m))return!1;p++,x++;break;case"LineString":case"MultiPoint":for(o=0;o<c.length;o++){if(!1===t(c[o],p,V,x,m))return!1;p++,"MultiPoint"===y&&x++}"LineString"===y&&x++;break;case"Polygon":case"MultiLineString":for(o=0;o<c.length;o++){for(n=0;n<c[o].length-s;n++){if(!1===t(c[o][n],p,V,x,m))return!1;p++}"MultiLineString"===y&&x++,"Polygon"===y&&m++}"Polygon"===y&&x++;break;case"MultiPolygon":for(o=0;o<c.length;o++){for("MultiPolygon"===y&&(m=0),n=0;n<c[o].length;n++){for(i=0;i<c[o][n].length-s;i++){if(!1===t(c[o][n][i],p,V,x,m))return!1;p++}m++}x++}break;case"GeometryCollection":for(o=0;o<$.geometries.length;o++)if(!1===di($.geometries[o],t,r))return!1;break;default:throw new Error("Unknown Geometry Type");}}}}}function hm(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function im(e,t){var r,o,n,i,$,a,c,u,l,s,p=0,g="FeatureCollection"===e.type,f="Feature"===e.type,h=g?e.features.length:1;for(r=0;r<h;r++){for(a=g?e.features[r].geometry:f?e.geometry:e,u=g?e.features[r].properties:f?e.properties:{},l=g?e.features[r].bbox:f?e.bbox:void 0,s=g?e.features[r].id:f?e.id:void 0,$=(c=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,n=0;n<$;n++)if(null!==(i=c?a.geometries[n]:a))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(i,p,u,l,s))return!1;break;case"GeometryCollection":for(o=0;o<i.geometries.length;o++)if(!1===t(i.geometries[o],p,u,l,s))return!1;break;default:throw new Error("Unknown Geometry Type");}else if(!1===t(null,p,u,l,s))return!1;p++}}var R=6371008.8,jm={meters:R,metres:R,millimeters:1e3*R,millimetres:1e3*R,centimeters:100*R,centimetres:100*R,kilometers:R/1e3,kilometres:R/1e3,miles:R/1609.344,nauticalmiles:R/1852,inches:39.37*R,yards:R/1.0936,feet:3.28084*R,radians:1,degrees:R/111325};function km(r,e,t){if(!ue(t=t||{}))throw new Error("options is invalid");var o=t.bbox,n=t.id;if(void 0===r)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");o&&lm(o),n&&mm(n);var i={type:"Feature"};return n&&(i.id=n),o&&(i.bbox=o),i.properties=e||{},i.geometry=r,i}function Tu(r,e,t){if(!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!te(r[0])||!te(r[1]))throw new Error("coordinates must contain numbers");return km({type:"Point",coordinates:r},e,t)}function ei(r,e){if(!ue(e=e||{}))throw new Error("options is invalid");var t=e.bbox,o=e.id;if(!r)throw new Error("No features passed");if(!Array.isArray(r))throw new Error("features must be an Array");t&&lm(t),o&&mm(o);var n={type:"FeatureCollection"};return o&&(n.id=o),t&&(n.bbox=t),n.features=r,n}function Uu(r,e){if(null==r)throw new Error("radians is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var t=jm[e||"kilometers"];if(!t)throw new Error(e+" units is invalid");return r*t}function Vu(r,e){if(null==r)throw new Error("distance is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var t=jm[e||"kilometers"];if(!t)throw new Error(e+" units is invalid");return r/t}function te(r){return!isNaN(r)&&null!==r&&!Array.isArray(r)}function ue(r){return!!r&&r.constructor===Object}function lm(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(4!==r.length&&6!==r.length)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(function(r){if(!te(r))throw new Error("bbox must only contain numbers")})}function mm(r){if(!r)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof r))throw new Error("id must be a number or a string")}var fi,qc={};!function(t,e){"object"==typeof qc?e(qc):"function"==typeof fi&&fi.amd?fi(["exports"],e):e(t.jsts={})}(qc,function(t){function e(){}function n(t){this.message=t||""}function i(t){this.message=t||""}function r(t){this.message=t||""}function o(){}function s(t){return null===t?Mt:t.color}function a(t){return null===t?null:t.parent}function u(t,e){null!==t&&(t.color=e)}function l(t){return null===t?null:t.left}function c(t){return null===t?null:t.right}function p(){this.root_=null,this.size_=0}function h(){}function f(){this.array_=[],arguments[0]instanceof It&&this.addAll(arguments[0])}function g(){}function d(t){this.message=t||""}function y(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,i=1 in arguments&&parseInt(Number(arguments[1]),10)||0;i=i<0?Math.max(n+i,0):Math.min(i,n);var r=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n;for(r=r<0?Math.max(n+arguments[2],0):Math.min(r,n);i<r;)e[i]=t,++i;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var _=function(){};_.prototype.interfaces_=function(){return[]},_.prototype.getClass=function(){return _},_.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n};var m=function(t){function e(e){t.call(this,e),this.name="IllegalArgumentException",this.message=e,this.stack=new t().stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),v=function(){},I={MAX_VALUE:{configurable:!0}};v.isNaN=function(t){return Number.isNaN(t)},v.doubleToLongBits=function(t){return t},v.longBitsToDouble=function(t){return t},v.isInfinite=function(t){return!Number.isFinite(t)},I.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(v,I);var E=function(){},x=function(){},N=function(){},C=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},S={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};C.prototype.setOrdinate=function(t,e){switch(t){case C.X:this.x=e;break;case C.Y:this.y=e;break;case C.Z:this.z=e;break;default:throw new m("Invalid ordinate index: "+t);}},C.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!_.equalsWithTolerance(this.x,e.x,n)&&!!_.equalsWithTolerance(this.y,e.y,n)}},C.prototype.getOrdinate=function(t){switch(t){case C.X:return this.x;case C.Y:return this.y;case C.Z:return this.z;}throw new m("Invalid ordinate index: "+t)},C.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||v.isNaN(this.z))&&v.isNaN(t.z)},C.prototype.equals=function(t){return t instanceof C&&this.equals2D(t)},C.prototype.equalInZ=function(t,e){return _.equalsWithTolerance(this.z,t.z,e)},C.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},C.prototype.clone=function(){},C.prototype.copy=function(){return new C(this)},C.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},C.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return Math.sqrt(e*e+n*n+i*i)},C.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},C.prototype.hashCode=function(){var t=17;return 37*(t=37*t+C.hashCode(this.x))+C.hashCode(this.y)},C.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},C.prototype.interfaces_=function(){return[E,x,e]},C.prototype.getClass=function(){return C},C.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=v.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}},S.DimensionalComparator.get=function(){return L},S.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},S.NULL_ORDINATE.get=function(){return v.NaN},S.X.get=function(){return 0},S.Y.get=function(){return 1},S.Z.get=function(){return 2},Object.defineProperties(C,S);var L=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new m("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};L.prototype.compare=function(t,e){var n=t,i=e,r=L.compare(n.x,i.x);if(0!==r)return r;var o=L.compare(n.y,i.y);return 0!==o?o:this._dimensionsToTest<=2?0:L.compare(n.z,i.z)},L.prototype.interfaces_=function(){return[N]},L.prototype.getClass=function(){return L},L.compare=function(t,e){return t<e?-1:t>e?1:v.isNaN(t)?v.isNaN(e)?0:-1:v.isNaN(e)?1:0};var b=function(){};b.prototype.create=function(){},b.prototype.interfaces_=function(){return[]},b.prototype.getClass=function(){return b};var w=function(){},O={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};w.prototype.interfaces_=function(){return[]},w.prototype.getClass=function(){return w},w.toLocationSymbol=function(t){switch(t){case w.EXTERIOR:return"e";case w.BOUNDARY:return"b";case w.INTERIOR:return"i";case w.NONE:return"-";}throw new m("Unknown location value: "+t)},O.INTERIOR.get=function(){return 0},O.BOUNDARY.get=function(){return 1},O.EXTERIOR.get=function(){return 2},O.NONE.get=function(){return-1},Object.defineProperties(w,O);var T=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},R=function(){},P={LOG_10:{configurable:!0}};R.prototype.interfaces_=function(){return[]},R.prototype.getClass=function(){return R},R.log10=function(t){var e=Math.log(t);return v.isInfinite(e)?e:v.isNaN(e)?e:e/R.LOG_10},R.min=function(t,e,n,i){var r=t;return e<r&&(r=e),n<r&&(r=n),i<r&&(r=i),r},R.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],r=arguments[1],o=arguments[2];return i<r?r:i>o?o:i}},R.wrap=function(t,e){return t<0?e- -t%e:t%e},R.max=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=t;return e>i&&(i=e),n>i&&(i=n),i}if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],u=r;return o>u&&(u=o),s>u&&(u=s),a>u&&(u=a),u}},R.average=function(t,e){return(t+e)/2},P.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(R,P);var D=function(t){this.str=t};D.prototype.append=function(t){this.str+=t},D.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},D.prototype.toString=function(t){return this.str};var M=function(t){this.value=t};M.prototype.intValue=function(){return this.value},M.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},M.isNaN=function(t){return Number.isNaN(t)};var A=function(){};A.isWhitespace=function(t){return t<=32&&t>=0||127===t},A.toUpperCase=function(t){return t.toUpperCase()};var F=function t(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}else if("string"==typeof arguments[0]){var i=arguments[0];t.call(this,t.parse(i))}}else if(2===arguments.length){var r=arguments[0],o=arguments[1];this.init(r,o)}},G={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};F.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},F.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),i=F.magnitude(n._hi),r=F.TEN.pow(i);(n=n.divide(r)).gt(F.TEN)?(n=n.divide(F.TEN),i+=1):n.lt(F.ONE)&&(n=n.multiply(F.TEN),i-=1);for(var o=i+1,s=new D,a=F.MAX_PRINT_DIGITS-1,u=0;u<=a;u++){t&&u===o&&s.append(".");var l=Math.trunc(n._hi);if(l<0)break;var c=!1,p=0;l>9?(c=!0,p="9"):p="0"+l,s.append(p),n=n.subtract(F.valueOf(l)).multiply(F.TEN),c&&n.selfAdd(F.TEN);var h=!0,f=F.magnitude(n._hi);if(f<0&&Math.abs(f)>=a-u&&(h=!1),!h)break}return e[0]=i,s.toString()},F.prototype.sqr=function(){return this.multiply(this)},F.prototype.doubleValue=function(){return this._hi+this._lo},F.prototype.subtract=function(){if(arguments[0]instanceof F){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},F.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},F.prototype.isZero=function(){return 0===this._hi&&0===this._lo},F.prototype.selfSubtract=function(){if(arguments[0]instanceof F){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},F.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},F.prototype.min=function(t){return this.le(t)?this:t},F.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof F){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n,i,r,o,s=arguments[0],a=arguments[1],u=null,l=null,c=null,p=null;return r=this._hi/s,p=(u=(c=F.SPLIT*r)-(u=c-r))*(l=(p=F.SPLIT*s)-(l=p-s))-(o=r*s)+u*(i=s-l)+(n=r-u)*l+n*i,p=r+(c=(this._hi-o-p+this._lo-r*a)/s),this._hi=p,this._lo=r-p+c,this}},F.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},F.prototype.divide=function(){if(arguments[0]instanceof F){var t,e,n,i,r=arguments[0],o=null,s=null,a=null,u=null;return t=(n=this._hi/r._hi)-(o=(a=F.SPLIT*n)-(o=a-n)),u=o*(s=(u=F.SPLIT*r._hi)-(s=u-r._hi))-(i=n*r._hi)+o*(e=r._hi-s)+t*s+t*e,a=(this._hi-i-u+this._lo-n*r._lo)/r._hi,new F(u=n+a,n-u+a)}if("number"==typeof arguments[0]){var l=arguments[0];return v.isNaN(l)?F.createNaN():F.copy(this).selfDivide(l,0)}},F.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},F.prototype.pow=function(t){if(0===t)return F.valueOf(1);var e=new F(this),n=F.valueOf(1),i=Math.abs(t);if(i>1)for(;i>0;)i%2==1&&n.selfMultiply(e),(i/=2)>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},F.prototype.ceil=function(){if(this.isNaN())return F.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new F(t,e)},F.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},F.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},F.prototype.setValue=function(){if(arguments[0]instanceof F){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},F.prototype.max=function(t){return this.ge(t)?this:t},F.prototype.sqrt=function(){if(this.isZero())return F.valueOf(0);if(this.isNegative())return F.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=F.valueOf(e),i=this.subtract(n.sqr())._hi*(.5*t);return n.add(i)},F.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof F){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e,n,i,r,o,s=arguments[0],a=null;return a=(i=this._hi+s)-(r=i-this._hi),n=(o=(a=s-r+(this._hi-a))+this._lo)+(i-(e=i+o)),this._hi=e+n,this._lo=n+(e-this._hi),this}}else if(2===arguments.length){var u,l,c,p,h=arguments[0],f=arguments[1],g=null,d=null,y=null;c=this._hi+h,l=this._lo+f,d=c-(y=c-this._hi),g=l-(p=l-this._lo);var _=(u=c+(y=(d=h-y+(this._hi-d))+l))+(y=(g=f-p+(this._lo-g))+(y+(c-u))),m=y+(u-_);return this._hi=_,this._lo=m,this}},F.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof F){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n,i,r=arguments[0],o=arguments[1],s=null,a=null,u=null,l=null;s=(u=F.SPLIT*this._hi)-this._hi,l=F.SPLIT*r,s=u-s,n=this._hi-s,a=l-r;var c=(u=this._hi*r)+(l=s*(a=l-a)-u+s*(i=r-a)+n*a+n*i+(this._hi*o+this._lo*r)),p=l+(s=u-c);return this._hi=c,this._lo=p,this}},F.prototype.selfSqr=function(){return this.selfMultiply(this)},F.prototype.floor=function(){if(this.isNaN())return F.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new F(t,e)},F.prototype.negate=function(){return this.isNaN()?this:new F(-this._hi,-this._lo)},F.prototype.clone=function(){},F.prototype.multiply=function(){if(arguments[0]instanceof F){var t=arguments[0];return t.isNaN()?F.createNaN():F.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return v.isNaN(e)?F.createNaN():F.copy(this).selfMultiply(e,0)}},F.prototype.isNaN=function(){return v.isNaN(this._hi)},F.prototype.intValue=function(){return Math.trunc(this._hi)},F.prototype.toString=function(){var t=F.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},F.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1,r=n;if("."===n.charAt(0))r="0"+n;else if(i<0)r="0."+F.stringOfChar("0",-i)+n;else if(-1===n.indexOf(".")){var o=i-n.length;r=n+F.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+r:r},F.prototype.reciprocal=function(){var t,e,n,i,r=null,o=null,s=null,a=null;t=(n=1/this._hi)-(r=(s=F.SPLIT*n)-(r=s-n)),o=(a=F.SPLIT*this._hi)-this._hi;var u=n+(s=(1-(i=n*this._hi)-(a=r*(o=a-o)-i+r*(e=this._hi-o)+t*o+t*e)-n*this._lo)/this._hi);return new F(u,n-u+s)},F.prototype.toSciNotation=function(){if(this.isZero())return F.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=F.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new Error("Found leading zero: "+n);var r="";n.length>1&&(r=n.substring(1));var o=n.charAt(0)+"."+r;return this.isNegative()?"-"+o+i:o+i},F.prototype.abs=function(){return this.isNaN()?F.NaN:this.isNegative()?this.negate():new F(this)},F.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},F.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},F.prototype.add=function(){if(arguments[0]instanceof F){var t=arguments[0];return F.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return F.copy(this).selfAdd(e)}},F.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof F){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._hi=n,this._lo=i}},F.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},F.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},F.prototype.trunc=function(){return this.isNaN()?F.NaN:this.isPositive()?this.floor():this.ceil()},F.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},F.prototype.interfaces_=function(){return[e,E,x]},F.prototype.getClass=function(){return F},F.sqr=function(t){return F.valueOf(t).selfMultiply(t)},F.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return F.parse(t)}if("number"==typeof arguments[0]){var e=arguments[0];return new F(e)}},F.sqrt=function(t){return F.valueOf(t).sqrt()},F.parse=function(t){for(var e=0,n=t.length;A.isWhitespace(t.charAt(e));)e++;var i=!1;if(e<n){var r=t.charAt(e);"-"!==r&&"+"!==r||(e++,"-"===r&&(i=!0))}for(var o=new F,s=0,a=0,u=0;!(e>=n);){var l=t.charAt(e);if(e++,A.isDigit(l)){var c=l-"0";o.selfMultiply(F.TEN),o.selfAdd(c),s++}else{if("."!==l){if("e"===l||"E"===l){var p=t.substring(e);try{u=M.parseInt(p)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+p+" in string "+t):e}break}throw new Error("Unexpected character '"+l+"' at position "+e+" in string "+t)}a=s}}var h=o,f=s-a-u;if(0===f)h=o;else if(f>0){var g=F.TEN.pow(f);h=o.divide(g)}else if(f<0){var d=F.TEN.pow(-f);h=o.multiply(d)}return i?h.negate():h},F.createNaN=function(){return new F(v.NaN,v.NaN)},F.copy=function(t){return new F(t)},F.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),i=Math.trunc(Math.floor(n));return 10*Math.pow(10,i)<=e&&(i+=1),i},F.stringOfChar=function(t,e){for(var n=new D,i=0;i<e;i++)n.append(t);return n.toString()},G.PI.get=function(){return new F(3.141592653589793,1.2246467991473532e-16)},G.TWO_PI.get=function(){return new F(6.283185307179586,2.4492935982947064e-16)},G.PI_2.get=function(){return new F(1.5707963267948966,6.123233995736766e-17)},G.E.get=function(){return new F(2.718281828459045,1.4456468917292502e-16)},G.NaN.get=function(){return new F(v.NaN,v.NaN)},G.EPS.get=function(){return 1.23259516440783e-32},G.SPLIT.get=function(){return 134217729},G.MAX_PRINT_DIGITS.get=function(){return 32},G.TEN.get=function(){return F.valueOf(10)},G.ONE.get=function(){return F.valueOf(1)},G.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},G.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(F,G);var q=function(){},B={DP_SAFE_EPSILON:{configurable:!0}};q.prototype.interfaces_=function(){return[]},q.prototype.getClass=function(){return q},q.orientationIndex=function(t,e,n){var i=q.orientationIndexFilter(t,e,n);if(i<=1)return i;var r=F.valueOf(e.x).selfAdd(-t.x),o=F.valueOf(e.y).selfAdd(-t.y),s=F.valueOf(n.x).selfAdd(-e.x),a=F.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()},q.signOfDet2x2=function(t,e,n,i){return t.multiply(i).selfSubtract(e.multiply(n)).signum()},q.intersection=function(t,e,n,i){var r=F.valueOf(i.y).selfSubtract(n.y).selfMultiply(F.valueOf(e.x).selfSubtract(t.x)),o=F.valueOf(i.x).selfSubtract(n.x).selfMultiply(F.valueOf(e.y).selfSubtract(t.y)),s=r.subtract(o),a=F.valueOf(i.x).selfSubtract(n.x).selfMultiply(F.valueOf(t.y).selfSubtract(n.y)),u=F.valueOf(i.y).selfSubtract(n.y).selfMultiply(F.valueOf(t.x).selfSubtract(n.x)),l=a.subtract(u).selfDivide(s).doubleValue(),c=F.valueOf(t.x).selfAdd(F.valueOf(e.x).selfSubtract(t.x).selfMultiply(l)).doubleValue(),p=F.valueOf(e.x).selfSubtract(t.x).selfMultiply(F.valueOf(t.y).selfSubtract(n.y)),h=F.valueOf(e.y).selfSubtract(t.y).selfMultiply(F.valueOf(t.x).selfSubtract(n.x)),f=p.subtract(h).selfDivide(s).doubleValue(),g=F.valueOf(n.y).selfAdd(F.valueOf(i.y).selfSubtract(n.y).selfMultiply(f)).doubleValue();return new C(c,g)},q.orientationIndexFilter=function(t,e,n){var i=null,r=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),s=r-o;if(r>0){if(o<=0)return q.signum(s);i=r+o}else{if(!(r<0))return q.signum(s);if(o>=0)return q.signum(s);i=-r-o}var a=q.DP_SAFE_EPSILON*i;return s>=a||-s>=a?q.signum(s):2},q.signum=function(t){return t>0?1:t<0?-1:0},B.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(q,B);var V=function(){},U={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};U.X.get=function(){return 0},U.Y.get=function(){return 1},U.Z.get=function(){return 2},U.M.get=function(){return 3},V.prototype.setOrdinate=function(t,e,n){},V.prototype.size=function(){},V.prototype.getOrdinate=function(t,e){},V.prototype.getCoordinate=function(){},V.prototype.getCoordinateCopy=function(t){},V.prototype.getDimension=function(){},V.prototype.getX=function(t){},V.prototype.clone=function(){},V.prototype.expandEnvelope=function(t){},V.prototype.copy=function(){},V.prototype.getY=function(t){},V.prototype.toCoordinateArray=function(){},V.prototype.interfaces_=function(){return[x]},V.prototype.getClass=function(){return V},Object.defineProperties(V,U);var z=function(){},X=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(z),Y=function(){};Y.arraycopy=function(t,e,n,i,r){for(var o=0,s=e;s<e+r;s++)n[i+o]=t[s],o++},Y.getProperty=function(t){return{"line.separator":"\n"}[t]};var k=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1];this.x=n,this.y=i,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var r=arguments[0],o=arguments[1];this.x=r.y*o.w-o.y*r.w,this.y=o.x*r.w-r.x*o.w,this.w=r.x*o.y-o.x*r.y}else if(arguments[0]instanceof C&&arguments[1]instanceof C){var s=arguments[0],a=arguments[1];this.x=s.y-a.y,this.y=a.x-s.x,this.w=s.x*a.y-a.x*s.y}}else if(3===arguments.length){var u=arguments[0],l=arguments[1],c=arguments[2];this.x=u,this.y=l,this.w=c}else if(4===arguments.length){var p=arguments[0],h=arguments[1],f=arguments[2],g=arguments[3],d=p.y-h.y,y=h.x-p.x,_=p.x*h.y-h.x*p.y,m=f.y-g.y,v=g.x-f.x,I=f.x*g.y-g.x*f.y;this.x=y*I-v*_,this.y=m*_-d*I,this.w=d*v-m*y}};k.prototype.getY=function(){var t=this.y/this.w;if(v.isNaN(t)||v.isInfinite(t))throw new X;return t},k.prototype.getX=function(){var t=this.x/this.w;if(v.isNaN(t)||v.isInfinite(t))throw new X;return t},k.prototype.getCoordinate=function(){var t=new C;return t.x=this.getX(),t.y=this.getY(),t},k.prototype.interfaces_=function(){return[]},k.prototype.getClass=function(){return k},k.intersection=function(t,e,n,i){var r=t.y-e.y,o=e.x-t.x,s=t.x*e.y-e.x*t.y,a=n.y-i.y,u=i.x-n.x,l=n.x*i.y-i.x*n.y,c=r*u-a*o,p=(o*l-u*s)/c,h=(a*s-r*l)/c;if(v.isNaN(p)||v.isInfinite(p)||v.isNaN(h)||v.isInfinite(h))throw new X;return new C(p,h)};var j=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof C){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i.x,r.x,i.y,r.y)}else if(4===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],u=arguments[3];this.init(o,s,a,u)}},H={serialVersionUID:{configurable:!0}};j.prototype.getArea=function(){return this.getWidth()*this.getHeight()},j.prototype.equals=function(t){if(!(t instanceof j))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},j.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new j;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,i=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new j(e,i,n,r)},j.prototype.isNull=function(){return this._maxx<this._minx},j.prototype.getMaxX=function(){return this._maxx},j.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof C){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof j){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&i>=this._miny&&i<=this._maxy}},j.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof j){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof C){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&!(n>this._maxx||n<this._minx||i>this._maxy||i<this._miny)}},j.prototype.getMinY=function(){return this._miny},j.prototype.getMinX=function(){return this._minx},j.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof C){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof j){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=i,this._maxy=i):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),i<this._miny&&(this._miny=i),i>this._maxy&&(this._maxy=i))}},j.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},j.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},j.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},j.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},j.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},j.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},j.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},j.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},j.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},j.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof j){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof C){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.covers(n,i)}},j.prototype.centre=function(){return this.isNull()?null:new C((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},j.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof C){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof j){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];r<o?(this._minx=r,this._maxx=o):(this._minx=o,this._maxx=r),s<a?(this._miny=s,this._maxy=a):(this._miny=a,this._maxy=s)}},j.prototype.getMaxY=function(){return this._maxy},j.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},j.prototype.hashCode=function(){var t=17;return 37*(t=37*(t=37*(t=37*t+C.hashCode(this._minx))+C.hashCode(this._maxx))+C.hashCode(this._miny))+C.hashCode(this._maxy)},j.prototype.interfaces_=function(){return[E,e]},j.prototype.getClass=function(){return j},j.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=Math.min(o.x,s.x),u=Math.max(o.x,s.x),l=Math.min(i.x,r.x),c=Math.max(i.x,r.x);return!(l>u||c<a||(a=Math.min(o.y,s.y),u=Math.max(o.y,s.y),l=Math.min(i.y,r.y),c=Math.max(i.y,r.y),l>u||c<a))}},H.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(j,H);var W={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},K=function(t){this.geometryFactory=t||new _e};K.prototype.read=function(t){var e,n,i;t=t.replace(/[\n\r]/g," ");var r=W.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=W.emptyTypeStr.exec(t))[2]=void 0),r&&(n=r[1].toLowerCase(),i=r[2],Q[n]&&(e=Q[n].apply(this,[i]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},K.prototype.write=function(t){return this.extractGeometry(t)},K.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!J[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+J[e].apply(this,[t])+")"};var J={coordinate:function(t){return t.x+" "+t.y},point:function(t){return J.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+J.point.apply(this,[t._geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(J.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(J.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+J.linestring.apply(this,[t._geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+J.linestring.apply(this,[t._shell])+")");for(var n=0,i=t._holes.length;n<i;++n)e.push("("+J.linestring.apply(this,[t._holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+J.polygon.apply(this,[t._geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}},Q={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(W.spaces);return this.geometryFactory.createPoint(new C(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(W.trimParens,"$1"),i.push(Q.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(i)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(W.spaces),i.push(new C(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(i)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(W.spaces),i.push(new C(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(W.parenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(W.trimParens,"$1"),i.push(Q.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(i)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,i,r,o=t.trim().split(W.parenComma),s=[],a=0,u=o.length;a<u;++a)e=o[a].replace(W.trimParens,"$1"),n=Q.linestring.apply(this,[e]),i=this.geometryFactory.createLinearRing(n._points),0===a?r=i:s.push(i);return this.geometryFactory.createPolygon(r,s)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(W.doubleParenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(W.trimParens,"$1"),i.push(Q.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(i)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],i=0,r=e.length;i<r;++i)n.push(this.read(e[i]));return this.geometryFactory.createGeometryCollection(n)}},$=function(t){this.parser=new K(t)};$.prototype.write=function(t){return this.parser.write(t)},$.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var Z=function(t){function e(e){t.call(this,e),this.name="RuntimeException",this.message=e,this.stack=new t().stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),tt=function(t){function e(){if(t.call(this),0===arguments.length)t.call(this);else if(1===arguments.length){var e=arguments[0];t.call(this,e)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Z),et=function(){};et.prototype.interfaces_=function(){return[]},et.prototype.getClass=function(){return et},et.shouldNeverReachHere=function(){if(0===arguments.length)et.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new tt("Should never reach here"+(null!==t?": "+t:""))}},et.isTrue=function(){var t,e;if(1===arguments.length)t=arguments[0],et.isTrue(t,null);else if(2===arguments.length&&(t=arguments[0],e=arguments[1],!t))throw null===e?new tt:new tt(e)},et.equals=function(){var t,e,n;if(2===arguments.length)t=arguments[0],e=arguments[1],et.equals(t,e,null);else if(3===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],!e.equals(t)))throw new tt("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))};var nt=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new C,this._intPt[1]=new C,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},it={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};nt.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},nt.prototype.getTopologySummary=function(){var t=new D;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},nt.prototype.computeIntersection=function(t,e,n,i){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=i,this._result=this.computeIntersect(t,e,n,i)},nt.prototype.getIntersectionNum=function(){return this._result},nt.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},nt.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},nt.prototype.setPrecisionModel=function(t){this._precisionModel=t},nt.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}},nt.prototype.getIntersection=function(t){return this._intPt[t]},nt.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},nt.prototype.hasIntersection=function(){return this._result!==nt.NO_INTERSECTION},nt.prototype.getEdgeDistance=function(t,e){return nt.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},nt.prototype.isCollinear=function(){return this._result===nt.COLLINEAR_INTERSECTION},nt.prototype.toString=function(){return $.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+$.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},nt.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},nt.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},nt.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},nt.prototype.interfaces_=function(){return[]},nt.prototype.getClass=function(){return nt},nt.computeEdgeDistance=function(t,e,n){var i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=i>r?i:r;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=i>r?s:a)||t.equals(e)||(o=Math.max(s,a))}return et.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},nt.nonRobustComputeEdgeDistance=function(t,e,n){var i=t.x-e.x,r=t.y-e.y,o=Math.sqrt(i*i+r*r);return et.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},it.DONT_INTERSECT.get=function(){return 0},it.DO_INTERSECT.get=function(){return 1},it.COLLINEAR.get=function(){return 2},it.NO_INTERSECTION.get=function(){return 0},it.POINT_INTERSECTION.get=function(){return 1},it.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(nt,it);var rt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(t){var e=new j(this._inputLines[0][0],this._inputLines[0][1]),n=new j(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)},e.prototype.computeIntersection=function(){if(3!==arguments.length)return t.prototype.computeIntersection.apply(this,arguments);var e=arguments[0],n=arguments[1],i=arguments[2];if(this._isProper=!1,j.intersects(n,i,e)&&0===at.orientationIndex(n,i,e)&&0===at.orientationIndex(i,n,e))return this._isProper=!0,(e.equals(n)||e.equals(i))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION},e.prototype.normalizeToMinimum=function(t,e,n,i,r){r.x=this.smallestInAbsValue(t.x,e.x,n.x,i.x),r.y=this.smallestInAbsValue(t.y,e.y,n.y,i.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},e.prototype.safeHCoordinateIntersection=function(t,n,i,r){var o=null;try{o=k.intersection(t,n,i,r)}catch(s){if(!(s instanceof X))throw s;o=e.nearestEndpoint(t,n,i,r)}return o},e.prototype.intersection=function(t,n,i,r){var o=this.intersectionWithNormalization(t,n,i,r);return this.isInSegmentEnvelopes(o)||(o=new C(e.nearestEndpoint(t,n,i,r))),null!==this._precisionModel&&this._precisionModel.makePrecise(o),o},e.prototype.smallestInAbsValue=function(t,e,n,i){var r=t,o=Math.abs(r);return Math.abs(e)<o&&(r=e,o=Math.abs(e)),Math.abs(n)<o&&(r=n,o=Math.abs(n)),Math.abs(i)<o&&(r=i),r},e.prototype.checkDD=function(t,e,n,i,r){var o=q.intersection(t,e,n,i),s=this.isInSegmentEnvelopes(o);Y.out.println("DD in env = "+s+"  --------------------- "+o),r.distance(o)>1e-4&&Y.out.println("Distance = "+r.distance(o))},e.prototype.intersectionWithNormalization=function(t,e,n,i){var r=new C(t),o=new C(e),s=new C(n),a=new C(i),u=new C;this.normalizeToEnvCentre(r,o,s,a,u);var l=this.safeHCoordinateIntersection(r,o,s,a);return l.x+=u.x,l.y+=u.y,l},e.prototype.computeCollinearIntersection=function(e,n,i,r){var o=j.intersects(e,n,i),s=j.intersects(e,n,r),a=j.intersects(i,r,e),u=j.intersects(i,r,n);return o&&s?(this._intPt[0]=i,this._intPt[1]=r,t.COLLINEAR_INTERSECTION):a&&u?(this._intPt[0]=e,this._intPt[1]=n,t.COLLINEAR_INTERSECTION):o&&a?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||s||u?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):o&&u?(this._intPt[0]=i,this._intPt[1]=n,!i.equals(n)||s||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||o||u?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&u?(this._intPt[0]=r,this._intPt[1]=n,!r.equals(n)||o||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(t,e,n,i,r){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,u=t.y>e.y?t.y:e.y,l=n.x<i.x?n.x:i.x,c=n.y<i.y?n.y:i.y,p=n.x>i.x?n.x:i.x,h=n.y>i.y?n.y:i.y,f=((o>l?o:l)+(a<p?a:p))/2,g=((s>c?s:c)+(u<h?u:h))/2;r.x=f,r.y=g,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},e.prototype.computeIntersect=function(e,n,i,r){if(this._isProper=!1,!j.intersects(e,n,i,r))return t.NO_INTERSECTION;var o=at.orientationIndex(e,n,i),s=at.orientationIndex(e,n,r);if(o>0&&s>0||o<0&&s<0)return t.NO_INTERSECTION;var a=at.orientationIndex(i,r,e),u=at.orientationIndex(i,r,n);return a>0&&u>0||a<0&&u<0?t.NO_INTERSECTION:0===o&&0===s&&0===a&&0===u?this.computeCollinearIntersection(e,n,i,r):(0===o||0===s||0===a||0===u?(this._isProper=!1,e.equals2D(i)||e.equals2D(r)?this._intPt[0]=e:n.equals2D(i)||n.equals2D(r)?this._intPt[0]=n:0===o?this._intPt[0]=new C(i):0===s?this._intPt[0]=new C(r):0===a?this._intPt[0]=new C(e):0===u&&(this._intPt[0]=new C(n))):(this._isProper=!0,this._intPt[0]=this.intersection(e,n,i,r)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(t,e,n,i){var r=t,o=at.distancePointLine(t,n,i),s=at.distancePointLine(e,n,i);return s<o&&(o=s,r=e),(s=at.distancePointLine(n,t,e))<o&&(o=s,r=n),(s=at.distancePointLine(i,t,e))<o&&(o=s,r=i),r},e}(nt),ot=function(){};ot.prototype.interfaces_=function(){return[]},ot.prototype.getClass=function(){return ot},ot.orientationIndex=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=n.x-e.x,s=n.y-e.y;return ot.signOfDet2x2(i,r,o,s)},ot.signOfDet2x2=function(t,e,n,i){var r=null,o=null,s=null;if(r=1,0===t||0===i)return 0===e||0===n?0:e>0?n>0?-r:r:n>0?r:-r;if(0===e||0===n)return i>0?t>0?r:-r:t>0?-r:r;if(e>0?i>0?e<=i||(r=-r,o=t,t=n,n=o,o=e,e=i,i=o):e<=-i?(r=-r,n=-n,i=-i):(o=t,t=-n,n=o,o=e,e=-i,i=o):i>0?-e<=i?(r=-r,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=i,i=o):e>=i?(t=-t,e=-e,n=-n,i=-i):(r=-r,o=-t,t=-n,n=o,o=-e,e=-i,i=o),t>0){if(!(n>0))return r;if(!(t<=n))return r}else{if(n>0)return-r;if(!(t>=n))return-r;r=-r,t=-t,n=-n}for(;;){if((i-=(s=Math.floor(n/t))*e)<0)return-r;if(i>e)return r;if(t>(n-=s*t)+n){if(e<i+i)return r}else{if(e>i+i)return-r;n=t-n,i=e-i,r=-r}if(0===i)return 0===n?0:-r;if(0===n)return r;if((e-=(s=Math.floor(t/n))*i)<0)return r;if(e>i)return-r;if(n>(t-=s*n)+t){if(i<e+e)return-r}else{if(i>e+e)return r;t=n-t,e=i-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}};var st=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};st.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,i=e.x;return n>i&&(n=e.x,i=t.x),this._p.x>=n&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var r=t.x-this._p.x,o=t.y-this._p.y,s=e.x-this._p.x,a=e.y-this._p.y,u=ot.signOfDet2x2(r,o,s,a);if(0===u)return this._isPointOnSegment=!0,null;a<o&&(u=-u),u>0&&this._crossingCount++}},st.prototype.isPointInPolygon=function(){return this.getLocation()!==w.EXTERIOR},st.prototype.getLocation=function(){return this._isPointOnSegment?w.BOUNDARY:this._crossingCount%2==1?w.INTERIOR:w.EXTERIOR},st.prototype.isOnSegment=function(){return this._isPointOnSegment},st.prototype.interfaces_=function(){return[]},st.prototype.getClass=function(){return st},st.locatePointInRing=function(){if(arguments[0]instanceof C&&T(arguments[1],V)){for(var t=arguments[0],e=arguments[1],n=new st(t),i=new C,r=new C,o=1;o<e.size();o++)if(e.getCoordinate(o,i),e.getCoordinate(o-1,r),n.countSegment(i,r),n.isOnSegment())return n.getLocation();return n.getLocation()}if(arguments[0]instanceof C&&arguments[1]instanceof Array){for(var s=arguments[0],a=arguments[1],u=new st(s),l=1;l<a.length;l++){var c=a[l],p=a[l-1];if(u.countSegment(c,p),u.isOnSegment())return u.getLocation()}return u.getLocation()}};var at=function(){},ut={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};at.prototype.interfaces_=function(){return[]},at.prototype.getClass=function(){return at},at.orientationIndex=function(t,e,n){return q.orientationIndex(t,e,n)},at.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,i=1;i<t.length-1;i++){var r=t[i].x-n,o=t[i+1].y;e+=r*(t[i-1].y-o)}return e/2}if(T(arguments[0],V)){var s=arguments[0],a=s.size();if(a<3)return 0;var u=new C,l=new C,c=new C;s.getCoordinate(0,l),s.getCoordinate(1,c);var p=l.x;c.x-=p;for(var h=0,f=1;f<a-1;f++)u.y=l.y,l.x=c.x,l.y=c.y,s.getCoordinate(f+1,c),c.x-=p,h+=l.x*(u.y-c.y);return h/2}},at.distanceLineLine=function(t,e,n,i){if(t.equals(e))return at.distancePointLine(t,n,i);if(n.equals(i))return at.distancePointLine(i,t,e);var r=!1;if(j.intersects(t,e,n,i)){var o=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(0===o)r=!0;else{var s=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,u=s/o;(u<0||u>1||a<0||a>1)&&(r=!0)}}else r=!0;return r?R.min(at.distancePointLine(t,n,i),at.distancePointLine(e,n,i),at.distancePointLine(n,t,e),at.distancePointLine(i,t,e)):0},at.isPointInRing=function(t,e){return at.locatePointInRing(t,e)!==w.EXTERIOR},at.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,i=new C;t.getCoordinate(0,i);for(var r=i.x,o=i.y,s=1;s<e;s++){t.getCoordinate(s,i);var a=i.x,u=i.y,l=a-r,c=u-o;n+=Math.sqrt(l*l+c*c),r=a,o=u}return n},at.isCCW=function(t){var e=t.length-1;if(e<3)throw new m("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],i=0,r=1;r<=e;r++){var o=t[r];o.y>n.y&&(n=o,i=r)}var s=i;do{(s-=1)<0&&(s=e)}while(t[s].equals2D(n)&&s!==i);var a=i;do{a=(a+1)%e}while(t[a].equals2D(n)&&a!==i);var u=t[s],l=t[a];if(u.equals2D(n)||l.equals2D(n)||u.equals2D(l))return!1;var c=at.computeOrientation(u,n,l);return 0===c?u.x>l.x:c>0},at.locatePointInRing=function(t,e){return st.locatePointInRing(t,e)},at.distancePointLinePerpendicular=function(t,e,n){var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)},at.computeOrientation=function(t,e,n){return at.orientationIndex(t,e,n)},at.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new m("Line array must contain at least one vertex");for(var n=t.distance(e[0]),i=0;i<e.length-1;i++){var r=at.distancePointLine(t,e[i],e[i+1]);r<n&&(n=r)}return n}if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];if(s.x===a.x&&s.y===a.y)return o.distance(s);var u=(a.x-s.x)*(a.x-s.x)+(a.y-s.y)*(a.y-s.y),l=((o.x-s.x)*(a.x-s.x)+(o.y-s.y)*(a.y-s.y))/u;if(l<=0)return o.distance(s);if(l>=1)return o.distance(a);var c=((s.y-o.y)*(a.x-s.x)-(s.x-o.x)*(a.y-s.y))/u;return Math.abs(c)*Math.sqrt(u)}},at.isOnLine=function(t,e){for(var n=new rt,i=1;i<e.length;i++){var r=e[i-1],o=e[i];if(n.computeIntersection(t,r,o),n.hasIntersection())return!0}return!1},ut.CLOCKWISE.get=function(){return-1},ut.RIGHT.get=function(){return at.CLOCKWISE},ut.COUNTERCLOCKWISE.get=function(){return 1},ut.LEFT.get=function(){return at.COUNTERCLOCKWISE},ut.COLLINEAR.get=function(){return 0},ut.STRAIGHT.get=function(){return at.COLLINEAR},Object.defineProperties(at,ut);var lt=function(){};lt.prototype.filter=function(t){},lt.prototype.interfaces_=function(){return[]},lt.prototype.getClass=function(){return lt};var ct=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},pt={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};ct.prototype.isGeometryCollection=function(){return this.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION},ct.prototype.getFactory=function(){return this._factory},ct.prototype.getGeometryN=function(t){return this},ct.prototype.getArea=function(){return 0},ct.prototype.isRectangle=function(){return!1},ct.prototype.equals=function(){if(arguments[0]instanceof ct){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof ct))return!1;var n=e;return this.equalsExact(n)}},ct.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},ct.prototype.geometryChanged=function(){this.apply(ct.geometryChangedFilter)},ct.prototype.geometryChangedAction=function(){this._envelope=null},ct.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},ct.prototype.getLength=function(){return 0},ct.prototype.getNumGeometries=function(){return 1},ct.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(n,i)}},ct.prototype.getUserData=function(){return this._userData},ct.prototype.getSRID=function(){return this._SRID},ct.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},ct.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION)throw new m("This method does not support GeometryCollection arguments")},ct.prototype.equal=function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},ct.prototype.norm=function(){var t=this.copy();return t.normalize(),t},ct.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},ct.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new j(this._envelope)},ct.prototype.setSRID=function(t){this._SRID=t},ct.prototype.setUserData=function(t){this._userData=t},ct.prototype.compare=function(t,e){for(var n=t.iterator(),i=e.iterator();n.hasNext()&&i.hasNext();){var r=n.next(),o=i.next(),s=r.compareTo(o);if(0!==s)return s}return n.hasNext()?1:i.hasNext()?-1:0},ct.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},ct.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===ct.SORTINDEX_MULTIPOINT||this.getSortIndex()===ct.SORTINDEX_MULTILINESTRING||this.getSortIndex()===ct.SORTINDEX_MULTIPOLYGON},ct.prototype.interfaces_=function(){return[x,E,e]},ct.prototype.getClass=function(){return ct},ct.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},ct.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},pt.serialVersionUID.get=function(){return 0x799ea46522854c00},pt.SORTINDEX_POINT.get=function(){return 0},pt.SORTINDEX_MULTIPOINT.get=function(){return 1},pt.SORTINDEX_LINESTRING.get=function(){return 2},pt.SORTINDEX_LINEARRING.get=function(){return 3},pt.SORTINDEX_MULTILINESTRING.get=function(){return 4},pt.SORTINDEX_POLYGON.get=function(){return 5},pt.SORTINDEX_MULTIPOLYGON.get=function(){return 6},pt.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},pt.geometryChangedFilter.get=function(){return ht},Object.defineProperties(ct,pt);var ht=function(){};ht.interfaces_=function(){return[lt]},ht.filter=function(t){t.geometryChangedAction()};var ft=function(){};ft.prototype.filter=function(t){},ft.prototype.interfaces_=function(){return[]},ft.prototype.getClass=function(){return ft};var gt=function(){},dt={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};gt.prototype.isInBoundary=function(t){},gt.prototype.interfaces_=function(){return[]},gt.prototype.getClass=function(){return gt},dt.Mod2BoundaryNodeRule.get=function(){return yt},dt.EndPointBoundaryNodeRule.get=function(){return _t},dt.MultiValentEndPointBoundaryNodeRule.get=function(){return mt},dt.MonoValentEndPointBoundaryNodeRule.get=function(){return vt},dt.MOD2_BOUNDARY_RULE.get=function(){return new yt},dt.ENDPOINT_BOUNDARY_RULE.get=function(){return new _t},dt.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new mt},dt.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new vt},dt.OGC_SFS_BOUNDARY_RULE.get=function(){return gt.MOD2_BOUNDARY_RULE},Object.defineProperties(gt,dt);var yt=function(){};yt.prototype.isInBoundary=function(t){return t%2==1},yt.prototype.interfaces_=function(){return[gt]},yt.prototype.getClass=function(){return yt};var _t=function(){};_t.prototype.isInBoundary=function(t){return t>0},_t.prototype.interfaces_=function(){return[gt]},_t.prototype.getClass=function(){return _t};var mt=function(){};mt.prototype.isInBoundary=function(t){return t>1},mt.prototype.interfaces_=function(){return[gt]},mt.prototype.getClass=function(){return mt};var vt=function(){};vt.prototype.isInBoundary=function(t){return 1===t},vt.prototype.interfaces_=function(){return[gt]},vt.prototype.getClass=function(){return vt};var It=function(){};It.prototype.add=function(){},It.prototype.addAll=function(){},It.prototype.isEmpty=function(){},It.prototype.iterator=function(){},It.prototype.size=function(){},It.prototype.toArray=function(){},It.prototype.remove=function(){},(n.prototype=new Error).name="IndexOutOfBoundsException";var Et=function(){};Et.prototype.hasNext=function(){},Et.prototype.next=function(){},Et.prototype.remove=function(){};var xt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(It);(i.prototype=new Error).name="NoSuchElementException";var Nt=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof It&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,It]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},e.prototype.iterator=function(){return new Ct(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new n;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,n=0,i=this.array_.length;n<i;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e},e}(xt),Ct=function(t){function e(e){t.call(this),this.arrayList_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new i;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(Et),St=function(t){function e(){if(t.call(this),0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.ensureCapacity(n.length),this.add(n,i)}}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(t){return this.get(t)},e.prototype.addAll=function(){if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=!1,r=e.iterator();r.hasNext();)this.add(r.next(),n),i=!0;return i}return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var e=t.prototype.clone.call(this),n=0;n<this.size();n++)e.add(n,this.get(n).copy());return e},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){if(1===arguments.length){var e=arguments[0];t.prototype.add.call(this,e)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var n=arguments[0],i=arguments[1];return this.add(n,i,!0),!0}if(arguments[0]instanceof C&&"boolean"==typeof arguments[1]){var r=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(r))return null;t.prototype.add.call(this,r)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1];return this.add(o,s),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var a=arguments[0],u=arguments[1];if(arguments[2])for(var l=0;l<a.length;l++)this.add(a[l],u);else for(var c=a.length-1;c>=0;c--)this.add(a[c],u);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof C){var p=arguments[0],h=arguments[1];if(!arguments[2]){var f=this.size();if(f>0){if(p>0&&this.get(p-1).equals2D(h))return null;if(p<f&&this.get(p).equals2D(h))return null}}t.prototype.add.call(this,p,h)}}else if(4===arguments.length){var g=arguments[0],d=arguments[1],y=arguments[2],_=arguments[3],m=1;y>_&&(m=-1);for(var v=y;v!==_;v+=m)this.add(g[v],d);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new C(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,n),e}(Nt),Lt=function(){},bt={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};bt.ForwardComparator.get=function(){return wt},bt.BidirectionalComparator.get=function(){return Ot},bt.coordArrayType.get=function(){return new Array(0).fill(null)},Lt.prototype.interfaces_=function(){return[]},Lt.prototype.getClass=function(){return Lt},Lt.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))},Lt.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(Lt.indexOf(i,e)<0)return i}return null},Lt.scroll=function(t,e){var n=Lt.indexOf(e,t);if(n<0)return null;var i=new Array(t.length).fill(null);Y.arraycopy(t,n,i,0,t.length-n),Y.arraycopy(t,0,i,t.length-n,n),Y.arraycopy(i,0,t,0,t.length)},Lt.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];if(i===r)return!0;if(null===i||null===r)return!1;if(i.length!==r.length)return!1;for(var s=0;s<i.length;s++)if(0!==o.compare(i[s],r[s]))return!1;return!0}},Lt.intersection=function(t,e){for(var n=new St,i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()},Lt.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},Lt.removeRepeatedPoints=function(t){return Lt.hasRepeatedPoints(t)?new St(t,!1).toCoordinateArray():t},Lt.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),i=0;i<=n;i++){var r=t[i];t[i]=t[e-i],t[e-i]=r}},Lt.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var i=new Array(e).fill(null);if(0===e)return i;for(var r=0,o=0;o<t.length;o++)null!==t[o]&&(i[r++]=t[o]);return i},Lt.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new C(t[n]);return e}if(5===arguments.length)for(var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4],u=0;u<a;u++)o[s+u]=new C(i[r+u])},Lt.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0},Lt.envelope=function(t){for(var e=new j,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},Lt.toCoordinateArray=function(t){return t.toArray(Lt.coordArrayType)},Lt.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},Lt.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},Lt.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1},Lt.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0},Lt.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},Lt.extract=function(t,e,n){e=R.clamp(e,0,t.length);var i=(n=R.clamp(n,-1,t.length))-e+1;n<0&&(i=0),e>=t.length&&(i=0),n<e&&(i=0);var r=new Array(i).fill(null);if(0===i)return r;for(var o=0,s=e;s<=n;s++)r[o++]=t[s];return r},Object.defineProperties(Lt,bt);var wt=function(){};wt.prototype.compare=function(t,e){return Lt.compare(t,e)},wt.prototype.interfaces_=function(){return[N]},wt.prototype.getClass=function(){return wt};var Ot=function(){};Ot.prototype.compare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;var r=Lt.compare(n,i);return Lt.isEqualReversed(n,i)?0:r},Ot.prototype.OLDcompare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;for(var r=Lt.increasingDirection(n),o=Lt.increasingDirection(i),s=r>0?0:n.length-1,a=o>0?0:n.length-1,u=0;u<n.length;u++){var l=n[s].compareTo(i[a]);if(0!==l)return l;s+=r,a+=o}return 0},Ot.prototype.interfaces_=function(){return[N]},Ot.prototype.getClass=function(){return Ot};var Tt=function(){};Tt.prototype.get=function(){},Tt.prototype.put=function(){},Tt.prototype.size=function(){},Tt.prototype.values=function(){},Tt.prototype.entrySet=function(){};var Rt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Tt);(r.prototype=new Error).name="OperationNotSupported",(o.prototype=new It).contains=function(){};var Pt=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof It&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new Dt(this)},e}(o),Dt=function(t){function e(e){t.call(this),this.hashSet_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new i;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new r},e}(Et),Mt=0;(p.prototype=new Rt).get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},p.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:Mt,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,i,r=this.root_;do{if(n=r,(i=t.compareTo(r.key))<0)r=r.left;else{if(!(i>0)){var o=r.value;return r.value=e,o}r=r.right}}while(null!==r);var s={key:t,left:null,right:null,value:e,parent:n,color:Mt,getValue:function(){return this.value},getKey:function(){return this.key}};return i<0?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null},p.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(a(t)===l(a(a(t)))){var e=c(a(a(t)));1===s(e)?(u(a(t),Mt),u(e,Mt),u(a(a(t)),1),t=a(a(t))):(t===c(a(t))&&(t=a(t),this.rotateLeft(t)),u(a(t),Mt),u(a(a(t)),1),this.rotateRight(a(a(t))))}else{var n=l(a(a(t)));1===s(n)?(u(a(t),Mt),u(n,Mt),u(a(a(t)),1),t=a(a(t))):(t===l(a(t))&&(t=a(t),this.rotateRight(t)),u(a(t),Mt),u(a(a(t)),1),this.rotateLeft(a(a(t))))}this.root_.color=Mt},p.prototype.values=function(){var t=new Nt,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=p.successor(e));)t.add(e.value);return t},p.prototype.entrySet=function(){var t=new Pt,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=p.successor(e));)t.add(e);return t},p.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},p.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},p.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},p.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var n=t.parent,i=t;null!==n&&i===n.right;)i=n,n=n.parent;return n},p.prototype.size=function(){return this.size_};var At=function(){};At.prototype.interfaces_=function(){return[]},At.prototype.getClass=function(){return At},h.prototype=new o,(f.prototype=new h).contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},f.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},f.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},f.prototype.remove=function(t){throw new r},f.prototype.size=function(){return this.array_.length},f.prototype.isEmpty=function(){return 0===this.array_.length},f.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},f.prototype.iterator=function(){return new Ft(this)};var Ft=function(t){this.treeSet_=t,this.position_=0};Ft.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new i;return this.treeSet_.array_[this.position_++]},Ft.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Ft.prototype.remove=function(){throw new r};var Gt=function(){};Gt.sort=function(){var t,e,n,i,r=arguments[0];if(1===arguments.length)i=function(t,e){return t.compareTo(e)},r.sort(i);else if(2===arguments.length)n=arguments[1],i=function(t,e){return n.compare(t,e)},r.sort(i);else if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])}else if(4===arguments.length)for(e=r.slice(arguments[1],arguments[2]),n=arguments[3],i=function(t,e){return n.compare(t,e)},e.sort(i),o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])},Gt.asList=function(t){for(var e=new Nt,n=0,i=t.length;n<i;n++)e.add(t[n]);return e};var qt=function(){},Bt={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Bt.P.get=function(){return 0},Bt.L.get=function(){return 1},Bt.A.get=function(){return 2},Bt.FALSE.get=function(){return-1},Bt.TRUE.get=function(){return-2},Bt.DONTCARE.get=function(){return-3},Bt.SYM_FALSE.get=function(){return"F"},Bt.SYM_TRUE.get=function(){return"T"},Bt.SYM_DONTCARE.get=function(){return"*"},Bt.SYM_P.get=function(){return"0"},Bt.SYM_L.get=function(){return"1"},Bt.SYM_A.get=function(){return"2"},qt.prototype.interfaces_=function(){return[]},qt.prototype.getClass=function(){return qt},qt.toDimensionSymbol=function(t){switch(t){case qt.FALSE:return qt.SYM_FALSE;case qt.TRUE:return qt.SYM_TRUE;case qt.DONTCARE:return qt.SYM_DONTCARE;case qt.P:return qt.SYM_P;case qt.L:return qt.SYM_L;case qt.A:return qt.SYM_A;}throw new m("Unknown dimension value: "+t)},qt.toDimensionValue=function(t){switch(A.toUpperCase(t)){case qt.SYM_FALSE:return qt.FALSE;case qt.SYM_TRUE:return qt.TRUE;case qt.SYM_DONTCARE:return qt.DONTCARE;case qt.SYM_P:return qt.P;case qt.SYM_L:return qt.L;case qt.SYM_A:return qt.A;}throw new m("Unknown dimension symbol: "+t)},Object.defineProperties(qt,Bt);var Vt=function(){};Vt.prototype.filter=function(t){},Vt.prototype.interfaces_=function(){return[]},Vt.prototype.getClass=function(){return Vt};var Ut=function(){};Ut.prototype.filter=function(t,e){},Ut.prototype.isDone=function(){},Ut.prototype.isGeometryChanged=function(){},Ut.prototype.interfaces_=function(){return[]},Ut.prototype.getClass=function(){return Ut};var zt=function(t){function e(e,n){if(t.call(this,n),this._geometries=e||[],t.hasNullElements(this._geometries))throw new m("geometries must not contain null elements")}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var t=new j,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},e.prototype.getGeometryN=function(t){return this._geometries[t]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var i=this._geometries[n].getCoordinates(),r=0;r<i.length;r++)t[++e]=i[r];return t},e.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e;if(this._geometries.length!==i._geometries.length)return!1;for(var r=0;r<this._geometries.length;r++)if(!this._geometries[r].equalsExact(i._geometries[r],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();Gt.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var t=qt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},e.prototype.getDimension=function(){for(var t=qt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},e.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=new f(Gt.asList(this._geometries)),n=new f(Gt.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o=i,s=this.getNumGeometries(),a=o.getNumGeometries(),u=0;u<s&&u<a;){var l=this.getGeometryN(u),c=o.getGeometryN(u),p=l.compareToSameClass(c,r);if(0!==p)return p;u++}return u<s?1:u<a?-1:0}},e.prototype.apply=function(){if(T(arguments[0],ft))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(T(arguments[0],Ut)){var n=arguments[0];if(0===this._geometries.length)return null;for(var i=0;i<this._geometries.length&&(this._geometries[i].apply(n),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else if(T(arguments[0],Vt)){var r=arguments[0];r.filter(this);for(var o=0;o<this._geometries.length;o++)this._geometries[o].apply(r)}else if(T(arguments[0],lt)){var s=arguments[0];s.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(s)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),et.shouldNeverReachHere(),null},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._geometries=new Array(this._geometries.length).fill(null);for(var n=0;n<this._geometries.length;n++)e._geometries[n]=this._geometries[n].clone();return e},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(e,n),e}(ct),Xt=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?qt.FALSE:0},e.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)},e.prototype.getBoundary=function(){return new Yt(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[At]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(e,n),e}(zt),Yt=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=gt.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._geom=n,this._geomFact=n.getFactory(),this._bnRule=i}};Yt.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},Yt.prototype.getBoundary=function(){return this._geom instanceof Kt?this.boundaryLineString(this._geom):this._geom instanceof Xt?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},Yt.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},Yt.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},Yt.prototype.computeBoundaryCoordinates=function(t){var e=new Nt;this._endpointMap=new p;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);0!==i.getNumPoints()&&(this.addEndpoint(i.getCoordinateN(0)),this.addEndpoint(i.getCoordinateN(i.getNumPoints()-1)))}for(var r=this._endpointMap.entrySet().iterator();r.hasNext();){var o=r.next(),s=o.getValue().count;this._bnRule.isInBoundary(s)&&e.add(o.getKey())}return Lt.toCoordinateArray(e)},Yt.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new kt,this._endpointMap.put(t,e)),e.count++},Yt.prototype.interfaces_=function(){return[]},Yt.prototype.getClass=function(){return Yt},Yt.getBoundary=function(){if(1===arguments.length){var t=arguments[0];return new Yt(t).getBoundary()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return new Yt(e,n).getBoundary()}};var kt=function(){this.count=null};kt.prototype.interfaces_=function(){return[]},kt.prototype.getClass=function(){return kt};var jt=function(){},Ht={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};jt.prototype.interfaces_=function(){return[]},jt.prototype.getClass=function(){return jt},jt.chars=function(t,e){for(var n=new Array(e).fill(null),i=0;i<e;i++)n[i]=t;return String(n)},jt.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new function(){},n=new function(){}(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o="",s=new function(){}(new function(){}(jt.getStackTrace(i))),a=0;a<r;a++)try{o+=s.readLine()+jt.NEWLINE}catch(t){if(!(t instanceof g))throw t;et.shouldNeverReachHere()}return o}},jt.split=function(t,e){for(var n=e.length,i=new Nt,r=""+t,o=r.indexOf(e);o>=0;){var s=r.substring(0,o);i.add(s),o=(r=r.substring(o+n)).indexOf(e)}r.length>0&&i.add(r);for(var a=new Array(i.size()).fill(null),u=0;u<a.length;u++)a[u]=i.get(u);return a},jt.toString=function(){if(1===arguments.length){var t=arguments[0];return jt.SIMPLE_ORDINATE_FORMAT.format(t)}},jt.spaces=function(t){return jt.chars(" ",t)},Ht.NEWLINE.get=function(){return Y.getProperty("line.separator")},Ht.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(jt,Ht);var Wt=function(){};Wt.prototype.interfaces_=function(){return[]},Wt.prototype.getClass=function(){return Wt},Wt.copyCoord=function(t,e,n,i){for(var r=Math.min(t.getDimension(),n.getDimension()),o=0;o<r;o++)n.setOrdinate(i,o,t.getOrdinate(e,o))},Wt.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,V.X)===t.getOrdinate(e-1,V.X)&&t.getOrdinate(0,V.Y)===t.getOrdinate(e-1,V.Y)},Wt.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var i=Math.min(t.getDimension(),e.getDimension()),r=0;r<n;r++)for(var o=0;o<i;o++){var s=t.getOrdinate(r,o),a=e.getOrdinate(r,o);if(!(t.getOrdinate(r,o)===e.getOrdinate(r,o)||v.isNaN(s)&&v.isNaN(a)))return!1}return!0},Wt.extend=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();if(Wt.copy(e,0,i,0,r),r>0)for(var o=r;o<n;o++)Wt.copy(e,r-1,i,o,1);return i},Wt.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),i=0;i<=n;i++)Wt.swap(t,i,e-i)},Wt.swap=function(t,e,n){if(e===n)return null;for(var i=0;i<t.getDimension();i++){var r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}},Wt.copy=function(t,e,n,i,r){for(var o=0;o<r;o++)Wt.copyCoord(t,e+o,n,i+o)},Wt.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),i=new D;i.append("(");for(var r=0;r<e;r++){r>0&&i.append(" ");for(var o=0;o<n;o++)o>0&&i.append(","),i.append(jt.toString(t.getOrdinate(r,o)))}return i.append(")"),i.toString()}},Wt.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?Wt.createClosedRing(t,e,4):e.getOrdinate(0,V.X)===e.getOrdinate(n-1,V.X)&&e.getOrdinate(0,V.Y)===e.getOrdinate(n-1,V.Y)?e:Wt.createClosedRing(t,e,n+1)},Wt.createClosedRing=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();Wt.copy(e,0,i,0,r);for(var o=r;o<n;o++)Wt.copy(e,0,i,o,1);return i};var Kt=function(t){function e(e,n){t.call(this,n),this._points=null,this.init(e)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new j:this._points.expandEnvelope(new j)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e;if(this._points.size()!==i._points.size())return!1;for(var r=0;r<this._points.size();r++)if(!this.equal(this._points.getCoordinate(r),i._points.getCoordinate(r),n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0&&Wt.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?qt.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return at.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return Wt.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this._points.size()&&n<t._points.size();){var i=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==i)return i;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){var r=arguments[0];return arguments[1].compare(this._points,r._points)}},e.prototype.apply=function(){if(T(arguments[0],ft))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(T(arguments[0],Ut)){var n=arguments[0];if(0===this._points.size())return null;for(var i=0;i<this._points.size()&&(n.filter(this._points,i),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else T(arguments[0],Vt)?arguments[0].filter(this):T(arguments[0],lt)&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return new Yt(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._points=this._points.clone(),e},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new m("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[At]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,n),e}(ct),Jt=function(){};Jt.prototype.interfaces_=function(){return[]},Jt.prototype.getClass=function(){return Jt};var Qt=function(t){function e(e,n){t.call(this,n),this._coordinates=e||null,this.init(this._coordinates)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new j;var t=new j;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),n))}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return qt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}},e.prototype.apply=function(){if(T(arguments[0],ft)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(T(arguments[0],Ut)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else T(arguments[0],Vt)?arguments[0].filter(this):T(arguments[0],lt)&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._coordinates=this._coordinates.clone(),e},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return 0===this._coordinates.size()},e.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),et.isTrue(t.size()<=1),this._coordinates=t},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[Jt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(e,n),e}(ct),$t=function(){};$t.prototype.interfaces_=function(){return[]},$t.prototype.getClass=function(){return $t};var Zt=function(t){function e(e,n,i){if(t.call(this,i),this._shell=null,this._holes=null,null===e&&(e=this.getFactory().createLinearRing()),null===n&&(n=[]),t.hasNullElements(n))throw new m("holes must not contain null elements");if(e.isEmpty()&&t.hasNonEmptyElements(n))throw new m("shell is empty but holes are not");this._shell=e,this._holes=n}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),i=0;i<n.length;i++)t[++e]=n[i];for(var r=0;r<this._holes.length;r++)for(var o=this._holes[r].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t},e.prototype.getArea=function(){var t=0;t+=Math.abs(at.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(at.signedArea(this._holes[e].getCoordinateSequence()));return t},e.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var i=t.getX(n);if(i!==e.getMinX()&&i!==e.getMaxX())return!1;var r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var o=t.getX(0),s=t.getY(0),a=1;a<=4;a++){var u=t.getX(a),l=t.getY(a);if(u!==o==(l!==s))return!1;o=u,s=l}return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e,r=this._shell,o=i._shell;if(!r.equalsExact(o,n))return!1;if(this._holes.length!==i._holes.length)return!1;for(var s=0;s<this._holes.length;s++)if(!this._holes[s].equalsExact(i._holes[s],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);Gt.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var i=new Array(e.getCoordinates().length-1).fill(null);Y.arraycopy(e.getCoordinates(),0,i,0,i.length);var r=Lt.minCoordinate(e.getCoordinates());Lt.scroll(i,r),Y.arraycopy(i,0,e.getCoordinates(),0,i.length),e.getCoordinates()[i.length]=i[0],at.isCCW(e.getCoordinates())===n&&Lt.reverse(e.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},e.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){var i=arguments[0],r=arguments[1],o=i,s=this._shell,a=o._shell,u=s.compareToSameClass(a,r);if(0!==u)return u;for(var l=this.getNumInteriorRing(),c=o.getNumInteriorRing(),p=0;p<l&&p<c;){var h=this.getInteriorRingN(p),f=o.getInteriorRingN(p),g=h.compareToSameClass(f,r);if(0!==g)return g;p++}return p<l?1:p<c?-1:0}},e.prototype.apply=function(t){if(T(t,ft)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(T(t,Ut)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(this._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(T(t,Vt))t.filter(this);else if(T(t,lt)){t.filter(this),this._shell.apply(t);for(var i=0;i<this._holes.length;i++)this._holes[i].apply(t)}},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._shell=this._shell.clone(),e._holes=new Array(this._holes.length).fill(null);for(var n=0;n<this._holes.length;n++)e._holes[n]=this._holes[n].clone();return e},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var t=this._shell.copy(),n=new Array(this._holes.length).fill(null),i=0;i<n.length;i++)n[i]=this._holes[i].copy();return new e(t,n,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(t){return this._holes[t]},e.prototype.interfaces_=function(){return[$t]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,n),e}(ct),te=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(1===arguments.length){var e=arguments[0];return this._geometries[e].getCoordinate()}return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return qt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Jt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(e,n),e}(zt),ee=function(t){function e(e,n){e instanceof C&&n instanceof _e&&(e=n.getCoordinateSequenceFactory().create(e)),t.call(this,e,n),this.validateConstruction()}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return qt.FALSE},e.prototype.isClosed=function(){return!!this.isEmpty()||t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var t=this._points.copy();return Wt.reverse(t),this.getFactory().createLinearRing(t)},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new m("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new m("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,n),e}(Kt),ne=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new Nt,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),i=0;i<n.getNumGeometries();i++)t.add(n.getGeometryN(i));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[$t]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,n),e}(zt),ie=function(t){this._factory=t||null,this._isUserDataCopied=!1},re={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};ie.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},ie.prototype.edit=function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n},ie.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof zt?this.editGeometryCollection(t,e):t instanceof Zt?this.editPolygon(t,e):t instanceof Qt?e.edit(t,this._factory):t instanceof Kt?e.edit(t,this._factory):(et.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},ie.prototype.editGeometryCollection=function(t,e){for(var n=e.edit(t,this._factory),i=new Nt,r=0;r<n.getNumGeometries();r++){var o=this.edit(n.getGeometryN(r),e);null===o||o.isEmpty()||i.add(o)}return n.getClass()===te?this._factory.createMultiPoint(i.toArray([])):n.getClass()===Xt?this._factory.createMultiLineString(i.toArray([])):n.getClass()===ne?this._factory.createMultiPolygon(i.toArray([])):this._factory.createGeometryCollection(i.toArray([]))},ie.prototype.editPolygon=function(t,e){var n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon(null)),n.isEmpty())return n;var i=this.edit(n.getExteriorRing(),e);if(null===i||i.isEmpty())return this._factory.createPolygon();for(var r=new Nt,o=0;o<n.getNumInteriorRing();o++){var s=this.edit(n.getInteriorRingN(o),e);null===s||s.isEmpty()||r.add(s)}return this._factory.createPolygon(i,r.toArray([]))},ie.prototype.interfaces_=function(){return[]},ie.prototype.getClass=function(){return ie},ie.GeometryEditorOperation=function(){},re.NoOpGeometryOperation.get=function(){return oe},re.CoordinateOperation.get=function(){return se},re.CoordinateSequenceOperation.get=function(){return ae},Object.defineProperties(ie,re);var oe=function(){};oe.prototype.edit=function(t,e){return t},oe.prototype.interfaces_=function(){return[ie.GeometryEditorOperation]},oe.prototype.getClass=function(){return oe};var se=function(){};se.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof ee?e.createLinearRing(n):t instanceof Kt?e.createLineString(n):t instanceof Qt?n.length>0?e.createPoint(n[0]):e.createPoint():t},se.prototype.interfaces_=function(){return[ie.GeometryEditorOperation]},se.prototype.getClass=function(){return se};var ae=function(){};ae.prototype.edit=function(t,e){return t instanceof ee?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Kt?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Qt?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},ae.prototype.interfaces_=function(){return[ie.GeometryEditorOperation]},ae.prototype.getClass=function(){return ae};var ue=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var e=0;e<t;e++)this._coordinates[e]=new C}else if(T(arguments[0],V)){var n=arguments[0];if(null===n)return this._coordinates=new Array(0).fill(null),null;this._dimension=n.getDimension(),this._coordinates=new Array(n.size()).fill(null);for(var i=0;i<this._coordinates.length;i++)this._coordinates[i]=n.getCoordinateCopy(i)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var r=arguments[0],o=arguments[1];this._coordinates=r,this._dimension=o,null===r&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var s=arguments[0],a=arguments[1];this._coordinates=new Array(s).fill(null),this._dimension=a;for(var u=0;u<s;u++)this._coordinates[u]=new C}},le={serialVersionUID:{configurable:!0}};ue.prototype.setOrdinate=function(t,e,n){switch(e){case V.X:this._coordinates[t].x=n;break;case V.Y:this._coordinates[t].y=n;break;case V.Z:this._coordinates[t].z=n;break;default:throw new m("invalid ordinateIndex");}},ue.prototype.size=function(){return this._coordinates.length},ue.prototype.getOrdinate=function(t,e){switch(e){case V.X:return this._coordinates[t].x;case V.Y:return this._coordinates[t].y;case V.Z:return this._coordinates[t].z;}return v.NaN},ue.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this._coordinates[e].x,n.y=this._coordinates[e].y,n.z=this._coordinates[e].z}},ue.prototype.getCoordinateCopy=function(t){return new C(this._coordinates[t])},ue.prototype.getDimension=function(){return this._dimension},ue.prototype.getX=function(t){return this._coordinates[t].x},ue.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new ue(t,this._dimension)},ue.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},ue.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new ue(t,this._dimension)},ue.prototype.toString=function(){if(this._coordinates.length>0){var t=new D(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},ue.prototype.getY=function(t){return this._coordinates[t].y},ue.prototype.toCoordinateArray=function(){return this._coordinates},ue.prototype.interfaces_=function(){return[V,e]},ue.prototype.getClass=function(){return ue},le.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(ue,le);var ce=function(){},pe={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};ce.prototype.readResolve=function(){return ce.instance()},ce.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new ue(t)}if(T(arguments[0],V)){var e=arguments[0];return new ue(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return i>3&&(i=3),i<2?new ue(n):new ue(n,i)}},ce.prototype.interfaces_=function(){return[b,e]},ce.prototype.getClass=function(){return ce},ce.instance=function(){return ce.instanceObject},pe.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},pe.instanceObject.get=function(){return new ce},Object.defineProperties(ce,pe);var he=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new Nt,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},e.prototype.entrySet=function(){var t=new Pt;return this.map_.entries().forEach(function(e){return t.add(e)}),t},e.prototype.size=function(){return this.map_.size()},e}(Tt),fe=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof de){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var n=arguments[0];this._modelType=t.FIXED,this.setScale(n)}else if(arguments[0]instanceof t){var i=arguments[0];this._modelType=i._modelType,this._scale=i._scale}},ge={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};fe.prototype.equals=function(t){if(!(t instanceof fe))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},fe.prototype.compareTo=function(t){var e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return new M(n).compareTo(new M(i))},fe.prototype.getScale=function(){return this._scale},fe.prototype.isFloating=function(){return this._modelType===fe.FLOATING||this._modelType===fe.FLOATING_SINGLE},fe.prototype.getType=function(){return this._modelType},fe.prototype.toString=function(){var t="UNKNOWN";return this._modelType===fe.FLOATING?t="Floating":this._modelType===fe.FLOATING_SINGLE?t="Floating-Single":this._modelType===fe.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},fe.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return v.isNaN(t)?t:this._modelType===fe.FLOATING_SINGLE?t:this._modelType===fe.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof C){var e=arguments[0];if(this._modelType===fe.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},fe.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===fe.FLOATING?t=16:this._modelType===fe.FLOATING_SINGLE?t=6:this._modelType===fe.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},fe.prototype.setScale=function(t){this._scale=Math.abs(t)},fe.prototype.interfaces_=function(){return[e,E]},fe.prototype.getClass=function(){return fe},fe.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},ge.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},ge.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(fe,ge);var de=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},ye={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};de.prototype.readResolve=function(){return de.nameToTypeMap.get(this._name)},de.prototype.toString=function(){return this._name},de.prototype.interfaces_=function(){return[e]},de.prototype.getClass=function(){return de},ye.serialVersionUID.get=function(){return-552860263173159e4},ye.nameToTypeMap.get=function(){return new he},Object.defineProperties(de,ye),fe.Type=de,fe.FIXED=new de("FIXED"),fe.FLOATING=new de("FLOATING"),fe.FLOATING_SINGLE=new de("FLOATING SINGLE");var _e=function t(){this._precisionModel=new fe,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?T(arguments[0],b)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof fe&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},me={serialVersionUID:{configurable:!0}};_e.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new C(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new C(t.getMinX(),t.getMinY()),new C(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new C(t.getMinX(),t.getMinY()),new C(t.getMinX(),t.getMaxY()),new C(t.getMaxX(),t.getMaxY()),new C(t.getMaxX(),t.getMinY()),new C(t.getMinX(),t.getMinY())]),null)},_e.prototype.createLineString=function(t){return t?t instanceof Array?new Kt(this.getCoordinateSequenceFactory().create(t),this):T(t,V)?new Kt(t,this):void 0:new Kt(this.getCoordinateSequenceFactory().create([]),this)},_e.prototype.createMultiLineString=function(){if(0===arguments.length)return new Xt(null,this);if(1===arguments.length){var t=arguments[0];return new Xt(t,this)}},_e.prototype.buildGeometry=function(t){for(var e=null,n=!1,i=!1,r=t.iterator();r.hasNext();){var o=r.next(),s=o.getClass();null===e&&(e=s),s!==e&&(n=!0),o.isGeometryCollectionOrDerived()&&(i=!0)}if(null===e)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection(_e.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof Zt)return this.createMultiPolygon(_e.toPolygonArray(t));if(a instanceof Kt)return this.createMultiLineString(_e.toLineStringArray(t));if(a instanceof Qt)return this.createMultiPoint(_e.toPointArray(t));et.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},_e.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},_e.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof C){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(T(arguments[0],V)){var e=arguments[0];return new Qt(e,this)}}},_e.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},_e.prototype.createPolygon=function(){if(0===arguments.length)return new Zt(null,null,this);if(1===arguments.length){if(T(arguments[0],V)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof ee){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];return new Zt(i,r,this)}},_e.prototype.getSRID=function(){return this._SRID},_e.prototype.createGeometryCollection=function(){if(0===arguments.length)return new zt(null,this);if(1===arguments.length){var t=arguments[0];return new zt(t,this)}},_e.prototype.createGeometry=function(t){return new ie(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},_e.prototype.getPrecisionModel=function(){return this._precisionModel},_e.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(T(arguments[0],V)){var e=arguments[0];return new ee(e,this)}}},_e.prototype.createMultiPolygon=function(){if(0===arguments.length)return new ne(null,this);if(1===arguments.length){var t=arguments[0];return new ne(t,this)}},_e.prototype.createMultiPoint=function(){if(0===arguments.length)return new te(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new te(t,this)}if(arguments[0]instanceof Array){var e=arguments[0];return this.createMultiPoint(null!==e?this.getCoordinateSequenceFactory().create(e):null)}if(T(arguments[0],V)){var n=arguments[0];if(null===n)return this.createMultiPoint(new Array(0).fill(null));for(var i=new Array(n.size()).fill(null),r=0;r<n.size();r++){var o=this.getCoordinateSequenceFactory().create(1,n.getDimension());Wt.copy(n,r,o,0,1),i[r]=this.createPoint(o)}return this.createMultiPoint(i)}}},_e.prototype.interfaces_=function(){return[e]},_e.prototype.getClass=function(){return _e},_e.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.getDefaultCoordinateSequenceFactory=function(){return ce.instance()},_e.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},me.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(_e,me);var ve=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Ie=function(t){this.geometryFactory=t||new _e};Ie.prototype.read=function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!Ee[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==ve.indexOf(n)?Ee[n].apply(this,[e.coordinates]):"GeometryCollection"===n?Ee[n].apply(this,[e.geometries]):Ee[n].apply(this,[e])},Ie.prototype.write=function(t){var e=t.getGeometryType();if(!xe[e])throw new Error("Geometry is not supported");return xe[e].apply(this,[t])};var Ee={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var i=t.geometry.type;if(!Ee[i])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=Ee.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(new C(i[0],i[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new C(t[0],t[1]),new C(t[2],t[1]),new C(t[2],t[3]),new C(t[0],t[3]),new C(t[0],t[1])])},Point:function(t){var e=new C(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(Ee.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=Ee.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(Ee.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=Ee.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),i=[],r=1;r<t.length;++r){var o=t[r],s=Ee.coordinates.apply(this,[o]),a=this.geometryFactory.createLinearRing(s);i.push(a)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(Ee.Polygon.apply(this,[i]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},xe={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:xe.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=xe.Point.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),i=0;i<n.length;++i){var r=n[i];e.push(xe.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=xe.LineString.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=xe.LineString.apply(this,[t._shell]);e.push(n.coordinates);for(var i=0;i<t._holes.length;++i){var r=t._holes[i],o=xe.LineString.apply(this,[r]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=xe.Polygon.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=i.getGeometryType();e.push(xe[r].apply(this,[i]))}return{type:"GeometryCollection",geometries:e}}},Ne=function(t){this.geometryFactory=t||new _e,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Ie(this.geometryFactory)};Ne.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===fe.FIXED&&this.reducePrecision(e),e},Ne.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])};var Ce=function(){this.parser=new Ie(this.geometryFactory)};Ce.prototype.write=function(t){return this.parser.write(t)};var Se=function(){},Le={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Se.prototype.interfaces_=function(){return[]},Se.prototype.getClass=function(){return Se},Se.opposite=function(t){return t===Se.LEFT?Se.RIGHT:t===Se.RIGHT?Se.LEFT:t},Le.ON.get=function(){return 0},Le.LEFT.get=function(){return 1},Le.RIGHT.get=function(){return 2},Object.defineProperties(Se,Le),(d.prototype=new Error).name="EmptyStackException",(y.prototype=new xt).add=function(t){return this.array_.push(t),!0},y.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},y.prototype.push=function(t){return this.array_.push(t),t},y.prototype.pop=function(t){if(0===this.array_.length)throw new d;return this.array_.pop()},y.prototype.peek=function(){if(0===this.array_.length)throw new d;return this.array_[this.array_.length-1]},y.prototype.empty=function(){return 0===this.array_.length},y.prototype.isEmpty=function(){return this.empty()},y.prototype.search=function(t){return this.array_.indexOf(t)},y.prototype.size=function(){return this.array_.length},y.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t};var be=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};be.prototype.getCoordinate=function(){return this._minCoord},be.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n},be.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();et.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],i=at.computeOrientation(this._minCoord,n,e),r=!1;e.y<this._minCoord.y&&n.y<this._minCoord.y&&i===at.COUNTERCLOCKWISE?r=!0:e.y>this._minCoord.y&&n.y>this._minCoord.y&&i===at.CLOCKWISE&&(r=!0),r&&(this._minIndex=this._minIndex-1)},be.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var i=Se.LEFT;return n[e].y<n[e+1].y&&(i=Se.RIGHT),i},be.prototype.getEdge=function(){return this._orientedDe},be.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])},be.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},be.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}et.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Se.LEFT&&(this._orientedDe=this._minDe.getSym())},be.prototype.interfaces_=function(){return[]},be.prototype.getClass=function(){return be};var we=function(t){function e(n,i){t.call(this,e.msgWithCoord(n,i)),this.pt=i?new C(i):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},e}(Z),Oe=function(){this.array_=[]};Oe.prototype.addLast=function(t){this.array_.push(t)},Oe.prototype.removeFirst=function(){return this.array_.shift()},Oe.prototype.isEmpty=function(){return 0===this.array_.length};var Te=function(){this._finder=null,this._dirEdgeList=new Nt,this._nodes=new Nt,this._rightMostCoord=null,this._env=null,this._finder=new be};Te.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},Te.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Te.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var i=n.next();if(i.isVisited()||i.getSym().isVisited()){e=i;break}}if(null===e)throw new we("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var r=t.getEdges().iterator();r.hasNext();){var o=r.next();o.setVisited(!0),this.copySymDepths(o)}},Te.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(Se.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},Te.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Te.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(Se.RIGHT)>=1&&e.getDepth(Se.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},Te.prototype.computeDepths=function(t){var e=new Pt,n=new Oe,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){var r=n.removeFirst();e.add(r),this.computeNodeDepth(r);for(var o=r.getEdges().iterator();o.hasNext();){var s=o.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(n.addLast(a),e.add(a))}}}},Te.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},Te.prototype.getEnvelope=function(){if(null===this._env){for(var t=new j,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),i=0;i<n.length-1;i++)t.expandToInclude(n[i]);this._env=t}return this._env},Te.prototype.addReachable=function(t){var e=new y;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},Te.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(Se.LEFT,t.getDepth(Se.RIGHT)),e.setDepth(Se.RIGHT,t.getDepth(Se.LEFT))},Te.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();this._dirEdgeList.add(i);var r=i.getSym().getNode();r.isVisited()||e.push(r)}},Te.prototype.getNodes=function(){return this._nodes},Te.prototype.getDirectedEdges=function(){return this._dirEdgeList},Te.prototype.interfaces_=function(){return[E]},Te.prototype.getClass=function(){return Te};var Re=function t(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[Se.ON]=n}else if(arguments[0]instanceof t){var i=arguments[0];if(this.init(i.location.length),null!==i)for(var r=0;r<this.location.length;r++)this.location[r]=i.location[r]}}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.init(3),this.location[Se.ON]=o,this.location[Se.LEFT]=s,this.location[Se.RIGHT]=a}};Re.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},Re.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==w.NONE)return!1;return!0},Re.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===w.NONE&&(this.location[e]=t)},Re.prototype.isLine=function(){return 1===this.location.length},Re.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[Se.ON]=this.location[Se.ON],e[Se.LEFT]=w.NONE,e[Se.RIGHT]=w.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===w.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},Re.prototype.getLocations=function(){return this.location},Re.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Se.LEFT];this.location[Se.LEFT]=this.location[Se.RIGHT],this.location[Se.RIGHT]=t},Re.prototype.toString=function(){var t=new D;return this.location.length>1&&t.append(w.toLocationSymbol(this.location[Se.LEFT])),t.append(w.toLocationSymbol(this.location[Se.ON])),this.location.length>1&&t.append(w.toLocationSymbol(this.location[Se.RIGHT])),t.toString()},Re.prototype.setLocations=function(t,e,n){this.location[Se.ON]=t,this.location[Se.LEFT]=e,this.location[Se.RIGHT]=n},Re.prototype.get=function(t){return t<this.location.length?this.location[t]:w.NONE},Re.prototype.isArea=function(){return this.location.length>1},Re.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===w.NONE)return!0;return!1},Re.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(Se.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},Re.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(w.NONE)},Re.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},Re.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},Re.prototype.interfaces_=function(){return[]},Re.prototype.getClass=function(){return Re};var Pe=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new Re(e),this.elt[1]=new Re(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.elt[0]=new Re(n.elt[0]),this.elt[1]=new Re(n.elt[1])}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.elt[0]=new Re(w.NONE),this.elt[1]=new Re(w.NONE),this.elt[i].setLocation(r)}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.elt[0]=new Re(o,s,a),this.elt[1]=new Re(o,s,a)}else if(4===arguments.length){var u=arguments[0],l=arguments[1],c=arguments[2],p=arguments[3];this.elt[0]=new Re(w.NONE,w.NONE,w.NONE),this.elt[1]=new Re(w.NONE,w.NONE,w.NONE),this.elt[u].setLocations(l,c,p)}};Pe.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},Pe.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},Pe.prototype.isNull=function(t){return this.elt[t].isNull()},Pe.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},Pe.prototype.isLine=function(t){return this.elt[t].isLine()},Pe.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Re(t.elt[e]):this.elt[e].merge(t.elt[e])},Pe.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},Pe.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(Se.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},Pe.prototype.toString=function(){var t=new D;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},Pe.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},Pe.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},Pe.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(Se.ON,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.elt[n].setLocation(i,r)}},Pe.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},Pe.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},Pe.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Re(this.elt[t].location[0]))},Pe.prototype.interfaces_=function(){return[]},Pe.prototype.getClass=function(){return Pe},Pe.toLineLabel=function(t){for(var e=new Pe(w.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};var De=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Nt,this._pts=new Nt,this._label=new Pe(w.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Nt,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};De.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=at.isCCW(this._ring.getCoordinates())},De.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},De.prototype.computePoints=function(t){this._startDe=t;var e=t,n=!0;do{if(null===e)throw new we("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new we("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var i=e.getLabel();et.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)},De.prototype.getLinearRing=function(){return this._ring},De.prototype.getCoordinate=function(t){return this._pts.get(t)},De.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},De.prototype.addPoints=function(t,e,n){var i=t.getCoordinates();if(e){var r=1;n&&(r=0);for(var o=r;o<i.length;o++)this._pts.add(i[o])}else{var s=i.length-2;n&&(s=i.length-1);for(var a=s;a>=0;a--)this._pts.add(i[a])}},De.prototype.isHole=function(){return this._isHole},De.prototype.setInResult=function(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)},De.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!at.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0},De.prototype.addHole=function(t){this._holes.add(t)},De.prototype.isShell=function(){return null===this._shell},De.prototype.getLabel=function(){return this._label},De.prototype.getEdges=function(){return this._edges},De.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},De.prototype.getShell=function(){return this._shell},De.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=e.getLocation(n,Se.RIGHT);if(i===w.NONE)return null;if(this._label.getLocation(n)===w.NONE)return this._label.setLocation(n,i),null}},De.prototype.setShell=function(t){this._shell=t,null!==t&&t.addHole(this)},De.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},De.prototype.interfaces_=function(){return[]},De.prototype.getClass=function(){return De};var Me=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},e.prototype.getNext=function(t){return t.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(De),Ae=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var t=new Nt,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new Me(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t},e.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)},e.prototype.getNext=function(t){return t.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(De),Fe=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};Fe.prototype.setVisited=function(t){this._isVisited=t},Fe.prototype.setInResult=function(t){this._isInResult=t},Fe.prototype.isCovered=function(){return this._isCovered},Fe.prototype.isCoveredSet=function(){return this._isCoveredSet},Fe.prototype.setLabel=function(t){this._label=t},Fe.prototype.getLabel=function(){return this._label},Fe.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},Fe.prototype.updateIM=function(t){et.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},Fe.prototype.isInResult=function(){return this._isInResult},Fe.prototype.isVisited=function(){return this._isVisited},Fe.prototype.interfaces_=function(){return[]},Fe.prototype.getClass=function(){return Fe};var Ge=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var e=arguments[0],n=arguments[1];this._coord=e,this._edges=n,this._label=new Pe(0,w.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},e.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(t){},e.prototype.computeMergedLocation=function(t,e){var n=w.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var i=t.getLocation(e);n!==w.BOUNDARY&&(n=i)}return n},e.prototype.setLabel=function(){if(2!==arguments.length)return t.prototype.setLabel.apply(this,arguments);var e=arguments[0],n=arguments[1];null===this._label?this._label=new Pe(e,n):this._label.setLocation(e,n)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){if(arguments[0]instanceof e){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof Pe)for(var n=arguments[0],i=0;i<2;i++){var r=this.computeMergedLocation(n,i);this._label.getLocation(i)===w.NONE&&this._label.setLocation(i,r)}},e.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},e.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=w.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;switch(e){case w.BOUNDARY:n=w.INTERIOR;break;case w.INTERIOR:default:n=w.BOUNDARY;}this._label.setLocation(t,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Fe),qe=function(){this.nodeMap=new p,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};qe.prototype.find=function(t){return this.nodeMap.get(t)},qe.prototype.addNode=function(){if(arguments[0]instanceof C){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof Ge){var n=arguments[0],i=this.nodeMap.get(n.getCoordinate());return null===i?(this.nodeMap.put(n.getCoordinate(),n),n):(i.mergeLabel(n),i)}},qe.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},qe.prototype.iterator=function(){return this.nodeMap.values().iterator()},qe.prototype.values=function(){return this.nodeMap.values()},qe.prototype.getBoundaryNodes=function(t){for(var e=new Nt,n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().getLocation(t)===w.BOUNDARY&&e.add(i)}return e},qe.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},qe.prototype.interfaces_=function(){return[]},qe.prototype.getClass=function(){return qe};var Be=function(){},Ve={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Be.prototype.interfaces_=function(){return[]},Be.prototype.getClass=function(){return Be},Be.isNorthern=function(t){return t===Be.NE||t===Be.NW},Be.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},Be.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n},Be.isInHalfPlane=function(t,e){return e===Be.SE?t===Be.SE||t===Be.SW:t===e||t===e+1},Be.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new m("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?Be.NE:Be.SE:e>=0?Be.NW:Be.SW}if(arguments[0]instanceof C&&arguments[1]instanceof C){var n=arguments[0],i=arguments[1];if(i.x===n.x&&i.y===n.y)throw new m("Cannot compute the quadrant for two identical points "+n);return i.x>=n.x?i.y>=n.y?Be.NE:Be.SE:i.y>=n.y?Be.NW:Be.SW}},Ve.NE.get=function(){return 0},Ve.NW.get=function(){return 1},Ve.SW.get=function(){return 2},Ve.SE.get=function(){return 3},Object.defineProperties(Be,Ve);var Ue=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];this._edge=e,this.init(n,i),this._label=null}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this._edge=r,this.init(o,s),this._label=a}};Ue.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:at.computeOrientation(t._p0,t._p1,this._p1)},Ue.prototype.getDy=function(){return this._dy},Ue.prototype.getCoordinate=function(){return this._p0},Ue.prototype.setNode=function(t){this._node=t},Ue.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},Ue.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},Ue.prototype.getDirectedCoordinate=function(){return this._p1},Ue.prototype.getDx=function(){return this._dx},Ue.prototype.getLabel=function(){return this._label},Ue.prototype.getEdge=function(){return this._edge},Ue.prototype.getQuadrant=function(){return this._quadrant},Ue.prototype.getNode=function(){return this._node},Ue.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},Ue.prototype.computeLabel=function(t){},Ue.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=Be.quadrant(this._dx,this._dy),et.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},Ue.prototype.interfaces_=function(){return[E]},Ue.prototype.getClass=function(){return Ue};var ze=function(t){function e(){var e=arguments[0],n=arguments[1];if(t.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=n,n)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var i=e.getNumPoints()-1;this.init(e.getCoordinate(i),e.getCoordinate(i-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(t){return this._depth[t]},e.prototype.setVisited=function(t){this._isVisited=t},e.prototype.computeDirectedLabel=function(){this._label=new Pe(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new we("assigned depths do not match",this.getCoordinate());this._depth[t]=e},e.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,Se.LEFT)===w.INTERIOR&&this._label.getLocation(e,Se.RIGHT)===w.INTERIOR||(t=!1);return t},e.prototype.setNextMin=function(t){this._nextMin=t},e.prototype.print=function(e){t.prototype.print.call(this,e),e.print(" "+this._depth[Se.LEFT]+"/"+this._depth[Se.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")},e.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},e.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,w.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,w.EXTERIOR);return t&&e&&n},e.prototype.setEdgeRing=function(t){this._edgeRing=t},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},e.prototype.setInResult=function(t){this._isInResult=t},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},e.prototype.setSym=function(t){this._sym=t},e.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},e.prototype.setEdgeDepths=function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var i=1;t===Se.LEFT&&(i=-1);var r=Se.opposite(t),o=e+n*i;this.setDepth(t,e),this.setDepth(r,o)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(t){this._next=t},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(t,e){return t===w.EXTERIOR&&e===w.INTERIOR?1:t===w.INTERIOR&&e===w.EXTERIOR?-1:0},e}(Ue),Xe=function(){};Xe.prototype.createNode=function(t){return new Ge(t,null)},Xe.prototype.interfaces_=function(){return[]},Xe.prototype.getClass=function(){return Xe};var Ye=function(){if(this._edges=new Nt,this._nodes=null,this._edgeEndList=new Nt,0===arguments.length)this._nodes=new qe(new Xe());else if(1===arguments.length){var t=arguments[0];this._nodes=new qe(t)}};Ye.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}},Ye.prototype.find=function(t){return this._nodes.find(t)},Ye.prototype.addNode=function(){if(arguments[0]instanceof Ge){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof C){var e=arguments[0];return this._nodes.addNode(e)}},Ye.prototype.getNodeIterator=function(){return this._nodes.iterator()},Ye.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},Ye.prototype.debugPrintln=function(t){Y.out.println(t)},Ye.prototype.isBoundaryNode=function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var i=n.getLabel();return null!==i&&i.getLocation(t)===w.BOUNDARY},Ye.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},Ye.prototype.matchInSameDirection=function(t,e,n,i){return!!t.equals(n)&&at.computeOrientation(t,e,i)===at.COLLINEAR&&Be.quadrant(t,e)===Be.quadrant(n,i)},Ye.prototype.getEdgeEnds=function(){return this._edgeEndList},Ye.prototype.debugPrint=function(t){Y.out.print(t)},Ye.prototype.getEdgeIterator=function(){return this._edges.iterator()},Ye.prototype.findEdgeInSameDirection=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null},Ye.prototype.insertEdge=function(t){this._edges.add(t)},Ye.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},Ye.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var i=new ze(n,!0),r=new ze(n,!1);i.setSym(r),r.setSym(i),this.add(i),this.add(r)}},Ye.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},Ye.prototype.getNodes=function(){return this._nodes.values()},Ye.prototype.findEdge=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null},Ye.prototype.interfaces_=function(){return[]},Ye.prototype.getClass=function(){return Ye},Ye.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()};var ke=function(){this._geometryFactory=null,this._shellList=new Nt;var t=arguments[0];this._geometryFactory=t};ke.prototype.sortShellsAndHoles=function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isHole()?n.add(r):e.add(r)}},ke.prototype.computePolygons=function(t){for(var e=new Nt,n=t.iterator();n.hasNext();){var i=n.next().toPolygon(this._geometryFactory);e.add(i)}return e},ke.prototype.placeFreeHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(null===i.getShell()){var r=this.findEdgeRingContaining(i,t);if(null===r)throw new we("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(r)}}},ke.prototype.buildMinimalEdgeRings=function(t,e,n){for(var i=new Nt,r=t.iterator();r.hasNext();){var o=r.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):n.addAll(s)}else i.add(o)}return i},ke.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},ke.prototype.buildMaximalEdgeRings=function(t){for(var e=new Nt,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&null===i.getEdgeRing()){var r=new Ae(i,this._geometryFactory);e.add(r),r.setInResult()}}return e},ke.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()&&i.setShell(t)}},ke.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},ke.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var u=a.next(),l=u.getLinearRing(),c=l.getEnvelopeInternal();null!==o&&(s=o.getLinearRing().getEnvelopeInternal());var p=!1;c.contains(i)&&at.isPointInRing(r,l.getCoordinates())&&(p=!0),p&&(null===o||s.contains(c))&&(o=u)}return o},ke.prototype.findShell=function(t){for(var e=0,n=null,i=t.iterator();i.hasNext();){var r=i.next();r.isHole()||(n=r,e++)}return et.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},ke.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];Ye.linkResultDirectedEdges(n);var i=this.buildMaximalEdgeRings(e),r=new Nt,o=this.buildMinimalEdgeRings(i,this._shellList,r);this.sortShellsAndHoles(o,this._shellList,r),this.placeFreeHoles(this._shellList,r)}},ke.prototype.interfaces_=function(){return[]},ke.prototype.getClass=function(){return ke};var je=function(){};je.prototype.getBounds=function(){},je.prototype.interfaces_=function(){return[]},je.prototype.getClass=function(){return je};var He=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};He.prototype.getItem=function(){return this._item},He.prototype.getBounds=function(){return this._bounds},He.prototype.interfaces_=function(){return[je,e]},He.prototype.getClass=function(){return He};var We=function(){this._size=null,this._items=null,this._size=0,this._items=new Nt,this._items.add(null)};We.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},We.prototype.size=function(){return this._size},We.prototype.reorder=function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)},We.prototype.clear=function(){this._size=0,this._items.clear()},We.prototype.isEmpty=function(){return 0===this._size},We.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},We.prototype.interfaces_=function(){return[]},We.prototype.getClass=function(){return We};var Ke=function(){};Ke.prototype.visitItem=function(t){},Ke.prototype.interfaces_=function(){return[]},Ke.prototype.getClass=function(){return Ke};var Je=function(){};Je.prototype.insert=function(t,e){},Je.prototype.remove=function(t,e){},Je.prototype.query=function(){},Je.prototype.interfaces_=function(){return[]},Je.prototype.getClass=function(){return Je};var Qe=function(){if(this._childBoundables=new Nt,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},$e={serialVersionUID:{configurable:!0}};Qe.prototype.getLevel=function(){return this._level},Qe.prototype.size=function(){return this._childBoundables.size()},Qe.prototype.getChildBoundables=function(){return this._childBoundables},Qe.prototype.addChildBoundable=function(t){et.isTrue(null===this._bounds),this._childBoundables.add(t)},Qe.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Qe.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Qe.prototype.interfaces_=function(){return[je,e]},Qe.prototype.getClass=function(){return Qe},$e.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Qe,$e);var Ze=function(){};Ze.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},Ze.min=function(t){return Ze.sort(t),t.get(0)},Ze.sort=function(t,e){var n=t.toArray();e?Gt.sort(n,e):Gt.sort(n);for(var i=t.iterator(),r=0,o=n.length;r<o;r++)i.next(),i.set(n[r])},Ze.singletonList=function(t){var e=new Nt;return e.add(t),e};var tn=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()};tn.prototype.expandToQueue=function(t,e){var n=tn.isComposite(this._boundable1),i=tn.isComposite(this._boundable2);if(n&&i)return tn.area(this._boundable1)>tn.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(i)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new m("neither boundable is composite")},tn.prototype.isLeaves=function(){return!(tn.isComposite(this._boundable1)||tn.isComposite(this._boundable2))},tn.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},tn.prototype.expand=function(t,e,n,i){for(var r=t.getChildBoundables().iterator();r.hasNext();){var o=r.next(),s=new tn(o,e,this._itemDistance);s.getDistance()<i&&n.add(s)}},tn.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},tn.prototype.getDistance=function(){return this._distance},tn.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},tn.prototype.interfaces_=function(){return[E]},tn.prototype.getClass=function(){return tn},tn.area=function(t){return t.getBounds().getArea()},tn.isComposite=function(t){return t instanceof Qe};var en=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new Nt,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var n=arguments[0];et.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},nn={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};en.prototype.getNodeCapacity=function(){return this._nodeCapacity},en.prototype.lastNode=function(t){return t.get(t.size()-1)},en.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Qe?t+=this.size(n):n instanceof He&&(t+=1)}return t}},en.prototype.removeItem=function(t,e){for(var n=null,i=t.getChildBoundables().iterator();i.hasNext();){var r=i.next();r instanceof He&&r.getItem()===e&&(n=r)}return null!==n&&(t.getChildBoundables().remove(n),!0)},en.prototype.itemsTree=function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new Nt:t}if(1===arguments.length){for(var e=arguments[0],n=new Nt,i=e.getChildBoundables().iterator();i.hasNext();){var r=i.next();if(r instanceof Qe){var o=this.itemsTree(r);null!==o&&n.add(o)}else r instanceof He?n.add(r.getItem()):et.shouldNeverReachHere()}return n.size()<=0?null:n}},en.prototype.insert=function(t,e){et.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new He(t,e))},en.prototype.boundablesAtLevel=function(){if(1===arguments.length){var t=arguments[0],e=new Nt;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(et.isTrue(n>-2),i.getLevel()===n)return r.add(i),null;for(var o=i.getChildBoundables().iterator();o.hasNext();){var s=o.next();s instanceof Qe?this.boundablesAtLevel(n,s,r):(et.isTrue(s instanceof He),-1===n&&r.add(s))}return null}},en.prototype.query=function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new Nt;return this.isEmpty()?e:(this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e),e)}if(2===arguments.length){var n=arguments[0],i=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,i)}else if(3===arguments.length)if(T(arguments[2],Ke)&&arguments[0]instanceof Object&&arguments[1]instanceof Qe)for(var r=arguments[0],o=arguments[1],s=arguments[2],a=o.getChildBoundables(),u=0;u<a.size();u++){var l=a.get(u);this.getIntersectsOp().intersects(l.getBounds(),r)&&(l instanceof Qe?this.query(r,l,s):l instanceof He?s.visitItem(l.getItem()):et.shouldNeverReachHere())}else if(T(arguments[2],xt)&&arguments[0]instanceof Object&&arguments[1]instanceof Qe)for(var c=arguments[0],p=arguments[1],h=arguments[2],f=p.getChildBoundables(),g=0;g<f.size();g++){var d=f.get(g);this.getIntersectsOp().intersects(d.getBounds(),c)&&(d instanceof Qe?this.query(c,d,h):d instanceof He?h.add(d.getItem()):et.shouldNeverReachHere())}},en.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},en.prototype.getRoot=function(){return this.build(),this._root},en.prototype.remove=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=this.removeItem(i,r);if(o)return!0;for(var s=null,a=i.getChildBoundables().iterator();a.hasNext();){var u=a.next();if(this.getIntersectsOp().intersects(u.getBounds(),n)&&u instanceof Qe&&(o=this.remove(n,u,r))){s=u;break}}return null!==s&&s.getChildBoundables().isEmpty()&&i.getChildBoundables().remove(s),o}},en.prototype.createHigherLevels=function(t,e){et.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},en.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof Qe){var i=this.depth(n);i>t&&(t=i)}}return t+1}},en.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var n=new Nt;n.add(this.createNode(e));var i=new Nt(t);Ze.sort(i,this.getComparator());for(var r=i.iterator();r.hasNext();){var o=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n},en.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},en.prototype.interfaces_=function(){return[e]},en.prototype.getClass=function(){return en},en.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},nn.IntersectsOp.get=function(){return rn},nn.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},nn.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(en,nn);var rn=function(){},on=function(){};on.prototype.distance=function(t,e){},on.prototype.interfaces_=function(){return[]},on.prototype.getClass=function(){return on};var sn=function(t){function n(e){e=e||n.DEFAULT_NODE_CAPACITY,t.call(this,e)}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var i={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return n.prototype.createParentBoundablesFromVerticalSlices=function(t,e){et.isTrue(t.length>0);for(var n=new Nt,i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n},n.prototype.createNode=function(t){return new an(t)},n.prototype.size=function(){return 0===arguments.length?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},n.prototype.insert=function(){if(2!==arguments.length)return t.prototype.insert.apply(this,arguments);var e=arguments[0],n=arguments[1];if(e.isNull())return null;t.prototype.insert.call(this,e,n)},n.prototype.getIntersectsOp=function(){return n.intersectsOp},n.prototype.verticalSlices=function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator(),o=0;o<e;o++){i[o]=new Nt;for(var s=0;r.hasNext()&&s<n;){var a=r.next();i[o].add(a),s++}}return i},n.prototype.query=function(){if(1===arguments.length){var e=arguments[0];return t.prototype.query.call(this,e)}if(2===arguments.length){var n=arguments[0],i=arguments[1];t.prototype.query.call(this,n,i)}else if(3===arguments.length)if(T(arguments[2],Ke)&&arguments[0]instanceof Object&&arguments[1]instanceof Qe){var r=arguments[0],o=arguments[1],s=arguments[2];t.prototype.query.call(this,r,o,s)}else if(T(arguments[2],xt)&&arguments[0]instanceof Object&&arguments[1]instanceof Qe){var a=arguments[0],u=arguments[1],l=arguments[2];t.prototype.query.call(this,a,u,l)}},n.prototype.getComparator=function(){return n.yComparator},n.prototype.createParentBoundablesFromVerticalSlice=function(e,n){return t.prototype.createParentBoundables.call(this,e,n)},n.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return t.prototype.remove.call(this,e,n)}return t.prototype.remove.apply(this,arguments)},n.prototype.depth=function(){return 0===arguments.length?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},n.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var i=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),r=new Nt(t);Ze.sort(r,n.xComparator);var o=this.verticalSlices(r,Math.trunc(Math.ceil(Math.sqrt(i))));return this.createParentBoundablesFromVerticalSlices(o,e)},n.prototype.nearestNeighbour=function(){if(1===arguments.length){if(T(arguments[0],on)){var t=arguments[0],e=new tn(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof tn){var i=arguments[0];return this.nearestNeighbour(i,v.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof n&&T(arguments[1],on)){var r=arguments[0],o=arguments[1],s=new tn(this.getRoot(),r.getRoot(),o);return this.nearestNeighbour(s)}if(arguments[0]instanceof tn&&"number"==typeof arguments[1]){var a=arguments[0],u=arguments[1],l=null,c=new We;for(c.add(a);!c.isEmpty()&&u>0;){var p=c.poll(),h=p.getDistance();if(h>=u)break;p.isLeaves()?(u=h,l=p):p.expandToQueue(c,u)}return[l.getBoundable(0).getItem(),l.getBoundable(1).getItem()]}}else if(3===arguments.length){var f=arguments[0],g=arguments[1],d=arguments[2],y=new He(f,g),_=new tn(this.getRoot(),y,d);return this.nearestNeighbour(_)[0]}},n.prototype.interfaces_=function(){return[Je,e]},n.prototype.getClass=function(){return n},n.centreX=function(t){return n.avg(t.getMinX(),t.getMaxX())},n.avg=function(t,e){return(t+e)/2},n.centreY=function(t){return n.avg(t.getMinY(),t.getMaxY())},i.STRtreeNode.get=function(){return an},i.serialVersionUID.get=function(){return 0x39920f7d5f261e0},i.xComparator.get=function(){return{interfaces_:function(){return[N]},compare:function(e,i){return t.compareDoubles(n.centreX(e.getBounds()),n.centreX(i.getBounds()))}}},i.yComparator.get=function(){return{interfaces_:function(){return[N]},compare:function(e,i){return t.compareDoubles(n.centreY(e.getBounds()),n.centreY(i.getBounds()))}}},i.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},i.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(n,i),n}(en),an=function(t){function e(){var e=arguments[0];t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new j(n.getBounds()):t.expandToInclude(n.getBounds())}return t},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Qe),un=function(){};un.prototype.interfaces_=function(){return[]},un.prototype.getClass=function(){return un},un.relativeSign=function(t,e){return t<e?-1:t>e?1:0},un.compare=function(t,e,n){if(e.equals2D(n))return 0;var i=un.relativeSign(e.x,n.x),r=un.relativeSign(e.y,n.y);switch(t){case 0:return un.compareValue(i,r);case 1:return un.compareValue(r,i);case 2:return un.compareValue(r,-i);case 3:return un.compareValue(-i,r);case 4:return un.compareValue(-i,-r);case 5:return un.compareValue(-r,-i);case 6:return un.compareValue(-r,i);case 7:return un.compareValue(i,-r);}return et.shouldNeverReachHere("invalid octant value"),0},un.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var ln=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._segString=t,this.coord=new C(e),this.segmentIndex=n,this._segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))};ln.prototype.getCoordinate=function(){return this.coord},ln.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},ln.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:un.compare(this._segmentOctant,this.coord,e.coord)},ln.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},ln.prototype.isInterior=function(){return this._isInterior},ln.prototype.interfaces_=function(){return[E]},ln.prototype.getClass=function(){return ln};var cn=function(){this._nodeMap=new p,this._edge=null;var t=arguments[0];this._edge=t};cn.prototype.getSplitCoordinates=function(){var t=new St;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()},cn.prototype.addCollapsedNodes=function(){var t=new Nt;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}},cn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},cn.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),i=this._edge.getCoordinate(e+2);n.equals2D(i)&&t.add(new M(e+1))}},cn.prototype.addEdgeCoordinates=function(t,e,n){var i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);n.add(new C(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)n.add(this._edge.getCoordinate(o));r&&n.add(new C(e.coord))},cn.prototype.iterator=function(){return this._nodeMap.values().iterator()},cn.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},cn.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)},cn.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),n=this.iterator(),i=n.next();n.hasNext();){var r=n.next();this.findCollapseIndex(i,r,e)&&t.add(new M(e[0])),i=r}},cn.prototype.getEdge=function(){return this._edge},cn.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},cn.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new C(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this._edge.getCoordinate(a);return r&&(o[s]=new C(e.coord)),new gn(o,this._edge.getData())},cn.prototype.add=function(t,e){var n=new ln(this._edge,t,e,this._edge.getSegmentOctant(e)),i=this._nodeMap.get(n);return null!==i?(et.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(n,n),n)},cn.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new Z("bad split edge start point at "+n);var i=t.get(t.size()-1).getCoordinates(),r=i[i.length-1];if(!r.equals2D(e[e.length-1]))throw new Z("bad split edge end point at "+r)},cn.prototype.interfaces_=function(){return[]},cn.prototype.getClass=function(){return cn};var pn=function(){};pn.prototype.interfaces_=function(){return[]},pn.prototype.getClass=function(){return pn},pn.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new m("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),i=Math.abs(e);return t>=0?e>=0?n>=i?0:1:n>=i?7:6:e>=0?n>=i?3:2:n>=i?4:5}if(arguments[0]instanceof C&&arguments[1]instanceof C){var r=arguments[0],o=arguments[1],s=o.x-r.x,a=o.y-r.y;if(0===s&&0===a)throw new m("Cannot compute the octant for two identical points "+r);return pn.octant(s,a)}};var hn=function(){};hn.prototype.getCoordinates=function(){},hn.prototype.size=function(){},hn.prototype.getCoordinate=function(t){},hn.prototype.isClosed=function(){},hn.prototype.setData=function(t){},hn.prototype.getData=function(){},hn.prototype.interfaces_=function(){return[]},hn.prototype.getClass=function(){return hn};var fn=function(){};fn.prototype.addIntersection=function(t,e){},fn.prototype.interfaces_=function(){return[hn]},fn.prototype.getClass=function(){return fn};var gn=function(){this._nodeList=new cn(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};gn.prototype.getCoordinates=function(){return this._pts},gn.prototype.size=function(){return this._pts.length},gn.prototype.getCoordinate=function(t){return this._pts[t]},gn.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},gn.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},gn.prototype.setData=function(t){this._data=t},gn.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:pn.octant(t,e)},gn.prototype.getData=function(){return this._data},gn.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[3],o=new C(n.getIntersection(r));this.addIntersection(o,i)}},gn.prototype.toString=function(){return $.toLineString(new ue(this._pts))},gn.prototype.getNodeList=function(){return this._nodeList},gn.prototype.addIntersectionNode=function(t,e){var n=e,i=n+1;if(i<this._pts.length){var r=this._pts[i];t.equals2D(r)&&(n=i)}return this._nodeList.add(t,n)},gn.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},gn.prototype.interfaces_=function(){return[fn]},gn.prototype.getClass=function(){return gn},gn.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new Nt;return gn.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[0],i=arguments[1],r=n.iterator();r.hasNext();)r.next().getNodeList().addSplitEdges(i)};var dn=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new C,this.p1=new C;else if(1===arguments.length){var t=arguments[0];this.p0=new C(t.p0),this.p1=new C(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3];this.p0=new C(e,n),this.p1=new C(i,r)}},yn={serialVersionUID:{configurable:!0}};dn.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},dn.prototype.orientationIndex=function(){if(arguments[0]instanceof dn){var t=arguments[0],e=at.orientationIndex(this.p0,this.p1,t.p0),n=at.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0?Math.max(e,n):e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof C){var i=arguments[0];return at.orientationIndex(this.p0,this.p1,i)}},dn.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},dn.prototype.isVertical=function(){return this.p0.x===this.p1.x},dn.prototype.equals=function(t){if(!(t instanceof dn))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},dn.prototype.intersection=function(t){var e=new rt;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},dn.prototype.project=function(){if(arguments[0]instanceof C){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new C(t);var e=this.projectionFactor(t),n=new C;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof dn){var i=arguments[0],r=this.projectionFactor(i.p0),o=this.projectionFactor(i.p1);if(r>=1&&o>=1)return null;if(r<=0&&o<=0)return null;var s=this.project(i.p0);r<0&&(s=this.p0),r>1&&(s=this.p1);var a=this.project(i.p1);return o<0&&(a=this.p0),o>1&&(a=this.p1),new dn(s,a)}},dn.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},dn.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},dn.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},dn.prototype.distancePerpendicular=function(t){return at.distancePointLinePerpendicular(t,this.p0,this.p1)},dn.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},dn.prototype.midPoint=function(){return dn.midPoint(this.p0,this.p1)},dn.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;return i<=0?v.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i},dn.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),i=v.MAX_VALUE,r=null,o=this.closestPoint(t.p0);i=o.distance(t.p0),n[0]=o,n[1]=t.p0;var s=this.closestPoint(t.p1);(r=s.distance(t.p1))<i&&(i=r,n[0]=s,n[1]=t.p1);var a=t.closestPoint(this.p0);(r=a.distance(this.p0))<i&&(i=r,n[0]=this.p0,n[1]=a);var u=t.closestPoint(this.p1);return(r=u.distance(this.p1))<i&&(i=r,n[0]=this.p1,n[1]=u),n},dn.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},dn.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},dn.prototype.getLength=function(){return this.p0.distance(this.p1)},dn.prototype.compareTo=function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},dn.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},dn.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},dn.prototype.lineIntersection=function(t){try{return k.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof X))throw t}return null},dn.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},dn.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(r*r+o*o),a=0,u=0;if(0!==e){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");a=e*r/s,u=e*o/s}return new C(n-u,i+a)},dn.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},dn.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||v.isNaN(e))&&(e=1),e},dn.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},dn.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},dn.prototype.distance=function(){if(arguments[0]instanceof dn){var t=arguments[0];return at.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof C){var e=arguments[0];return at.distancePointLine(e,this.p0,this.p1)}},dn.prototype.pointAlong=function(t){var e=new C;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},dn.prototype.hashCode=function(){var t=v.doubleToLongBits(this.p0.x);t^=31*v.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=v.doubleToLongBits(this.p1.x);return n^=31*v.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)},dn.prototype.interfaces_=function(){return[E,e]},dn.prototype.getClass=function(){return dn},dn.midPoint=function(t,e){return new C((t.x+e.x)/2,(t.y+e.y)/2)},yn.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(dn,yn);var _n=function(){this.tempEnv1=new j,this.tempEnv2=new j,this._overlapSeg1=new dn,this._overlapSeg2=new dn};_n.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];t.getLineSegment(e,this._overlapSeg1),n.getLineSegment(i,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},_n.prototype.interfaces_=function(){return[]},_n.prototype.getClass=function(){return _n};var mn=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=i};mn.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},mn.prototype.computeSelect=function(t,e,n,i){var r=this._pts[e],o=this._pts[n];if(i.tempEnv1.init(r,o),n-e==1)return i.select(this,e),null;if(!t.intersects(i.tempEnv1))return null;var s=Math.trunc((e+n)/2);e<s&&this.computeSelect(t,e,s,i),s<n&&this.computeSelect(t,s,n,i)},mn.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t},mn.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},mn.prototype.setId=function(t){this._id=t},mn.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},mn.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new j(t,e)}return this._env},mn.prototype.getEndIndex=function(){return this._end},mn.prototype.getStartIndex=function(){return this._start},mn.prototype.getContext=function(){return this._context},mn.prototype.getId=function(){return this._id},mn.prototype.computeOverlapsInternal=function(t,e,n,i,r,o){var s=this._pts[t],a=this._pts[e],u=n._pts[i],l=n._pts[r];if(e-t==1&&r-i==1)return o.overlap(this,t,n,i),null;if(o.tempEnv1.init(s,a),o.tempEnv2.init(u,l),!o.tempEnv1.intersects(o.tempEnv2))return null;var c=Math.trunc((t+e)/2),p=Math.trunc((i+r)/2);t<c&&(i<p&&this.computeOverlapsInternal(t,c,n,i,p,o),p<r&&this.computeOverlapsInternal(t,c,n,p,r,o)),c<e&&(i<p&&this.computeOverlapsInternal(c,e,n,i,p,o),p<r&&this.computeOverlapsInternal(c,e,n,p,r,o))},mn.prototype.interfaces_=function(){return[]},mn.prototype.getClass=function(){return mn};var vn=function(){};vn.prototype.interfaces_=function(){return[]},vn.prototype.getClass=function(){return vn},vn.getChainStartIndices=function(t){var e=0,n=new Nt;n.add(new M(e));do{var i=vn.findChainEnd(t,e);n.add(new M(i)),e=i}while(e<t.length-1);return vn.toIntArray(n)},vn.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var i=Be.quadrant(t[n],t[n+1]),r=e+1;r<t.length&&(t[r-1].equals2D(t[r])||Be.quadrant(t[r-1],t[r])===i);)r++;return r-1},vn.getChains=function(){if(1===arguments.length){var t=arguments[0];return vn.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=new Nt,r=vn.getChainStartIndices(e),o=0;o<r.length-1;o++){var s=new mn(e,r[o],r[o+1],n);i.add(s)}return i}},vn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var In=function(){};In.prototype.computeNodes=function(t){},In.prototype.getNodedSubstrings=function(){},In.prototype.interfaces_=function(){return[]},In.prototype.getClass=function(){return In};var En=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};En.prototype.setSegmentIntersector=function(t){this._segInt=t},En.prototype.interfaces_=function(){return[In]},En.prototype.getClass=function(){return En};var xn=function(t){function e(e){e?t.call(this,e):t.call(this),this._monoChains=new Nt,this._index=new sn,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return gn.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(t){for(var e=vn.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}},e.prototype.computeNodes=function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var t=new Nn(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),i=this._index.query(n.getEnvelope()).iterator();i.hasNext();){var r=i.next();if(r.getId()>n.getId()&&(n.computeOverlaps(r,t),this._nOverlaps++),this._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.SegmentOverlapAction.get=function(){return Nn},Object.defineProperties(e,n),e}(En),Nn=function(t){function e(){t.call(this),this._si=null;var e=arguments[0];this._si=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(4!==arguments.length)return t.prototype.overlap.apply(this,arguments);var e=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3],o=e.getContext(),s=i.getContext();this._si.processIntersections(o,n,s,r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(_n),Cn=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(i)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(o),this.setJoinStyle(s),this.setMitreLimit(a)}},Sn={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Cn.prototype.getEndCapStyle=function(){return this._endCapStyle},Cn.prototype.isSingleSided=function(){return this._isSingleSided},Cn.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=Cn.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Cn.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==Cn.JOIN_ROUND&&(this._quadrantSegments=Cn.DEFAULT_QUADRANT_SEGMENTS)},Cn.prototype.getJoinStyle=function(){return this._joinStyle},Cn.prototype.setJoinStyle=function(t){this._joinStyle=t},Cn.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},Cn.prototype.getSimplifyFactor=function(){return this._simplifyFactor},Cn.prototype.getQuadrantSegments=function(){return this._quadrantSegments},Cn.prototype.setEndCapStyle=function(t){this._endCapStyle=t},Cn.prototype.getMitreLimit=function(){return this._mitreLimit},Cn.prototype.setMitreLimit=function(t){this._mitreLimit=t},Cn.prototype.setSingleSided=function(t){this._isSingleSided=t},Cn.prototype.interfaces_=function(){return[]},Cn.prototype.getClass=function(){return Cn},Cn.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},Sn.CAP_ROUND.get=function(){return 1},Sn.CAP_FLAT.get=function(){return 2},Sn.CAP_SQUARE.get=function(){return 3},Sn.JOIN_ROUND.get=function(){return 1},Sn.JOIN_MITRE.get=function(){return 2},Sn.JOIN_BEVEL.get=function(){return 3},Sn.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Sn.DEFAULT_MITRE_LIMIT.get=function(){return 5},Sn.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01},Object.defineProperties(Cn,Sn);var Ln=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=at.COUNTERCLOCKWISE,this._inputLine=t||null},bn={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Ln.prototype.isDeletable=function(t,e,n,i){var r=this._inputLine[t],o=this._inputLine[e],s=this._inputLine[n];return!!this.isConcave(r,o,s)&&!!this.isShallow(r,o,s,i)&&this.isShallowSampled(r,o,t,n,i)},Ln.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),i=!1;n<this._inputLine.length;){var r=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=Ln.DELETE,r=!0,i=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i},Ln.prototype.isShallowConcavity=function(t,e,n,i){return at.computeOrientation(t,e,n)===this._angleOrientation&&at.distancePointLine(e,t,n)<i},Ln.prototype.isShallowSampled=function(t,e,n,i,r){var o=Math.trunc((i-n)/Ln.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var s=n;s<i;s+=o)if(!this.isShallow(t,e,this._inputLine[s],r))return!1;return!0},Ln.prototype.isConcave=function(t,e,n){return at.computeOrientation(t,e,n)===this._angleOrientation},Ln.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=at.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},Ln.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Ln.DELETE;)e++;return e},Ln.prototype.isShallow=function(t,e,n,i){return at.distancePointLine(e,t,n)<i},Ln.prototype.collapseLine=function(){for(var t=new St,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Ln.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},Ln.prototype.interfaces_=function(){return[]},Ln.prototype.getClass=function(){return Ln},Ln.simplify=function(t,e){return new Ln(t).simplify(e)},bn.INIT.get=function(){return 0},bn.DELETE.get=function(){return 1},bn.KEEP.get=function(){return 1},bn.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Ln,bn);var wn=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Nt},On={COORDINATE_ARRAY_TYPE:{configurable:!0}};wn.prototype.getCoordinates=function(){return this._ptList.toArray(wn.COORDINATE_ARRAY_TYPE)},wn.prototype.setPrecisionModel=function(t){this._precisionModel=t},wn.prototype.addPt=function(t){var e=new C(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},wn.prototype.revere=function(){},wn.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var i=t.length-1;i>=0;i--)this.addPt(t[i])},wn.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},wn.prototype.toString=function(){return new _e().createLineString(this.getCoordinates()).toString()},wn.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new C(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},wn.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},wn.prototype.interfaces_=function(){return[]},wn.prototype.getClass=function(){return wn},On.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(wn,On);var Tn=function(){},Rn={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Tn.prototype.interfaces_=function(){return[]},Tn.prototype.getClass=function(){return Tn},Tn.toDegrees=function(t){return 180*t/Math.PI},Tn.normalize=function(t){for(;t>Math.PI;)t-=Tn.PI_TIMES_2;for(;t<=-Math.PI;)t+=Tn.PI_TIMES_2;return t},Tn.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=n.x-e.x,r=n.y-e.y;return Math.atan2(r,i)}},Tn.isAcute=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)>0},Tn.isObtuse=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)<0},Tn.interiorAngle=function(t,e,n){var i=Tn.angle(e,t),r=Tn.angle(e,n);return Math.abs(r-i)},Tn.normalizePositive=function(t){if(t<0){for(;t<0;)t+=Tn.PI_TIMES_2;t>=Tn.PI_TIMES_2&&(t=0)}else{for(;t>=Tn.PI_TIMES_2;)t-=Tn.PI_TIMES_2;t<0&&(t=0)}return t},Tn.angleBetween=function(t,e,n){var i=Tn.angle(e,t),r=Tn.angle(e,n);return Tn.diff(i,r)},Tn.diff=function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},Tn.toRadians=function(t){return t*Math.PI/180},Tn.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?Tn.COUNTERCLOCKWISE:n<0?Tn.CLOCKWISE:Tn.NONE},Tn.angleBetweenOriented=function(t,e,n){var i=Tn.angle(e,t),r=Tn.angle(e,n)-i;return r<=-Math.PI?r+Tn.PI_TIMES_2:r>Math.PI?r-Tn.PI_TIMES_2:r},Rn.PI_TIMES_2.get=function(){return 2*Math.PI},Rn.PI_OVER_2.get=function(){return Math.PI/2},Rn.PI_OVER_4.get=function(){return Math.PI/4},Rn.COUNTERCLOCKWISE.get=function(){return at.COUNTERCLOCKWISE},Rn.CLOCKWISE.get=function(){return at.CLOCKWISE},Rn.NONE.get=function(){return at.COLLINEAR},Object.defineProperties(Tn,Rn);var Pn=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new dn,this._seg1=new dn,this._offset0=new dn,this._offset1=new dn,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],n=arguments[1],i=arguments[2];this._precisionModel=e,this._bufParams=n,this._li=new rt,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===Cn.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(i)},Dn={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Pn.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=at.computeOrientation(this._s0,this._s1,this._s2),i=n===at.CLOCKWISE&&this._side===Se.LEFT||n===at.COUNTERCLOCKWISE&&this._side===Se.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},Pn.prototype.addLineEndCap=function(t,e){var n=new dn(t,e),i=new dn;this.computeOffsetSegment(n,Se.LEFT,this._distance,i);var r=new dn;this.computeOffsetSegment(n,Se.RIGHT,this._distance,r);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this._bufParams.getEndCapStyle()){case Cn.CAP_ROUND:this._segList.addPt(i.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,at.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case Cn.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(r.p1);break;case Cn.CAP_SQUARE:var u=new C;u.x=Math.abs(this._distance)*Math.cos(a),u.y=Math.abs(this._distance)*Math.sin(a);var l=new C(i.p1.x+u.x,i.p1.y+u.y),c=new C(r.p1.x+u.x,r.p1.y+u.y);this._segList.addPt(l),this._segList.addPt(c);}},Pn.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Pn.prototype.addMitreJoin=function(t,e,n,i){var r=!0,o=null;try{o=k.intersection(e.p0,e.p1,n.p0,n.p1),(i<=0?1:o.distance(t)/Math.abs(i))>this._bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof X))throw t;o=new C(0,0),r=!1}r?this._segList.addPt(o):this.addLimitedMitreJoin(e,n,i,this._bufParams.getMitreLimit())},Pn.prototype.addFilletCorner=function(t,e,n,i,r){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),u=n.x-t.x,l=n.y-t.y,c=Math.atan2(l,u);i===at.CLOCKWISE?a<=c&&(a+=2*Math.PI):a>=c&&(a-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,a,c,i,r),this._segList.addPt(n)},Pn.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Pn.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Cn.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Cn.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},Pn.prototype.createSquare=function(t){this._segList.addPt(new C(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new C(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new C(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new C(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},Pn.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},Pn.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Pn.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Pn.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)},Pn.prototype.addLimitedMitreJoin=function(t,e,n,i){var r=this._seg0.p1,o=Tn.angle(r,this._seg0.p0),s=Tn.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=Tn.normalize(o+s),u=Tn.normalize(a+Math.PI),l=i*n,c=n-l*Math.abs(Math.sin(s)),p=r.x+l*Math.cos(u),h=r.y+l*Math.sin(u),f=new C(p,h),g=new dn(r,f),d=g.pointAlongOffset(1,c),y=g.pointAlongOffset(1,-c);this._side===Se.LEFT?(this._segList.addPt(d),this._segList.addPt(y)):(this._segList.addPt(y),this._segList.addPt(d))},Pn.prototype.computeOffsetSegment=function(t,e,n,i){var r=e===Se.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),u=r*n*o/a,l=r*n*s/a;i.p0.x=t.p0.x-l,i.p0.y=t.p0.y+u,i.p1.x=t.p1.x-l,i.p1.y=t.p1.y+u},Pn.prototype.addFilletArc=function(t,e,n,i,r){var o=i===at.CLOCKWISE?-1:1,s=Math.abs(e-n),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;for(var u=s/a,l=0,c=new C;l<s;){var p=e+o*l;c.x=t.x+r*Math.cos(p),c.y=t.y+r*Math.sin(p),this._segList.addPt(c),l+=u}},Pn.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Pn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var n=new C((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var i=new C((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Pn.prototype.createCircle=function(t){var e=new C(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Pn.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},Pn.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new wn,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Pn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Pn.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===Cn.JOIN_BEVEL||this._bufParams.getJoinStyle()===Cn.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,at.CLOCKWISE,this._distance))},Pn.prototype.closeRing=function(){this._segList.closeRing()},Pn.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Pn.prototype.interfaces_=function(){return[]},Pn.prototype.getClass=function(){return Pn},Dn.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001},Dn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001},Dn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Dn.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Pn,Dn);var Mn=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};Mn.prototype.getOffsetCurve=function(t,e){if(this._distance=e,0===e)return null;var n=e<0,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);var o=r.getCoordinates();return n&&Lt.reverse(o),o},Mn.prototype.computeSingleSidedBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var r=Ln.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],Se.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(r[s],!0)}else{n.addSegments(t,!1);var a=Ln.simplify(t,i),u=a.length-1;n.initSideSegments(a[0],a[1],Se.LEFT),n.addFirstSegment();for(var l=2;l<=u;l++)n.addNextSegment(a[l],!0)}n.addLastSegment(),n.closeRing()},Mn.prototype.computeRingBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);e===Se.RIGHT&&(i=-i);var r=Ln.simplify(t,i),o=r.length-1;n.initSideSegments(r[o-1],r[0],e);for(var s=1;s<=o;s++){var a=1!==s;n.addNextSegment(r[s],a)}n.closeRing()},Mn.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),i=Ln.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],Se.LEFT);for(var o=2;o<=r;o++)e.addNextSegment(i[o],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);var s=Ln.simplify(t,-n),a=s.length-1;e.initSideSegments(s[a],s[a-1],Se.LEFT);for(var u=a-2;u>=0;u--)e.addNextSegment(s[u],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},Mn.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case Cn.CAP_ROUND:e.createCircle(t);break;case Cn.CAP_SQUARE:e.createSquare(t);}},Mn.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this._bufParams.isSingleSided()){var r=e<0;this.computeSingleSidedBufferCurve(t,r,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()},Mn.prototype.getBufferParameters=function(){return this._bufParams},Mn.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},Mn.prototype.getRingCurve=function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return Mn.copyCoordinates(t);var i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()},Mn.prototype.computeOffsetCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){var r=Ln.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],Se.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(r[s],!0)}else{var a=Ln.simplify(t,i),u=a.length-1;n.initSideSegments(a[0],a[1],Se.LEFT),n.addFirstSegment();for(var l=2;l<=u;l++)n.addNextSegment(a[l],!0)}n.addLastSegment()},Mn.prototype.getSegGen=function(t){return new Pn(this._precisionModel,this._bufParams,t)},Mn.prototype.interfaces_=function(){return[]},Mn.prototype.getClass=function(){return Mn},Mn.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new C(t[n]);return e};var An=function(){this._subgraphs=null,this._seg=new dn,this._cga=new at;var t=arguments[0];this._subgraphs=t},Fn={DepthSegment:{configurable:!0}};An.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=new Nt,n=this._subgraphs.iterator();n.hasNext();){var i=n.next(),r=i.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,i.getDirectedEdges(),e)}return e}if(3===arguments.length)if(T(arguments[2],xt)&&arguments[0]instanceof C&&arguments[1]instanceof ze){for(var o=arguments[0],s=arguments[1],a=arguments[2],u=s.getEdge().getCoordinates(),l=0;l<u.length-1;l++)if(this._seg.p0=u[l],this._seg.p1=u[l+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<o.x||this._seg.isHorizontal()||o.y<this._seg.p0.y||o.y>this._seg.p1.y||at.computeOrientation(this._seg.p0,this._seg.p1,o)===at.RIGHT)){var c=s.getDepth(Se.LEFT);this._seg.p0.equals(u[l])||(c=s.getDepth(Se.RIGHT));var p=new Gn(this._seg,c);a.add(p)}}else if(T(arguments[2],xt)&&arguments[0]instanceof C&&T(arguments[1],xt))for(var h=arguments[0],f=arguments[1],g=arguments[2],d=f.iterator();d.hasNext();){var y=d.next();y.isForward()&&this.findStabbedSegments(h,y,g)}},An.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Ze.min(e)._leftDepth},An.prototype.interfaces_=function(){return[]},An.prototype.getClass=function(){return An},Fn.DepthSegment.get=function(){return Gn},Object.defineProperties(An,Fn);var Gn=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new dn(t),this._leftDepth=e};Gn.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n?n:0!=(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)},Gn.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},Gn.prototype.toString=function(){return this._upwardSeg.toString()},Gn.prototype.interfaces_=function(){return[E]},Gn.prototype.getClass=function(){return Gn};var qn=function(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null};qn.prototype.area=function(){return qn.area(this.p0,this.p1,this.p2)},qn.prototype.signedArea=function(){return qn.signedArea(this.p0,this.p1,this.p2)},qn.prototype.interpolateZ=function(t){if(null===t)throw new m("Supplied point is null.");return qn.interpolateZ(t,this.p0,this.p1,this.p2)},qn.prototype.longestSideLength=function(){return qn.longestSideLength(this.p0,this.p1,this.p2)},qn.prototype.isAcute=function(){return qn.isAcute(this.p0,this.p1,this.p2)},qn.prototype.circumcentre=function(){return qn.circumcentre(this.p0,this.p1,this.p2)},qn.prototype.area3D=function(){return qn.area3D(this.p0,this.p1,this.p2)},qn.prototype.centroid=function(){return qn.centroid(this.p0,this.p1,this.p2)},qn.prototype.inCentre=function(){return qn.inCentre(this.p0,this.p1,this.p2)},qn.prototype.interfaces_=function(){return[]},qn.prototype.getClass=function(){return qn},qn.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},qn.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},qn.det=function(t,e,n,i){return t*i-e*n},qn.interpolateZ=function(t,e,n,i){var r=e.x,o=e.y,s=n.x-r,a=i.x-r,u=n.y-o,l=i.y-o,c=s*l-a*u,p=t.x-r,h=t.y-o,f=(l*p-a*h)/c,g=(-u*p+s*h)/c;return e.z+f*(n.z-e.z)+g*(i.z-e.z)},qn.longestSideLength=function(t,e,n){var i=t.distance(e),r=e.distance(n),o=n.distance(t),s=i;return r>s&&(s=r),o>s&&(s=o),s},qn.isAcute=function(t,e,n){return!!Tn.isAcute(t,e,n)&&!!Tn.isAcute(e,n,t)&&!!Tn.isAcute(n,t,e)},qn.circumcentre=function(t,e,n){var i=n.x,r=n.y,o=t.x-i,s=t.y-r,a=e.x-i,u=e.y-r,l=2*qn.det(o,s,a,u),c=qn.det(s,o*o+s*s,u,a*a+u*u),p=qn.det(o,o*o+s*s,a,a*a+u*u);return new C(i-c/l,r+p/l)},qn.perpendicularBisector=function(t,e){var n=e.x-t.x,i=e.y-t.y,r=new k(t.x+n/2,t.y+i/2,1),o=new k(t.x-i+n/2,t.y+n+i/2,1);return new k(r,o)},qn.angleBisector=function(t,e,n){var i=e.distance(t),r=i/(i+e.distance(n)),o=n.x-t.x,s=n.y-t.y;return new C(t.x+r*o,t.y+r*s)},qn.area3D=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=e.z-t.z,s=n.x-t.x,a=n.y-t.y,u=n.z-t.z,l=r*u-o*a,c=o*s-i*u,p=i*a-r*s,h=l*l+c*c+p*p;return Math.sqrt(h)/2},qn.centroid=function(t,e,n){var i=(t.x+e.x+n.x)/3,r=(t.y+e.y+n.y)/3;return new C(i,r)},qn.inCentre=function(t,e,n){var i=e.distance(n),r=t.distance(n),o=t.distance(e),s=i+r+o,a=(i*t.x+r*e.x+o*n.x)/s,u=(i*t.y+r*e.y+o*n.y)/s;return new C(a,u)};var Bn=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Nt;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n};Bn.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,w.EXTERIOR,w.INTERIOR)},Bn.prototype.addPolygon=function(t){var e=this._distance,n=Se.LEFT;this._distance<0&&(e=-this._distance,n=Se.RIGHT);var i=t.getExteriorRing(),r=Lt.removeRepeatedPoints(i.getCoordinates());if(this._distance<0&&this.isErodedCompletely(i,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,n,w.EXTERIOR,w.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var s=t.getInteriorRingN(o),a=Lt.removeRepeatedPoints(s.getCoordinates());this._distance>0&&this.isErodedCompletely(s,-this._distance)||this.addPolygonRing(a,e,Se.opposite(n),w.INTERIOR,w.EXTERIOR)}},Bn.prototype.isTriangleErodedCompletely=function(t,e){var n=new qn(t[0],t[1],t[2]),i=n.inCentre();return at.distancePointLine(i,n.p0,n.p1)<Math.abs(e)},Bn.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Lt.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,w.EXTERIOR,w.INTERIOR)},Bn.prototype.addCurve=function(t,e,n){if(null===t||t.length<2)return null;var i=new gn(t,new Pe(0,w.BOUNDARY,e,n));this._curveList.add(i)},Bn.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Bn.prototype.addPolygonRing=function(t,e,n,i,r){if(0===e&&t.length<ee.MINIMUM_VALID_SIZE)return null;var o=i,s=r;t.length>=ee.MINIMUM_VALID_SIZE&&at.isCCW(t)&&(o=r,s=i,n=Se.opposite(n));var a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,o,s)},Bn.prototype.add=function(t){if(t.isEmpty())return null;t instanceof Zt?this.addPolygon(t):t instanceof Kt?this.addLineString(t):t instanceof Qt?this.addPoint(t):t instanceof te?this.addCollection(t):t instanceof Xt?this.addCollection(t):t instanceof ne?this.addCollection(t):t instanceof zt&&this.addCollection(t)},Bn.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return e<0&&2*Math.abs(e)>r},Bn.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},Bn.prototype.interfaces_=function(){return[]},Bn.prototype.getClass=function(){return Bn};var Vn=function(){};Vn.prototype.locate=function(t){},Vn.prototype.interfaces_=function(){return[]},Vn.prototype.getClass=function(){return Vn};var Un=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};Un.prototype.next=function(){if(this._atStart)return this._atStart=!1,Un.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new i;var t=this._parent.getGeometryN(this._index++);return t instanceof zt?(this._subcollectionIterator=new Un(t),this._subcollectionIterator.next()):t},Un.prototype.remove=function(){throw new Error(this.getClass().getName())},Un.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},Un.prototype.interfaces_=function(){return[Et]},Un.prototype.getClass=function(){return Un},Un.isAtomic=function(t){return!(t instanceof zt)};var zn=function(){this._geom=null;var t=arguments[0];this._geom=t};zn.prototype.locate=function(t){return zn.locate(t,this._geom)},zn.prototype.interfaces_=function(){return[Vn]},zn.prototype.getClass=function(){return zn},zn.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&at.isPointInRing(t,e.getCoordinates())},zn.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!zn.isPointInRing(t,n))return!1;for(var i=0;i<e.getNumInteriorRing();i++){var r=e.getInteriorRingN(i);if(zn.isPointInRing(t,r))return!1}return!0},zn.containsPoint=function(t,e){if(e instanceof Zt)return zn.containsPointInPolygon(t,e);if(e instanceof zt)for(var n=new Un(e);n.hasNext();){var i=n.next();if(i!==e&&zn.containsPoint(t,i))return!0}return!1},zn.locate=function(t,e){return e.isEmpty()?w.EXTERIOR:zn.containsPoint(t,e)?w.INTERIOR:w.EXTERIOR};var Xn=function(){this._edgeMap=new p,this._edgeList=null,this._ptInAreaLocation=[w.NONE,w.NONE]};Xn.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)},Xn.prototype.propagateSideLabels=function(t){for(var e=w.NONE,n=this.iterator();n.hasNext();){var i=n.next().getLabel();i.isArea(t)&&i.getLocation(t,Se.LEFT)!==w.NONE&&(e=i.getLocation(t,Se.LEFT))}if(e===w.NONE)return null;for(var r=e,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getLabel();if(a.getLocation(t,Se.ON)===w.NONE&&a.setLocation(t,Se.ON,r),a.isArea(t)){var u=a.getLocation(t,Se.LEFT),l=a.getLocation(t,Se.RIGHT);if(l!==w.NONE){if(l!==r)throw new we("side location conflict",s.getCoordinate());u===w.NONE&&et.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),r=u}else et.isTrue(a.getLocation(t,Se.LEFT)===w.NONE,"found single null side"),a.setLocation(t,Se.RIGHT,r),a.setLocation(t,Se.LEFT,r)}}},Xn.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},Xn.prototype.print=function(t){Y.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},Xn.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Xn.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,i=e.get(n).getLabel().getLocation(t,Se.LEFT);et.isTrue(i!==w.NONE,"Found unlabelled area edge");for(var r=i,o=this.iterator();o.hasNext();){var s=o.next().getLabel();et.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,Se.LEFT),u=s.getLocation(t,Se.RIGHT);if(a===u)return!1;if(u!==r)return!1;r=a}return!0},Xn.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},Xn.prototype.iterator=function(){return this.getEdges().iterator()},Xn.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new Nt(this._edgeMap.values())),this._edgeList},Xn.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===w.NONE&&(this._ptInAreaLocation[t]=zn.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]},Xn.prototype.toString=function(){var t=new D;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},Xn.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},Xn.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var i=n.next().getLabel(),r=0;r<2;r++)i.isLine(r)&&i.getLocation(r)===w.BOUNDARY&&(e[r]=!0);for(var o=this.iterator();o.hasNext();)for(var s=o.next(),a=s.getLabel(),u=0;u<2;u++)if(a.isAnyNull(u)){var l=w.NONE;if(e[u])l=w.EXTERIOR;else{var c=s.getCoordinate();l=this.getLocation(u,c,t)}a.setAllLocationsIfNull(u,l)}},Xn.prototype.getDegree=function(){return this._edgeMap.size()},Xn.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},Xn.prototype.interfaces_=function(){return[]},Xn.prototype.getClass=function(){return Xn};var Yn=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,i=0;i<this._resultAreaEdgeList.size();i++){var r=this._resultAreaEdgeList.get(i),o=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this._SCANNING_FOR_INCOMING;}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new we("no outgoing dirEdge found",this.getCoordinate());et.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},e.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},e.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var i=t.get(e-1),r=n.getQuadrant(),o=i.getQuadrant();return Be.isNorthern(r)&&Be.isNorthern(o)?n:Be.isNorthern(r)||Be.isNorthern(o)?0!==n.getDy()?n:0!==i.getDy()?i:(et.shouldNeverReachHere("found two horizontal edges incident on node"),null):i},e.prototype.print=function(t){Y.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},e.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Nt;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;n>=0;n--){var i=this._edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)},e.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=t.getDepth(Se.LEFT),i=t.getDepth(Se.RIGHT),r=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,r)!==i)throw new we("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var o=arguments[0],s=arguments[1],a=arguments[2],u=o;u<s;u++){var l=this._edgeList.get(u);l.setEdgeDepths(Se.RIGHT,a),a=l.getDepth(Se.LEFT)}return a}},e.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,n=null,i=this._SCANNING_FOR_INCOMING,r=this._resultAreaEdgeList.size()-1;r>=0;r--){var o=this._resultAreaEdgeList.get(r),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),i){case this._SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;n=s,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),i=this._SCANNING_FOR_INCOMING;}}i===this._LINKING_TO_OUTGOING&&(et.isTrue(null!==e,"found null for first outgoing dirEdge"),et.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},e.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var n=arguments[0],i=0,r=this.iterator();r.hasNext();)r.next().getEdgeRing()===n&&i++;return i}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var t=w.NONE,e=this.iterator();e.hasNext();){var n=e.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=w.INTERIOR;break}if(i.isInResult()){t=w.EXTERIOR;break}}}if(t===w.NONE)return null;for(var r=t,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(r===w.INTERIOR):(s.isInResult()&&(r=w.EXTERIOR),a.isInResult()&&(r=w.INTERIOR))}},e.prototype.computeLabelling=function(e){t.prototype.computeLabelling.call(this,e),this._label=new Pe(w.NONE);for(var n=this.iterator();n.hasNext();)for(var i=n.next().getEdge().getLabel(),r=0;r<2;r++){var o=i.getLocation(r);o!==w.INTERIOR&&o!==w.BOUNDARY||this._label.setLocation(r,w.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Xn),kn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(t){return new Ge(t,new Yn())},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Xe),jn=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};jn.prototype.compareTo=function(t){var e=t;return jn.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},jn.prototype.interfaces_=function(){return[E]},jn.prototype.getClass=function(){return jn},jn.orientation=function(t){return 1===Lt.increasingDirection(t)},jn.compareOriented=function(t,e,n,i){for(var r=e?1:-1,o=i?1:-1,s=e?t.length:-1,a=i?n.length:-1,u=e?0:t.length-1,l=i?0:n.length-1;;){var c=t[u].compareTo(n[l]);if(0!==c)return c;var p=(u+=r)===s,h=(l+=o)===a;if(p&&!h)return-1;if(!p&&h)return 1;if(p&&h)return 0}};var Hn=function(){this._edges=new Nt,this._ocaMap=new p};Hn.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var i=n.getCoordinates(),r=0;r<i.length;r++)r>0&&t.print(","),t.print(i[r].x+" "+i[r].y);t.println(")")}t.print(")  ")},Hn.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},Hn.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},Hn.prototype.iterator=function(){return this._edges.iterator()},Hn.prototype.getEdges=function(){return this._edges},Hn.prototype.get=function(t){return this._edges.get(t)},Hn.prototype.findEqualEdge=function(t){var e=new jn(t.getCoordinates());return this._ocaMap.get(e)},Hn.prototype.add=function(t){this._edges.add(t);var e=new jn(t.getCoordinates());this._ocaMap.put(e,t)},Hn.prototype.interfaces_=function(){return[]},Hn.prototype.getClass=function(){return Hn};var Wn=function(){};Wn.prototype.processIntersections=function(t,e,n,i){},Wn.prototype.isDone=function(){},Wn.prototype.interfaces_=function(){return[]},Wn.prototype.getClass=function(){return Wn};var Kn=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};Kn.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(Kn.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},Kn.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Kn.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Kn.prototype.getLineIntersector=function(){return this._li},Kn.prototype.hasProperIntersection=function(){return this._hasProper},Kn.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Kn.prototype.hasIntersection=function(){return this._hasIntersection},Kn.prototype.isDone=function(){return!1},Kn.prototype.hasInteriorIntersection=function(){return this._hasInterior},Kn.prototype.interfaces_=function(){return[Wn]},Kn.prototype.getClass=function(){return Kn},Kn.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var Jn=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new C(t),this.segmentIndex=e,this.dist=n};Jn.prototype.getSegmentIndex=function(){return this.segmentIndex},Jn.prototype.getCoordinate=function(){return this.coord},Jn.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},Jn.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},Jn.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},Jn.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Jn.prototype.getDistance=function(){return this.dist},Jn.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},Jn.prototype.interfaces_=function(){return[E]},Jn.prototype.getClass=function(){return Jn};var Qn=function(){this._nodeMap=new p,this.edge=null;var t=arguments[0];this.edge=t};Qn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Qn.prototype.iterator=function(){return this._nodeMap.values().iterator()},Qn.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},Qn.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},Qn.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new C(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return r&&(o[s]=e.coord),new ni(o,new Pe(this.edge._label))},Qn.prototype.add=function(t,e,n){var i=new Jn(t,e,n),r=this._nodeMap.get(i);return null!==r?r:(this._nodeMap.put(i,i),i)},Qn.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},Qn.prototype.interfaces_=function(){return[]},Qn.prototype.getClass=function(){return Qn};var $n=function(){};$n.prototype.getChainStartIndices=function(t){var e=0,n=new Nt;n.add(new M(e));do{var i=this.findChainEnd(t,e);n.add(new M(i)),e=i}while(e<t.length-1);return $n.toIntArray(n)},$n.prototype.findChainEnd=function(t,e){for(var n=Be.quadrant(t[e],t[e+1]),i=e+1;i<t.length&&Be.quadrant(t[i-1],t[i])===n;)i++;return i-1},$n.prototype.interfaces_=function(){return[]},$n.prototype.getClass=function(){return $n},$n.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var Zn=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new j,this.env2=new j;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new $n;this.startIndex=e.getChainStartIndices(this.pts)};Zn.prototype.getCoordinates=function(){return this.pts},Zn.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},Zn.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},Zn.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(6===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],u=arguments[4],l=arguments[5],c=this.pts[r],p=this.pts[o],h=s.pts[a],f=s.pts[u];if(o-r==1&&u-a==1)return l.addIntersections(this.e,r,s.e,a),null;if(this.env1.init(c,p),this.env2.init(h,f),!this.env1.intersects(this.env2))return null;var g=Math.trunc((r+o)/2),d=Math.trunc((a+u)/2);r<g&&(a<d&&this.computeIntersectsForChain(r,g,s,a,d,l),d<u&&this.computeIntersectsForChain(r,g,s,d,u,l)),g<o&&(a<d&&this.computeIntersectsForChain(g,o,s,a,d,l),d<u&&this.computeIntersectsForChain(g,o,s,d,u,l))}},Zn.prototype.getStartIndexes=function(){return this.startIndex},Zn.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)},Zn.prototype.interfaces_=function(){return[]},Zn.prototype.getClass=function(){return Zn};var ti=function t(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var e=0;e<2;e++)for(var n=0;n<3;n++)this._depth[e][n]=t.NULL_VALUE},ei={NULL_VALUE:{configurable:!0}};ti.prototype.getDepth=function(t,e){return this._depth[t][e]},ti.prototype.setDepth=function(t,e,n){this._depth[t][e]=n},ti.prototype.isNull=function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==ti.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this._depth[n][1]===ti.NULL_VALUE}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._depth[i][r]===ti.NULL_VALUE}},ti.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var i=0;this._depth[t][n]>e&&(i=1),this._depth[t][n]=i}}},ti.prototype.getDelta=function(t){return this._depth[t][Se.RIGHT]-this._depth[t][Se.LEFT]},ti.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?w.EXTERIOR:w.INTERIOR},ti.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},ti.prototype.add=function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var n=1;n<3;n++){var i=t.getLocation(e,n);i!==w.EXTERIOR&&i!==w.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=ti.depthAtLocation(i):this._depth[e][n]+=ti.depthAtLocation(i))}else if(3===arguments.length){var r=arguments[0],o=arguments[1];arguments[2]===w.INTERIOR&&this._depth[r][o]++}},ti.prototype.interfaces_=function(){return[]},ti.prototype.getClass=function(){return ti},ti.depthAtLocation=function(t){return t===w.EXTERIOR?0:t===w.INTERIOR?1:ti.NULL_VALUE},ei.NULL_VALUE.get=function(){return-1},Object.defineProperties(ti,ei);var ni=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new Qn(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new ti,this._depthDelta=0,1===arguments.length){var n=arguments[0];e.call(this,n,null)}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.pts=i,this._label=r}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,Pe.toLineLabel(this._label))},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(t){this._isIsolated=t},e.prototype.setName=function(t){this._name=t},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;if(this.pts.length!==n.pts.length)return!1;for(var i=!0,r=!0,o=this.pts.length,s=0;s<this.pts.length;s++)if(this.pts[s].equals2D(n.pts[s])||(i=!1),this.pts[s].equals2D(n.pts[--o])||(r=!1),!i&&!r)return!1;return!0},e.prototype.getCoordinate=function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},e.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(t){e.updateIM(this._label,t)},e.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},e.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new Zn(this)),this._mce},e.prototype.getEnvelope=function(){if(null===this._env){this._env=new j;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},e.prototype.addIntersection=function(t,e,n,i){var r=new C(t.getIntersection(i)),o=e,s=t.getEdgeDistance(n,i),a=o+1;if(a<this.pts.length){var u=this.pts[a];r.equals2D(u)&&(o=a,s=0)}this.eiList.add(r,o,s)},e.prototype.toString=function(){var t=new D;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},e.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},e.prototype.setDepthDelta=function(t){this._depthDelta=t},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(2!==arguments.length)return t.prototype.updateIM.apply(this,arguments);var e=arguments[0],n=arguments[1];n.setAtLeastIfValid(e.getLocation(0,Se.ON),e.getLocation(1,Se.ON),1),e.isArea()&&(n.setAtLeastIfValid(e.getLocation(0,Se.LEFT),e.getLocation(1,Se.LEFT),2),n.setAtLeastIfValid(e.getLocation(0,Se.RIGHT),e.getLocation(1,Se.RIGHT),2))},e}(Fe),ii=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Hn,this._bufParams=t||null};ii.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},ii.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new Pe(t.getLabel())).flip(),n.merge(i);var r=ii.depthDelta(i),o=e.getDepthDelta()+r;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(ii.depthDelta(t.getLabel()))},ii.prototype.buildSubgraphs=function(t,e){for(var n=new Nt,i=t.iterator();i.hasNext();){var r=i.next(),o=r.getRightmostCoordinate(),s=new An(n).getDepth(o);r.computeDepth(s),r.findResultEdges(),n.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},ii.prototype.createSubgraphs=function(t){for(var e=new Nt,n=t.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var r=new Te;r.create(i),e.add(r)}}return Ze.sort(e,Ze.reverseOrder()),e},ii.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},ii.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new xn,n=new rt;return n.setPrecisionModel(t),e.setSegmentIntersector(new Kn(n)),e},ii.prototype.buffer=function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var i=new Mn(n,this._bufParams),r=new Bn(t,e,i).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this._graph=new Ye(new kn()),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),s=new ke(this._geomFact);this.buildSubgraphs(o,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)},ii.prototype.computeNodedEdges=function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var i=n.getNodedSubstrings().iterator();i.hasNext();){var r=i.next(),o=r.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var s=r.getData(),a=new ni(r.getCoordinates(),new Pe(s));this.insertUniqueEdge(a)}}},ii.prototype.setNoder=function(t){this._workingNoder=t},ii.prototype.interfaces_=function(){return[]},ii.prototype.getClass=function(){return ii},ii.depthDelta=function(t){var e=t.getLocation(0,Se.LEFT),n=t.getLocation(0,Se.RIGHT);return e===w.INTERIOR&&n===w.EXTERIOR?1:e===w.EXTERIOR&&n===w.INTERIOR?-1:0},ii.convertSegStrings=function(t){for(var e=new _e,n=new Nt;t.hasNext();){var i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)};var ri=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=arguments[3];this._noder=n,this._scaleFactor=i,this._offsetX=r,this._offsetY=o,this._isScaled=!this.isIntegerPrecision()}};ri.prototype.rescale=function(){if(T(arguments[0],It))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],i=0;i<n.length;i++)n[i].x=n[i].x/this._scaleFactor+this._offsetX,n[i].y=n[i].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&Y.out.println(n)}},ri.prototype.scale=function(){if(T(arguments[0],It)){for(var t=arguments[0],e=new Nt,n=t.iterator();n.hasNext();){var i=n.next();e.add(new gn(this.scale(i.getCoordinates()),i.getData()))}return e}if(arguments[0]instanceof Array){for(var r=arguments[0],o=new Array(r.length).fill(null),s=0;s<r.length;s++)o[s]=new C(Math.round((r[s].x-this._offsetX)*this._scaleFactor),Math.round((r[s].y-this._offsetY)*this._scaleFactor),r[s].z);return Lt.removeRepeatedPoints(o)}},ri.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},ri.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},ri.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},ri.prototype.interfaces_=function(){return[In]},ri.prototype.getClass=function(){return ri};var oi=function(){this._li=new rt,this._segStrings=null;var t=arguments[0];this._segStrings=t},si={fact:{configurable:!0}};oi.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1].iterator();i.hasNext();)for(var r=i.next().getCoordinates(),o=1;o<r.length-1;o++)if(r[o].equals(n))throw new Z("found endpt/interior pt intersection at index "+o+" :pt "+n)},oi.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var i=n.next();this.checkInteriorIntersections(e,i)}else if(2===arguments.length)for(var r=arguments[0],o=arguments[1],s=r.getCoordinates(),a=o.getCoordinates(),u=0;u<s.length-1;u++)for(var l=0;l<a.length-1;l++)this.checkInteriorIntersections(r,u,o,l);else if(4===arguments.length){var c=arguments[0],p=arguments[1],h=arguments[2],f=arguments[3];if(c===h&&p===f)return null;var g=c.getCoordinates()[p],d=c.getCoordinates()[p+1],y=h.getCoordinates()[f],_=h.getCoordinates()[f+1];if(this._li.computeIntersection(g,d,y,_),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,g,d)||this.hasInteriorIntersection(this._li,y,_)))throw new Z("found non-noded intersection at "+g+"-"+d+" and "+y+"-"+_)}},oi.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},oi.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),i=0;i<n.length-2;i++)this.checkCollapse(n[i],n[i+1],n[i+2])},oi.prototype.hasInteriorIntersection=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++){var r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1},oi.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new Z("found non-noded collapse at "+oi.fact.createLineString([t,e,n]))},oi.prototype.interfaces_=function(){return[]},oi.prototype.getClass=function(){return oi},si.fact.get=function(){return new _e},Object.defineProperties(oi,si);var ai=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new m("Scale factor must be non-zero");1!==e&&(this._pt=new C(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new C,this._p1Scaled=new C),this.initCorners(this._pt)},ui={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};ai.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this._maxx<n||this._minx>i||this._maxy<r||this._miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return et.isTrue(!(s&&a),"Found bad envelope test"),a},ai.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new C(this._maxx,this._maxy),this._corner[1]=new C(this._minx,this._maxy),this._corner[2]=new C(this._minx,this._miny),this._corner[3]=new C(this._maxx,this._miny)},ai.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},ai.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},ai.prototype.getCoordinate=function(){return this._originalPt},ai.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},ai.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=ai.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new j(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},ai.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},ai.prototype.intersectsToleranceSquare=function(t,e){var n=!1,i=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||n&&i||t.equals(this._pt)||e.equals(this._pt)))))},ai.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)},ai.prototype.interfaces_=function(){return[]},ai.prototype.getClass=function(){return ai},ui.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75},Object.defineProperties(ai,ui);var li=function(){this.tempEnv1=new j,this.selectedSegment=new dn};li.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}},li.prototype.interfaces_=function(){return[]},li.prototype.getClass=function(){return li};var ci=function(){this._index=null;var t=arguments[0];this._index=t},pi={HotPixelSnapAction:{configurable:!0}};ci.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=e.getSafeEnvelope(),o=new hi(e,n,i);return this._index.query(r,{interfaces_:function(){return[Ke]},visitItem:function(t){t.select(r,o)}}),o.isNodeAdded()}},ci.prototype.interfaces_=function(){return[]},ci.prototype.getClass=function(){return ci},pi.HotPixelSnapAction.get=function(){return hi},Object.defineProperties(ci,pi);var hi=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],n=arguments[1],i=arguments[2];this._hotPixel=e,this._parentEdge=n,this._hotPixelVertexIndex=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(2!==arguments.length)return t.prototype.select.apply(this,arguments);var e=arguments[0],n=arguments[1],i=e.getContext();if(null!==this._parentEdge&&i===this._parentEdge&&n===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(i,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(li),fi=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new Nt};fi.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var u=0;u<this._li.getIntersectionNum();u++)this._interiorIntersections.add(this._li.getIntersection(u));t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)}},fi.prototype.isDone=function(){return!1},fi.prototype.getInteriorIntersections=function(){return this._interiorIntersections},fi.prototype.interfaces_=function(){return[Wn]},fi.prototype.getClass=function(){return fi};var gi=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new rt,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};gi.prototype.checkCorrectness=function(t){var e=gn.getNodedSubstrings(t),n=new oi(e);try{n.checkValid()}catch(t){if(!(t instanceof z))throw t;t.printStackTrace()}},gi.prototype.getNodedSubstrings=function(){return gn.getNodedSubstrings(this._nodedSegStrings)},gi.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},gi.prototype.findInteriorIntersections=function(t,e){var n=new fi(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()},gi.prototype.computeVertexSnaps=function(){if(T(arguments[0],It))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof gn)for(var n=arguments[0],i=n.getCoordinates(),r=0;r<i.length;r++){var o=new ai(i[r],this._scaleFactor,this._li);this._pointSnapper.snap(o,n,r)&&n.addIntersection(i[r],r)}},gi.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new xn,this._pointSnapper=new ci(this._noder.getIndex()),this.snapRound(t,this._li)},gi.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=new ai(n,this._scaleFactor,this._li);this._pointSnapper.snap(i)}},gi.prototype.interfaces_=function(){return[In]},gi.prototype.getClass=function(){return gi};var di=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Cn,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}},yi={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};di.prototype.bufferFixedPrecision=function(t){var e=new ri(new gi(new fe(1)),t.getScale()),n=new ii(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)},di.prototype.bufferReducedPrecision=function(){var t=this;if(0===arguments.length){for(var e=di.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(e){if(!(e instanceof we))throw e;t._saveException=e}if(null!==t._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var n=arguments[0],i=di.precisionScaleFactor(this._argGeom,this._distance,n),r=new fe(i);this.bufferFixedPrecision(r)}},di.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===fe.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},di.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},di.prototype.bufferOriginalPrecision=function(){try{var t=new ii(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof Z))throw t;this._saveException=t}},di.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},di.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},di.prototype.interfaces_=function(){return[]},di.prototype.getClass=function(){return di},di.bufferOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new di(t).getResultGeometry(e)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof ct&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1],r=arguments[2],o=new di(n);return o.setQuadrantSegments(r),o.getResultGeometry(i)}if(arguments[2]instanceof Cn&&arguments[0]instanceof ct&&"number"==typeof arguments[1]){var s=arguments[0],a=arguments[1],u=arguments[2];return new di(s,u).getResultGeometry(a)}}else if(4===arguments.length){var l=arguments[0],c=arguments[1],p=arguments[2],h=arguments[3],f=new di(l);return f.setQuadrantSegments(p),f.setEndCapStyle(h),f.getResultGeometry(c)}},di.precisionScaleFactor=function(t,e,n){var i=t.getEnvelopeInternal(),r=R.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(e>0?e:0),o=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,o)},yi.CAP_ROUND.get=function(){return Cn.CAP_ROUND},yi.CAP_BUTT.get=function(){return Cn.CAP_FLAT},yi.CAP_FLAT.get=function(){return Cn.CAP_FLAT},yi.CAP_SQUARE.get=function(){return Cn.CAP_SQUARE},yi.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(di,yi);var _i=function(){this._pt=[new C,new C],this._distance=v.NaN,this._isNull=!0};_i.prototype.getCoordinates=function(){return this._pt},_i.prototype.getCoordinate=function(t){return this._pt[t]},_i.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},_i.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},_i.prototype.getDistance=function(){return this._distance},_i.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},_i.prototype.interfaces_=function(){return[]},_i.prototype.getClass=function(){return _i};var mi=function(){};mi.prototype.interfaces_=function(){return[]},mi.prototype.getClass=function(){return mi},mi.computeDistance=function(){if(arguments[2]instanceof _i&&arguments[0]instanceof Kt&&arguments[1]instanceof C)for(var t=arguments[0],e=arguments[1],n=arguments[2],i=t.getCoordinates(),r=new dn,o=0;o<i.length-1;o++){r.setCoordinates(i[o],i[o+1]);var s=r.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof _i&&arguments[0]instanceof Zt&&arguments[1]instanceof C){var a=arguments[0],u=arguments[1],l=arguments[2];mi.computeDistance(a.getExteriorRing(),u,l);for(var c=0;c<a.getNumInteriorRing();c++)mi.computeDistance(a.getInteriorRingN(c),u,l)}else if(arguments[2]instanceof _i&&arguments[0]instanceof ct&&arguments[1]instanceof C){var p=arguments[0],h=arguments[1],f=arguments[2];if(p instanceof Kt)mi.computeDistance(p,h,f);else if(p instanceof Zt)mi.computeDistance(p,h,f);else if(p instanceof zt)for(var g=p,d=0;d<g.getNumGeometries();d++){var y=g.getGeometryN(d);mi.computeDistance(y,h,f)}else f.setMinimum(p.getCoordinate(),h)}else if(arguments[2]instanceof _i&&arguments[0]instanceof dn&&arguments[1]instanceof C){var _=arguments[0],m=arguments[1],v=arguments[2],I=_.closestPoint(m);v.setMinimum(I,m)}};var vi=function(t){this._maxPtDist=new _i,this._inputGeom=t||null},Ii={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};vi.prototype.computeMaxMidpointDistance=function(t){var e=new xi(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},vi.prototype.computeMaxVertexDistance=function(t){var e=new Ei(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},vi.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},vi.prototype.getDistancePoints=function(){return this._maxPtDist},vi.prototype.interfaces_=function(){return[]},vi.prototype.getClass=function(){return vi},Ii.MaxPointDistanceFilter.get=function(){return Ei},Ii.MaxMidpointDistanceFilter.get=function(){return xi},Object.defineProperties(vi,Ii);var Ei=function(t){this._maxPtDist=new _i,this._minPtDist=new _i,this._geom=t||null};Ei.prototype.filter=function(t){this._minPtDist.initialize(),mi.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Ei.prototype.getMaxPointDistance=function(){return this._maxPtDist},Ei.prototype.interfaces_=function(){return[ft]},Ei.prototype.getClass=function(){return Ei};var xi=function(t){this._maxPtDist=new _i,this._minPtDist=new _i,this._geom=t||null};xi.prototype.filter=function(t,e){if(0===e)return null;var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=new C((n.x+i.x)/2,(n.y+i.y)/2);this._minPtDist.initialize(),mi.computeDistance(this._geom,r,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},xi.prototype.isDone=function(){return!1},xi.prototype.isGeometryChanged=function(){return!1},xi.prototype.getMaxPointDistance=function(){return this._maxPtDist},xi.prototype.interfaces_=function(){return[Ut]},xi.prototype.getClass=function(){return xi};var Ni=function(t){this._comps=t||null};Ni.prototype.filter=function(t){t instanceof Zt&&this._comps.add(t)},Ni.prototype.interfaces_=function(){return[Vt]},Ni.prototype.getClass=function(){return Ni},Ni.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return Ni.getPolygons(t,new Nt)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Zt?n.add(e):e instanceof zt&&e.apply(new Ni(n)),n}};var Ci=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._lines=e,this._isForcedToLineString=n}};Ci.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof ee){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Kt&&this._lines.add(t)},Ci.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},Ci.prototype.interfaces_=function(){return[lt]},Ci.prototype.getClass=function(){return Ci},Ci.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(Ci.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(Ci.getLines(e,n))}},Ci.getLines=function(){if(1===arguments.length){var t=arguments[0];return Ci.getLines(t,!1)}if(2===arguments.length){if(T(arguments[0],It)&&T(arguments[1],It)){for(var e=arguments[0],n=arguments[1],i=e.iterator();i.hasNext();){var r=i.next();Ci.getLines(r,n)}return n}if(arguments[0]instanceof ct&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1],a=new Nt;return o.apply(new Ci(a,s)),a}if(arguments[0]instanceof ct&&T(arguments[1],It)){var u=arguments[0],l=arguments[1];return u instanceof Kt?l.add(u):u.apply(new Ci(l)),l}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&T(arguments[0],It)&&T(arguments[1],It)){for(var c=arguments[0],p=arguments[1],h=arguments[2],f=c.iterator();f.hasNext();){var g=f.next();Ci.getLines(g,p,h)}return p}if("boolean"==typeof arguments[2]&&arguments[0]instanceof ct&&T(arguments[1],It)){var d=arguments[0],y=arguments[1],_=arguments[2];return d.apply(new Ci(y,_)),y}}};var Si=function(){if(this._boundaryRule=gt.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new m("Rule must be non-null");this._boundaryRule=t}};Si.prototype.locateInternal=function(){if(arguments[0]instanceof C&&arguments[1]instanceof Zt){var t=arguments[0],e=arguments[1];if(e.isEmpty())return w.EXTERIOR;var n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===w.EXTERIOR)return w.EXTERIOR;if(i===w.BOUNDARY)return w.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var o=e.getInteriorRingN(r),s=this.locateInPolygonRing(t,o);if(s===w.INTERIOR)return w.EXTERIOR;if(s===w.BOUNDARY)return w.BOUNDARY}return w.INTERIOR}if(arguments[0]instanceof C&&arguments[1]instanceof Kt){var a=arguments[0],u=arguments[1];if(!u.getEnvelopeInternal().intersects(a))return w.EXTERIOR;var l=u.getCoordinates();return u.isClosed()||!a.equals(l[0])&&!a.equals(l[l.length-1])?at.isOnLine(a,l)?w.INTERIOR:w.EXTERIOR:w.BOUNDARY}if(arguments[0]instanceof C&&arguments[1]instanceof Qt){var c=arguments[0];return arguments[1].getCoordinate().equals2D(c)?w.INTERIOR:w.EXTERIOR}},Si.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?at.locatePointInRing(t,e.getCoordinates()):w.EXTERIOR},Si.prototype.intersects=function(t,e){return this.locate(t,e)!==w.EXTERIOR},Si.prototype.updateLocationInfo=function(t){t===w.INTERIOR&&(this._isIn=!0),t===w.BOUNDARY&&this._numBoundaries++},Si.prototype.computeLocation=function(t,e){if(e instanceof Qt&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof Kt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Zt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Xt)for(var n=e,i=0;i<n.getNumGeometries();i++){var r=n.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,r))}else if(e instanceof ne)for(var o=e,s=0;s<o.getNumGeometries();s++){var a=o.getGeometryN(s);this.updateLocationInfo(this.locateInternal(t,a))}else if(e instanceof zt)for(var u=new Un(e);u.hasNext();){var l=u.next();l!==e&&this.computeLocation(t,l)}},Si.prototype.locate=function(t,e){return e.isEmpty()?w.EXTERIOR:e instanceof Kt?this.locateInternal(t,e):e instanceof Zt?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?w.BOUNDARY:this._numBoundaries>0||this._isIn?w.INTERIOR:w.EXTERIOR)},Si.prototype.interfaces_=function(){return[]},Si.prototype.getClass=function(){return Si};var Li=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length){var e=arguments[0],n=arguments[1];t.call(this,e,t.INSIDE_AREA,n)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._component=i,this._segIndex=r,this._pt=o}},bi={INSIDE_AREA:{configurable:!0}};Li.prototype.isInsideArea=function(){return this._segIndex===Li.INSIDE_AREA},Li.prototype.getCoordinate=function(){return this._pt},Li.prototype.getGeometryComponent=function(){return this._component},Li.prototype.getSegmentIndex=function(){return this._segIndex},Li.prototype.interfaces_=function(){return[]},Li.prototype.getClass=function(){return Li},bi.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Li,bi);var wi=function(t){this._pts=t||null};wi.prototype.filter=function(t){t instanceof Qt&&this._pts.add(t)},wi.prototype.interfaces_=function(){return[Vt]},wi.prototype.getClass=function(){return wi},wi.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof Qt?Ze.singletonList(t):wi.getPoints(t,new Nt)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Qt?n.add(e):e instanceof zt&&e.apply(new wi(n)),n}};var Oi=function(){this._locations=null;var t=arguments[0];this._locations=t};Oi.prototype.filter=function(t){(t instanceof Qt||t instanceof Kt||t instanceof Zt)&&this._locations.add(new Li(t,0,t.getCoordinate()))},Oi.prototype.interfaces_=function(){return[Vt]},Oi.prototype.getClass=function(){return Oi},Oi.getLocations=function(t){var e=new Nt;return t.apply(new Oi(e)),e};var Ti=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Si,this._minDistanceLocation=null,this._minDistance=v.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=n,this._geom[1]=i,this._terminateDistance=r}};Ti.prototype.computeContainmentDistance=function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=1-e,r=Ni.getPolygons(this._geom[e]);if(r.size()>0){var o=Oi.getLocations(this._geom[i]);if(this.computeContainmentDistance(o,r,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[i]=n[0],this._minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&T(arguments[0],xt)&&T(arguments[1],xt)){for(var s=arguments[0],a=arguments[1],u=arguments[2],l=0;l<s.size();l++)for(var c=s.get(l),p=0;p<a.size();p++)if(this.computeContainmentDistance(c,a.get(p),u),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Li&&arguments[1]instanceof Zt){var h=arguments[0],f=arguments[1],g=arguments[2],d=h.getCoordinate();if(w.EXTERIOR!==this._ptLocator.locate(d,f))return this._minDistance=0,g[0]=h,g[1]=new Li(f,d),null}},Ti.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},Ti.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=Ci.getLines(this._geom[0]),n=Ci.getLines(this._geom[1]),i=wi.getPoints(this._geom[0]),r=wi.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,i,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(i,r,t),void this.updateMinDistance(t,!1))))},Ti.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Ti.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},Ti.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Ti.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Kt&&arguments[1]instanceof Qt){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var i=t.getCoordinates(),r=e.getCoordinate(),o=0;o<i.length-1;o++){var s=at.distancePointLine(r,i[o],i[o+1]);if(s<this._minDistance){this._minDistance=s;var a=new dn(i[o],i[o+1]).closestPoint(r);n[0]=new Li(t,o,a),n[1]=new Li(e,0,r)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Kt&&arguments[1]instanceof Kt){var u=arguments[0],l=arguments[1],c=arguments[2];if(u.getEnvelopeInternal().distance(l.getEnvelopeInternal())>this._minDistance)return null;for(var p=u.getCoordinates(),h=l.getCoordinates(),f=0;f<p.length-1;f++)for(var g=0;g<h.length-1;g++){var d=at.distanceLineLine(p[f],p[f+1],h[g],h[g+1]);if(d<this._minDistance){this._minDistance=d;var y=new dn(p[f],p[f+1]),_=new dn(h[g],h[g+1]),m=y.closestPoints(_);c[0]=new Li(u,f,m[0]),c[1]=new Li(l,g,m[1])}if(this._minDistance<=this._terminateDistance)return null}}},Ti.prototype.computeMinDistancePoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o),a=r.getCoordinate().distance(s.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,n[0]=new Li(r,0,r.getCoordinate()),n[1]=new Li(s,0,s.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},Ti.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new m("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Ti.prototype.computeMinDistanceLines=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},Ti.prototype.interfaces_=function(){return[]},Ti.prototype.getClass=function(){return Ti},Ti.distance=function(t,e){return new Ti(t,e).distance()},Ti.isWithinDistance=function(t,e,n){return new Ti(t,e,n).distance()<=n},Ti.nearestPoints=function(t,e){return new Ti(t,e).nearestPoints()};var Ri=function(){this._pt=[new C,new C],this._distance=v.NaN,this._isNull=!0};Ri.prototype.getCoordinates=function(){return this._pt},Ri.prototype.getCoordinate=function(t){return this._pt[t]},Ri.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},Ri.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},Ri.prototype.toString=function(){return $.toLineString(this._pt[0],this._pt[1])},Ri.prototype.getDistance=function(){return this._distance},Ri.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},Ri.prototype.interfaces_=function(){return[]},Ri.prototype.getClass=function(){return Ri};var Pi=function(){};Pi.prototype.interfaces_=function(){return[]},Pi.prototype.getClass=function(){return Pi},Pi.computeDistance=function(){if(arguments[2]instanceof Ri&&arguments[0]instanceof Kt&&arguments[1]instanceof C)for(var t=arguments[0],e=arguments[1],n=arguments[2],i=new dn,r=t.getCoordinates(),o=0;o<r.length-1;o++){i.setCoordinates(r[o],r[o+1]);var s=i.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof Ri&&arguments[0]instanceof Zt&&arguments[1]instanceof C){var a=arguments[0],u=arguments[1],l=arguments[2];Pi.computeDistance(a.getExteriorRing(),u,l);for(var c=0;c<a.getNumInteriorRing();c++)Pi.computeDistance(a.getInteriorRingN(c),u,l)}else if(arguments[2]instanceof Ri&&arguments[0]instanceof ct&&arguments[1]instanceof C){var p=arguments[0],h=arguments[1],f=arguments[2];if(p instanceof Kt)Pi.computeDistance(p,h,f);else if(p instanceof Zt)Pi.computeDistance(p,h,f);else if(p instanceof zt)for(var g=p,d=0;d<g.getNumGeometries();d++){var y=g.getGeometryN(d);Pi.computeDistance(y,h,f)}else f.setMinimum(p.getCoordinate(),h)}else if(arguments[2]instanceof Ri&&arguments[0]instanceof dn&&arguments[1]instanceof C){var _=arguments[0],m=arguments[1],v=arguments[2],I=_.closestPoint(m);v.setMinimum(I,m)}};var Di=function(){this._g0=null,this._g1=null,this._ptDist=new Ri,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},Mi={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Di.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Di.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new m("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},Di.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},Di.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Di.prototype.computeOrientedDistance=function(t,e,n){var i=new Ai(e);if(t.apply(i),n.setMaximum(i.getMaxPointDistance()),this._densifyFrac>0){var r=new Fi(e,this._densifyFrac);t.apply(r),n.setMaximum(r.getMaxPointDistance())}},Di.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Di.prototype.interfaces_=function(){return[]},Di.prototype.getClass=function(){return Di},Di.distance=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Di(t,e).distance()}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=new Di(n,i);return o.setDensifyFraction(r),o.distance()}},Mi.MaxPointDistanceFilter.get=function(){return Ai},Mi.MaxDensifiedByFractionDistanceFilter.get=function(){return Fi},Object.defineProperties(Di,Mi);var Ai=function(){this._maxPtDist=new Ri,this._minPtDist=new Ri,this._euclideanDist=new Pi,this._geom=null;var t=arguments[0];this._geom=t};Ai.prototype.filter=function(t){this._minPtDist.initialize(),Pi.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Ai.prototype.getMaxPointDistance=function(){return this._maxPtDist},Ai.prototype.interfaces_=function(){return[ft]},Ai.prototype.getClass=function(){return Ai};var Fi=function(){this._maxPtDist=new Ri,this._minPtDist=new Ri,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};Fi.prototype.filter=function(t,e){if(0===e)return null;for(var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=(i.x-n.x)/this._numSubSegs,o=(i.y-n.y)/this._numSubSegs,s=0;s<this._numSubSegs;s++){var a=n.x+s*r,u=n.y+s*o,l=new C(a,u);this._minPtDist.initialize(),Pi.computeDistance(this._geom,l,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},Fi.prototype.isDone=function(){return!1},Fi.prototype.isGeometryChanged=function(){return!1},Fi.prototype.getMaxPointDistance=function(){return this._maxPtDist},Fi.prototype.interfaces_=function(){return[Ut]},Fi.prototype.getClass=function(){return Fi};var Gi=function(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null},qi={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Gi.prototype.checkMaximumDistance=function(t,e,n){var i=new Di(e,t);if(i.setDensifyFraction(.25),this._maxDistanceFound=i.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var r=i.getCoordinates();this._errorLocation=r[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+$.toLineString(r[0],r[1])+")"}},Gi.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=Gi.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),Gi.VERBOSE&&Y.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},Gi.prototype.checkNegativeValid=function(){if(!(this._input instanceof Zt||this._input instanceof ne||this._input instanceof zt))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},Gi.prototype.getErrorIndicator=function(){return this._errorIndicator},Gi.prototype.checkMinimumDistance=function(t,e,n){var i=new Ti(t,e,n);if(this._minDistanceFound=i.distance(),this._minDistanceFound<n){this._isValid=!1;var r=i.nearestPoints();this._errorLocation=i.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+$.toLineString(r[0],r[1])+" )"}},Gi.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},Gi.prototype.getErrorLocation=function(){return this._errorLocation},Gi.prototype.getPolygonLines=function(t){for(var e=new Nt,n=new Ci(e),i=Ni.getPolygons(t).iterator();i.hasNext();)i.next().apply(n);return t.getFactory().buildGeometry(e)},Gi.prototype.getErrorMessage=function(){return this._errMsg},Gi.prototype.interfaces_=function(){return[]},Gi.prototype.getClass=function(){return Gi},qi.VERBOSE.get=function(){return!1},qi.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012},Object.defineProperties(Gi,qi);var Bi=function(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null},Vi={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Bi.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},Bi.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*Bi.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new j(this._input.getEnvelopeInternal());e.expandBy(this._distance);var n=new j(this._result.getEnvelopeInternal());n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")},Bi.prototype.checkDistance=function(){var t=new Gi(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},Bi.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},Bi.prototype.checkPolygonal=function(){this._result instanceof Zt||this._result instanceof ne||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},Bi.prototype.getErrorIndicator=function(){return this._errorIndicator},Bi.prototype.getErrorLocation=function(){return this._errorLocation},Bi.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2?null:this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},Bi.prototype.report=function(t){if(!Bi.VERBOSE)return null;Y.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},Bi.prototype.getErrorMessage=function(){return this._errorMsg},Bi.prototype.interfaces_=function(){return[]},Bi.prototype.getClass=function(){return Bi},Bi.isValidMsg=function(t,e,n){var i=new Bi(t,e,n);return i.isValid()?null:i.getErrorMessage()},Bi.isValid=function(t,e,n){return!!new Bi(t,e,n).isValid()},Vi.VERBOSE.get=function(){return!1},Vi.MAX_ENV_DIFF_FRAC.get=function(){return .012},Object.defineProperties(Bi,Vi);var Ui=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};Ui.prototype.getCoordinates=function(){return this._pts},Ui.prototype.size=function(){return this._pts.length},Ui.prototype.getCoordinate=function(t){return this._pts[t]},Ui.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Ui.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:pn.octant(this.getCoordinate(t),this.getCoordinate(t+1))},Ui.prototype.setData=function(t){this._data=t},Ui.prototype.getData=function(){return this._data},Ui.prototype.toString=function(){return $.toLineString(new ue(this._pts))},Ui.prototype.interfaces_=function(){return[hn]},Ui.prototype.getClass=function(){return Ui};var zi=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Nt,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};zi.prototype.getInteriorIntersection=function(){return this._interiorIntersection},zi.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},zi.prototype.getIntersectionSegments=function(){return this._intSegments},zi.prototype.count=function(){return this._intersectionCount},zi.prototype.getIntersections=function(){return this._intersections},zi.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},zi.prototype.setKeepIntersections=function(t){this._keepIntersections=t},zi.prototype.processIntersections=function(t,e,n,i){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===i)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(n,i))return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=r,this._intSegments[1]=o,this._intSegments[2]=s,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},zi.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},zi.prototype.hasIntersection=function(){return null!==this._interiorIntersection},zi.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},zi.prototype.interfaces_=function(){return[Wn]},zi.prototype.getClass=function(){return zi},zi.createAllIntersectionsFinder=function(t){var e=new zi(t);return e.setFindAllIntersections(!0),e},zi.createAnyIntersectionFinder=function(t){return new zi(t)},zi.createIntersectionCounter=function(t){var e=new zi(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var Xi=function(){this._li=new rt,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};Xi.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},Xi.prototype.getIntersections=function(){return this._segInt.getIntersections()},Xi.prototype.isValid=function(){return this.execute(),this._isValid},Xi.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Xi.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new zi(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new xn;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Xi.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new we(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Xi.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+$.toLineString(t[0],t[1])+" and "+$.toLineString(t[2],t[3])},Xi.prototype.interfaces_=function(){return[]},Xi.prototype.getClass=function(){return Xi},Xi.computeIntersections=function(t){var e=new Xi(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var Yi=function t(){this._nv=null;var e=arguments[0];this._nv=new Xi(t.toSegmentStrings(e))};Yi.prototype.checkValid=function(){this._nv.checkValid()},Yi.prototype.interfaces_=function(){return[]},Yi.prototype.getClass=function(){return Yi},Yi.toSegmentStrings=function(t){for(var e=new Nt,n=t.iterator();n.hasNext();){var i=n.next();e.add(new Ui(i.getCoordinates(),i))}return e},Yi.checkValid=function(t){new Yi(t).checkValid()};var ki=function(t){this._mapOp=t};ki.prototype.map=function(t){for(var e=new Nt,n=0;n<t.getNumGeometries();n++){var i=this._mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection(_e.toGeometryArray(e))},ki.prototype.interfaces_=function(){return[]},ki.prototype.getClass=function(){return ki},ki.map=function(t,e){return new ki(e).map(t)};var ji=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Nt,this._resultLineList=new Nt;var t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n};ji.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}},ji.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)},ji.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},ji.prototype.collectLineEdge=function(t,e,n){var i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!Lr.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))},ji.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getEdge();if(n.isLineEdge()&&!i.isCoveredSet()){var r=this._op.isCoveredByA(n.getCoordinate());i.setCovered(r)}}},ji.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(i.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},ji.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var n=e.next(),i=this._geometryFactory.createLineString(n.getCoordinates());this._resultLineList.add(i),n.setInResult(!0)}},ji.prototype.collectBoundaryTouchEdge=function(t,e,n){var i=t.getLabel();return t.isLineEdge()?null:t.isVisited()?null:t.isInteriorAreaEdge()?null:t.getEdge().isInResult()?null:(et.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(Lr.isResultOfOp(i,e)&&e===Lr.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},ji.prototype.interfaces_=function(){return[]},ji.prototype.getClass=function(){return ji};var Hi=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Nt;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};Hi.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}},Hi.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==Lr.INTERSECTION)){var i=n.getLabel();Lr.isResultOfOp(i,t)&&this.filterCoveredNodeToPoint(n)}}},Hi.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},Hi.prototype.interfaces_=function(){return[]},Hi.prototype.getClass=function(){return Hi};var Wi=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Wi.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},Wi.prototype.transformPolygon=function(t,e){var n=!0,i=this.transformLinearRing(t.getExteriorRing(),t);null!==i&&i instanceof ee&&!i.isEmpty()||(n=!1);for(var r=new Nt,o=0;o<t.getNumInteriorRing();o++){var s=this.transformLinearRing(t.getInteriorRingN(o),t);null===s||s.isEmpty()||(s instanceof ee||(n=!1),r.add(s))}if(n)return this._factory.createPolygon(i,r.toArray([]));var a=new Nt;return null!==i&&a.add(i),a.addAll(r),this._factory.buildGeometry(a)},Wi.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},Wi.prototype.getInputGeometry=function(){return this._inputGeom},Wi.prototype.transformMultiLineString=function(t,e){for(var n=new Nt,i=0;i<t.getNumGeometries();i++){var r=this.transformLineString(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Wi.prototype.transformCoordinates=function(t,e){return this.copy(t)},Wi.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},Wi.prototype.transformMultiPoint=function(t,e){for(var n=new Nt,i=0;i<t.getNumGeometries();i++){var r=this.transformPoint(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Wi.prototype.transformMultiPolygon=function(t,e){for(var n=new Nt,i=0;i<t.getNumGeometries();i++){var r=this.transformPolygon(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Wi.prototype.copy=function(t){return t.copy()},Wi.prototype.transformGeometryCollection=function(t,e){for(var n=new Nt,i=0;i<t.getNumGeometries();i++){var r=this.transform(t.getGeometryN(i));null!==r&&(this._pruneEmptyGeometry&&r.isEmpty()||n.add(r))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(_e.toGeometryArray(n)):this._factory.buildGeometry(n)},Wi.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof Qt)return this.transformPoint(t,null);if(t instanceof te)return this.transformMultiPoint(t,null);if(t instanceof ee)return this.transformLinearRing(t,null);if(t instanceof Kt)return this.transformLineString(t,null);if(t instanceof Xt)return this.transformMultiLineString(t,null);if(t instanceof Zt)return this.transformPolygon(t,null);if(t instanceof ne)return this.transformMultiPolygon(t,null);if(t instanceof zt)return this.transformGeometryCollection(t,null);throw new m("Unknown Geometry subtype: "+t.getClass().getName())},Wi.prototype.transformLinearRing=function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);var i=n.size();return i>0&&i<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)},Wi.prototype.interfaces_=function(){return[]},Wi.prototype.getClass=function(){return Wi};var Ki=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new dn,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Kt&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];t.call(this,e.getCoordinates(),n)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var i=arguments[0],r=arguments[1];this._srcPts=i,this._isClosed=t.isClosed(i),this._snapTolerance=r}};Ki.prototype.snapVertices=function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),i=0;i<n;i++){var r=t.get(i),o=this.findSnapForVertex(r,e);null!==o&&(t.set(i,new C(o)),0===i&&this._isClosed&&t.set(t.size()-1,new C(o)))}},Ki.prototype.findSnapForVertex=function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null},Ki.prototype.snapTo=function(t){var e=new St(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},Ki.prototype.snapSegments=function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var i=0;i<n;i++){var r=e[i],o=this.findSegmentIndexToSnap(r,t);o>=0&&t.add(o+1,new C(r),!1)}},Ki.prototype.findSegmentIndexToSnap=function(t,e){for(var n=v.MAX_VALUE,i=-1,r=0;r<e.size()-1;r++){if(this._seg.p0=e.get(r),this._seg.p1=e.get(r+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var o=this._seg.distance(t);o<this._snapTolerance&&o<n&&(n=o,i=r)}return i},Ki.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},Ki.prototype.interfaces_=function(){return[]},Ki.prototype.getClass=function(){return Ki},Ki.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var Ji=function(t){this._srcGeom=t||null},Qi={SNAP_PRECISION_FACTOR:{configurable:!0}};Ji.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t);return new $i(e,n).transform(this._srcGeom)},Ji.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),i=new $i(t,n,!0).transform(this._srcGeom),r=i;return e&&T(r,$t)&&(r=i.buffer(0)),r},Ji.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},Ji.prototype.extractTargetCoordinates=function(t){for(var e=new f,n=t.getCoordinates(),i=0;i<n.length;i++)e.add(n[i]);return e.toArray(new Array(0).fill(null))},Ji.prototype.computeMinimumSegmentLength=function(t){for(var e=v.MAX_VALUE,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);i<e&&(e=i)}return e},Ji.prototype.interfaces_=function(){return[]},Ji.prototype.getClass=function(){return Ji},Ji.snap=function(t,e,n){var i=new Array(2).fill(null),r=new Ji(t);i[0]=r.snapTo(e,n);var o=new Ji(e);return i[1]=o.snapTo(i[0],n),i},Ji.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=Ji.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===fe.FIXED){var i=1/n.getScale()*2/1.415;i>e&&(e=i)}return e}if(2===arguments.length){var r=arguments[0],o=arguments[1];return Math.min(Ji.computeOverlaySnapTolerance(r),Ji.computeOverlaySnapTolerance(o))}},Ji.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*Ji.SNAP_PRECISION_FACTOR},Ji.snapToSelf=function(t,e,n){return new Ji(t).snapToSelf(e,n)},Qi.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Ji,Qi);var $i=function(t){function e(e,n,i){t.call(this),this._snapTolerance=e||null,this._snapPts=n||null,this._isSelfSnap=void 0!==i&&i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(t,e){var n=new Ki(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)},e.prototype.transformCoordinates=function(t,e){var n=t.toCoordinateArray(),i=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Wi),Zi=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Zi.prototype.getCommon=function(){return v.longBitsToDouble(this._commonBits)},Zi.prototype.add=function(t){var e=v.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=Zi.signExpBits(this._commonBits),this._isFirst=!1,null):Zi.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=Zi.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=Zi.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},Zi.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=v.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+v.toBinaryString(t),i=n.substring(n.length-64);return i.substring(0,1)+"  "+i.substring(1,12)+"(exp) "+i.substring(12)+" [ "+e+" ]"}},Zi.prototype.interfaces_=function(){return[]},Zi.prototype.getClass=function(){return Zi},Zi.getBit=function(t,e){return 0!=(t&1<<e)?1:0},Zi.signExpBits=function(t){return t>>52},Zi.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},Zi.numCommonMostSigMantissaBits=function(t,e){for(var n=0,i=52;i>=0;i--){if(Zi.getBit(t,i)!==Zi.getBit(e,i))return n;n++}return 52};var tr=function(){this._commonCoord=null,this._ccFilter=new nr},er={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};tr.prototype.addCommonBits=function(t){var e=new ir(this._commonCoord);t.apply(e),t.geometryChanged()},tr.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new C(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new ir(e);return t.apply(n),t.geometryChanged(),t},tr.prototype.getCommonCoordinate=function(){return this._commonCoord},tr.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},tr.prototype.interfaces_=function(){return[]},tr.prototype.getClass=function(){return tr},er.CommonCoordinateFilter.get=function(){return nr},er.Translater.get=function(){return ir},Object.defineProperties(tr,er);var nr=function(){this._commonBitsX=new Zi,this._commonBitsY=new Zi};nr.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},nr.prototype.getCommonCoordinate=function(){return new C(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},nr.prototype.interfaces_=function(){return[ft]},nr.prototype.getClass=function(){return nr};var ir=function(){this.trans=null;var t=arguments[0];this.trans=t};ir.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)},ir.prototype.isDone=function(){return!1},ir.prototype.isGeometryChanged=function(){return!0},ir.prototype.interfaces_=function(){return[Ut]},ir.prototype.getClass=function(){return ir};var rr=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};rr.prototype.selfSnap=function(t){return new Ji(t).snapTo(t,this._snapTolerance)},rr.prototype.removeCommonBits=function(t){this._cbr=new tr,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},rr.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},rr.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),n=Lr.overlayOp(e[0],e[1],t);return this.prepareResult(n)},rr.prototype.checkValid=function(t){t.isValid()||Y.out.println("Snapped geometry is invalid")},rr.prototype.computeSnapTolerance=function(){this._snapTolerance=Ji.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},rr.prototype.snap=function(t){var e=this.removeCommonBits(t);return Ji.snap(e[0],e[1],this._snapTolerance)},rr.prototype.interfaces_=function(){return[]},rr.prototype.getClass=function(){return rr},rr.overlayOp=function(t,e,n){return new rr(t,e).getResultGeometry(n)},rr.union=function(t,e){return rr.overlayOp(t,e,Lr.UNION)},rr.intersection=function(t,e){return rr.overlayOp(t,e,Lr.INTERSECTION)},rr.symDifference=function(t,e){return rr.overlayOp(t,e,Lr.SYMDIFFERENCE)},rr.difference=function(t,e){return rr.overlayOp(t,e,Lr.DIFFERENCE)};var or=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};or.prototype.getResultGeometry=function(t){var e=null,n=!1,i=null;try{e=Lr.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof Z))throw t;i=t}if(!n)try{e=rr.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof Z?i:t}return e},or.prototype.interfaces_=function(){return[]},or.prototype.getClass=function(){return or},or.overlayOp=function(t,e,n){return new or(t,e).getResultGeometry(n)},or.union=function(t,e){return or.overlayOp(t,e,Lr.UNION)},or.intersection=function(t,e){return or.overlayOp(t,e,Lr.INTERSECTION)},or.symDifference=function(t,e){return or.overlayOp(t,e,Lr.SYMDIFFERENCE)},or.difference=function(t,e){return or.overlayOp(t,e,Lr.DIFFERENCE)};var sr=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};sr.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},sr.prototype.interfaces_=function(){return[]},sr.prototype.getClass=function(){return sr};var ar=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],n=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=n}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._eventType=t.INSERT,this._label=i,this._xValue=r,this._obj=o}},ur={INSERT:{configurable:!0},DELETE:{configurable:!0}};ar.prototype.isDelete=function(){return this._eventType===ar.DELETE},ar.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},ar.prototype.getObject=function(){return this._obj},ar.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},ar.prototype.getInsertEvent=function(){return this._insertEvent},ar.prototype.isInsert=function(){return this._eventType===ar.INSERT},ar.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},ar.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},ar.prototype.interfaces_=function(){return[E]},ar.prototype.getClass=function(){return ar},ur.INSERT.get=function(){return 1},ur.DELETE.get=function(){return 2},Object.defineProperties(ar,ur);var lr=function(){};lr.prototype.interfaces_=function(){return[]},lr.prototype.getClass=function(){return lr};var cr=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n};cr.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(cr.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},cr.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},cr.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},cr.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},cr.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next().getCoordinate();if(t.isIntersection(i))return!0}return!1},cr.prototype.hasProperIntersection=function(){return this._hasProper},cr.prototype.hasIntersection=function(){return this._hasIntersection},cr.prototype.isDone=function(){return this._isDone},cr.prototype.isBoundaryPoint=function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))},cr.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},cr.prototype.addIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},cr.prototype.interfaces_=function(){return[]},cr.prototype.getClass=function(){return cr},cr.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var pr=function(t){function e(){t.call(this),this.events=new Nt,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){Ze.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof cr&&T(arguments[0],xt)&&T(arguments[1],xt)){var i=arguments[0],r=arguments[1],o=arguments[2];this.addEdges(i,i),this.addEdges(r,r),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&T(arguments[0],xt)&&arguments[1]instanceof cr){var s=arguments[0],a=arguments[1];arguments[2]?this.addEdges(s,null):this.addEdges(s),this.computeIntersections(a)}},e.prototype.addEdge=function(t,e){for(var n=t.getMonotoneChainEdge(),i=n.getStartIndexes(),r=0;r<i.length-1;r++){var o=new sr(n,r),s=new ar(e,n.getMinX(r),o);this.events.add(s),this.events.add(new ar(n.getMaxX(r),s))}},e.prototype.processOverlaps=function(t,e,n,i){for(var r=n.getObject(),o=t;o<e;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();n.isSameLabel(s)||(r.computeIntersections(a,i),this.nOverlaps++)}}},e.prototype.addEdges=function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1],r=n.iterator();r.hasNext();){var o=r.next();this.addEdge(o,i)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(lr),hr=function(){this._min=v.POSITIVE_INFINITY,this._max=v.NEGATIVE_INFINITY},fr={NodeComparator:{configurable:!0}};hr.prototype.getMin=function(){return this._min},hr.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},hr.prototype.getMax=function(){return this._max},hr.prototype.toString=function(){return $.toLineString(new C(this._min,0),new C(this._max,0))},hr.prototype.interfaces_=function(){return[]},hr.prototype.getClass=function(){return hr},fr.NodeComparator.get=function(){return gr},Object.defineProperties(hr,fr);var gr=function(){};gr.prototype.compare=function(t,e){var n=t,i=e,r=(n._min+n._max)/2,o=(i._min+i._max)/2;return r<o?-1:r>o?1:0},gr.prototype.interfaces_=function(){return[N]},gr.prototype.getClass=function(){return gr};var dr=function(t){function e(){t.call(this),this._item=null;var e=arguments[0],n=arguments[1],i=arguments[2];this._min=e,this._max=n,this._item=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(hr),yr=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var e=arguments[0],n=arguments[1];this._node1=e,this._node2=n,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(hr),_r=function(){this._leaves=new Nt,this._root=null,this._level=0};_r.prototype.buildTree=function(){Ze.sort(this._leaves,new hr.NodeComparator);for(var t=this._leaves,e=null,n=new Nt;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},_r.prototype.insert=function(t,e,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new dr(t,e,n))},_r.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)},_r.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},_r.prototype.printNode=function(t){Y.out.println($.toLineString(new C(t._min,this._level),new C(t._max,this._level)))},_r.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},_r.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{var r=new yr(t.get(n),t.get(n+1));e.add(r)}}},_r.prototype.interfaces_=function(){return[]},_r.prototype.getClass=function(){return _r};var mr=function(){this._items=new Nt};mr.prototype.visitItem=function(t){this._items.add(t)},mr.prototype.getItems=function(){return this._items},mr.prototype.interfaces_=function(){return[Ke]},mr.prototype.getClass=function(){return mr};var vr=function(){this._index=null;var t=arguments[0];if(!T(t,$t))throw new m("Argument must be Polygonal");this._index=new xr(t)},Ir={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};vr.prototype.locate=function(t){var e=new st(t),n=new Er(e);return this._index.query(t.y,t.y,n),e.getLocation()},vr.prototype.interfaces_=function(){return[Vn]},vr.prototype.getClass=function(){return vr},Ir.SegmentVisitor.get=function(){return Er},Ir.IntervalIndexedGeometry.get=function(){return xr},Object.defineProperties(vr,Ir);var Er=function(){this._counter=null;var t=arguments[0];this._counter=t};Er.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},Er.prototype.interfaces_=function(){return[Ke]},Er.prototype.getClass=function(){return Er};var xr=function(){this._index=new _r;var t=arguments[0];this.init(t)};xr.prototype.init=function(t){for(var e=Ci.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},xr.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var n=new dn(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this._index.insert(i,r,n)}},xr.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new mr;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._index.query(i,r,o)}},xr.prototype.interfaces_=function(){return[]},xr.prototype.getClass=function(){return xr};var Nr=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new he,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Si,2===arguments.length){var e=arguments[0],n=arguments[1],i=gt.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=n,this._boundaryNodeRule=i,null!==n&&this.add(n)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this._argIndex=r,this._parentGeom=o,this._boundaryNodeRule=s,null!==o&&this.add(o)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(t,n){var i=this._nodes.addNode(n).getLabel(),r=1;w.NONE,i.getLocation(t,Se.ON)===w.BOUNDARY&&r++;var o=e.determineBoundary(this._boundaryNodeRule,r);i.setLocation(t,o)},e.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=new cr(n,!0,!1);o.setIsDoneIfProperInt(r);var s=this.createEdgeSetIntersector(),a=this._parentGeom instanceof ee||this._parentGeom instanceof Zt||this._parentGeom instanceof ne,u=i||!a;return s.computeIntersections(this._edges,o,u),this.addSelfIntersectionNodes(this._argIndex),o}},e.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},e.prototype.computeEdgeIntersections=function(t,e,n){var i=new cr(e,n,!0);return i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,i),i},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof Qt){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,w.INTERIOR)}else if(arguments[0]instanceof C){var e=arguments[0];this.insertPoint(this._argIndex,e,w.INTERIOR)}},e.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),w.EXTERIOR,w.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,w.INTERIOR,w.EXTERIOR)}},e.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],w.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],w.BOUNDARY)},e.prototype.addLineString=function(t){var e=Lt.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new ni(e,new Pe(this._argIndex,w.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),et.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,i=t.iterator();i.hasNext();){var r=i.next();e[n++]=r.getCoordinate().copy()}return e},e.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===w.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)},e.prototype.addPolygonRing=function(t,e,n){if(t.isEmpty())return null;var i=Lt.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=i[0],null;var r=e,o=n;at.isCCW(i)&&(r=n,o=e);var s=new ni(i,new Pe(this._argIndex,w.BOUNDARY,r,o));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,i[0],w.BOUNDARY)},e.prototype.insertPoint=function(t,e,n){var i=this._nodes.addNode(e),r=i.getLabel();null===r?i._label=new Pe(t,n):r.setLocation(t,n)},e.prototype.createEdgeSetIntersector=function(){return new pr},e.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.eiList.iterator();r.hasNext();){var o=r.next();this.addSelfIntersectionNode(t,o.coord,i)}},e.prototype.add=function(){if(1!==arguments.length)return t.prototype.add.apply(this,arguments);var e=arguments[0];if(e.isEmpty())return null;if(e instanceof ne&&(this._useBoundaryDeterminationRule=!1),e instanceof Zt)this.addPolygon(e);else if(e instanceof Kt)this.addLineString(e);else if(e instanceof Qt)this.addPoint(e);else if(e instanceof te)this.addCollection(e);else if(e instanceof Xt)this.addCollection(e);else if(e instanceof ne)this.addCollection(e);else{if(!(e instanceof zt))throw new Error(e.getClass().getName());this.addCollection(e)}},e.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},e.prototype.locate=function(t){return T(this._parentGeom,$t)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new vr(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},e.prototype.findEdge=function(){if(1===arguments.length){var e=arguments[0];return this._lineEdgeMap.get(e)}return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(t,e){return t.isInBoundary(e)?w.BOUNDARY:w.INTERIOR},e}(Ye),Cr=function(){if(this._li=new rt,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Nr(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=gt.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(n.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(n.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Nr(0,e,i),this._arg[1]=new Nr(1,n,i)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];r.getPrecisionModel().compareTo(o.getPrecisionModel())>=0?this.setComputationPrecision(r.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Nr(0,r,s),this._arg[1]=new Nr(1,o,s)}};Cr.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},Cr.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},Cr.prototype.interfaces_=function(){return[]},Cr.prototype.getClass=function(){return Cr};var Sr=function(){};Sr.prototype.interfaces_=function(){return[]},Sr.prototype.getClass=function(){return Sr},Sr.map=function(){if(arguments[0]instanceof ct&&T(arguments[1],Sr.MapOp)){for(var t=arguments[0],e=arguments[1],n=new Nt,i=0;i<t.getNumGeometries();i++){var r=e.map(t.getGeometryN(i));null!==r&&n.add(r)}return t.getFactory().buildGeometry(n)}if(T(arguments[0],It)&&T(arguments[1],Sr.MapOp)){for(var o=arguments[0],s=arguments[1],a=new Nt,u=o.iterator();u.hasNext();){var l=u.next(),c=s.map(l);null!==c&&a.add(c)}return a}},Sr.MapOp=function(){};var Lr=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n),this._ptLocator=new Si,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Hn,this._resultPolyList=new Nt,this._resultLineList=new Nt,this._resultPointList=new Nt,this._graph=new Ye(new kn()),this._geomFact=e.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new Pe(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this._edgeList.add(t)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},e.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},e.prototype.computeGeometry=function(t,n,i,r){var o=new Nt;return o.addAll(t),o.addAll(n),o.addAll(i),o.isEmpty()?e.createEmptyResult(r,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(o)},e.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},e.prototype.isCovered=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(this._ptLocator.locate(t,i)!==w.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var t=new Nt,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)},e.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},e.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},e.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},e.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new Nt;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Yi.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new ke(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var i=new ji(this,this._geomFact,this._ptLocator);this._resultLineList=i.build(t);var r=new Hi(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},e.prototype.labelIncompleteNode=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)},e.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},e.prototype.findResultAreaEdges=function(t){for(var n=this._graph.getEdgeEnds().iterator();n.hasNext();){var i=n.next(),r=i.getLabel();r.isArea()&&!i.isInteriorAreaEdge()&&e.isResultOfOp(r.getLocation(0,Se.RIGHT),r.getLocation(1,Se.RIGHT),t)&&i.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(var r=0;r<2;r++)n.isNull(r)||!n.isArea()||i.isNull(r)||(0===i.getDelta(r)?n.toLine(r):(et.isTrue(!i.isNull(r,Se.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(r,Se.LEFT,i.getLocation(r,Se.LEFT)),et.isTrue(!i.isNull(r,Se.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(r,Se.RIGHT,i.getLocation(r,Se.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},e.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Cr);Lr.overlayOp=function(t,e,n){return new Lr(t,e).getResultGeometry(n)},Lr.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Lr.createEmptyResult(Lr.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return ki.map(t,{interfaces_:function(){return[Sr.MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Lr.INTERSECTION)},Lr.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Lr.createEmptyResult(Lr.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Lr.SYMDIFFERENCE)},Lr.resultDimension=function(t,e,n){var i=e.getDimension(),r=n.getDimension(),o=-1;switch(t){case Lr.INTERSECTION:o=Math.min(i,r);break;case Lr.UNION:o=Math.max(i,r);break;case Lr.DIFFERENCE:o=i;break;case Lr.SYMDIFFERENCE:o=Math.max(i,r);}return o},Lr.createEmptyResult=function(t,e,n,i){var r=null;switch(Lr.resultDimension(t,e,n)){case-1:r=i.createGeometryCollection(new Array(0).fill(null));break;case 0:r=i.createPoint();break;case 1:r=i.createLineString();break;case 2:r=i.createPolygon();}return r},Lr.difference=function(t,e){return t.isEmpty()?Lr.createEmptyResult(Lr.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Lr.DIFFERENCE))},Lr.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),i=t.getLocation(1);return Lr.isResultOfOp(n,i,e)}if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];switch(r===w.BOUNDARY&&(r=w.INTERIOR),o===w.BOUNDARY&&(o=w.INTERIOR),s){case Lr.INTERSECTION:return r===w.INTERIOR&&o===w.INTERIOR;case Lr.UNION:return r===w.INTERIOR||o===w.INTERIOR;case Lr.DIFFERENCE:return r===w.INTERIOR&&o!==w.INTERIOR;case Lr.SYMDIFFERENCE:return r===w.INTERIOR&&o!==w.INTERIOR||r!==w.INTERIOR&&o===w.INTERIOR;}return!1}},Lr.INTERSECTION=1,Lr.UNION=2,Lr.DIFFERENCE=3,Lr.SYMDIFFERENCE=4;var br=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Si,this._seg=new dn;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};br.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var n=this._linework.getGeometryN(e).getCoordinateSequence(),i=0;i<n.size()-1;i++)if(n.getCoordinate(i,this._seg.p0),n.getCoordinate(i+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0;return!1},br.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?w.BOUNDARY:this._ptLocator.locate(t,this._g)},br.prototype.extractLinework=function(t){var e=new wr;t.apply(e);var n=e.getLinework(),i=_e.toLineStringArray(n);return t.getFactory().createMultiLineString(i)},br.prototype.interfaces_=function(){return[]},br.prototype.getClass=function(){return br};var wr=function(){this._linework=null,this._linework=new Nt};wr.prototype.getLinework=function(){return this._linework},wr.prototype.filter=function(t){if(t instanceof Zt){var e=t;this._linework.add(e.getExteriorRing());for(var n=0;n<e.getNumInteriorRing();n++)this._linework.add(e.getInteriorRingN(n))}},wr.prototype.interfaces_=function(){return[Vt]},wr.prototype.getClass=function(){return wr};var Or=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};Or.prototype.extractPoints=function(t,e,n){for(var i=t.getCoordinates(),r=0;r<i.length-1;r++)this.computeOffsetPoints(i[r],i[r+1],e,n)},Or.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},Or.prototype.getPoints=function(t){for(var e=new Nt,n=Ci.getLines(this._g).iterator();n.hasNext();){var i=n.next();this.extractPoints(i,t,e)}return e},Or.prototype.computeOffsetPoints=function(t,e,n,i){var r=e.x-t.x,o=e.y-t.y,s=Math.sqrt(r*r+o*o),a=n*r/s,u=n*o/s,l=(e.x+t.x)/2,c=(e.y+t.y)/2;if(this._doLeft){var p=new C(l-u,c+a);i.add(p)}if(this._doRight){var h=new C(l+u,c-a);i.add(h)}},Or.prototype.interfaces_=function(){return[]},Or.prototype.getClass=function(){return Or};var Tr=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new Nt;var e=arguments[0],n=arguments[1],i=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,n),this._geom=[e,n,i],this._locFinder=[new br(this._geom[0],this._boundaryDistanceTolerance),new br(this._geom[1],this._boundaryDistanceTolerance),new br(this._geom[2],this._boundaryDistanceTolerance)]},Rr={TOLERANCE:{configurable:!0}};Tr.prototype.reportResult=function(t,e,n){Y.out.println("Overlay result invalid - A:"+w.toLocationSymbol(e[0])+" B:"+w.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+w.toLocationSymbol(e[2]))},Tr.prototype.isValid=function(t){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(t)},Tr.prototype.checkValid=function(){if(1===arguments.length){for(var t=arguments[0],e=0;e<this._testCoords.size();e++){var n=this._testCoords.get(e);if(!this.checkValid(t,n))return this._invalidLocation=n,!1}return!0}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._location[0]=this._locFinder[0].getLocation(r),this._location[1]=this._locFinder[1].getLocation(r),this._location[2]=this._locFinder[2].getLocation(r),!!Tr.hasLocation(this._location,w.BOUNDARY)||this.isValidResult(i,this._location)}},Tr.prototype.addTestPts=function(t){var e=new Or(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},Tr.prototype.isValidResult=function(t,e){var n=Lr.isResultOfOp(e[0],e[1],t),i=!(n^e[2]===w.INTERIOR);return i||this.reportResult(t,e,n),i},Tr.prototype.getInvalidLocation=function(){return this._invalidLocation},Tr.prototype.interfaces_=function(){return[]},Tr.prototype.getClass=function(){return Tr},Tr.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1},Tr.computeBoundaryDistanceTolerance=function(t,e){return Math.min(Ji.computeSizeBasedSnapTolerance(t),Ji.computeSizeBasedSnapTolerance(e))},Tr.isValid=function(t,e,n,i){return new Tr(t,e,i).isValid(n)},Rr.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Tr,Rr);var Pr=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};Pr.prototype.extractElements=function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);this._skipEmpty&&i.isEmpty()||e.add(i)}},Pr.prototype.combine=function(){for(var t=new Nt,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},Pr.prototype.interfaces_=function(){return[]},Pr.prototype.getClass=function(){return Pr},Pr.combine=function(){if(1===arguments.length){var t=arguments[0];return new Pr(t).combine()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return new Pr(Pr.createList(e,n)).combine()}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];return new Pr(Pr.createList(i,r,o)).combine()}},Pr.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Pr.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new Nt;return n.add(t),n.add(e),n}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=new Nt;return s.add(i),s.add(r),s.add(o),s}};var Dr=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new Nt)},Mr={STRTREE_NODE_CAPACITY:{configurable:!0}};Dr.prototype.reduceToGeometries=function(t){for(var e=new Nt,n=t.iterator();n.hasNext();){var i=n.next(),r=null;T(i,xt)?r=this.unionTree(i):i instanceof ct&&(r=i),e.add(r)}return e},Dr.prototype.extractByEnvelope=function(t,e,n){for(var i=new Nt,r=0;r<e.getNumGeometries();r++){var o=e.getGeometryN(r);o.getEnvelopeInternal().intersects(t)?i.add(o):n.add(o)}return this._geomFactory.buildGeometry(i)},Dr.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),i=e.getEnvelopeInternal();if(!n.intersects(i))return Pr.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=n.intersection(i);return this.unionUsingEnvelopeIntersection(t,e,r)},Dr.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new sn(Dr.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var i=t.itemsTree();return this.unionTree(i)},Dr.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];if(i-n<=1){var r=Dr.getGeometry(e,n);return this.unionSafe(r,null)}if(i-n==2)return this.unionSafe(Dr.getGeometry(e,n),Dr.getGeometry(e,n+1));var o=Math.trunc((i+n)/2),s=this.binaryUnion(e,n,o),a=this.binaryUnion(e,o,i);return this.unionSafe(s,a)}},Dr.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();){var i=n.next();e=null===e?i.copy():e.union(i)}return e},Dr.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},Dr.prototype.unionActual=function(t,e){return Dr.restrictToPolygons(t.union(e))},Dr.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},Dr.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var i=new Nt,r=this.extractByEnvelope(n,t,i),o=this.extractByEnvelope(n,e,i),s=this.unionActual(r,o);return i.add(s),Pr.combine(i)},Dr.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}},Dr.prototype.interfaces_=function(){return[]},Dr.prototype.getClass=function(){return Dr},Dr.restrictToPolygons=function(t){if(T(t,$t))return t;var e=Ni.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(_e.toPolygonArray(e))},Dr.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Dr.union=function(t){return new Dr(t).union()},Mr.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Dr,Mr);var Ar=function(){};Ar.prototype.interfaces_=function(){return[]},Ar.prototype.getClass=function(){return Ar},Ar.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Lr.createEmptyResult(Lr.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Lr.UNION)},t.GeoJSONReader=Ne,t.GeoJSONWriter=Ce,t.OverlayOp=Lr,t.UnionOp=Ar,t.BufferOp=di,Object.defineProperty(t,"__esModule",{value:!0})});function Wu(r,t){return nm(r,"mercator",t)}function Xu(r,t){return nm(r,"wgs84",t)}function nm(r,t,$){if($=$||{},!ue($))throw new Error("options is invalid");var o=$.mutate;if(!r)throw new Error("geojson is required");return Array.isArray(r)&&te(r[0])?r="mercator"===t?om(r):pm(r):(!0!==o&&(r=Zu(r)),di(r,function(r){var $="mercator"===t?om(r):pm(r);r[0]=$[0],r[1]=$[1]})),r}function om(r){var t=Math.PI/180,$=6378137,o=20037508.342789244,e=[$*(Math.abs(r[0])<=180?r[0]:r[0]-360*Yu(r[0]))*t,$*Math.log(Math.tan(.25*Math.PI+.5*r[1]*t))];return e[0]>o&&(e[0]=o),e[0]<-o&&(e[0]=-o),e[1]>o&&(e[1]=o),e[1]<-o&&(e[1]=-o),e}function pm(r){var t=180/Math.PI,$=6378137;return[r[0]*t/$,(.5*Math.PI-2*Math.atan(Math.exp(-r[1]/$)))*t]}function Yu(r){return r<0?-1:r>0?1:0}function Zu(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return qm(e);case"FeatureCollection":return $u(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return gi(e);default:throw new Error("unknown GeoJSON type");}}function qm(e){var r={type:"Feature"};return Object.keys(e).forEach(function(t){switch(t){case"type":case"properties":case"geometry":return;default:r[t]=e[t];}}),r.properties=rm(e.properties),r.geometry=gi(e.geometry),r}function rm(e){var r={};return e?(Object.keys(e).forEach(function(t){var n=e[t];"object"==typeof n?null===n?r[t]=null:n.length?r[t]=n.map(function(e){return e}):r[t]=rm(n):r[t]=n}),r):r}function $u(e){var r={type:"FeatureCollection"};return Object.keys(e).forEach(function(t){switch(t){case"type":case"features":return;default:r[t]=e[t];}}),r.features=e.features.map(function(e){return qm(e)}),r}function gi(e){var r={type:e.type};return e.bbox&&(r.bbox=e.bbox),"GeometryCollection"===e.type?(r.geometries=e.geometries.map(function(e){return gi(e)}),r):(r.coordinates=sm(e.coordinates),r)}function sm(e){return"object"!=typeof e[0]?e.slice():e.map(function(e){return sm(e)})}var ob=function(){return new ve};function ve(){this.reset()}ve.prototype={constructor:ve,reset:function(){this.s=this.t=0},add:function($){tm(we,$,this.t),tm(this,we.s,this.s),this.s?this.t+=we.t:this.s=we.t},valueOf:function(){return this.s}};var we=new ve;function tm($,t,r){var e=$.s=t+r,f=e-t,a=e-f;$.t=t-a+(r-f)}var F=1e-6;var y=Math.PI;var V=y/2;var xe=y/4;var _=2*y;var T=180/y;var B=y/180;var z=Math.abs;var bd=Math.atan;var Xa=Math.atan2;var k=Math.cos;var Kw=Math.ceil;var um=Math.exp;var Lw=Math.floor;var vm=Math.log;var Mw=Math.pow;var j=Math.sin;var Nw=Math.sign||function($){return $>0?1:$<0?-1:0};var ja=Math.sqrt;var wm=Math.tan;function xm($){return $>1?0:$<-1?y:Math.acos($)}function Ya($){return $>1?V:$<-1?-V:Math.asin($)}function s(){}function ye(e,t){e&&zm.hasOwnProperty(e.type)&&zm[e.type](e,t)}var ym={Feature:function(e,t){ye(e.geometry,t)},FeatureCollection:function(e,t){for(var r=e.features,o=-1,n=r.length;++o<n;)ye(r[o].geometry,t)}},zm={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var r=e.coordinates,o=-1,n=r.length;++o<n;)e=r[o],t.point(e[0],e[1],e[2])},LineString:function(e,t){hi(e.coordinates,t,0)},MultiLineString:function(e,t){for(var r=e.coordinates,o=-1,n=r.length;++o<n;)hi(r[o],t,0)},Polygon:function(e,t){Am(e.coordinates,t)},MultiPolygon:function(e,t){for(var r=e.coordinates,o=-1,n=r.length;++o<n;)Am(r[o],t)},GeometryCollection:function(e,t){for(var r=e.geometries,o=-1,n=r.length;++o<n;)ye(r[o],t)}};function hi(e,t,r){var o,n=-1,$=e.length-r;for(t.lineStart();++n<$;)o=e[n],t.point(o[0],o[1],o[2]);t.lineEnd()}function Am(e,t){var r=-1,o=e.length;for(t.polygonStart();++r<o;)hi(e[r],t,1);t.polygonEnd()}var Bm=function(e,t){e&&ym.hasOwnProperty(e.type)?ym[e.type](e,t):ye(e,t)};var ze=ob();var _u,av,bv,cv,dv,Cm=ob(),Za={point:s,lineStart:s,lineEnd:s,polygonStart:function(){ze.reset(),Za.lineStart=ev,Za.lineEnd=fv},polygonEnd:function(){var r=+ze;Cm.add(r<0?_+r:r),this.lineStart=this.lineEnd=this.point=s},sphere:function(){Cm.add(_)}};function ev(){Za.point=gv}function fv(){Dm(_u,av)}function gv(r,$){Za.point=Dm,_u=r,av=$,r*=B,$*=B,bv=r,cv=k($=$/2+xe),dv=j($)}function Dm(r,$){r*=B,$=($*=B)/2+xe;var t=r-bv,a=t>=0?1:-1,e=a*t,i=k($),o=j($),K=dv*o,n=cv*i+K*k(e),p=K*a*j(e);ze.add(Xa(p,n)),bv=r,cv=i,dv=o}function Ae($){return[Xa($[1],$[0]),Ya($[2])]}function Sb($){var r=$[0],t=$[1],e=k(t);return[e*k(r),e*j(r),j(t)]}function Be($,r){return $[0]*r[0]+$[1]*r[1]+$[2]*r[2]}function rc($,r){return[$[1]*r[2]-$[2]*r[1],$[2]*r[0]-$[0]*r[2],$[0]*r[1]-$[1]*r[0]]}function ii($,r){$[0]+=r[0],$[1]+=r[1],$[2]+=r[2]}function Ce($,r){return[$[0]*r,$[1]*r,$[2]*r]}function De($){var r=ja($[0]*$[0]+$[1]*$[1]+$[2]*$[2]);$[0]/=r,$[1]/=r,$[2]/=r}var qa,Ee,ra,Fe,sc,hv,iv,ji,Em,tc,cd=ob(),pb={point:ki,lineStart:Gm,lineEnd:Hm,polygonStart:function(){pb.point=Im,pb.lineStart=jv,pb.lineEnd=kv,cd.reset(),Za.polygonStart()},polygonEnd:function(){Za.polygonEnd(),pb.point=ki,pb.lineStart=Gm,pb.lineEnd=Hm,ze<0?(qa=-(ra=180),Ee=-(Fe=90)):cd>F?Fe=90:cd<-F&&(Ee=-90),tc[0]=qa,tc[1]=ra}};function ki($,r){Em.push(tc=[qa=$,ra=$]),r<Ee&&(Ee=r),r>Fe&&(Fe=r)}function Fm($,r){var a=Sb([$*B,r*B]);if(ji){var L=rc(ji,a),w=[L[1],-L[0],0],v=rc(w,L);De(v),v=Ae(v);var n,e=$-sc,i=e>0?1:-1,t=v[0]*T*i,l=z(e)>180;l^(i*sc<t&&t<i*$)?(n=v[1]*T)>Fe&&(Fe=n):l^(i*sc<(t=(t+360)%360-180)&&t<i*$)?(n=-v[1]*T)<Ee&&(Ee=n):(r<Ee&&(Ee=r),r>Fe&&(Fe=r)),l?$<sc?qb(qa,$)>qb(qa,ra)&&(ra=$):qb($,ra)>qb(qa,ra)&&(qa=$):ra>=qa?($<qa&&(qa=$),$>ra&&(ra=$)):$>sc?qb(qa,$)>qb(qa,ra)&&(ra=$):qb($,ra)>qb(qa,ra)&&(qa=$)}else Em.push(tc=[qa=$,ra=$]);r<Ee&&(Ee=r),r>Fe&&(Fe=r),ji=a,sc=$}function Gm(){pb.point=Fm}function Hm(){tc[0]=qa,tc[1]=ra,pb.point=ki,ji=null}function Im($,r){if(ji){var a=$-sc;cd.add(z(a)>180?a+(a>0?360:-360):a)}else hv=$,iv=r;Za.point($,r),Fm($,r)}function jv(){Za.lineStart()}function kv(){Im(hv,iv),Za.lineEnd(),z(cd)>F&&(qa=-(ra=180)),tc[0]=qa,tc[1]=ra,ji=null}function qb($,r){return(r-=$)<0?r+360:r}var li,Ow,lv,mv,nv,Pw,Qw,Rw,Sw,Tw,Uw,ov,pv,sa,ta,ua;var Fa={sphere:s,point:mi,lineStart:Jm,lineEnd:Km,polygonStart:function(){Fa.lineStart=sv,Fa.lineEnd=tv},polygonEnd:function(){Fa.lineStart=Jm,Fa.lineEnd=Km}};function mi($,r){$*=B,r*=B;var s=k(r);dd(s*k($),s*j($),j(r))}function dd($,r,s){lv+=($-lv)/++li,mv+=(r-mv)/li,nv+=(s-nv)/li}function Jm(){Fa.point=qv}function qv($,r){$*=B,r*=B;var s=k(r);sa=s*k($),ta=s*j($),ua=j(r),Fa.point=rv,dd(sa,ta,ua)}function rv($,r){$*=B,r*=B;var s=k(r),a=s*k($),C=s*j($),G=j(r),Q=Xa(ja((Q=ta*G-ua*C)*Q+(Q=ua*a-sa*G)*Q+(Q=sa*C-ta*a)*Q),sa*a+ta*C+ua*G);Ow+=Q,Pw+=Q*(sa+(sa=a)),Qw+=Q*(ta+(ta=C)),Rw+=Q*(ua+(ua=G)),dd(sa,ta,ua)}function Km(){Fa.point=mi}function sv(){Fa.point=uv}function tv(){Lm(ov,pv),Fa.point=mi}function uv($,r){ov=$,pv=r,$*=B,r*=B,Fa.point=Lm;var s=k(r);sa=s*k($),ta=s*j($),ua=j(r),dd(sa,ta,ua)}function Lm($,r){$*=B,r*=B;var s=k(r),a=s*k($),C=s*j($),G=j(r),Q=ta*G-ua*C,i=ua*a-sa*G,t=sa*C-ta*a,n=ja(Q*Q+i*i+t*t),v=Ya(n),o=n&&-v/n;Sw+=o*Q,Tw+=o*i,Uw+=o*t,Ow+=v,Pw+=v*(sa+(sa=a)),Qw+=v*(ta+(ta=C)),Rw+=v*(ua+(ua=G)),dd(sa,ta,ua)}function vv($,t,r,c,i,o){if(r){var n=k(t),e=j(t),a=c*r;null==i?(i=t+c*_,o=t-a/2):(i=Mm(n,i),o=Mm(n,o),(c>0?i<o:i>o)&&(i+=c*_));for(var p,R=i;c>0?R>o:R<o;R-=a)p=Ae([n,-e*k(R),-e*j(R)]),$.point(p[0],p[1])}}function Mm($,t){(t=Sb(t))[0]-=$,De(t);var r=xm(-t[1]);return((-t[2]<0?-r:r)+_-F)%_}function ni($,r){return[$>y?$-_:$<-y?$+_:$,r]}function Nm($,r,t){return($%=_)?r||t?Rm(Pm($),Qm(r,t)):Pm($):r||t?Qm(r,t):ni}function Om($){return function(r,t){return[(r+=$)>y?r-_:r<-y?r+_:r,t]}}function Pm($){var r=Om($);return r.invert=Om(-$),r}function Qm($,r){var t=k($),o=j($),i=k(r),a=j(r);function n($,r){var n=k(r),L=k($)*n,q=j($)*n,U=j(r),Y=U*t+L*o;return[Xa(q*i-Y*a,L*t-U*o),Ya(Y*i+q*a)]}return n.invert=function($,r){var n=k(r),L=k($)*n,q=j($)*n,U=j(r),Y=U*i-q*a;return[Xa(q*i+U*a,L*t+Y*o),Ya(Y*t-L*o)]},n}var Rm=function(t,r){function e(e,n){return e=t(e,n),r(e[0],e[1])}return t.invert&&r.invert&&(e.invert=function(e,n){return(e=r.invert(e,n))&&t.invert(e[0],e[1])}),e};ni.invert=ni;var wv=function($){function r(r){return(r=$(r[0]*B,r[1]*B))[0]*=T,r[1]*=T,r}return $=Nm($[0]*B,$[1]*B,$.length>2?$[2]*B:0),r.invert=function(r){return(r=$.invert(r[0]*B,r[1]*B))[0]*=T,r[1]*=T,r},r};var Sm=function(){var n,t=[];return{point:function(t,r){n.push([t,r])},lineStart:function(){t.push(n=[])},lineEnd:s,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var r=t;return t=[],n=null,r}}};var xv=function(i,e,f,r,t,n){var u,$=i[0],l=i[1],s=0,a=1,o=e[0]-$,p=e[1]-l;if(u=f-$,o||!(u>0)){if(u/=o,o<0){if(u<s)return;u<a&&(a=u)}else if(o>0){if(u>a)return;u>s&&(s=u)}if(u=t-$,o||!(u<0)){if(u/=o,o<0){if(u>a)return;u>s&&(s=u)}else if(o>0){if(u<s)return;u<a&&(a=u)}if(u=r-l,p||!(u>0)){if(u/=p,p<0){if(u<s)return;u<a&&(a=u)}else if(p>0){if(u>a)return;u>s&&(s=u)}if(u=n-l,p||!(u<0)){if(u/=p,p<0){if(u>a)return;u>s&&(s=u)}else if(p>0){if(u<s)return;u<a&&(a=u)}return s>0&&(i[0]=$+s*o,i[1]=l+s*p),a<1&&(e[0]=$+a*o,e[1]=l+a*p),!0}}}}};function Ge(n,e,t,r){this.x=n,this.z=e,this.o=t,this.e=r,this.v=!1,this.n=this.p=null}var He=function($,r){return z($[0]-r[0])<F&&z($[1]-r[1])<F};var Tm=function(n,e,t,r,i){var $,l,o=[],u=[];if(n.forEach(function(n){if(!((e=n.length-1)<=0)){var e,t,r=n[0],l=n[e];if(He(r,l)){for(i.lineStart(),$=0;$<e;++$)i.point((r=n[$])[0],r[1]);i.lineEnd()}else o.push(t=new Ge(r,n,null,!0)),u.push(t.o=new Ge(r,null,t,!1)),o.push(t=new Ge(l,n,null,!1)),u.push(t.o=new Ge(l,null,t,!0))}}),o.length){for(u.sort(e),Um(o),Um(u),$=0,l=u.length;$<l;++$)u[$].e=t=!t;for(var a,f,s=o[0];;){for(var p=s,v=!0;p.v;)if((p=p.n)===s)return;a=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(v)for($=0,l=a.length;$<l;++$)i.point((f=a[$])[0],f[1]);else r(p.x,p.n.x,1,i);p=p.n}else{if(v)for(a=p.p.z,$=a.length-1;$>=0;--$)i.point((f=a[$])[0],f[1]);else r(p.x,p.p.x,-1,i);p=p.p}a=(p=p.o).z,v=!v}while(!p.v);i.lineEnd()}}};function Um(n){if(e=n.length){for(var e,t,r=0,i=n[0];++r<e;)i.n=t=n[r],t.p=i,i=t;i.n=t=n[0],t.p=i}}var Vm=function($,t){return $<t?-1:$>t?1:$>=t?0:NaN};var yv=function(r){return 1===r.length&&(r=zv(r)),{left:function(n,t,e,$){for(null==e&&(e=0),null==$&&($=n.length);e<$;){var a=e+$>>>1;r(n[a],t)<0?e=a+1:$=a}return e},right:function(n,t,e,$){for(null==e&&(e=0),null==$&&($=n.length);e<$;){var a=e+$>>>1;r(n[a],t)>0?$=a:e=a+1}return e}}};function zv(r){return function(n,t){return Vm(r(n),t)}}var Wm=yv(Vm),Vw=Wm.right;var Ww=Wm.left;var Xm=Array.prototype,Xw=Xm.slice;var Yw=Xm.map;var Zw=Math.sqrt(50),$w=Math.sqrt(10),_w=Math.sqrt(2);var Ym=function(e){for(var t,r,$,o=e.length,d=-1,f=0;++d<o;)f+=e[d].length;for(r=new Array(f);--o>=0;)for(t=($=e[o]).length;--t>=0;)r[--f]=$[t];return r};var ed=1e9,Ie=-ed;function Av(n,o,t,$){function r(r,i){return n<=r&&r<=t&&o<=i&&i<=$}function i(r,i,a,p){var u=0,d=0;if(null==r||(u=e(r,a))!==(d=e(i,a))||l(r,i)<0^a>0)do{p.point(0===u||3===u?n:t,u>1?$:o)}while((u=(u+a+4)%4)!==d);else p.point(i[0],i[1])}function e($,r){return z($[0]-n)<F?r>0?0:3:z($[0]-t)<F?r>0?2:1:z($[1]-o)<F?r>0?1:0:r>0?3:2}function a(n,o){return l(n.x,o.x)}function l(n,o){var t=e(n,1),$=e(o,1);return t!==$?t-$:0===t?o[1]-n[1]:1===t?n[0]-o[0]:2===t?n[1]-o[1]:o[0]-n[0]}return function(e){var l,p,u,d,E,c,F,f,x,v,m,M=e,h=Sm(),s={point:g,lineStart:function(){s.point=y,p&&p.push(u=[]);v=!0,x=!1,F=f=NaN},lineEnd:function(){l&&(y(d,E),c&&x&&h.rejoin(),l.push(h.result()));s.point=g,x&&M.lineEnd()},polygonStart:function(){M=h,l=[],p=[],m=!0},polygonEnd:function(){var o=function(){for(var o=0,t=0,r=p.length;t<r;++t)for(var i,e,a=p[t],l=1,u=a.length,d=a[0],E=d[0],c=d[1];l<u;++l)i=E,e=c,d=a[l],E=d[0],c=d[1],e<=$?c>$&&(E-i)*($-e)>(c-e)*(n-i)&&++o:c<=$&&(E-i)*($-e)<(c-e)*(n-i)&&--o;return o}(),t=m&&o,r=(l=Ym(l)).length;(t||r)&&(e.polygonStart(),t&&(e.lineStart(),i(null,null,1,e),e.lineEnd()),r&&Tm(l,a,o,i,e),e.polygonEnd());M=e,l=p=u=null}};function g(n,o){r(n,o)&&M.point(n,o)}function y(i,e){var a=r(i,e);if(p&&u.push([i,e]),v)d=i,E=e,c=a,v=!1,a&&(M.lineStart(),M.point(i,e));else if(a&&x)M.point(i,e);else{var l=[F=Math.max(Ie,Math.min(ed,F)),f=Math.max(Ie,Math.min(ed,f))],h=[i=Math.max(Ie,Math.min(ed,i)),e=Math.max(Ie,Math.min(ed,e))];xv(l,h,n,o,t,$)?(x||(M.lineStart(),M.point(l[0],l[1])),M.point(h[0],h[1]),a||M.lineEnd(),m=!1):a&&(M.lineStart(),M.point(i,e),m=!1)}F=i,f=e,x=a}return s}}var oi=ob(),Zm=function(r,$){var i=$[0],t=$[1],a=[j(i),-k(i),0],o=0,e=0;oi.reset();for(var p=0,w=r.length;p<w;++p)if(G=(B=r[p]).length)for(var B,G,m=B[G-1],s=m[0],n=m[1]/2+xe,c=j(n),l=k(n),u=0;u<G;++u,s=d,c=q,l=x,m=v){var v=B[u],d=v[0],f=v[1]/2+xe,q=j(f),x=k(f),P=d-s,h=P>=0?1:-1,g=h*P,z=g>y,C=c*q;if(oi.add(Xa(C*h*j(g),l*x+C*k(g))),o+=z?P+h*_:P,z^s>=i^d>=i){var I=rc(Sb(m),Sb(v));De(I);var N=rc(a,I);De(N);var b=(z^P>=0?-1:1)*Ya(N[2]);(t>b||t===b&&(I[0]||I[1]))&&(e+=z^P>=0?1:-1)}}return(o<-F||o<F&&oi<-F)^1&e};var Bv,$m,_m,pi=ob(),uc={sphere:s,point:s,lineStart:Cv,lineEnd:s,polygonStart:s,polygonEnd:s};function Cv(){uc.point=Ev,uc.lineEnd=Dv}function Dv(){uc.point=uc.lineEnd=s}function Ev($,e){$*=B,e*=B,Bv=$,$m=j(e),_m=k(e),uc.point=Fv}function Fv($,e){$*=B,e*=B;var r=j(e),t=k(e),a=z($-Bv),n=k(a),i=t*j(a),b=_m*r-$m*t*n,o=$m*r+_m*t*n;pi.add(Xa(ja(i*i+b*b),o)),Bv=$,$m=r,_m=t}var Gv=function($){return pi.reset(),Bm($,uc),+pi};var qi=[null,null],Hv={type:"LineString",coordinates:qi},Je=function($,r){return qi[0]=$,qi[1]=r,Gv(Hv)};var an={Sphere:function(){return!0},Point:function(t,n){return bn(t.coordinates,n)},MultiPoint:function(t,n){for(var r=t.coordinates,$=-1,e=r.length;++$<e;)if(bn(r[$],n))return!0;return!1},LineString:function(t,n){return cn(t.coordinates,n)},MultiLineString:function(t,n){for(var r=t.coordinates,$=-1,e=r.length;++$<e;)if(cn(r[$],n))return!0;return!1},Polygon:function(t,n){return dn(t.coordinates,n)},MultiPolygon:function(t,n){for(var r=t.coordinates,$=-1,e=r.length;++$<e;)if(dn(r[$],n))return!0;return!1},GeometryCollection:function(t,n){for(var r=t.geometries,$=-1,e=r.length;++$<e;)if(Iv(r[$],n))return!0;return!1}};function Iv(t,n){return!(!t||!an.hasOwnProperty(t.type))&&an[t.type](t,n)}function bn(t,n){return 0===Je(t,n)}function cn(t,n){var r=Je(t[0],t[1]);return Je(t[0],n)+Je(n,t[1])<=r+F}function dn(t,n){return!!Zm(t.map(Jv),en(n))}function Jv(t){return(t=t.map(en)).pop(),t}function en(t){return[t[0]*B,t[1]*B]}var fn=function(r){return r};var Kv,Lv,Mv,Nv,ri=ob(),si=ob(),Tb={point:s,lineStart:s,lineEnd:s,polygonStart:function(){Tb.lineStart=Ov,Tb.lineEnd=Qv},polygonEnd:function(){Tb.lineStart=Tb.lineEnd=Tb.point=s,ri.add(z(si)),si.reset()},result:function(){var e=ri/2;return ri.reset(),e}};function Ov(){Tb.point=Pv}function Pv(e,$){Tb.point=gn,Kv=Mv=e,Lv=Nv=$}function gn(e,$){si.add(Nv*e-Mv*$),Mv=e,Nv=$}function Qv(){gn(Kv,Lv)}var Ke=1/0,hn=Ke,ti=-Ke,jn=ti,kn={point:Rv,lineStart:s,lineEnd:s,polygonStart:s,polygonEnd:s,result:function(){var $=[[Ke,hn],[ti,jn]];return ti=jn=-(hn=Ke=1/0),$}};function Rv($,t){$<Ke&&(Ke=$),$>ti&&(ti=$),t<hn&&(hn=t),t>jn&&(jn=t)}var Sv,Tv,vc,wc,Uv=0,Vv=0,Le=0,Wv=0,Xv=0,ui=0,Yv=0,Zv=0,vi=0,Ga={point:Ub,lineStart:ln,lineEnd:mn,polygonStart:function(){Ga.lineStart=aw,Ga.lineEnd=bw},polygonEnd:function(){Ga.point=Ub,Ga.lineStart=ln,Ga.lineEnd=mn},result:function(){var $=vi?[Yv/vi,Zv/vi]:ui?[Wv/ui,Xv/ui]:Le?[Uv/Le,Vv/Le]:[NaN,NaN];return Uv=Vv=Le=Wv=Xv=ui=Yv=Zv=vi=0,$}};function Ub($,r){Uv+=$,Vv+=r,++Le}function ln(){Ga.point=$v}function $v($,r){Ga.point=_v,Ub(vc=$,wc=r)}function _v($,r){var P=$-vc,a=r-wc,t=ja(P*P+a*a);Wv+=t*(vc+$)/2,Xv+=t*(wc+r)/2,ui+=t,Ub(vc=$,wc=r)}function mn(){Ga.point=Ub}function aw(){Ga.point=cw}function bw(){nn(Sv,Tv)}function cw($,r){Ga.point=nn,Ub(Sv=vc=$,Tv=wc=r)}function nn($,r){var P=$-vc,a=r-wc,t=ja(P*P+a*a);Wv+=t*(vc+$)/2,Xv+=t*(wc+r)/2,ui+=t,Yv+=(t=wc*$-vc*r)*(vc+$),Zv+=t*(wc+r),vi+=3*t,Ub(vc=$,wc=r)}function dw(t){this._context=t}dw.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,i){switch(this._point){case 0:this._context.moveTo(t,i),this._point=1;break;case 1:this._context.lineTo(t,i);break;default:this._context.moveTo(t+this._radius,i),this._context.arc(t,i,this._radius,0,_);}},result:s};var ew,fw,gw,on,pn,wi=ob(),xi={point:s,lineStart:function(){xi.point=hw},lineEnd:function(){ew&&qn(fw,gw),xi.point=s},polygonStart:function(){ew=!0},polygonEnd:function(){ew=null},result:function(){var $=+wi;return wi.reset(),$}};function hw($,r){xi.point=qn,fw=on=$,gw=pn=r}function qn($,r){on-=$,pn-=r,wi.add(ja(on*on+pn*pn)),on=$,pn=r}function iw(){this._string=[]}function rn(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}iw.prototype={_radius:4.5,_circle:rn(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,i){switch(this._point){case 0:this._string.push("M",t,",",i),this._point=1;break;case 1:this._string.push("L",t,",",i);break;default:null==this._circle&&(this._circle=rn(this._radius)),this._string.push("M",t,",",i,this._circle);}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};var sn=function(n,t,r,i){return function(o,e){var l,$,p,a=t(e),u=o.invert(i[0],i[1]),h=Sm(),f=t(h),c=!1,J={point:g,lineStart:m,lineEnd:s,polygonStart:function(){J.point=v,J.lineStart=S,J.lineEnd=y,$=[],l=[]},polygonEnd:function(){J.point=g,J.lineStart=m,J.lineEnd=s,$=Ym($);var n=Zm(l,u);$.length?(c||(e.polygonStart(),c=!0),Tm($,kw,n,r,e)):n&&(c||(e.polygonStart(),c=!0),e.lineStart(),r(null,null,1,e),e.lineEnd()),c&&(e.polygonEnd(),c=!1),$=l=null},sphere:function(){e.polygonStart(),e.lineStart(),r(null,null,1,e),e.lineEnd(),e.polygonEnd()}};function g(t,r){var i=o(t,r);n(t=i[0],r=i[1])&&e.point(t,r)}function d(n,t){var r=o(n,t);a.point(r[0],r[1])}function m(){J.point=d,a.lineStart()}function s(){J.point=g,a.lineEnd()}function v(n,t){p.push([n,t]);var r=o(n,t);f.point(r[0],r[1])}function S(){f.lineStart(),p=[]}function y(){v(p[0][0],p[0][1]),f.lineEnd();var n,t,r,i,o=f.clean(),a=h.result(),u=a.length;if(p.pop(),l.push(p),p=null,u)if(1&o){if((t=(r=a[0]).length-1)>0){for(c||(e.polygonStart(),c=!0),e.lineStart(),n=0;n<t;++n)e.point((i=r[n])[0],i[1]);e.lineEnd()}}else u>1&&2&o&&a.push(a.pop().concat(a.shift())),$.push(a.filter(jw))}return J}};function jw(n){return n.length>1}function kw(n,t){return((n=n.x)[0]<0?n[1]-V-F:V-n[1])-((t=t.x)[0]<0?t[1]-V-F:V-t[1])}var tn=sn(function(){return!0},lw,nw,[-y,-V]);function lw($){var i,o=NaN,t=NaN,p=NaN;return{lineStart:function(){$.lineStart(),i=1},point:function(n,r){var e=n>0?y:-y,G=z(n-o);z(G-y)<F?($.point(o,t=(t+r)/2>0?V:-V),$.point(p,t),$.lineEnd(),$.lineStart(),$.point(e,t),$.point(n,t),i=0):p!==e&&G>=y&&(z(o-p)<F&&(o-=p*F),z(n-e)<F&&(n-=e*F),t=mw(o,t,n,r),$.point(p,t),$.lineEnd(),$.lineStart(),$.point(e,t),i=0),$.point(o=n,t=r),p=e},lineEnd:function(){$.lineEnd(),o=t=NaN},clean:function(){return 2-i}}}function mw($,i,o,t){var p,n,r=j($-o);return z(r)>F?bd((j(i)*(n=k(t))*j(o)-j(t)*(p=k(i))*j($))/(p*n*r)):(i+t)/2}function nw($,i,o,t){var p;if(null==$)p=o*V,t.point(-y,p),t.point(0,p),t.point(y,p),t.point(y,0),t.point(y,-p),t.point(0,-p),t.point(-y,-p),t.point(-y,0),t.point(-y,p);else if(z($[0]-i[0])>F){var n=$[0]<i[0]?y:-y;p=o*n/2,t.point(-n,p),t.point(0,p),t.point(n,p)}else t.point(i[0],i[1])}var ow=function($,i){var r=k($),t=r>0,c=z(r)>F;function l($,i){return k($)*k(i)>r}function n($,i,t){var c=Sb($),l=Sb(i),n=[1,0,0],o=rc(c,l),p=Be(o,o),a=o[0],e=p-a*a;if(!e)return!t&&$;var C=r*p/e,J=-r*a/e,m=rc(n,o),s=Ce(n,C),u=Ce(o,J);ii(s,u);var f=m,d=Be(s,f),v=Be(f,f),q=d*d-v*(Be(s,s)-1);if(!(q<0)){var S=ja(q),E=Ce(f,(-d-S)/v);if(ii(E,s),E=Ae(E),!t)return E;var x,D=$[0],b=i[0],h=$[1],A=i[1];b<D&&(x=D,D=b,b=x);var I=b-D,P=z(I-y)<F;if(!P&&A<h&&(x=h,h=A,A=x),P||I<F?P?h+A>0^E[1]<(z(E[0]-D)<F?h:A):h<=E[1]&&E[1]<=A:I>y^(D<=E[0]&&E[0]<=b)){var g=Ce(f,(-d+S)/v);return ii(g,s),[E,Ae(g)]}}}function o(i,r){var c=t?$:y-$,l=0;return i<-c?l|=1:i>c&&(l|=2),r<-c?l|=4:r>c&&(l|=8),l}return sn(l,function($){var i,r,p,a,e;return{lineStart:function(){a=p=!1,e=1},point:function(C,J){var m,s=[C,J],u=l(C,J),f=t?u?0:o(C,J):u?o(C+(C<0?y:-y),J):0;if(!i&&(a=p=u)&&$.lineStart(),u!==p&&(!(m=n(i,s))||He(i,m)||He(s,m))&&(s[0]+=F,s[1]+=F,u=l(s[0],s[1])),u!==p)e=0,u?($.lineStart(),m=n(s,i),$.point(m[0],m[1])):(m=n(i,s),$.point(m[0],m[1]),$.lineEnd()),i=m;else if(c&&i&&t^u){var d;f&r||!(d=n(s,i,!0))||(e=0,t?($.lineStart(),$.point(d[0][0],d[0][1]),$.point(d[1][0],d[1][1]),$.lineEnd()):($.point(d[1][0],d[1][1]),$.lineEnd(),$.lineStart(),$.point(d[0][0],d[0][1])))}!u||i&&He(i,s)||$.point(s[0],s[1]),i=s,p=u,r=f},lineEnd:function(){p&&$.lineEnd(),i=null},clean:function(){return e|(a&&p)<<1}}},function(r,t,c,l){vv(l,$,i,c,r,t)},t?[0,-$]:[-y,$-y])};function un(r){return function(t){var n=new yi;for(var o in r)n[o]=r[o];return n.stream=t,n}}function yi(){}yi.prototype={constructor:yi,point:function(r,t){this.stream.point(r,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function vn(t,e,$){var r=e[1][0]-e[0][0],a=e[1][1]-e[0][1],c=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=c&&t.clipExtent(null),Bm($,t.stream(kn));var n=kn.result(),i=Math.min(r/(n[1][0]-n[0][0]),a/(n[1][1]-n[0][1])),m=+e[0][0]+(r-i*(n[1][0]+n[0][0]))/2,p=+e[0][1]+(a-i*(n[1][1]+n[0][1]))/2;return null!=c&&t.clipExtent(c),t.scale(150*i).translate([m,p])}function pw(t,e,$){return vn(t,[[0,0],e],$)}var wn=16,qw=k(30*B),xn=function(n,$){return+$?sw(n,$):rw(n)};function rw(n){return un({point:function($,t){$=n($,t),this.stream.point($[0],$[1])}})}function sw(n,$){function t(r,i,o,a,e,p,h,A,s,c,u,l,m,f){var v=h-r,d=A-i,x=v*v+d*d;if(x>4*$&&m--){var E=a+c,S=e+u,D=p+l,b=ja(E*E+S*S+D*D),g=Ya(D/=b),q=z(z(D)-1)<F||z(o-s)<F?(o+s)/2:Xa(S,E),y=n(q,g),N=y[0],M=y[1],j=N-r,k=M-i,w=d*j-v*k;(w*w/x>$||z((v*j+d*k)/x-.5)>.3||a*c+e*u+p*l<qw)&&(t(r,i,o,a,e,p,N,M,q,E/=b,S/=b,D,m,f),f.point(N,M),t(N,M,q,E,S,D,h,A,s,c,u,l,m,f))}}return function($){var r,i,o,a,e,p,h,A,s,c,u,l,m={point:f,lineStart:v,lineEnd:x,polygonStart:function(){$.polygonStart(),m.lineStart=E},polygonEnd:function(){$.polygonEnd(),m.lineStart=v}};function f(t,r){t=n(t,r),$.point(t[0],t[1])}function v(){A=NaN,m.point=d,$.lineStart()}function d(r,i){var o=Sb([r,i]),a=n(r,i);t(A,s,h,c,u,l,A=a[0],s=a[1],h=r,c=o[0],u=o[1],l=o[2],wn,$),$.point(A,s)}function x(){m.point=f,$.lineEnd()}function E(){v(),m.point=S,m.lineEnd=D}function S(n,$){d(r=n,$),i=A,o=s,a=c,e=u,p=l,m.point=d}function D(){t(A,s,h,c,u,l,i,o,r,a,e,p,wn,$),m.lineEnd=x,x()}return m}}var tw=un({point:function(t,r){this.stream.point(t*B,r*B)}});function uw(t){return vw(function(){return t})()}function vw(t){var r,$,e,p,i,n,o,a,u,l,K=150,c=480,m=250,s=0,f=0,d=0,g=0,x=0,h=null,q=tn,v=null,j=fn,y=.5,E=xn(R,y);function M(t){return[(t=i(t[0]*B,t[1]*B))[0]*K+$,e-t[1]*K]}function A(t){return(t=i.invert((t[0]-$)/K,(e-t[1])/K))&&[t[0]*T,t[1]*T]}function R(t,p){return[(t=r(t,p))[0]*K+$,e-t[1]*K]}function z(){i=Rm(p=Nm(d,g,x),r);var t=r(s,f);return $=c-t[0]*K,e=m+t[1]*K,S()}function S(){return u=l=null,M}return M.stream=function(t){return u&&l===t?u:u=tw(q(p,E(j(l=t))))},M.clipAngle=function(t){return arguments.length?(q=+t?ow(h=t*B,6*B):(h=null,tn),S()):h*T},M.clipExtent=function(t){return arguments.length?(j=null==t?(v=n=o=a=null,fn):Av(v=+t[0][0],n=+t[0][1],o=+t[1][0],a=+t[1][1]),S()):null==v?null:[[v,n],[o,a]]},M.scale=function(t){return arguments.length?(K=+t,z()):K},M.translate=function(t){return arguments.length?(c=+t[0],m=+t[1],z()):[c,m]},M.center=function(t){return arguments.length?(s=t[0]%360*B,f=t[1]%360*B,z()):[s*T,f*T]},M.rotate=function(t){return arguments.length?(d=t[0]%360*B,g=t[1]%360*B,x=t.length>2?t[2]%360*B:0,z()):[d*T,g*T,x*T]},M.precision=function(t){return arguments.length?(E=xn(R,y=t*t),S()):ja(y)},M.fitExtent=function(t,r){return vn(M,t,r)},M.fitSize=function(t,r){return pw(M,t,r)},function(){return r=t.apply(this,arguments),M.invert=r.invert&&A,z()}}function yn($){return function(t,r){var s=k(t),i=k(r),a=$(s*i);return[a*i*j(t),a*j(r)]}}function fd($){return function(t,r){var s=ja(t*t+r*r),i=$(s),a=j(i),o=k(i);return[Xa(t*a,s*o),Ya(s&&r*a/s)]}}var ww=yn(function($){return ja(2/(1+$))});ww.invert=fd(function($){return 2*Ya($/2)});var xw=yn(function(t){return(t=xm(t))&&t/j(t)});xw.invert=fd(function(t){return t});function zn(t,r){return[t,vm(wm((V+r)/2))]}zn.invert=function(t,r){return[t,2*bd(um(r))-V]};function yw(t){var r,n,$,e=uw(t),o=e.center,a=e.scale,i=e.translate,c=e.clipExtent,l=null;function p(){var o=y*a(),i=e(wv(e.rotate()).invert([0,0]));return c(null==l?[[i[0]-o,i[1]-o],[i[0]+o,i[1]+o]]:t===zn?[[Math.max(i[0]-o,l),r],[Math.min(i[0]+o,n),$]]:[[l,Math.max(i[1]-o,r)],[n,Math.min(i[1]+o,$)]])}return e.scale=function(t){return arguments.length?(a(t),p()):a()},e.translate=function(t){return arguments.length?(i(t),p()):i()},e.center=function(t){return arguments.length?(o(t),p()):o()},e.clipExtent=function(t){return arguments.length?(null==t?l=r=n=$=null:(l=+t[0][0],r=+t[0][1],n=+t[1][0],$=+t[1][1]),p()):null==l?null:[[l,r],[n,$]]},p()}function An(e,r){return[e,r]}An.invert=An;function zw(o,$){var r=k($),t=k(o)*r;return[r*j(o)/t,j($)/t]}zw.invert=fd(bd);function Aw(r,$){var t=$*$,a=t*t;return[r*(.8707-.131979*t+a*(a*(.003971*t-.001529*a)-.013791)),$*(1.007226+t*(.015085+a*(.028874*t-.044475-.005916*a)))]}Aw.invert=function(r,$){var t,a=$,e=25;do{var o=a*a,n=o*o;a-=t=(a*(1.007226+o*(.015085+n*(.028874*o-.044475-.005916*n)))-$)/(1.007226+o*(.045255+n*(.259866*o-.311325-.005916*11*n)))}while(z(t)>F&&--e>0);return[r/(.8707+(o=a*a)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),a]};function Bw($,r){return[k(r)*j($),j(r)]}Bw.invert=fd(Ya);function Cw($,r){var e=k(r),t=1+k($)*e;return[e*j($)/t,j(r)/t]}Cw.invert=fd(function($){return 2*bd($)});function Bn(e,r){return[vm(wm((V+r)/2)),-e]}Bn.invert=function(e,r){return[-r,2*bd(um(e))-V]};var Dw=function(){var e=yw(Bn),r=e.center,t=e.rotate;return e.center=function(e){return arguments.length?r([-e[1],e[0]]):[(e=r())[1],-e[0]]},e.rotate=function(e){return arguments.length?t([e[0],e[1],e.length>2?e[2]+90:90]):[(e=t())[0],e[1],e[2]-90]},t([0,0,90]).scale(159.155)};class Ew{constructor(t){navigator.serviceWorker.register("service-worker.js").then(e=>{Notification.requestPermission().then(a=>{"granted"===a&&(this.registration=e,navigator.serviceWorker.addEventListener("message",e=>{e.data.action&&t(e.data)}))})})}showNotification(t,e){this.registration&&this.registration.showNotification(t,e)}}var Fw={};Fw="lost.4ba911d7.jpg";class Gw extends EventTarget{constructor(t,e,i){super(),this.view=t,this.segment=e,this.distance=i,this.geolocation=new pj({projection:this.view.getProjection()}),this.positionFeature=new K(new na([])),this.positionFeature.setStyle(nb.position),this.shortestLineFeature=new K(new Da([])),this.shortestLineFeature.setStyle(nb.shortestLine),this.geolocation.on("change:position",this.onPositionChange.bind(this)),this.notifier=new Ew(this.onAction.bind(this)),this.difference=0,this.outside=!1,this.mutted=!1}onAction(t){this.mutted="mute"===t.action,this.notify()}onPositionChange(t){const e=t.target.getPosition();Ze(this.view.calculateExtent(),e)||this.view.animate({center:e,duration:250}),this.positionFeature.getGeometry().setCoordinates(e);const i=this.segment.getClosestPoint(e);this.shortestLineFeature.getGeometry().setCoordinates([e,i]);const o=Rc(i,e);this.difference=o-this.distance,this.outside=this.difference>0}notify(){const t=[];var $kz0$$interop$default=Ne(Fw);this.mutted?t.push({action:"Unmute",title:"Unmute"}):t.push({action:"mute",title:"Mute"}),this.notifier.showNotification("You are lost!",{body:`${Math.round(this.difference)}m away from the track `,image:$kz0$$interop$default.d,tag:"outside",renotify:!this.mutted,actions:t})}set outside(t){t&&this.notify(),this.positionFeature.set("outside",t),this.shortestLineFeature.set("outside",t);const e=new CustomEvent("change",{detail:{outside:t,difference:this.difference}});this.dispatchEvent(e)}get tracking(){return this.geolocation.getTracking()}set tracking(t){this.geolocation.setTracking(t),this.positionFeature.set("visible",t),this.shortestLineFeature.set("visible",t)}}const gd=new Da([]),Cn=new K(gd);Cn.setStyle(nb.track);const zi=new oa([]),Dn=new K(zi);Dn.setStyle(nb.buffer);const Ai=new URLSearchParams(location.search),En=Ai.has("width")?Ai.get("width"):75,Hw=$j(Ai.get("gpx"),new Ul,(e,$)=>{for(const r of e){const e=r.getGeometry(),o=e.getType();if("MultiLineString"===o||"LineString"===o){e.transform($,ad.getProjection()),e.getLineString?gd.setCoordinates(e.getLineString(0).getCoordinates()):gd.setCoordinates(e.getCoordinates());const r=Qu(gd,ad.getProjection(),En);zi.setCoordinates(r),ad.fit(zi)}}});Hw(),ci.setTarget("map");const Me=new Gw(ad,gd,En);ci.addLayer(new fb({source:new gb({features:[Cn,Dn]}),updateWhileInteracting:!0})),ci.addLayer(new fb({source:new gb({features:[Me.positionFeature,Me.shortestLineFeature]}),updateWhileInteracting:!0}));const Bi=document.querySelector(".controls .start"),Ci=document.querySelector(".controls .stop");Bi.addEventListener("click",()=>{Me.tracking=!0,Bi.style.display="none",Ci.style.display=""}),Ci.addEventListener("click",()=>{Me.tracking=!1,Bi.style.display="",Ci.style.display="none"});return{"Focm":{}};});